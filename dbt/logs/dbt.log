[0m06:53:09.799597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8253271f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825110c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825110c550>]}


============================== 06:53:09.803724 | bcbe0d8d-2536-48b4-b816-8eab0ae853e8 ==============================
[0m06:53:09.803724 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:53:09.804906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:53:10.133165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825305bf10>]}
[0m06:53:10.201074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82511b4ee0>]}
[0m06:53:10.202763 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:53:10.295848 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:53:10.300260 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:53:10.301269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824fe17760>]}
[0m06:53:11.953046 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:53:11.954380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824fa8c490>]}
[0m06:53:12.219509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m06:53:12.238729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824df8b130>]}
[0m06:53:12.481236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824fa8c040>]}
[0m06:53:12.484045 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 500 macros
[0m06:53:12.485627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824df86730>]}
[0m06:53:12.489003 [info ] [MainThread]: 
[0m06:53:12.490826 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:53:12.500721 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:53:12.524938 [debug] [ThreadPool]: dbt-sqlserver
[0m06:53:12.526496 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:53:12.527682 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:53:12.528545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:12.529283 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:12.575839 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:12.579673 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:53:12.581657 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:53:12.583793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m06:53:12.592774 [debug] [ThreadPool]: dbt-sqlserver
[0m06:53:12.593955 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:53:12.594673 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:53:12.595313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:12.595990 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:12.609439 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:12.645358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:53:12.647674 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:53:12.648652 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:53:12.651565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824e1f92b0>]}
[0m06:53:12.652668 [debug] [MainThread]: On master: COMMIT
[0m06:53:12.653558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:12.654670 [info ] [MainThread]: 
[0m06:53:12.663962 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m06:53:12.665449 [info ] [Thread-1  ]: 1 of 2 START sql view model dbo.stg_customers .................................. [RUN]
[0m06:53:12.667276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m06:53:12.668525 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m06:53:12.678475 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m06:53:12.692623 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m06:53:12.736064 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m06:53:12.750623 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:53:12.751510 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as with source as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

staged as (
    select
        CustomerID,
        PersonID,
        StoreID,
        TerritoryID,
        AccountNumber,
        rowguid,
        ModifiedDate
    from source
)

select * from staged;
    ')


[0m06:53:12.752448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:53:12.753251 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:12.769704 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:12.773004 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:53:12.774856 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m06:53:12.776080 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m06:53:12.777377 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_customers.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:12.779772 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:53:12.782924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82511ab7f0>]}
[0m06:53:12.784700 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbo.stg_customers ......................... [[31mERROR[0m in 0.11s]
[0m06:53:12.787214 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m06:53:12.788714 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m06:53:12.790091 [info ] [Thread-1  ]: 2 of 2 START sql view model dbo.stg_example .................................... [RUN]
[0m06:53:12.791841 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.stg_customers, now model.dbt_sqlserver_project.stg_example)
[0m06:53:12.792878 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m06:53:12.797452 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m06:53:12.803326 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m06:53:12.812194 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m06:53:12.818939 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:53:12.820315 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:53:12.821682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:53:12.822681 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:12.837902 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:12.840335 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:53:12.842043 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m06:53:12.842952 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m06:53:12.844134 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_example.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:12.845498 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:53:12.846509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcbe0d8d-2536-48b4-b816-8eab0ae853e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824fc4c730>]}
[0m06:53:12.847627 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbo.stg_example ........................... [[31mERROR[0m in 0.05s]
[0m06:53:12.848947 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m06:53:12.851035 [debug] [MainThread]: On master: COMMIT
[0m06:53:12.852237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:12.853165 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m06:53:12.854024 [info ] [MainThread]: 
[0m06:53:12.855044 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m06:53:12.856704 [debug] [MainThread]: Command end result
[0m06:53:12.915420 [info ] [MainThread]: 
[0m06:53:12.916520 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:53:12.917411 [info ] [MainThread]: 
[0m06:53:12.918466 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:12.919370 [info ] [MainThread]: 
[0m06:53:12.920339 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:12.921167 [info ] [MainThread]: 
[0m06:53:12.922066 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m06:53:12.923586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.200623, "process_user_time": 4.449025, "process_kernel_time": 0.241675, "process_mem_max_rss": "127408", "process_in_blocks": "120", "process_out_blocks": "216", "command_success": false}
[0m06:53:12.924548 [debug] [MainThread]: Command `dbt run` failed at 06:53:12.924411 after 3.20 seconds
[0m06:53:12.925411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8253271f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825183a0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824fa88fa0>]}
[0m06:53:12.926340 [debug] [MainThread]: Flushing usage events
[0m06:53:25.944742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8225cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b800fa640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b800fa5e0>]}


============================== 06:53:25.948538 | 8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6 ==============================
[0m06:53:25.948538 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:53:25.949958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:53:26.247354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7f02d640>]}
[0m06:53:26.313331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b802e9ca0>]}
[0m06:53:26.314861 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:53:26.411692 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:53:28.971682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:28.972551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:28.981811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m06:53:29.036934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7ea40130>]}
[0m06:53:29.234655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b82481130>]}
[0m06:53:29.235789 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 500 macros
[0m06:53:29.236882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7ea6ad60>]}
[0m06:53:29.239220 [info ] [MainThread]: 
[0m06:53:29.240731 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:53:29.247645 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:53:29.267626 [debug] [ThreadPool]: dbt-sqlserver
[0m06:53:29.268734 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:53:29.269710 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:53:29.270722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:29.271508 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:29.288636 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:29.290110 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:53:29.291779 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:53:29.293585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m06:53:29.300771 [debug] [ThreadPool]: dbt-sqlserver
[0m06:53:29.301510 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:53:29.302218 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:53:29.302823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:29.303739 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:29.314954 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:29.319431 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:53:29.321167 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:53:29.321793 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:53:29.324065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7ea8aaf0>]}
[0m06:53:29.324911 [debug] [MainThread]: On master: COMMIT
[0m06:53:29.325656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:29.326518 [info ] [MainThread]: 
[0m06:53:29.333891 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m06:53:29.334953 [info ] [Thread-1  ]: 1 of 2 START sql view model dbo.stg_customers .................................. [RUN]
[0m06:53:29.336000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m06:53:29.336766 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m06:53:29.346386 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m06:53:29.352006 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m06:53:29.392534 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m06:53:29.399681 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:53:29.400474 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as with source as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

staged as (
    select
        CustomerID,
        PersonID,
        StoreID,
        TerritoryID,
        AccountNumber,
        rowguid,
        ModifiedDate
    from source
)

select * from staged;
    ')


[0m06:53:29.401176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:53:29.402098 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:29.413270 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:29.415253 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:53:29.416593 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m06:53:29.417232 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m06:53:29.418171 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_customers.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:29.420097 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:53:29.422091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7f02d850>]}
[0m06:53:29.423079 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbo.stg_customers ......................... [[31mERROR[0m in 0.09s]
[0m06:53:29.424212 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m06:53:29.425135 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m06:53:29.425954 [info ] [Thread-1  ]: 2 of 2 START sql view model dbo.stg_example .................................... [RUN]
[0m06:53:29.427072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.stg_customers, now model.dbt_sqlserver_project.stg_example)
[0m06:53:29.427799 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m06:53:29.431749 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m06:53:29.437099 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m06:53:29.441989 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m06:53:29.447553 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:53:29.448552 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:53:29.449384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:53:29.450310 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:53:29.461200 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:53:29.463046 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:53:29.464486 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m06:53:29.465159 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m06:53:29.466111 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_example.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:29.467220 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:53:29.468055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8edb0f54-801d-4fcc-a39a-5ba6bcb5e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b80de4880>]}
[0m06:53:29.468989 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbo.stg_example ........................... [[31mERROR[0m in 0.04s]
[0m06:53:29.470040 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m06:53:29.471670 [debug] [MainThread]: On master: COMMIT
[0m06:53:29.472395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:29.472957 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m06:53:29.473626 [info ] [MainThread]: 
[0m06:53:29.474478 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m06:53:29.475892 [debug] [MainThread]: Command end result
[0m06:53:29.527205 [info ] [MainThread]: 
[0m06:53:29.528274 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:53:29.529524 [info ] [MainThread]: 
[0m06:53:29.530510 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:29.531534 [info ] [MainThread]: 
[0m06:53:29.532431 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:53:29.533227 [info ] [MainThread]: 
[0m06:53:29.534060 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m06:53:29.535376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3795267, "process_user_time": 2.633496, "process_kernel_time": 0.106619, "process_mem_max_rss": "120232", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m06:53:29.536226 [debug] [MainThread]: Command `dbt run` failed at 06:53:29.536106 after 1.38 seconds
[0m06:53:29.537073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8225cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b82481e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7eeb3ee0>]}
[0m06:53:29.537944 [debug] [MainThread]: Flushing usage events
[0m06:58:01.806095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6b2dafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f69177640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f691775e0>]}


============================== 06:58:01.810036 | db2e575c-b986-44f2-8210-a5b26a9387a5 ==============================
[0m06:58:01.810036 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:58:01.811361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:58:02.137756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f680ab640>]}
[0m06:58:02.206826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f69366ca0>]}
[0m06:58:02.208498 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:58:02.320480 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:58:02.639646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:58:02.640749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:58:02.649857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m06:58:02.710997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f67abc130>]}
[0m06:58:02.947815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6b4ff130>]}
[0m06:58:02.949160 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 500 macros
[0m06:58:02.950483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f67ae7d60>]}
[0m06:58:02.952761 [info ] [MainThread]: 
[0m06:58:02.954304 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:58:02.962759 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:58:02.986322 [debug] [ThreadPool]: dbt-sqlserver
[0m06:58:02.987935 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:58:02.989394 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:58:02.990596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:02.991575 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:03.028115 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:03.031367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:58:03.034024 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:58:03.036450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m06:58:03.044766 [debug] [ThreadPool]: dbt-sqlserver
[0m06:58:03.046014 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:58:03.046925 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:58:03.047651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:58:03.048608 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:03.062290 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:03.096179 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:58:03.098448 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:58:03.099955 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:58:03.103572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f67b09af0>]}
[0m06:58:03.104594 [debug] [MainThread]: On master: COMMIT
[0m06:58:03.105535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:58:03.106505 [info ] [MainThread]: 
[0m06:58:03.115693 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m06:58:03.117054 [info ] [Thread-1  ]: 1 of 2 START sql view model dbo.stg_customers .................................. [RUN]
[0m06:58:03.118153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m06:58:03.119074 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m06:58:03.129962 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m06:58:03.136910 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m06:58:03.182753 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m06:58:03.192085 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:58:03.193105 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as with source as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

staged as (
    select
        CustomerID,
        PersonID,
        StoreID,
        TerritoryID,
        AccountNumber,
        rowguid,
        ModifiedDate
    from source
)

select * from staged;
    ')


[0m06:58:03.193977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:58:03.194829 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:03.207263 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:03.209900 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:58:03.211445 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m06:58:03.212399 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m06:58:03.213578 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_customers.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:03.215376 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:58:03.217984 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6b4af040>]}
[0m06:58:03.219327 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbo.stg_customers ......................... [[31mERROR[0m in 0.10s]
[0m06:58:03.220633 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m06:58:03.221595 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m06:58:03.222637 [info ] [Thread-1  ]: 2 of 2 START sql view model dbo.stg_example .................................... [RUN]
[0m06:58:03.223891 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.stg_customers, now model.dbt_sqlserver_project.stg_example)
[0m06:58:03.224812 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m06:58:03.229823 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m06:58:03.236454 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m06:58:03.242167 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m06:58:03.247956 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:58:03.248923 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:58:03.249713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:58:03.250450 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:03.262451 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:03.264986 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:58:03.266644 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m06:58:03.267467 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m06:58:03.268678 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_example.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:03.270154 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:58:03.271168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2e575c-b986-44f2-8210-a5b26a9387a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f69e52af0>]}
[0m06:58:03.272205 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbo.stg_example ........................... [[31mERROR[0m in 0.05s]
[0m06:58:03.273360 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m06:58:03.275266 [debug] [MainThread]: On master: COMMIT
[0m06:58:03.276265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:03.276996 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m06:58:03.277865 [info ] [MainThread]: 
[0m06:58:03.278956 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m06:58:03.280635 [debug] [MainThread]: Command end result
[0m06:58:03.341529 [info ] [MainThread]: 
[0m06:58:03.342910 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:58:03.344298 [info ] [MainThread]: 
[0m06:58:03.345759 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:03.346977 [info ] [MainThread]: 
[0m06:58:03.348037 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:03.349072 [info ] [MainThread]: 
[0m06:58:03.350038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m06:58:03.351527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6213146, "process_user_time": 2.930688, "process_kernel_time": 0.378502, "process_mem_max_rss": "123776", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m06:58:03.352522 [debug] [MainThread]: Command `dbt run` failed at 06:58:03.352364 after 1.62 seconds
[0m06:58:03.353465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6b2dafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f67f20430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f67f20e80>]}
[0m06:58:03.354471 [debug] [MainThread]: Flushing usage events
[0m06:58:19.990545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915f27df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915d11b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915d11b5e0>]}


============================== 06:58:19.995066 | e56625ba-5318-4f47-ae7b-483db02e3fd4 ==============================
[0m06:58:19.995066 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:58:19.996399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:58:20.301833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915e49ca60>]}
[0m06:58:20.366987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915d1c31c0>]}
[0m06:58:20.369031 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:58:20.469840 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:58:20.706580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:58:20.707846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:58:20.717057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m06:58:20.777429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915ba61130>]}
[0m06:58:20.988962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915d1d8280>]}
[0m06:58:20.990329 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 500 macros
[0m06:58:20.991272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915ba8bc70>]}
[0m06:58:20.994294 [info ] [MainThread]: 
[0m06:58:20.995728 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:58:21.003012 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:58:21.025086 [debug] [ThreadPool]: dbt-sqlserver
[0m06:58:21.026552 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:58:21.027715 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:58:21.028864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:21.029741 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:21.061762 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:21.065553 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:58:21.068042 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:58:21.070356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m06:58:21.077966 [debug] [ThreadPool]: dbt-sqlserver
[0m06:58:21.080364 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:58:21.081392 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:58:21.082187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:58:21.082969 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:21.094739 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:21.125533 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:58:21.128466 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:58:21.130028 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:58:21.132720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915d1adca0>]}
[0m06:58:21.133754 [debug] [MainThread]: On master: COMMIT
[0m06:58:21.134695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:58:21.135488 [info ] [MainThread]: 
[0m06:58:21.144385 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m06:58:21.145733 [info ] [Thread-1  ]: 1 of 2 START sql view model dbo.stg_customers .................................. [RUN]
[0m06:58:21.147146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m06:58:21.148142 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m06:58:21.158819 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m06:58:21.165693 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m06:58:21.209775 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m06:58:21.216401 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:58:21.217277 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as with source as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

staged as (
    select
        CustomerID,
        PersonID,
        StoreID,
        TerritoryID,
        AccountNumber,
        rowguid,
        ModifiedDate
    from source
)

select * from staged;
    ')


[0m06:58:21.217940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:58:21.218688 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:21.231244 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:21.233395 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:58:21.234786 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m06:58:21.235855 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m06:58:21.237624 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_customers.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:21.239915 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:58:21.242179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915bac4e20>]}
[0m06:58:21.243261 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbo.stg_customers ......................... [[31mERROR[0m in 0.09s]
[0m06:58:21.244627 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m06:58:21.245823 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m06:58:21.246929 [info ] [Thread-1  ]: 2 of 2 START sql view model dbo.stg_example .................................... [RUN]
[0m06:58:21.248126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.stg_customers, now model.dbt_sqlserver_project.stg_example)
[0m06:58:21.249099 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m06:58:21.254584 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m06:58:21.261042 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m06:58:21.267059 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m06:58:21.274511 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:58:21.275483 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:58:21.276276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:58:21.277093 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:58:21.290356 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:58:21.292737 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:58:21.294972 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m06:58:21.296015 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m06:58:21.297230 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_example.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:21.299881 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:58:21.301964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56625ba-5318-4f47-ae7b-483db02e3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915abb1d00>]}
[0m06:58:21.303162 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbo.stg_example ........................... [[31mERROR[0m in 0.05s]
[0m06:58:21.304555 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m06:58:21.306893 [debug] [MainThread]: On master: COMMIT
[0m06:58:21.307793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:21.308493 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m06:58:21.309159 [info ] [MainThread]: 
[0m06:58:21.310008 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m06:58:21.311514 [debug] [MainThread]: Command end result
[0m06:58:21.365471 [info ] [MainThread]: 
[0m06:58:21.366884 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:58:21.368002 [info ] [MainThread]: 
[0m06:58:21.369222 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:21.370113 [info ] [MainThread]: 
[0m06:58:21.371132 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:58:21.371951 [info ] [MainThread]: 
[0m06:58:21.372811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m06:58:21.374191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4577643, "process_user_time": 2.559575, "process_kernel_time": 0.223962, "process_mem_max_rss": "120268", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m06:58:21.375074 [debug] [MainThread]: Command `dbt run` failed at 06:58:21.374954 after 1.46 seconds
[0m06:58:21.376050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915f27df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915d845460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915bfc9730>]}
[0m06:58:21.377327 [debug] [MainThread]: Flushing usage events
[0m06:59:15.160560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99afaf5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad9934c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad993460>]}


============================== 06:59:15.164334 | a85dd2fa-994c-44dc-a5a4-0677476a9187 ==============================
[0m06:59:15.164334 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:59:15.165831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:59:15.455720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b18c5f70>]}
[0m06:59:15.518552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adb82d60>]}
[0m06:59:15.520302 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:59:15.612404 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:59:15.846528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:59:15.848001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:59:15.857296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m06:59:15.911779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac2d9130>]}
[0m06:59:16.117721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac7e2f40>]}
[0m06:59:16.118976 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 500 macros
[0m06:59:16.120068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac304c40>]}
[0m06:59:16.122286 [info ] [MainThread]: 
[0m06:59:16.123712 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:59:16.131123 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:59:16.151878 [debug] [ThreadPool]: dbt-sqlserver
[0m06:59:16.153328 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:59:16.154470 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:59:16.155422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:59:16.156370 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:59:16.187699 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:59:16.190784 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:59:16.192658 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:59:16.195023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m06:59:16.203050 [debug] [ThreadPool]: dbt-sqlserver
[0m06:59:16.204046 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:59:16.204918 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:59:16.205776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:59:16.206599 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:59:16.218226 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:59:16.247129 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:59:16.249979 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:59:16.251150 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:59:16.253669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac8c6040>]}
[0m06:59:16.254592 [debug] [MainThread]: On master: COMMIT
[0m06:59:16.255439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:59:16.256413 [info ] [MainThread]: 
[0m06:59:16.263511 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m06:59:16.264546 [info ] [Thread-1  ]: 1 of 2 START sql view model dbo.stg_customers .................................. [RUN]
[0m06:59:16.265577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m06:59:16.266365 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m06:59:16.276106 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m06:59:16.282651 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m06:59:16.324987 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m06:59:16.332129 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:59:16.332869 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as with source as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

staged as (
    select
        CustomerID,
        PersonID,
        StoreID,
        TerritoryID,
        AccountNumber,
        rowguid,
        ModifiedDate
    from source
)

select * from staged;
    ')


[0m06:59:16.333560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:59:16.334475 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:59:16.345543 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:59:16.347352 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:59:16.348634 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m06:59:16.349329 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m06:59:16.350536 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_customers.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:59:16.352711 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:59:16.354714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac30b340>]}
[0m06:59:16.355709 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbo.stg_customers ......................... [[31mERROR[0m in 0.09s]
[0m06:59:16.356826 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m06:59:16.357623 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m06:59:16.358430 [info ] [Thread-1  ]: 2 of 2 START sql view model dbo.stg_example .................................... [RUN]
[0m06:59:16.359430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.stg_customers, now model.dbt_sqlserver_project.stg_example)
[0m06:59:16.360221 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m06:59:16.364167 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m06:59:16.370199 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m06:59:16.375121 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m06:59:16.380114 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:59:16.381051 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:59:16.381903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:59:16.382599 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:59:16.393562 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:59:16.395410 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:59:16.396900 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m06:59:16.397720 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m06:59:16.398786 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_example.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:59:16.400241 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m06:59:16.401164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a85dd2fa-994c-44dc-a5a4-0677476a9187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac747430>]}
[0m06:59:16.402067 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbo.stg_example ........................... [[31mERROR[0m in 0.04s]
[0m06:59:16.403117 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m06:59:16.404771 [debug] [MainThread]: On master: COMMIT
[0m06:59:16.405447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:59:16.406044 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m06:59:16.406678 [info ] [MainThread]: 
[0m06:59:16.407481 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m06:59:16.408820 [debug] [MainThread]: Command end result
[0m06:59:16.463712 [info ] [MainThread]: 
[0m06:59:16.465049 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:59:16.465905 [info ] [MainThread]: 
[0m06:59:16.466869 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:59:16.467728 [info ] [MainThread]: 
[0m06:59:16.468675 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m06:59:16.469539 [info ] [MainThread]: 
[0m06:59:16.470529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m06:59:16.471922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3854162, "process_user_time": 2.517454, "process_kernel_time": 0.14934, "process_mem_max_rss": "119920", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m06:59:16.472758 [debug] [MainThread]: Command `dbt run` failed at 06:59:16.472634 after 1.39 seconds
[0m06:59:16.473526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99afaf5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ae0bde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac3fb5e0>]}
[0m06:59:16.474328 [debug] [MainThread]: Flushing usage events
[0m07:03:38.131333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e35d18fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e34f52190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e33bb6430>]}


============================== 07:03:38.135108 | 266b2a5f-78a9-46fd-b530-3c705237ffad ==============================
[0m07:03:38.135108 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:03:38.136668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:03:38.145706 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m07:03:38.147528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09184614, "process_user_time": 1.426887, "process_kernel_time": 0.074538, "process_mem_max_rss": "88020", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:03:38.148727 [debug] [MainThread]: Command `dbt run` failed at 07:03:38.148537 after 0.09 seconds
[0m07:03:38.149496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e35d18fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e33bf7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e33bf7130>]}
[0m07:03:38.150287 [debug] [MainThread]: Flushing usage events
[0m07:03:45.912335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fc2f5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fb5a1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fa28f6d0>]}


============================== 07:03:45.916637 | a3109c93-2ebe-4682-b396-4a0ab12c4ad7 ==============================
[0m07:03:45.916637 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:03:45.918271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:03:45.926387 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m07:03:45.928439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09162557, "process_user_time": 1.513809, "process_kernel_time": 0.095945, "process_mem_max_rss": "87764", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:03:45.929486 [debug] [MainThread]: Command `dbt run` failed at 07:03:45.929289 after 0.09 seconds
[0m07:03:45.930405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fc2f5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fa37e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fa28f3d0>]}
[0m07:03:45.931214 [debug] [MainThread]: Flushing usage events
[0m07:04:53.957783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ee29fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ccc7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ccc75b0>]}


============================== 07:04:53.962298 | ead5f74b-ece4-41ff-96d1-747bf55fbc7a ==============================
[0m07:04:53.962298 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:04:53.963684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:04:53.972750 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m07:04:53.974768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09875185, "process_user_time": 2.031596, "process_kernel_time": 0.064838, "process_mem_max_rss": "88080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:04:53.975991 [debug] [MainThread]: Command `dbt run` failed at 07:04:53.975812 after 0.10 seconds
[0m07:04:53.977090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ee29fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763cd08400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763cd08460>]}
[0m07:04:53.978147 [debug] [MainThread]: Flushing usage events
[0m07:04:57.526983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468e8c1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468c75f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468c75f460>]}


============================== 07:04:57.532368 | 91cba385-dbc7-46ff-9e82-6b4527fd0dc1 ==============================
[0m07:04:57.532368 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:04:57.533737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:04:57.544561 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m07:04:57.546362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.13940796, "process_user_time": 1.851212, "process_kernel_time": 0.129909, "process_mem_max_rss": "87772", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:04:57.547542 [debug] [MainThread]: Command `dbt run` failed at 07:04:57.547365 after 0.14 seconds
[0m07:04:57.548495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468e8c1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468c7a0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468c7a0070>]}
[0m07:04:57.549396 [debug] [MainThread]: Flushing usage events
[0m07:05:38.373919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8887d1dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885bbb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885bbb5b0>]}


============================== 07:05:38.377671 | 5ba4ec3f-6d39-48c3-849c-c19cb06ab1ba ==============================
[0m07:05:38.377671 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:05:38.379096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:05:38.386918 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m07:05:38.388754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.085964374, "process_user_time": 1.419943, "process_kernel_time": 0.04369, "process_mem_max_rss": "87856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:05:38.389736 [debug] [MainThread]: Command `dbt run` failed at 07:05:38.389573 after 0.09 seconds
[0m07:05:38.390507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8887d1dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885c1c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885c1c460>]}
[0m07:05:38.391334 [debug] [MainThread]: Flushing usage events
[0m07:05:47.120464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989dfc4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989bdc8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989bdc85b0>]}


============================== 07:05:47.125121 | 93cf6a70-7500-427e-abb3-28902adbb7cb ==============================
[0m07:05:47.125121 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:05:47.126545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /usr/app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:05:47.136689 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m07:05:47.138537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.101290986, "process_user_time": 1.482643, "process_kernel_time": 0.04206, "process_mem_max_rss": "88108", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:05:47.139652 [debug] [MainThread]: Command `dbt run` failed at 07:05:47.139496 after 0.10 seconds
[0m07:05:47.140632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989dfc4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989c4ebaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989be830d0>]}
[0m07:05:47.141797 [debug] [MainThread]: Flushing usage events
[0m07:06:45.533240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa653e42ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa651c466d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa651c46670>]}


============================== 07:06:45.537495 | 5def4c35-bb29-4ab9-a88b-bc38400b3589 ==============================
[0m07:06:45.537495 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:06:45.538850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /usr/app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:06:45.919609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5def4c35-bb29-4ab9-a88b-bc38400b3589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa650b7d100>]}
[0m07:06:45.991578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5def4c35-bb29-4ab9-a88b-bc38400b3589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa650b03520>]}
[0m07:06:45.993285 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:06:46.114591 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:06:46.308530 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:06:46.310073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5def4c35-bb29-4ab9-a88b-bc38400b3589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652921b80>]}
[0m07:06:48.111667 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_Customer".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "Customer").
  
  To fix this, change the name of one of these resources:
  - source.dbt_sqlserver_project.raw.Customer (models/staging/sources.yml)
  - source.dbt_sqlserver_project.raw.Customer (models/sources.yml)
[0m07:06:48.113634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6772876, "process_user_time": 4.325555, "process_kernel_time": 0.128481, "process_mem_max_rss": "118900", "process_out_blocks": "136", "command_success": false, "process_in_blocks": "0"}
[0m07:06:48.114870 [debug] [MainThread]: Command `dbt run` failed at 07:06:48.114731 after 2.68 seconds
[0m07:06:48.115811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa653e42ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64abccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64abccbe0>]}
[0m07:06:48.116706 [debug] [MainThread]: Flushing usage events
[0m07:08:01.801478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91a8d5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9186d9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9186d9520>]}


============================== 07:08:01.806291 | 92ea5d39-7cff-4d0b-ad28-bec940b6c396 ==============================
[0m07:08:01.806291 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:08:01.807561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sales_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:08:02.183517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9175002b0>]}
[0m07:08:02.256150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd918795910>]}
[0m07:08:02.257914 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:08:02.411953 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:08:02.620739 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:08:02.622329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9193b73d0>]}
[0m07:08:04.804638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:08:04.826705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9155dc130>]}
[0m07:08:05.001332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd915535790>]}
[0m07:08:05.002960 [info ] [MainThread]: Found 4 models, 7 sources, 500 macros
[0m07:08:05.004670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9155b90d0>]}
[0m07:08:05.007858 [info ] [MainThread]: 
[0m07:08:05.010210 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:08:05.013112 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:08:05.038375 [debug] [ThreadPool]: dbt-sqlserver
[0m07:08:05.040281 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:08:05.042032 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:08:05.043728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:05.044716 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:08:05.100048 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:08:05.105307 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:08:05.107933 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:08:05.116966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:08:05.128986 [debug] [ThreadPool]: dbt-sqlserver
[0m07:08:05.130510 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:08:05.131811 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:08:05.133062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:08:05.134771 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:08:05.151588 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:08:05.196610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:08:05.200224 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:08:05.201788 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:08:05.204462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91760fe20>]}
[0m07:08:05.205796 [debug] [MainThread]: On master: COMMIT
[0m07:08:05.207321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:08:05.208713 [info ] [MainThread]: 
[0m07:08:05.224019 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:08:05.225558 [info ] [Thread-1  ]: 1 of 1 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:08:05.227162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_sales_orders)
[0m07:08:05.228782 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:08:05.242002 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:08:05.251937 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:08:05.396286 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:08:05.407555 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:08:05.409043 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select * from "AdventureWorks2014"."dbo"."SalesOrderHeader"
),

sales_order_detail as (
    select * from "AdventureWorks2014"."dbo"."SalesOrderDetail"
),

staged as (
    select
        soh.SalesOrderID,
        soh.OrderDate,
        soh.DueDate,
        soh.ShipDate,
        soh.Status,
        soh.CustomerID,
        soh.SalesPersonID,
        soh.TerritoryID,
        soh.BillToAddressID,
        soh.ShipToAddressID,
        soh.ShipMethodID,
        soh.SubTotal,
        soh.TaxAmt,
        soh.Freight,
        soh.TotalDue,
        sod.SalesOrderDetailID,
        sod.ProductID,
        sod.OrderQty,
        sod.UnitPrice,
        sod.UnitPriceDiscount,
        sod.LineTotal,
        sod.ModifiedDate as last_modified_date
    from sales_order_header soh
    left join sales_order_detail sod
        on soh.SalesOrderID = sod.SalesOrderID
)

select * from staged;
    ')


[0m07:08:05.410399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:08:05.411418 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:08:05.426210 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:08:05.428898 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:08:05.430742 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:08:05.431768 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:08:05.434020 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_sales_orders.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.SalesOrderHeader'. (208) (SQLMoreResults)")
[0m07:08:05.437330 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.SalesOrderHeader'. (208) (SQLMoreResults)")

[0m07:08:05.440412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ea5d39-7cff-4d0b-ad28-bec940b6c396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91a4e9d30>]}
[0m07:08:05.441897 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbo.stg_sales_orders ...................... [[31mERROR[0m in 0.21s]
[0m07:08:05.443796 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:08:05.446428 [debug] [MainThread]: On master: COMMIT
[0m07:08:05.447722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:08:05.449401 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:08:05.450310 [info ] [MainThread]: 
[0m07:08:05.451331 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m07:08:05.453046 [debug] [MainThread]: Command end result
[0m07:08:05.526326 [info ] [MainThread]: 
[0m07:08:05.528691 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:08:05.530778 [info ] [MainThread]: 
[0m07:08:05.532735 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.SalesOrderHeader'. (208) (SQLMoreResults)")
[0m07:08:05.534327 [info ] [MainThread]: 
[0m07:08:05.535853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:08:05.538542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8314035, "process_user_time": 5.357351, "process_kernel_time": 0.331492, "process_mem_max_rss": "127604", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m07:08:05.540015 [debug] [MainThread]: Command `dbt run` failed at 07:08:05.539810 after 3.83 seconds
[0m07:08:05.542611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91a8d5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9193b73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd916ffbd00>]}
[0m07:08:05.544853 [debug] [MainThread]: Flushing usage events
[0m07:08:11.664927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5bc095fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5b9f32550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5b9f324f0>]}


============================== 07:08:11.670112 | 4844cf48-b507-497b-8eff-77d7673cfbae ==============================
[0m07:08:11.670112 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:08:11.671732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m07:08:11.683140 [info ] [MainThread]: dbt version: 1.8.7
[0m07:08:11.684120 [info ] [MainThread]: python version: 3.9.22
[0m07:08:11.685056 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m07:08:11.685963 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m07:08:11.929722 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m07:08:11.931220 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m07:08:11.932684 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m07:08:11.934217 [info ] [MainThread]: adapter type: sqlserver
[0m07:08:11.935917 [info ] [MainThread]: adapter version: 1.8.7
[0m07:08:12.090814 [info ] [MainThread]: Configuration:
[0m07:08:12.092500 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:08:12.094244 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:08:12.095551 [info ] [MainThread]: Required dependencies:
[0m07:08:12.096940 [debug] [MainThread]: Executing "git --help"
[0m07:08:12.104122 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:08:12.105899 [debug] [MainThread]: STDERR: "b''"
[0m07:08:12.107098 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:08:12.108783 [info ] [MainThread]: Connection:
[0m07:08:12.110287 [info ] [MainThread]:   server: host.docker.internal
[0m07:08:12.111616 [info ] [MainThread]:   database: AdventureWorks2014
[0m07:08:12.112774 [info ] [MainThread]:   schema: dbo
[0m07:08:12.113948 [info ] [MainThread]:   UID: imrandbtnew
[0m07:08:12.115633 [info ] [MainThread]:   client_id: None
[0m07:08:12.117355 [info ] [MainThread]:   authentication: sql
[0m07:08:12.118870 [info ] [MainThread]:   encrypt: False
[0m07:08:12.120372 [info ] [MainThread]:   trust_cert: True
[0m07:08:12.121604 [info ] [MainThread]:   retries: 3
[0m07:08:12.123164 [info ] [MainThread]:   login_timeout: 0
[0m07:08:12.124667 [info ] [MainThread]:   query_timeout: 0
[0m07:08:12.125918 [info ] [MainThread]:   trace_flag: False
[0m07:08:12.127250 [info ] [MainThread]:   port: 1433
[0m07:08:12.129212 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:08:12.231843 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m07:08:12.233158 [debug] [MainThread]: Using sqlserver connection "debug"
[0m07:08:12.234664 [debug] [MainThread]: On debug: select 1 as id
[0m07:08:12.236974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:08:12.238846 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:08:12.290925 [debug] [MainThread]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:08:12.293467 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:08:12.296156 [debug] [MainThread]: On debug: Close
[0m07:08:12.298239 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:08:12.299911 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:08:12.302529 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.72211313, "process_user_time": 2.560821, "process_kernel_time": 0.231798, "process_mem_max_rss": "112044", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:08:12.303965 [debug] [MainThread]: Command `dbt debug` succeeded at 07:08:12.303780 after 0.72 seconds
[0m07:08:12.304956 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:08:12.305966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5bc095fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ba12eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5bbe71c10>]}
[0m07:08:12.307032 [debug] [MainThread]: Flushing usage events
[0m07:09:01.930046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593fe0aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593dc0e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593dc0e760>]}


============================== 07:09:01.934092 | edda7229-602d-450c-a0ed-5e30a571dbc0 ==============================
[0m07:09:01.934092 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:09:01.935227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_sales_orders --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m07:09:02.225018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593ddf8be0>]}
[0m07:09:02.288018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593dcaa190>]}
[0m07:09:02.290003 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:09:02.387317 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:09:02.623412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:09:02.624767 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/staging/schema.yml
[0m07:09:02.701716 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:09:02.703137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593c9d15e0>]}
[0m07:09:03.907837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:09:03.928741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593c43fee0>]}
[0m07:09:05.545157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593c60f0d0>]}
[0m07:09:05.546514 [info ] [MainThread]: Found 4 models, 2 data tests, 7 sources, 500 macros
[0m07:09:05.547804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593c592430>]}
[0m07:09:05.550090 [info ] [MainThread]: 
[0m07:09:05.551772 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:09:05.553751 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:09:05.574040 [debug] [ThreadPool]: dbt-sqlserver
[0m07:09:05.575515 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:09:05.576875 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:09:05.577800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:05.578900 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:09:05.611974 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:09:05.615031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:09:05.617181 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:09:05.625302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:09:05.635025 [debug] [ThreadPool]: dbt-sqlserver
[0m07:09:05.636286 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:09:05.637014 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:09:05.637982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:05.639055 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:09:05.652557 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:09:05.683948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:09:05.686699 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:09:05.688153 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:09:05.690846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593c4703a0>]}
[0m07:09:05.691855 [debug] [MainThread]: On master: COMMIT
[0m07:09:05.692744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:09:05.693876 [info ] [MainThread]: 
[0m07:09:05.698105 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:05.699295 [info ] [Thread-1  ]: 1 of 1 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:09:05.700950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_sales_orders)
[0m07:09:05.702019 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:05.713119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:05.720250 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:05.764476 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:05.772650 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:05.773818 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select * from "AdventureWorks2014"."dbo"."SalesOrderHeader"
),

sales_order_detail as (
    select * from "AdventureWorks2014"."dbo"."SalesOrderDetail"
),

staged as (
    select
        soh.SalesOrderID,
        soh.OrderDate,
        soh.DueDate,
        soh.ShipDate,
        soh.Status,
        soh.CustomerID,
        soh.SalesPersonID,
        soh.TerritoryID,
        soh.BillToAddressID,
        soh.ShipToAddressID,
        soh.ShipMethodID,
        soh.SubTotal,
        soh.TaxAmt,
        soh.Freight,
        soh.TotalDue,
        sod.SalesOrderDetailID,
        sod.ProductID,
        sod.OrderQty,
        sod.UnitPrice,
        sod.UnitPriceDiscount,
        sod.LineTotal,
        sod.ModifiedDate as last_modified_date
    from sales_order_header soh
    left join sales_order_detail sod
        on soh.SalesOrderID = sod.SalesOrderID
)

select * from staged;
    ')


[0m07:09:05.774594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:09:05.775291 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:09:05.787767 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:09:05.791054 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:09:05.793028 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:09:05.793958 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:09:05.795633 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_sales_orders.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.SalesOrderHeader'. (208) (SQLMoreResults)")
[0m07:09:05.798225 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.SalesOrderHeader'. (208) (SQLMoreResults)")

[0m07:09:05.800858 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edda7229-602d-450c-a0ed-5e30a571dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593f004490>]}
[0m07:09:05.802551 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbo.stg_sales_orders ...................... [[31mERROR[0m in 0.10s]
[0m07:09:05.804191 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:05.806651 [debug] [MainThread]: On master: COMMIT
[0m07:09:05.807672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:05.808568 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:09:05.809577 [info ] [MainThread]: 
[0m07:09:05.810575 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m07:09:05.812026 [debug] [MainThread]: Command end result
[0m07:09:05.871809 [info ] [MainThread]: 
[0m07:09:05.873160 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:09:05.874376 [info ] [MainThread]: 
[0m07:09:05.875497 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.SalesOrderHeader'. (208) (SQLMoreResults)")
[0m07:09:05.876581 [info ] [MainThread]: 
[0m07:09:05.877977 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:09:05.879765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6962934, "process_user_time": 2.752541, "process_kernel_time": 0.201923, "process_mem_max_rss": "123336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:09:05.880784 [debug] [MainThread]: Command `dbt run` failed at 07:09:05.880615 after 1.70 seconds
[0m07:09:05.881668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593fe0aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593f1af820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593dcaa190>]}
[0m07:09:05.882709 [debug] [MainThread]: Flushing usage events
[0m07:09:34.573678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86614ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe863f52730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe863f526d0>]}


============================== 07:09:34.577881 | 25159ece-c068-4e71-8e00-ae39382b1780 ==============================
[0m07:09:34.577881 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:09:34.579236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_sales_orders --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m07:09:34.869053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe862d792b0>]}
[0m07:09:34.937380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe862e05550>]}
[0m07:09:34.939309 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:09:35.036840 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:09:36.181219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:09:36.182627 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/staging/src_adventureworks.yml
[0m07:09:36.183967 [debug] [MainThread]: Partial parsing: updated file: dbt_sqlserver_project://models/staging/stg_sales_orders.sql
[0m07:09:38.033363 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:09:38.035057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8611b52b0>]}
[0m07:09:38.257718 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:09:38.275432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86100a130>]}
[0m07:09:38.442212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8628f8b50>]}
[0m07:09:38.443467 [info ] [MainThread]: Found 4 models, 2 data tests, 9 sources, 500 macros
[0m07:09:38.444903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe860fd0280>]}
[0m07:09:38.447710 [info ] [MainThread]: 
[0m07:09:38.449885 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:09:38.452069 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:09:38.472387 [debug] [ThreadPool]: dbt-sqlserver
[0m07:09:38.473697 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:09:38.474901 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:09:38.475826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:38.477095 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:09:38.510444 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:09:38.513890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:09:38.516000 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:09:38.524977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:09:38.533505 [debug] [ThreadPool]: dbt-sqlserver
[0m07:09:38.534760 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:09:38.535769 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:09:38.536704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:38.537695 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:09:38.551133 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:09:38.581611 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:09:38.584352 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:09:38.585519 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:09:38.588835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86100a610>]}
[0m07:09:38.589932 [debug] [MainThread]: On master: COMMIT
[0m07:09:38.590923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:09:38.592004 [info ] [MainThread]: 
[0m07:09:38.595938 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:38.597068 [info ] [Thread-1  ]: 1 of 1 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:09:38.598524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_sales_orders)
[0m07:09:38.599449 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:38.610809 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:38.618570 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:38.663338 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:38.671948 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:38.673080 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:09:38.673969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:09:38.674822 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:09:38.688232 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:09:38.693904 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:09:38.703077 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:38.704304 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:09:38.870242 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:09:38.890237 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:09:38.898638 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:09:38.908835 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:09:38.910344 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:38.911625 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:09:38.927501 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:09:38.930515 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:09:38.932101 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:09:38.935148 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:09:38.938805 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:09:38.939770 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:09:38.942235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25159ece-c068-4e71-8e00-ae39382b1780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86017ef40>]}
[0m07:09:38.943290 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.34s]
[0m07:09:38.944735 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:09:38.947316 [debug] [MainThread]: On master: COMMIT
[0m07:09:38.948535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:38.949254 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:09:38.949963 [info ] [MainThread]: 
[0m07:09:38.951006 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m07:09:38.952549 [debug] [MainThread]: Command end result
[0m07:09:39.019036 [info ] [MainThread]: 
[0m07:09:39.020376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:09:39.021569 [info ] [MainThread]: 
[0m07:09:39.022969 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:09:39.024498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2109983, "process_user_time": 3.090026, "process_kernel_time": 0.171668, "process_mem_max_rss": "127716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:09:39.025875 [debug] [MainThread]: Command `dbt run` succeeded at 07:09:39.025575 after 2.21 seconds
[0m07:09:39.026889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86614ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe861138ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe861138b80>]}
[0m07:09:39.027804 [debug] [MainThread]: Flushing usage events
[0m07:11:28.508232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e81deeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7fbf3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7fbf3700>]}


============================== 07:11:28.512143 | fb22270d-4de8-47d1-bf7b-3472c49ad19b ==============================
[0m07:11:28.512143 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:11:28.513327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt show --select stg_sales_orders --limit 10', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:11:28.807808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb22270d-4de8-47d1-bf7b-3472c49ad19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7eb24e80>]}
[0m07:11:28.872478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb22270d-4de8-47d1-bf7b-3472c49ad19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7fc9a4f0>]}
[0m07:11:28.873943 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:11:28.972669 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:11:29.271344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:11:29.272690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:11:29.284141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:11:29.367992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb22270d-4de8-47d1-bf7b-3472c49ad19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7e557f40>]}
[0m07:11:29.610408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb22270d-4de8-47d1-bf7b-3472c49ad19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7e56a460>]}
[0m07:11:29.611830 [info ] [MainThread]: Found 4 models, 2 data tests, 9 sources, 500 macros
[0m07:11:29.613094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb22270d-4de8-47d1-bf7b-3472c49ad19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e81a01d30>]}
[0m07:11:29.615653 [info ] [MainThread]: 
[0m07:11:29.617373 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:11:29.625832 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:11:29.650632 [debug] [ThreadPool]: dbt-sqlserver
[0m07:11:29.652132 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:11:29.653474 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:11:29.654612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:29.655599 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:11:29.690960 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:11:29.738993 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:11:29.741690 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:11:29.742740 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:11:29.745387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb22270d-4de8-47d1-bf7b-3472c49ad19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7e541f40>]}
[0m07:11:29.747049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:11:29.748290 [info ] [MainThread]: 
[0m07:11:29.754385 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:29.755794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_sales_orders)
[0m07:11:29.756793 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:29.769442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:11:29.777805 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:29.792001 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:11:29.793482 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

  with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id
        order by (select null) offset 0 rows fetch first 10 rows only

[0m07:11:29.794859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:11:29.796024 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:11:29.813326 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:11:29.826568 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:11:29.831280 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:11:29.833102 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:29.834998 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:29.835451 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:29.836475 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:11:29.838085 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be'
[0m07:11:29.839152 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:29.840232 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:29.856016 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:11:29.864109 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:11:29.871662 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:29.879632 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:29.881719 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:11:29.888069 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:11:29.889147 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null



        order by (select null) offset 0 rows fetch first 10 rows only

[0m07:11:29.890349 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"} */

  
    
    

select
    sales_order_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is not null
group by sales_order_id
having count(*) > 1



        order by (select null) offset 0 rows fetch first 10 rows only

[0m07:11:29.891585 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:11:29.892733 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:11:29.893956 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:11:29.895036 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:11:29.909559 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:11:29.910035 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:11:29.917571 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:11:29.919781 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:11:29.920328 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:11:29.922020 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:29.924043 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: Close
[0m07:11:29.926148 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:29.928520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:29.929644 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:11:29.930581 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:11:29.931458 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be' was properly closed.
[0m07:11:29.933158 [debug] [MainThread]: Command end result
[0m07:11:30.002764 [debug] [MainThread]: Excluded node 'not_null_stg_sales_orders_sales_order_id' from results
[0m07:11:30.004100 [debug] [MainThread]: Excluded node 'unique_stg_sales_orders_sales_order_id' from results
[0m07:11:30.005824 [info ] [MainThread]: Previewing node 'stg_sales_orders':
| sales_order_id |          order_date |            due_date |           ship_date | status | online_order_flag | ... |
| -------------- | ------------------- | ------------------- | ------------------- | ------ | ----------------- | --- |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43683 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |

[0m07:11:30.008158 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.5772388, "process_user_time": 2.7777, "process_kernel_time": 0.227858, "process_mem_max_rss": "122252", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:11:30.009432 [debug] [MainThread]: Command `dbt show` succeeded at 07:11:30.009262 after 1.58 seconds
[0m07:11:30.010512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e81deeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e803159a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7fc9a4f0>]}
[0m07:11:30.011498 [debug] [MainThread]: Flushing usage events
[0m07:11:48.589051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd794bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd57eb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd57eb4f0>]}


============================== 07:11:48.593025 | a1025af9-6ca1-4335-bae6-682853dc7f0b ==============================
[0m07:11:48.593025 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:11:48.594470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select stg_sales_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:11:48.933184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1025af9-6ca1-4335-bae6-682853dc7f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd588bdf0>]}
[0m07:11:49.015368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1025af9-6ca1-4335-bae6-682853dc7f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd5ed62b0>]}
[0m07:11:49.017215 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:11:49.121389 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:11:49.417074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:11:49.418657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:11:49.428622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:11:49.493021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1025af9-6ca1-4335-bae6-682853dc7f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd414fe20>]}
[0m07:11:49.729402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1025af9-6ca1-4335-bae6-682853dc7f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd41623a0>]}
[0m07:11:49.730562 [info ] [MainThread]: Found 4 models, 2 data tests, 9 sources, 500 macros
[0m07:11:49.731701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1025af9-6ca1-4335-bae6-682853dc7f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd4192bb0>]}
[0m07:11:49.734268 [info ] [MainThread]: 
[0m07:11:49.736147 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:11:49.745374 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:11:49.769076 [debug] [ThreadPool]: dbt-sqlserver
[0m07:11:49.770587 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:11:49.771626 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:11:49.772505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:49.773356 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:11:49.806071 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:11:49.845663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:11:49.848905 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:11:49.850216 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:11:49.853213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1025af9-6ca1-4335-bae6-682853dc7f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd4162760>]}
[0m07:11:49.854569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:11:49.855604 [info ] [MainThread]: 
[0m07:11:49.859941 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:49.861044 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_sales_orders)
[0m07:11:49.861963 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:49.875467 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:11:49.884043 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:49.885943 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:11:49.888129 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:49.888860 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:49.890100 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:11:49.891173 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be'
[0m07:11:49.892040 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:49.892961 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:49.910138 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:11:49.918548 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:11:49.925211 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:49.927108 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:11:49.927665 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:49.929610 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:11:49.931699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:49.932567 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:11:49.933325 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:11:49.934091 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be' was properly closed.
[0m07:11:49.935744 [debug] [MainThread]: Command end result
[0m07:11:50.005957 [debug] [MainThread]: Excluded node 'unique_stg_sales_orders_sales_order_id' from results
[0m07:11:50.006942 [debug] [MainThread]: Excluded node 'not_null_stg_sales_orders_sales_order_id' from results
[0m07:11:50.007910 [info ] [MainThread]: Compiled node 'stg_sales_orders' is:
with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id
[0m07:11:50.009827 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.5036223, "process_user_time": 2.692653, "process_kernel_time": 0.200629, "process_mem_max_rss": "119900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:11:50.010990 [debug] [MainThread]: Command `dbt compile` succeeded at 07:11:50.010838 after 1.50 seconds
[0m07:11:50.011980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd794bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd762e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd5f11250>]}
[0m07:11:50.013009 [debug] [MainThread]: Flushing usage events
[0m07:12:47.903500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088c57a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb086a5a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb086a5a5b0>]}


============================== 07:12:47.908046 | 701fe944-787f-4b46-852a-169c3222c744 ==============================
[0m07:12:47.908046 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:12:47.909332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m07:12:48.275579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0889989d0>]}
[0m07:12:48.352013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb085814af0>]}
[0m07:12:48.353926 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:12:48.467622 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:12:48.767954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:12:48.769505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:12:48.780720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:12:48.852125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0853bee80>]}
[0m07:12:49.091571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0853d2a60>]}
[0m07:12:49.093481 [info ] [MainThread]: Found 4 models, 2 data tests, 9 sources, 500 macros
[0m07:12:49.095241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08545dee0>]}
[0m07:12:49.098176 [info ] [MainThread]: 
[0m07:12:49.099771 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:12:49.109110 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:12:49.134004 [debug] [ThreadPool]: dbt-sqlserver
[0m07:12:49.135585 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:12:49.136724 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:12:49.137626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:49.138628 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:12:49.179411 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:12:49.182722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:12:49.184962 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:12:49.188590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:12:50.165085 [debug] [ThreadPool]: dbt-sqlserver
[0m07:12:50.166543 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:12:50.167645 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:12:50.168590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:12:50.169962 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:12:50.186724 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:12:50.227816 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:12:50.230291 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:12:50.231519 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:12:50.235109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088dc8670>]}
[0m07:12:50.236366 [debug] [MainThread]: On master: COMMIT
[0m07:12:50.237335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:12:50.238381 [info ] [MainThread]: 
[0m07:12:50.244166 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:12:50.244885 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m07:12:50.245515 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:12:50.245974 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:12:50.246764 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m07:12:50.248254 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m07:12:50.250121 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m07:12:50.251500 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:12:50.252799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:12:50.253922 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m07:12:50.254988 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m07:12:50.255897 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m07:12:50.256808 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:12:50.257699 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m07:12:50.258639 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:12:50.259469 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:12:50.271799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:12:50.276539 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m07:12:50.282736 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:12:50.288771 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:12:50.295949 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:12:50.296953 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:12:50.298050 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:12:50.309363 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m07:12:51.797998 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m07:12:51.801968 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:12:51.808530 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m07:12:51.815205 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m07:12:51.822524 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:12:51.823334 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:12:51.823967 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:12:51.824968 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

person as (
    select * from "AdventureWorks2014"."dbo"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m07:12:51.826182 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:12:51.826712 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:12:51.828053 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."dbo"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."dbo"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m07:12:51.829578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:12:51.830833 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."dbo"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m07:12:51.832040 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:12:51.833003 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:12:51.833957 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:12:51.835223 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:12:51.837037 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:12:51.838605 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:12:51.840529 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:12:51.855860 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:12:51.856442 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:12:51.856958 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:12:51.857455 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:12:51.859780 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:12:51.860354 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:12:51.862672 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m07:12:51.863203 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:12:51.864640 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m07:12:51.865082 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:12:51.866075 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m07:12:51.868514 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m07:12:51.869518 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:12:51.880200 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:12:51.881634 [error] [Thread-2  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_example.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m07:12:51.883296 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:12:51.885043 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_customers.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m07:12:51.886239 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m07:12:51.889549 [error] [Thread-3  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_products.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Product'. (208) (SQLMoreResults)")
[0m07:12:51.890670 [debug] [Thread-2  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m07:12:51.891923 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")

[0m07:12:51.893712 [debug] [Thread-3  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Product'. (208) (SQLMoreResults)")

[0m07:12:51.896312 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb087739a60>]}
[0m07:12:51.897932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb085995790>]}
[0m07:12:51.899783 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0858f48b0>]}
[0m07:12:51.901329 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model dbo.stg_example ........................... [[31mERROR[0m in 1.64s]
[0m07:12:51.903184 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dbo.stg_customers ......................... [[31mERROR[0m in 1.65s]
[0m07:12:51.905071 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model dbo.stg_products .......................... [[31mERROR[0m in 1.64s]
[0m07:12:51.906623 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m07:12:51.908285 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:12:51.909975 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:12:52.103686 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:12:52.109609 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:12:52.111058 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:12:52.115013 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:12:52.142968 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:12:52.153703 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:12:52.165016 [debug] [Thread-4  ]: dbt-sqlserver
[0m07:12:52.166772 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:12:52.168274 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:12:52.185041 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:12:52.187641 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:12:52.188738 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:12:52.191962 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:12:52.196053 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:12:52.197388 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:12:52.199094 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701fe944-787f-4b46-852a-169c3222c744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088995310>]}
[0m07:12:52.200626 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 1.94s]
[0m07:12:52.201960 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:12:52.204653 [debug] [MainThread]: On master: COMMIT
[0m07:12:52.205973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:12:52.206907 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:12:52.207738 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m07:12:52.208512 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:12:52.209349 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:12:52.210293 [info ] [MainThread]: 
[0m07:12:52.211302 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m07:12:52.213518 [debug] [MainThread]: Command end result
[0m07:12:52.280909 [info ] [MainThread]: 
[0m07:12:52.282248 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:12:52.283547 [info ] [MainThread]: 
[0m07:12:52.284777 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m07:12:52.285903 [info ] [MainThread]: 
[0m07:12:52.287094 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Customer'. (208) (SQLMoreResults)")
[0m07:12:52.288273 [info ] [MainThread]: 
[0m07:12:52.289453 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'AdventureWorks2014.dbo.Product'. (208) (SQLMoreResults)")
[0m07:12:52.290712 [info ] [MainThread]: 
[0m07:12:52.292759 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m07:12:52.294624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0741096, "process_user_time": 3.035317, "process_kernel_time": 0.213004, "process_mem_max_rss": "123064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:12:52.295969 [debug] [MainThread]: Command `dbt run` failed at 07:12:52.295799 after 2.08 seconds
[0m07:12:52.297261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088c57a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08775dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08890ea00>]}
[0m07:12:52.298289 [debug] [MainThread]: Flushing usage events
[0m07:13:50.209888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0578a59a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057685c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057685c6d0>]}


============================== 07:13:50.214267 | bd972f7c-2dbc-4a7a-a650-fda4aa47be1a ==============================
[0m07:13:50.214267 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:13:50.215604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:13:50.500138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057879ac40>]}
[0m07:13:50.565705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05756102b0>]}
[0m07:13:50.567306 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:13:50.668557 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:13:50.945600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m07:13:50.947689 [debug] [MainThread]: Partial parsing: updated file: dbt_sqlserver_project://models/staging/src_adventureworks.yml
[0m07:13:50.948896 [debug] [MainThread]: Partial parsing: updated file: dbt_sqlserver_project://models/staging/stg_customers.sql
[0m07:13:50.949883 [debug] [MainThread]: Partial parsing: updated file: dbt_sqlserver_project://models/staging/stg_example.sql
[0m07:13:50.950756 [debug] [MainThread]: Partial parsing: updated file: dbt_sqlserver_project://models/staging/stg_products.sql
[0m07:13:51.315965 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:13:51.318442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057555b940>]}
[0m07:13:51.641444 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:13:51.659063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056f915130>]}
[0m07:13:51.829039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056f9206d0>]}
[0m07:13:51.830038 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:13:51.831212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056f8ea490>]}
[0m07:13:51.834442 [info ] [MainThread]: 
[0m07:13:51.836275 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:13:51.844401 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:13:51.864773 [debug] [ThreadPool]: dbt-sqlserver
[0m07:13:51.866312 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:13:51.867565 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:13:51.868772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:13:51.870028 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:13:51.903604 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:13:51.906676 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:13:51.908758 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:13:51.911691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:13:51.920697 [debug] [ThreadPool]: dbt-sqlserver
[0m07:13:51.921961 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:13:51.922758 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:13:51.923762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:13:51.924824 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:13:51.937111 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:13:51.970655 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:13:51.973396 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:13:51.974837 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:13:51.977491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05786ab5e0>]}
[0m07:13:51.978509 [debug] [MainThread]: On master: COMMIT
[0m07:13:51.979458 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:13:51.980412 [info ] [MainThread]: 
[0m07:13:51.985597 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:13:51.986125 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m07:13:51.986818 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:13:51.987468 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:13:51.988343 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m07:13:51.989518 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m07:13:51.990730 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m07:13:51.991986 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:13:51.993005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:13:51.993958 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m07:13:51.994908 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m07:13:51.995816 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m07:13:51.996646 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:13:51.997331 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m07:13:51.998127 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:13:51.998891 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:13:52.009789 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:13:52.014293 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m07:13:52.020120 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:13:52.025098 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:13:52.030966 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:13:52.031643 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m07:13:52.033133 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:13:52.044631 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:13:52.094931 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m07:13:52.097933 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:13:52.102918 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m07:13:52.108674 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m07:13:52.115742 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:13:52.116549 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:13:52.117465 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m07:13:52.118077 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:13:52.118583 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:13:52.119256 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:13:52.120243 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:13:52.121281 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m07:13:52.122363 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m07:13:52.123381 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:13:52.124369 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:13:52.125338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:13:52.126496 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:13:52.128512 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:13:52.131093 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:13:52.132563 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:13:52.144221 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:13:52.146304 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:13:52.146794 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:13:52.149029 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:13:52.157497 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.158457 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.159682 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.160388 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.168393 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:13:52.173873 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:13:52.179772 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:13:52.184837 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:13:52.185918 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m07:13:52.187141 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m07:13:52.188075 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m07:13:52.188859 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m07:13:52.348082 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.348613 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.349072 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.349491 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.370290 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m07:13:52.371496 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m07:13:52.373651 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m07:13:52.378840 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:13:52.387332 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m07:13:52.391065 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m07:13:52.396569 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m07:13:52.397840 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:13:52.406527 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:13:52.408309 [debug] [Thread-2  ]: dbt-sqlserver
[0m07:13:52.410307 [debug] [Thread-3  ]: dbt-sqlserver
[0m07:13:52.412600 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:13:52.413837 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:13:52.414547 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.415457 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:13:52.416284 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:13:52.417208 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:13:52.421927 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:13:52.422827 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:13:52.428003 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:13:52.430369 [debug] [Thread-4  ]: dbt-sqlserver
[0m07:13:52.431380 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:13:52.432239 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:13:52.442047 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.444563 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:13:52.445489 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.446177 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m07:13:52.448557 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:13:52.449090 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.450141 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:13:52.450678 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.452867 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:13:52.453933 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.457767 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m07:13:52.458348 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.458994 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m07:13:52.461138 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:13:52.461745 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:13:52.463746 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:13:52.465355 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m07:13:52.465938 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.468449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0578797340>]}
[0m07:13:52.469285 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:13:52.472272 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:13:52.473275 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m07:13:52.474299 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.47s]
[0m07:13:52.475830 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056efdefa0>]}
[0m07:13:52.478019 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m07:13:52.478843 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m07:13:52.479717 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:13:52.480843 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.48s]
[0m07:13:52.481988 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:13:52.483398 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056efcca60>]}
[0m07:13:52.485363 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:13:52.486931 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd972f7c-2dbc-4a7a-a650-fda4aa47be1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056efdee80>]}
[0m07:13:52.488242 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.49s]
[0m07:13:52.490182 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.49s]
[0m07:13:52.491344 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m07:13:52.492409 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:13:52.495212 [debug] [MainThread]: On master: COMMIT
[0m07:13:52.496215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:13:52.497035 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:13:52.497765 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m07:13:52.498403 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:13:52.499058 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:13:52.499835 [info ] [MainThread]: 
[0m07:13:52.501015 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m07:13:52.504094 [debug] [MainThread]: Command end result
[0m07:13:52.566694 [info ] [MainThread]: 
[0m07:13:52.568063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:13:52.569275 [info ] [MainThread]: 
[0m07:13:52.570429 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:13:52.572049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4400747, "process_user_time": 3.367584, "process_kernel_time": 0.171051, "process_mem_max_rss": "135016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:13:52.573046 [debug] [MainThread]: Command `dbt run` succeeded at 07:13:52.572898 after 2.44 seconds
[0m07:13:52.573898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0578a59a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056d1f40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05786b1fd0>]}
[0m07:13:52.574745 [debug] [MainThread]: Flushing usage events
[0m07:14:41.755876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a982b3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a960b66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a960b6640>]}


============================== 07:14:41.760250 | 0d2f8431-2aa9-42e3-846b-3d4da4f797bd ==============================
[0m07:14:41.760250 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:14:41.761642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:14:42.044813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a960b67f0>]}
[0m07:14:42.105412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94f016d0>]}
[0m07:14:42.106920 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:14:42.203600 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:14:42.503841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:42.505091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:42.514219 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:14:42.572995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94a18130>]}
[0m07:14:42.786744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94a64580>]}
[0m07:14:42.787993 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:14:42.789047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94ab2910>]}
[0m07:14:42.791619 [info ] [MainThread]: 
[0m07:14:42.793533 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:14:42.802153 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:14:42.823864 [debug] [ThreadPool]: dbt-sqlserver
[0m07:14:42.825559 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:14:42.826606 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:14:42.827481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:42.828387 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:42.846794 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:42.848380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:14:42.850201 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:14:42.852742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:14:42.861725 [debug] [ThreadPool]: dbt-sqlserver
[0m07:14:42.862788 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:14:42.863755 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:14:42.864526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:42.865276 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:42.885761 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:42.891085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:14:42.893121 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:14:42.893987 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:14:42.896637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94e06b80>]}
[0m07:14:42.898049 [debug] [MainThread]: On master: COMMIT
[0m07:14:42.899249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:42.900337 [info ] [MainThread]: 
[0m07:14:42.905352 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:14:42.905809 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m07:14:42.906235 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:14:42.906657 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:14:42.907345 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m07:14:42.908377 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m07:14:42.909745 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m07:14:42.910883 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:14:42.911947 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:14:42.913299 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m07:14:42.914564 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m07:14:42.915580 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m07:14:42.916448 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:14:42.917417 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m07:14:42.918249 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:14:42.919023 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:14:42.929917 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:14:42.934855 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m07:14:42.939781 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:14:42.944854 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:14:42.951214 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:14:42.951747 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:14:42.958751 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m07:14:42.965380 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:14:43.015910 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:14:43.017432 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m07:14:43.023299 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m07:14:43.028724 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m07:14:43.035358 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:14:43.036010 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:14:43.036965 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m07:14:43.037638 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:14:43.038587 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m07:14:43.039085 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:14:43.039873 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:14:43.040796 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:14:43.041781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:43.042545 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m07:14:43.043380 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:43.044107 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:14:43.044818 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:43.045493 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:14:43.046620 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:43.048453 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:43.059743 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:43.060331 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:43.061261 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:43.063953 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:43.065879 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.066459 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.068667 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.069205 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.076831 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:14:43.081681 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:14:43.086902 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:14:43.091524 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:14:43.092986 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m07:14:43.094396 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m07:14:43.095381 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m07:14:43.096604 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m07:14:43.100445 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.100936 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.101424 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.101779 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.106028 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:14:43.110649 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:14:43.115598 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:14:43.120168 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:14:43.120946 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m07:14:43.121843 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m07:14:43.123086 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m07:14:43.124227 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:14:43.128475 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.129092 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.129554 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.129911 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.151644 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m07:14:43.152367 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m07:14:43.155241 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:14:43.157764 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m07:14:43.165824 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m07:14:43.169823 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m07:14:43.174300 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:14:43.178246 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m07:14:43.187590 [debug] [Thread-3  ]: dbt-sqlserver
[0m07:14:43.189406 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:14:43.191054 [debug] [Thread-4  ]: dbt-sqlserver
[0m07:14:43.192475 [debug] [Thread-2  ]: dbt-sqlserver
[0m07:14:43.193548 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:14:43.194434 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:14:43.195249 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:14:43.195970 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:14:43.196646 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:14:43.197520 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:14:43.198450 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:14:43.199318 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:14:43.201817 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.202605 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.203623 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.206428 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:14:43.206880 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.208476 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:14:43.210107 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:14:43.210705 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m07:14:43.212543 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:14:43.213403 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m07:14:43.214423 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:14:43.215877 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m07:14:43.218097 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.219169 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.219692 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.222810 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m07:14:43.223193 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:14:43.224843 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m07:14:43.226291 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:14:43.226892 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:14:43.229033 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m07:14:43.229896 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:14:43.230759 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:14:43.233746 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94e6af40>]}
[0m07:14:43.234420 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m07:14:43.235545 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94e6a3d0>]}
[0m07:14:43.236568 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94e6a700>]}
[0m07:14:43.237611 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.32s]
[0m07:14:43.238959 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2f8431-2aa9-42e3-846b-3d4da4f797bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a94e6a8e0>]}
[0m07:14:43.240001 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.32s]
[0m07:14:43.241075 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.32s]
[0m07:14:43.242129 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:14:43.243443 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.33s]
[0m07:14:43.244962 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:14:43.246126 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:14:43.247866 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m07:14:43.251068 [debug] [MainThread]: On master: COMMIT
[0m07:14:43.251898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:43.252528 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:14:43.253156 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m07:14:43.253796 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:14:43.254427 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:14:43.255101 [info ] [MainThread]: 
[0m07:14:43.255828 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m07:14:43.257917 [debug] [MainThread]: Command end result
[0m07:14:43.315799 [info ] [MainThread]: 
[0m07:14:43.316877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:14:43.317987 [info ] [MainThread]: 
[0m07:14:43.319486 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:14:43.321105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6373603, "process_user_time": 2.753986, "process_kernel_time": 0.199083, "process_mem_max_rss": "125352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:14:43.322255 [debug] [MainThread]: Command `dbt run` succeeded at 07:14:43.322060 after 1.64 seconds
[0m07:14:43.323082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a982b3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9a0818b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a960b67f0>]}
[0m07:14:43.323914 [debug] [MainThread]: Flushing usage events
[0m07:14:50.816353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3a641a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d38446700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d384466a0>]}


============================== 07:14:50.820225 | c7c84dd2-f968-4473-916c-890577cbba07 ==============================
[0m07:14:50.820225 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:14:50.821755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt show --select stg_customers --limit 5', 'send_anonymous_usage_stats': 'True'}
[0m07:14:51.103953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c84dd2-f968-4473-916c-890577cbba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3737aee0>]}
[0m07:14:51.163668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c84dd2-f968-4473-916c-890577cbba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d371f93a0>]}
[0m07:14:51.165206 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:14:51.261345 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:14:51.532018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:51.533334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:51.543121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:14:51.609792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c84dd2-f968-4473-916c-890577cbba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d36da8130>]}
[0m07:14:51.813127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c84dd2-f968-4473-916c-890577cbba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d36e432b0>]}
[0m07:14:51.814340 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:14:51.815504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c84dd2-f968-4473-916c-890577cbba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d36f1c3d0>]}
[0m07:14:51.817905 [info ] [MainThread]: 
[0m07:14:51.819434 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:14:51.827099 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:14:51.848943 [debug] [ThreadPool]: dbt-sqlserver
[0m07:14:51.850326 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:14:51.851731 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:14:51.852786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:51.854206 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:51.887028 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:51.921267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:14:51.924006 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:14:51.925142 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:14:51.928133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c84dd2-f968-4473-916c-890577cbba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d36ecd1f0>]}
[0m07:14:51.929250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:51.930486 [info ] [MainThread]: 
[0m07:14:51.934937 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:14:51.936054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:14:51.937155 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:14:51.950039 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:14:51.956864 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:14:51.970021 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:14:51.971283 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

  

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged
        order by (select null) offset 0 rows fetch first 5 rows only

[0m07:14:51.972213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:51.973055 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:14:51.985747 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:14:52.001358 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:14:52.004924 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:14:52.006671 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:14:52.009341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:52.010479 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:14:52.011588 [debug] [MainThread]: Command end result
[0m07:14:52.073999 [info ] [MainThread]: Previewing node 'stg_customers':
| CustomerID | FirstName | LastName | EmailPromotion | StoreID | TerritoryID | ... |
| ---------- | --------- | -------- | -------------- | ------- | ----------- | --- |
|          1 |           |          |                |     934 |           1 | ... |
|          2 |           |          |                |    1028 |           1 | ... |
|          3 |           |          |                |     642 |           4 | ... |
|          4 |           |          |                |     932 |           4 | ... |
|          5 |           |          |                |    1026 |           4 | ... |

[0m07:14:52.075909 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.3368983, "process_user_time": 2.34867, "process_kernel_time": 0.251253, "process_mem_max_rss": "120868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:14:52.077225 [debug] [MainThread]: Command `dbt show` succeeded at 07:14:52.077082 after 1.34 seconds
[0m07:14:52.078150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3a641a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d38b68610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d36df0ee0>]}
[0m07:14:52.079174 [debug] [MainThread]: Flushing usage events
[0m07:15:06.513557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fa4ccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f82d1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f82d1730>]}


============================== 07:15:06.517249 | 3a903538-cbdf-42b8-96d2-0f69da2356fb ==============================
[0m07:15:06.517249 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:15:06.518394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select stg_products --limit 5', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:15:06.798723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a903538-cbdf-42b8-96d2-0f69da2356fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f71bdfa0>]}
[0m07:15:06.862263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a903538-cbdf-42b8-96d2-0f69da2356fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f7152400>]}
[0m07:15:06.864018 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:15:06.962047 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:15:07.224514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:15:07.225833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:15:07.234490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:15:07.292721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a903538-cbdf-42b8-96d2-0f69da2356fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f6c33130>]}
[0m07:15:07.520993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a903538-cbdf-42b8-96d2-0f69da2356fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f6dbfa30>]}
[0m07:15:07.522116 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:15:07.523051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a903538-cbdf-42b8-96d2-0f69da2356fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f6cbbac0>]}
[0m07:15:07.525017 [info ] [MainThread]: 
[0m07:15:07.526518 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:15:07.535266 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:15:07.557866 [debug] [ThreadPool]: dbt-sqlserver
[0m07:15:07.559739 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:15:07.561149 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:15:07.562305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:07.563643 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:15:07.582650 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:15:07.587452 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:15:07.589795 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:15:07.590923 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:15:07.593905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a903538-cbdf-42b8-96d2-0f69da2356fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71f6c329a0>]}
[0m07:15:07.595064 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:15:07.596126 [info ] [MainThread]: 
[0m07:15:07.600052 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:15:07.601136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_products)
[0m07:15:07.601996 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:15:07.613601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:15:07.620092 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:15:07.632269 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:15:07.633524 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

  with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged
        order by (select null) offset 0 rows fetch first 5 rows only

[0m07:15:07.634541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:07.635490 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:15:07.648967 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:15:07.657164 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:15:07.661350 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:15:07.662887 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:15:07.664886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:15:07.665614 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:15:07.666837 [debug] [MainThread]: Command end result
[0m07:15:07.725841 [info ] [MainThread]: Previewing node 'stg_products':
| ProductID | ProductName          | ProductNumber | MakeFlag | FinishedGoodsFlag | Color | ... |
| --------- | -------------------- | ------------- | -------- | ----------------- | ----- | --- |
|         1 | Adjustable Race      | AR-5381       |    False |             False |       | ... |
|         2 | Bearing Ball         | BA-8327       |    False |             False |       | ... |
|         3 | BB Ball Bearing      | BE-2349       |     True |             False |       | ... |
|         4 | Headset Ball Bear... | BE-2908       |    False |             False |       | ... |
|       316 | Blade                | BL-2036       |     True |             False |       | ... |

[0m07:15:07.727660 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.2902707, "process_user_time": 2.387684, "process_kernel_time": 0.150574, "process_mem_max_rss": "121012", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:15:07.728726 [debug] [MainThread]: Command `dbt show` succeeded at 07:15:07.728563 after 1.29 seconds
[0m07:15:07.729884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fa4ccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fa209340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fa0d1d30>]}
[0m07:15:07.730817 [debug] [MainThread]: Flushing usage events
[0m07:15:35.685152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff67d18a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff65b1d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff65b1d6a0>]}


============================== 07:15:35.688789 | e3af25bc-469e-472a-b0f3-b3c26d9d54c9 ==============================
[0m07:15:35.688789 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:15:35.689878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt show --select stg_sales_orders --limit 5', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:15:35.969173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3af25bc-469e-472a-b0f3-b3c26d9d54c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff64a52ee0>]}
[0m07:15:36.031788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3af25bc-469e-472a-b0f3-b3c26d9d54c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff648d03a0>]}
[0m07:15:36.033085 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:15:36.127339 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:15:36.372637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:15:36.373817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:15:36.382984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:15:36.442047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3af25bc-469e-472a-b0f3-b3c26d9d54c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6447e130>]}
[0m07:15:36.653150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3af25bc-469e-472a-b0f3-b3c26d9d54c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6451a2b0>]}
[0m07:15:36.654302 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:15:36.655347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3af25bc-469e-472a-b0f3-b3c26d9d54c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff645e23d0>]}
[0m07:15:36.657406 [info ] [MainThread]: 
[0m07:15:36.659067 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:15:36.667468 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:15:36.688708 [debug] [ThreadPool]: dbt-sqlserver
[0m07:15:36.690220 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:15:36.691702 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:15:36.693332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:36.694765 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:15:36.714100 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:15:36.718639 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:15:36.720849 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:15:36.721602 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:15:36.724825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3af25bc-469e-472a-b0f3-b3c26d9d54c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff645a01f0>]}
[0m07:15:36.726008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:15:36.726989 [info ] [MainThread]: 
[0m07:15:36.730802 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:15:36.731742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_sales_orders)
[0m07:15:36.732483 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:15:36.744704 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:15:36.750667 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:15:36.762593 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:15:36.763934 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

  with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id
        order by (select null) offset 0 rows fetch first 5 rows only

[0m07:15:36.765010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:36.765963 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:15:36.778584 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:15:36.786564 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:15:36.790687 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:15:36.792259 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:15:36.793895 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:15:36.794335 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:15:36.795230 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:15:36.796124 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be'
[0m07:15:36.796862 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:15:36.797555 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:15:36.812314 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:15:36.821107 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:15:36.827667 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:15:36.828328 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:15:36.835281 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:15:36.840259 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:15:36.841440 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null



        order by (select null) offset 0 rows fetch first 5 rows only

[0m07:15:36.842390 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"} */

  
    
    

select
    sales_order_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is not null
group by sales_order_id
having count(*) > 1



        order by (select null) offset 0 rows fetch first 5 rows only

[0m07:15:36.843258 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:15:36.844059 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:15:36.844923 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:15:36.845725 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:15:36.860217 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:15:36.860701 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:15:36.864986 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:15:36.866992 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:15:36.867654 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:15:36.869557 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:15:36.871392 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: Close
[0m07:15:36.873040 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:15:36.875052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:15:36.875722 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:15:36.876331 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:15:36.876938 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be' was properly closed.
[0m07:15:36.878586 [debug] [MainThread]: Command end result
[0m07:15:36.949085 [debug] [MainThread]: Excluded node 'not_null_stg_sales_orders_sales_order_id' from results
[0m07:15:36.950262 [debug] [MainThread]: Excluded node 'unique_stg_sales_orders_sales_order_id' from results
[0m07:15:36.951322 [info ] [MainThread]: Previewing node 'stg_sales_orders':
| sales_order_id |          order_date |            due_date |           ship_date | status | online_order_flag | ... |
| -------------- | ------------------- | ------------------- | ------------------- | ------ | ----------------- | --- |
|          43659 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43659 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43659 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43659 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |
|          43659 | 2011-05-31 00:00:00 | 2011-06-12 00:00:00 | 2011-06-07 00:00:00 |      5 |             False | ... |

[0m07:15:36.953206 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.3401897, "process_user_time": 2.428046, "process_kernel_time": 0.128922, "process_mem_max_rss": "121008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:15:36.954162 [debug] [MainThread]: Command `dbt show` succeeded at 07:15:36.954027 after 1.34 seconds
[0m07:15:36.955253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff67d18a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6623f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6796a250>]}
[0m07:15:36.956433 [debug] [MainThread]: Flushing usage events
[0m07:19:06.688100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c4c18ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c2b657f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c2b650d0>]}


============================== 07:19:06.692188 | bbdfe5ae-bedf-489c-99fa-4c932bc9dd29 ==============================
[0m07:19:06.692188 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:19:06.693372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:19:06.990013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c4a01ee0>]}
[0m07:19:07.051537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c19647c0>]}
[0m07:19:07.053057 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:19:07.149776 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:19:07.415522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:19:07.416717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:19:07.425128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:19:07.481765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c1416130>]}
[0m07:19:07.695262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c1868d00>]}
[0m07:19:07.696547 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:19:07.697560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c14b0a30>]}
[0m07:19:07.700554 [info ] [MainThread]: 
[0m07:19:07.702354 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:19:07.710920 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:19:07.734483 [debug] [ThreadPool]: dbt-sqlserver
[0m07:19:07.735856 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:19:07.736866 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:19:07.737713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:07.738792 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:07.785956 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:07.789180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:19:07.791070 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:19:07.793660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:19:07.802775 [debug] [ThreadPool]: dbt-sqlserver
[0m07:19:07.804068 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:19:07.805030 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:19:07.805907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:19:07.806574 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:07.819419 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:07.849291 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:19:07.851642 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:19:07.852649 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:19:07.854927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c3f01280>]}
[0m07:19:07.856017 [debug] [MainThread]: On master: COMMIT
[0m07:19:07.856965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:19:07.857963 [info ] [MainThread]: 
[0m07:19:07.868059 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:19:07.868560 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m07:19:07.868946 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:19:07.869605 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:19:07.870490 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m07:19:07.871733 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m07:19:07.873086 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m07:19:07.874556 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:19:07.875803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:19:07.876962 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m07:19:07.878078 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m07:19:07.879180 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m07:19:07.880058 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:19:07.880859 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m07:19:07.881639 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:19:07.882395 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:19:07.894300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:19:07.899305 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m07:19:07.904765 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:19:07.910792 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:19:07.916669 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:19:07.917470 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m07:19:07.918065 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:19:07.924289 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:19:07.980663 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m07:19:07.985178 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m07:19:07.989985 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m07:19:07.995839 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:19:08.001597 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:19:08.002346 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:19:08.002924 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:19:08.003688 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m07:19:08.004410 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:19:08.005011 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m07:19:08.005985 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m07:19:08.006974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:19:08.007778 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:19:08.008594 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:19:08.009380 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:19:08.010194 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:08.010931 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:19:08.011749 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:08.012759 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:08.014360 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:08.027495 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:08.028195 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:08.028678 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:08.029126 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:08.035242 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.035892 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.036516 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.036909 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.045605 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:19:08.050906 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:19:08.055470 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:19:08.060109 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:19:08.061454 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m07:19:08.062804 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m07:19:08.063915 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:19:08.064783 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m07:19:08.221757 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.222343 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.222832 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.223286 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.241629 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m07:19:08.243394 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:19:08.246438 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m07:19:08.249188 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m07:19:08.256921 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m07:19:08.260872 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:19:08.266269 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m07:19:08.269894 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m07:19:08.279248 [debug] [Thread-2  ]: dbt-sqlserver
[0m07:19:08.280870 [debug] [Thread-4  ]: dbt-sqlserver
[0m07:19:08.282335 [debug] [Thread-3  ]: dbt-sqlserver
[0m07:19:08.283986 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:19:08.285331 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:19:08.286602 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:19:08.287479 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:19:08.288284 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:19:08.289069 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:19:08.289957 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:19:08.290897 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:19:08.291793 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:19:08.316611 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.317859 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.318367 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.318971 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.320756 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:19:08.323258 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:19:08.325498 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:19:08.327252 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:19:08.327989 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:19:08.328826 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m07:19:08.329613 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m07:19:08.330366 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m07:19:08.332634 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.333242 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.334125 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.335533 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:19:08.338078 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:19:08.340727 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m07:19:08.342600 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m07:19:08.344573 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m07:19:08.345324 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:19:08.346219 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:19:08.347153 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m07:19:08.347952 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:19:08.350698 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c14b96d0>]}
[0m07:19:08.352056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0578fa0>]}
[0m07:19:08.353590 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0578460>]}
[0m07:19:08.355065 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdfe5ae-bedf-489c-99fa-4c932bc9dd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c14b9880>]}
[0m07:19:08.356363 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.47s]
[0m07:19:08.357960 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.48s]
[0m07:19:08.359540 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.48s]
[0m07:19:08.361098 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.48s]
[0m07:19:08.362643 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:19:08.364134 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:19:08.365412 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m07:19:08.366644 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:19:08.372061 [debug] [MainThread]: On master: COMMIT
[0m07:19:08.373367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:19:08.374280 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:19:08.375092 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m07:19:08.375835 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:19:08.376627 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:19:08.377570 [info ] [MainThread]: 
[0m07:19:08.378743 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m07:19:08.381169 [debug] [MainThread]: Command end result
[0m07:19:08.442423 [info ] [MainThread]: 
[0m07:19:08.443648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:19:08.445159 [info ] [MainThread]: 
[0m07:19:08.446651 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:19:08.448554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.833771, "process_user_time": 2.740368, "process_kernel_time": 0.194199, "process_mem_max_rss": "123816", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m07:19:08.449912 [debug] [MainThread]: Command `dbt run` succeeded at 07:19:08.449761 after 1.84 seconds
[0m07:19:08.450927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c4c18ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c19647c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c407d5b0>]}
[0m07:19:08.451834 [debug] [MainThread]: Flushing usage events
[0m07:19:12.908428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac76a2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac553e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac553e5b0>]}


============================== 07:19:12.912183 | c11dbd3f-c581-4217-8f20-41be9eb4eb58 ==============================
[0m07:19:12.912183 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:19:12.914204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:19:13.221558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c11dbd3f-c581-4217-8f20-41be9eb4eb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac748cf40>]}
[0m07:19:13.301487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c11dbd3f-c581-4217-8f20-41be9eb4eb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac55e6880>]}
[0m07:19:13.303383 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:19:13.439437 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:19:13.833034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:19:13.834443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:19:13.844245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:19:13.905108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c11dbd3f-c581-4217-8f20-41be9eb4eb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac3ea1130>]}
[0m07:19:14.149870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c11dbd3f-c581-4217-8f20-41be9eb4eb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac3e57880>]}
[0m07:19:14.150967 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:19:14.151918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c11dbd3f-c581-4217-8f20-41be9eb4eb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac422a370>]}
[0m07:19:14.155971 [info ] [MainThread]: 
[0m07:19:14.157986 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:19:14.165969 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:19:14.189342 [debug] [ThreadPool]: dbt-sqlserver
[0m07:19:14.190654 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:19:14.191752 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:19:14.192592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:14.193366 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:14.226627 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:14.259804 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:19:14.262319 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:19:14.263490 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:19:14.267258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c11dbd3f-c581-4217-8f20-41be9eb4eb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac3e579d0>]}
[0m07:19:14.268756 [debug] [MainThread]: On master: COMMIT
[0m07:19:14.269863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:19:14.271102 [info ] [MainThread]: 
[0m07:19:14.280766 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:19:14.281736 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:19:14.282875 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:19:14.284372 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_sales_orders_sales_order_id ....................... [RUN]
[0m07:19:14.286212 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8)
[0m07:19:14.287602 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be'
[0m07:19:14.288652 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:19:14.289567 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:19:14.318054 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:19:14.323153 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:19:14.329704 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:19:14.330505 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:19:14.367297 [debug] [Thread-1  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:19:14.371298 [debug] [Thread-2  ]: local_md5(model.name): e30686143bbe80d2e567cb5b509b642f
[0m07:19:14.372415 [debug] [Thread-1  ]: local_md5(invocation_id): 4220697718f8cfbe8e2171bc4adade39
[0m07:19:14.373966 [debug] [Thread-2  ]: local_md5(invocation_id): 4220697718f8cfbe8e2171bc4adade39
[0m07:19:14.376240 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:19:14.378159 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:19:14.385483 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:19:14.386444 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_76fb56d21b8bd49cd96f10c5316fd6ff]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_76fb56d21b8bd49cd96f10c5316fd6ff]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_76fb56d21b8bd49cd96f10c5316fd6ff]
  ;')
[0m07:19:14.387396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:19:14.387798 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:19:14.388506 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:14.389597 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6c3de7b7ba4eaf37a5fddde31c477608]
   as 
    
    

select
    sales_order_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is not null
group by sales_order_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6c3de7b7ba4eaf37a5fddde31c477608]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6c3de7b7ba4eaf37a5fddde31c477608]
  ;')
[0m07:19:14.392324 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:19:14.394023 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:19:14.404574 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:14.408367 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:19:14.415988 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:19:14.423123 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:19:14.424742 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:19:14.426595 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.14s]
[0m07:19:14.428527 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:19:14.461959 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:19:14.464860 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: ROLLBACK
[0m07:19:14.466009 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: Close
[0m07:19:14.467481 [error] [Thread-2  ]: 2 of 2 FAIL 21209 unique_stg_sales_orders_sales_order_id ....................... [[31mFAIL 21209[0m in 0.18s]
[0m07:19:14.469749 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:19:14.472927 [debug] [MainThread]: On master: COMMIT
[0m07:19:14.474030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:19:14.474782 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:19:14.475505 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be' was properly closed.
[0m07:19:14.476528 [info ] [MainThread]: 
[0m07:19:14.477561 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m07:19:14.479169 [debug] [MainThread]: Command end result
[0m07:19:14.540174 [info ] [MainThread]: 
[0m07:19:14.541406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:19:14.542555 [info ] [MainThread]: 
[0m07:19:14.543651 [error] [MainThread]: [31mFailure in test unique_stg_sales_orders_sales_order_id (models/staging/schema.yml)[0m
[0m07:19:14.544623 [error] [MainThread]:   Got 21209 results, configured to fail if != 0
[0m07:19:14.545539 [info ] [MainThread]: 
[0m07:19:14.546601 [info ] [MainThread]:   compiled code at target/compiled/dbt_sqlserver_project/models/staging/schema.yml/unique_stg_sales_orders_sales_order_id.sql
[0m07:19:14.547858 [info ] [MainThread]: 
[0m07:19:14.549910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m07:19:14.551849 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.7236648, "process_user_time": 2.894753, "process_kernel_time": 0.182939, "process_mem_max_rss": "125972", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m07:19:14.552712 [debug] [MainThread]: Command `dbt test` failed at 07:19:14.552586 after 1.72 seconds
[0m07:19:14.553547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac76a2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac73f2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac5c6c0d0>]}
[0m07:19:14.554662 [debug] [MainThread]: Flushing usage events
[0m07:20:31.079016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae9fdafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7e78640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7e785e0>]}


============================== 07:20:31.083575 | b4391a8d-cf18-4762-b052-3b456475f2f4 ==============================
[0m07:20:31.083575 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:20:31.085275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:20:31.430920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae9224610>]}
[0m07:20:31.503702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7f35520>]}
[0m07:20:31.505548 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:20:31.614557 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:20:31.823915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36f1acfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d04a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d04a5e0>]}


============================== 07:20:31.828426 | 8c31c7b7-b438-45ec-9524-b8306cd9bcaf ==============================
[0m07:20:31.828426 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:20:31.829578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:20:31.913948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:20:31.915636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:20:31.926081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:20:31.989711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae67db130>]}
[0m07:20:32.196715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36e3f5610>]}
[0m07:20:32.264662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae6bdaee0>]}
[0m07:20:32.265826 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:20:32.265939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d107520>]}
[0m07:20:32.266936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae8b8c160>]}
[0m07:20:32.267445 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:20:32.271509 [info ] [MainThread]: 
[0m07:20:32.273429 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:20:32.283723 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:20:32.307928 [debug] [ThreadPool]: dbt-sqlserver
[0m07:20:32.309185 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:20:32.310170 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:20:32.310992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:32.311835 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:32.349528 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:32.353184 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:20:32.355311 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:20:32.357915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:20:32.367506 [debug] [ThreadPool]: dbt-sqlserver
[0m07:20:32.368837 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:20:32.369826 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:20:32.370748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:32.371670 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:32.379570 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:20:32.385414 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:32.419309 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:20:32.422374 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:20:32.423706 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:20:32.426551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7eb9fa0>]}
[0m07:20:32.427722 [debug] [MainThread]: On master: COMMIT
[0m07:20:32.428722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:20:32.429669 [info ] [MainThread]: 
[0m07:20:32.440036 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:20:32.440662 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m07:20:32.441389 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:20:32.441955 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:32.442826 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m07:20:32.443946 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m07:20:32.445063 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m07:20:32.446502 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:20:32.447851 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:20:32.449321 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m07:20:32.450448 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m07:20:32.451561 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m07:20:32.452659 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:20:32.453962 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m07:20:32.455058 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:20:32.455999 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:32.467789 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:20:32.472718 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m07:20:32.478258 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:20:32.483334 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:32.489479 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:20:32.490630 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:20:32.496439 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:32.506847 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m07:20:32.558216 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m07:20:32.559692 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m07:20:32.561611 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:32.567579 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m07:20:32.572678 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:32.573693 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:32.574220 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:20:32.574676 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:32.575235 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:32.576137 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m07:20:32.577065 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:20:32.577965 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m07:20:32.578861 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m07:20:32.579700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:20:32.580800 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:32.581652 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:20:32.582431 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:20:32.583220 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:32.584503 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:32.585355 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:32.597614 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:32.598602 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:32.599117 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:32.599623 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:32.604769 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.605258 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.606092 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.614611 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:32.619462 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:32.625180 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:32.625856 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.626538 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m07:20:32.627383 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m07:20:32.628169 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m07:20:32.632550 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:32.635291 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m07:20:32.681364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:20:32.682800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:20:32.693329 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:20:32.763696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36b9ad130>]}
[0m07:20:32.804305 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.805047 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.805559 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.806198 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.811225 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:32.816082 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:32.820296 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:32.827001 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:32.828153 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m07:20:32.829307 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m07:20:32.830334 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:20:32.831359 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m07:20:32.834811 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.835363 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.835924 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.836646 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.866735 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m07:20:32.867572 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m07:20:32.869828 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:20:32.872373 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m07:20:32.880481 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m07:20:32.884746 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m07:20:32.888985 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:20:32.892820 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m07:20:32.903758 [debug] [Thread-3  ]: dbt-sqlserver
[0m07:20:32.905369 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:20:32.907017 [debug] [Thread-4  ]: dbt-sqlserver
[0m07:20:32.909074 [debug] [Thread-2  ]: dbt-sqlserver
[0m07:20:32.910537 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:32.911879 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:32.913625 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:32.915489 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:32.917203 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:32.918866 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:32.920034 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:32.921220 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:32.938181 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.941604 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:32.942219 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.942677 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.943603 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m07:20:32.946270 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:32.948461 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:32.949740 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.950338 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m07:20:32.951306 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:20:32.951880 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.953818 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:32.958588 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m07:20:32.959332 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.959799 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.960432 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m07:20:32.961377 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:20:32.963801 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m07:20:32.965881 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:20:32.969030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae6c25d30>]}
[0m07:20:32.969622 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:32.970260 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:20:32.971109 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:20:32.972300 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.52s]
[0m07:20:32.975351 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m07:20:32.977015 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae8b9a460>]}
[0m07:20:32.978619 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae58ef370>]}
[0m07:20:32.980062 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:20:32.981238 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m07:20:32.982708 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.53s]
[0m07:20:32.984378 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.53s]
[0m07:20:32.987075 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4391a8d-cf18-4762-b052-3b456475f2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae5909a00>]}
[0m07:20:32.988319 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:20:32.989705 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:32.991136 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.54s]
[0m07:20:32.994928 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m07:20:32.998023 [debug] [MainThread]: On master: COMMIT
[0m07:20:32.998973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:32.999723 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:20:33.000551 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m07:20:33.001362 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:20:33.002361 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:20:33.003458 [info ] [MainThread]: 
[0m07:20:33.004776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36bdaaee0>]}
[0m07:20:33.004892 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m07:20:33.006750 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:20:33.007881 [debug] [MainThread]: Command end result
[0m07:20:33.008567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36dd5d760>]}
[0m07:20:33.011590 [info ] [MainThread]: 
[0m07:20:33.013065 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:20:33.021606 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:20:33.046226 [debug] [ThreadPool]: dbt-sqlserver
[0m07:20:33.047260 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:20:33.047968 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:20:33.048706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:33.049440 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:33.073730 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:33.075870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:20:33.076501 [info ] [MainThread]: 
[0m07:20:33.077666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:20:33.078530 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:20:33.078990 [info ] [MainThread]: 
[0m07:20:33.080452 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:20:33.081770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:20:33.083864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0840304, "process_user_time": 3.108508, "process_kernel_time": 0.267053, "process_mem_max_rss": "125204", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m07:20:33.093058 [debug] [ThreadPool]: dbt-sqlserver
[0m07:20:33.094432 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:20:33.094403 [debug] [MainThread]: Command `dbt run` succeeded at 07:20:33.094232 after 2.09 seconds
[0m07:20:33.095282 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:20:33.095355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae9fdafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae9cc5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7f35520>]}
[0m07:20:33.096087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:33.096174 [debug] [MainThread]: Flushing usage events
[0m07:20:33.097244 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:33.110051 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:33.115029 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:20:33.117251 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:20:33.117894 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:20:33.120150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d08bfa0>]}
[0m07:20:33.120973 [debug] [MainThread]: On master: COMMIT
[0m07:20:33.121710 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:20:33.122480 [info ] [MainThread]: 
[0m07:20:33.132121 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:20:33.132645 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m07:20:33.133119 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:20:33.133573 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:33.134330 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m07:20:33.135506 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m07:20:33.136581 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m07:20:33.137607 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:20:33.138709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:20:33.139606 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m07:20:33.140402 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m07:20:33.141182 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m07:20:33.141893 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:20:33.142885 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m07:20:33.144101 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:20:33.145034 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:33.158034 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:20:33.163366 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m07:20:33.168773 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:20:33.173562 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:33.179119 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:20:33.179680 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:20:33.186088 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:33.186537 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m07:20:33.246191 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m07:20:33.247087 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m07:20:33.253218 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:33.258977 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m07:20:33.265860 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:33.266702 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:33.267786 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:33.268302 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:20:33.269622 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:33.270204 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m07:20:33.271095 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m07:20:33.271863 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:20:33.272574 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m07:20:33.273303 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:20:33.274094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:20:33.274864 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:33.275546 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:20:33.276273 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:33.277273 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:33.278691 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:33.291731 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:33.292800 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:33.294490 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:33.295576 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:33.305314 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.305810 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.306188 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.306539 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.315081 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:33.321866 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:33.327667 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:33.333107 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:33.334218 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m07:20:33.335456 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m07:20:33.336453 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m07:20:33.337803 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m07:20:33.341377 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.342051 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.343034 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.343553 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.348804 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:33.353206 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:33.357450 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:33.364246 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:33.365457 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m07:20:33.366487 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m07:20:33.367456 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:20:33.368630 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m07:20:33.373093 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.374085 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.374898 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.375445 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.399450 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m07:20:33.397606 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m07:20:33.402237 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:20:33.404693 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m07:20:33.412820 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m07:20:33.416516 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m07:20:33.420899 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:20:33.425340 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m07:20:33.433942 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:20:33.435712 [debug] [Thread-2  ]: dbt-sqlserver
[0m07:20:33.437769 [debug] [Thread-4  ]: dbt-sqlserver
[0m07:20:33.439520 [debug] [Thread-3  ]: dbt-sqlserver
[0m07:20:33.440422 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:33.441206 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:33.441983 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:33.442706 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:33.443490 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:33.444421 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:33.445316 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:33.446060 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:20:33.448010 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.448490 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.449409 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.452313 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:20:33.452788 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.454819 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:20:33.456443 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:20:33.457088 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m07:20:33.459019 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:20:33.459551 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m07:20:33.460293 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:20:33.461473 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m07:20:33.463022 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.463906 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.464740 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.468050 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m07:20:33.468580 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:20:33.470438 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m07:20:33.471978 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:20:33.472647 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:20:33.474556 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m07:20:33.475167 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m07:20:33.475750 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:20:33.477887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36bdf7f70>]}
[0m07:20:33.478572 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:20:33.479493 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36bdf7cd0>]}
[0m07:20:33.480996 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36aade370>]}
[0m07:20:33.482290 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.34s]
[0m07:20:33.484042 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31c7b7-b438-45ec-9524-b8306cd9bcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36bd48760>]}
[0m07:20:33.485347 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.34s]
[0m07:20:33.486440 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.34s]
[0m07:20:33.487556 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:20:33.488711 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.34s]
[0m07:20:33.489743 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m07:20:33.490777 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:20:33.492187 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:20:33.495465 [debug] [MainThread]: On master: COMMIT
[0m07:20:33.496705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:33.497411 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:20:33.498025 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m07:20:33.498662 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:20:33.499416 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:20:33.500188 [info ] [MainThread]: 
[0m07:20:33.500961 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m07:20:33.502675 [debug] [MainThread]: Command end result
[0m07:20:33.561088 [info ] [MainThread]: 
[0m07:20:33.562953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:20:33.564500 [info ] [MainThread]: 
[0m07:20:33.565749 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:20:33.567776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8295325, "process_user_time": 2.964232, "process_kernel_time": 0.354419, "process_mem_max_rss": "125184", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m07:20:33.568901 [debug] [MainThread]: Command `dbt run` succeeded at 07:20:33.568768 after 1.83 seconds
[0m07:20:33.569747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36f1acfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36ee97970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d107520>]}
[0m07:20:33.570508 [debug] [MainThread]: Flushing usage events
[0m07:20:38.291257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd6238f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd40d35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd40d3580>]}


============================== 07:20:38.295735 | e4516a2b-9779-4065-878b-54d93d43e2de ==============================
[0m07:20:38.295735 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:20:38.296898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:20:38.615521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4516a2b-9779-4065-878b-54d93d43e2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd30105b0>]}
[0m07:20:38.681205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4516a2b-9779-4065-878b-54d93d43e2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd640bdf0>]}
[0m07:20:38.682940 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:20:38.781099 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:20:39.060362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:20:39.061580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:20:39.070965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:20:39.131603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4516a2b-9779-4065-878b-54d93d43e2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2a36130>]}
[0m07:20:39.364113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4516a2b-9779-4065-878b-54d93d43e2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd41cfb20>]}
[0m07:20:39.365143 [info ] [MainThread]: Found 4 models, 2 data tests, 13 sources, 500 macros
[0m07:20:39.366124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4516a2b-9779-4065-878b-54d93d43e2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2b5c6a0>]}
[0m07:20:39.368853 [info ] [MainThread]: 
[0m07:20:39.370239 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:20:39.378645 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:20:39.400477 [debug] [ThreadPool]: dbt-sqlserver
[0m07:20:39.402134 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:20:39.403272 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:20:39.404338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:39.405219 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:39.425785 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:39.431376 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:20:39.434174 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:20:39.435238 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:20:39.437990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4516a2b-9779-4065-878b-54d93d43e2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2e36dc0>]}
[0m07:20:39.438929 [debug] [MainThread]: On master: COMMIT
[0m07:20:39.439773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:20:39.440657 [info ] [MainThread]: 
[0m07:20:39.450507 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:20:39.451124 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:20:39.452079 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:20:39.453407 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_sales_orders_sales_order_id ....................... [RUN]
[0m07:20:39.455523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8)
[0m07:20:39.456841 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be'
[0m07:20:39.457710 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:20:39.458614 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:20:39.486418 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:20:39.490269 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:20:39.496128 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:20:39.497028 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:20:39.537866 [debug] [Thread-2  ]: local_md5(model.name): e30686143bbe80d2e567cb5b509b642f
[0m07:20:39.550747 [debug] [Thread-1  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:20:39.551310 [debug] [Thread-2  ]: local_md5(invocation_id): 25381868606e62e071c52ff3cd3fc6a5
[0m07:20:39.552690 [debug] [Thread-1  ]: local_md5(invocation_id): 25381868606e62e071c52ff3cd3fc6a5
[0m07:20:39.554292 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:20:39.556152 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:20:39.562114 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"
[0m07:20:39.563842 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_31e5b33cbc29e025b0d4475ea0062398]
   as 
    
    

select
    sales_order_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is not null
group by sales_order_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_31e5b33cbc29e025b0d4475ea0062398]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_31e5b33cbc29e025b0d4475ea0062398]
  ;')
[0m07:20:39.564616 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:20:39.565264 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:20:39.566303 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_923b015cc75fb9ba7f41abf9a57e2a33]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_923b015cc75fb9ba7f41abf9a57e2a33]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_923b015cc75fb9ba7f41abf9a57e2a33]
  ;')
[0m07:20:39.567222 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:39.568052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:20:39.569577 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:20:39.583165 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:39.583649 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:20:39.590683 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:20:39.596803 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:20:39.598083 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:20:39.599418 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.14s]
[0m07:20:39.601194 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:20:39.631237 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:20:39.634109 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: ROLLBACK
[0m07:20:39.635444 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be: Close
[0m07:20:39.636879 [error] [Thread-2  ]: 2 of 2 FAIL 21209 unique_stg_sales_orders_sales_order_id ....................... [[31mFAIL 21209[0m in 0.18s]
[0m07:20:39.638441 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be
[0m07:20:39.640703 [debug] [MainThread]: On master: COMMIT
[0m07:20:39.641656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:39.642540 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:20:39.643232 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_stg_sales_orders_sales_order_id.5fc18d57be' was properly closed.
[0m07:20:39.644317 [info ] [MainThread]: 
[0m07:20:39.645560 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m07:20:39.647218 [debug] [MainThread]: Command end result
[0m07:20:39.711807 [info ] [MainThread]: 
[0m07:20:39.713094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:20:39.714269 [info ] [MainThread]: 
[0m07:20:39.715629 [error] [MainThread]: [31mFailure in test unique_stg_sales_orders_sales_order_id (models/staging/schema.yml)[0m
[0m07:20:39.716656 [error] [MainThread]:   Got 21209 results, configured to fail if != 0
[0m07:20:39.717503 [info ] [MainThread]: 
[0m07:20:39.718423 [info ] [MainThread]:   compiled code at target/compiled/dbt_sqlserver_project/models/staging/schema.yml/unique_stg_sales_orders_sales_order_id.sql
[0m07:20:39.719260 [info ] [MainThread]: 
[0m07:20:39.720338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m07:20:39.721761 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.5065311, "process_user_time": 2.553015, "process_kernel_time": 0.185475, "process_mem_max_rss": "124556", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m07:20:39.722592 [debug] [MainThread]: Command `dbt test` failed at 07:20:39.722466 after 1.51 seconds
[0m07:20:39.723390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd6238f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd640bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd48010a0>]}
[0m07:20:39.724335 [debug] [MainThread]: Flushing usage events
[0m07:22:23.203323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc4006a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc1e09520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc1e094c0>]}


============================== 07:22:23.207925 | 0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29 ==============================
[0m07:22:23.207925 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:22:23.209263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:22:23.586295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc0cca760>]}
[0m07:22:23.658619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc0cca250>]}
[0m07:22:23.660459 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:22:23.769450 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:22:24.066276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:22:24.068092 [debug] [MainThread]: Partial parsing: updated file: dbt_sqlserver_project://models/staging/schema.yml
[0m07:22:24.485941 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:22:24.487574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc0ba9520>]}
[0m07:22:24.748502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:22:24.779480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbad4c130>]}
[0m07:22:24.978077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbad5f3a0>]}
[0m07:22:24.979658 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 500 macros
[0m07:22:24.980905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc078d3d0>]}
[0m07:22:24.983923 [info ] [MainThread]: 
[0m07:22:24.985561 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:22:24.993807 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:22:25.016014 [debug] [ThreadPool]: dbt-sqlserver
[0m07:22:25.017526 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:22:25.018800 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:22:25.019978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:25.021177 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:25.060080 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:25.063855 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:22:25.066122 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:22:25.068931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:22:25.078059 [debug] [ThreadPool]: dbt-sqlserver
[0m07:22:25.079348 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:22:25.080563 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:22:25.081858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:22:25.082643 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:25.096676 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:25.131250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:22:25.133712 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:22:25.134900 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:22:25.138291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc0c1fca0>]}
[0m07:22:25.139467 [debug] [MainThread]: On master: COMMIT
[0m07:22:25.140617 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:22:25.141612 [info ] [MainThread]: 
[0m07:22:25.153101 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m07:22:25.153625 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m07:22:25.154074 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m07:22:25.154665 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:22:25.155506 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m07:22:25.156625 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m07:22:25.157765 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m07:22:25.159053 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:22:25.160122 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m07:22:25.161128 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m07:22:25.162253 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m07:22:25.163338 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m07:22:25.164159 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m07:22:25.165126 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m07:22:25.166232 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m07:22:25.167166 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:22:25.178046 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m07:22:25.182864 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m07:22:25.189188 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m07:22:25.194275 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:22:25.199884 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m07:22:25.200666 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m07:22:25.201599 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m07:22:25.207580 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:22:25.277235 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m07:22:25.283208 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m07:22:25.283764 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m07:22:25.291497 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:22:25.298605 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:22:25.299307 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:22:25.300387 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m07:22:25.301028 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:22:25.301528 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:22:25.302131 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m07:22:25.302952 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:22:25.303776 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m07:22:25.304620 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:22:25.305947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:22:25.307031 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:25.307949 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:22:25.308842 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:22:25.310070 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:25.311796 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:25.313164 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:25.328810 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:25.332098 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:25.332727 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:25.333274 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:25.335563 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.347113 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:22:25.347706 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.348219 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.348938 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.349808 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m07:22:25.355540 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:22:25.361234 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:22:25.367172 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:22:25.369335 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m07:22:25.370956 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m07:22:25.372510 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m07:22:25.571636 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.572487 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.572938 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.573402 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.578814 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:22:25.584969 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:22:25.590938 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:22:25.596976 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:22:25.598246 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m07:22:25.599373 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:22:25.600783 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m07:22:25.602244 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m07:22:25.606626 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.607360 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.608035 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.608642 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.656661 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:22:25.658420 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m07:22:25.661520 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m07:22:25.664589 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m07:22:25.678598 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:22:25.683307 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m07:22:25.688550 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m07:22:25.693989 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m07:22:25.704308 [debug] [Thread-4  ]: dbt-sqlserver
[0m07:22:25.706075 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:22:25.708098 [debug] [Thread-3  ]: dbt-sqlserver
[0m07:22:25.709943 [debug] [Thread-2  ]: dbt-sqlserver
[0m07:22:25.711679 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:22:25.712874 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:22:25.714015 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:22:25.715292 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:22:25.716211 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:22:25.717066 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:22:25.718112 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:22:25.719080 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:22:25.740657 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.741769 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.742404 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.742931 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.745199 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m07:22:25.747884 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m07:22:25.750712 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m07:22:25.752890 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:22:25.754058 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m07:22:25.755199 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m07:22:25.756577 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m07:22:25.757988 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:22:25.761831 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.762671 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.763281 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.763859 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m07:22:25.767561 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m07:22:25.769852 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m07:22:25.772171 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m07:22:25.774754 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:22:25.775968 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m07:22:25.777141 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m07:22:25.777996 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m07:22:25.779096 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:22:25.782075 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cba2575b0>]}
[0m07:22:25.783231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cba257730>]}
[0m07:22:25.784647 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cba4283d0>]}
[0m07:22:25.786025 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1a036e-eadb-4d2a-bb8e-8e00d14d3d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cba428f70>]}
[0m07:22:25.787394 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.62s]
[0m07:22:25.789053 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.62s]
[0m07:22:25.790581 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.62s]
[0m07:22:25.792083 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.62s]
[0m07:22:25.793447 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m07:22:25.794669 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m07:22:25.796002 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m07:22:25.797188 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:22:25.801578 [debug] [MainThread]: On master: COMMIT
[0m07:22:25.803009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:25.804152 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m07:22:25.805092 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m07:22:25.805949 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m07:22:25.806837 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:22:25.807886 [info ] [MainThread]: 
[0m07:22:25.808936 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m07:22:25.811141 [debug] [MainThread]: Command end result
[0m07:22:25.887584 [info ] [MainThread]: 
[0m07:22:25.889176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:22:25.890350 [info ] [MainThread]: 
[0m07:22:25.891668 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:22:25.893819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.77246, "process_user_time": 3.901729, "process_kernel_time": 0.279434, "process_mem_max_rss": "132484", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m07:22:25.895250 [debug] [MainThread]: Command `dbt run` succeeded at 07:22:25.895002 after 2.77 seconds
[0m07:22:25.896652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc4006a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb84df3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc0cca250>]}
[0m07:22:25.898346 [debug] [MainThread]: Flushing usage events
[0m07:22:31.065547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaeabb5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae8a52640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae8a525e0>]}


============================== 07:22:31.069118 | a5be280b-751b-418b-902b-9c15f01efc11 ==============================
[0m07:22:31.069118 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:22:31.070165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:22:31.373947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5be280b-751b-418b-902b-9c15f01efc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae9dfd610>]}
[0m07:22:31.444206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5be280b-751b-418b-902b-9c15f01efc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae8b0f520>]}
[0m07:22:31.445735 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:22:31.540362 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:22:34.168561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:22:34.169852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:22:34.179043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:22:34.237537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5be280b-751b-418b-902b-9c15f01efc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae73b6130>]}
[0m07:22:34.458984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5be280b-751b-418b-902b-9c15f01efc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae736da60>]}
[0m07:22:34.460270 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 500 macros
[0m07:22:34.461448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5be280b-751b-418b-902b-9c15f01efc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae73f6160>]}
[0m07:22:34.464413 [info ] [MainThread]: 
[0m07:22:34.465903 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:22:34.473747 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:22:34.496261 [debug] [ThreadPool]: dbt-sqlserver
[0m07:22:34.497659 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:22:34.498835 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:22:34.499986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:34.501049 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:34.532072 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:34.560402 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:22:34.562802 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:22:34.563832 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:22:34.566673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5be280b-751b-418b-902b-9c15f01efc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae7372820>]}
[0m07:22:34.567629 [debug] [MainThread]: On master: COMMIT
[0m07:22:34.568662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:22:34.569651 [info ] [MainThread]: 
[0m07:22:34.578232 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:22:34.578710 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:22:34.579134 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:22:34.579882 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m07:22:34.580840 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m07:22:34.582030 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:22:34.583090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m07:22:34.584065 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m07:22:34.585011 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:22:34.585888 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:22:34.586786 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:22:34.587567 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:22:34.615075 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:22:34.622920 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:22:34.624469 [debug] [Thread-1  ]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:22:34.626784 [error] [Thread-1  ]: 1 of 3 ERROR dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[31mERROR[0m in 0.04s]
[0m07:22:34.628063 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:22:34.630130 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:22:34.637243 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:22:34.666465 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:22:34.666775 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m07:22:34.667846 [debug] [Thread-3  ]: local_md5(invocation_id): 13304494bfbad4bfd4a2a3b801be4b74
[0m07:22:34.669134 [debug] [Thread-2  ]: local_md5(invocation_id): 13304494bfbad4bfd4a2a3b801be4b74
[0m07:22:34.670642 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:22:34.672251 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:22:34.677290 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:22:34.678353 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:22:34.678876 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_c687683f9d3eb6090bdc13d302ebca1c]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_c687683f9d3eb6090bdc13d302ebca1c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_c687683f9d3eb6090bdc13d302ebca1c]
  ;')
[0m07:22:34.680034 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_87b0d0f7a29e7602860bec44defd0eab]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_87b0d0f7a29e7602860bec44defd0eab]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_87b0d0f7a29e7602860bec44defd0eab]
  ;')
[0m07:22:34.681006 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:22:34.682074 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:22:34.682965 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:34.683826 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:22:34.696967 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:34.697458 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:22:34.715414 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:22:34.721838 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:22:34.722961 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:22:34.724379 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.14s]
[0m07:22:34.726133 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:22:34.810446 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:22:34.812828 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m07:22:34.813729 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m07:22:34.814782 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.23s]
[0m07:22:34.816473 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:22:34.819758 [debug] [MainThread]: On master: COMMIT
[0m07:22:34.821169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:34.822402 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m07:22:34.823401 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m07:22:34.824200 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:22:34.824902 [info ] [MainThread]: 
[0m07:22:34.825724 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m07:22:34.827512 [debug] [MainThread]: Command end result
[0m07:22:34.889004 [info ] [MainThread]: 
[0m07:22:34.890021 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:22:34.890960 [info ] [MainThread]: 
[0m07:22:34.892061 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:22:34.892931 [info ] [MainThread]: 
[0m07:22:34.893984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:22:34.895517 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.5762357, "process_user_time": 2.715266, "process_kernel_time": 0.22449, "process_mem_max_rss": "125028", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m07:22:34.896292 [debug] [MainThread]: Command `dbt test` failed at 07:22:34.896179 after 1.58 seconds
[0m07:22:34.897008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaeabb5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae917a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae42730d0>]}
[0m07:22:34.897823 [debug] [MainThread]: Flushing usage events
[0m07:24:19.674479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38211def10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381f07a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381f07a580>]}


============================== 07:24:19.678052 | 819711a8-8e08-469a-b4f3-3d9f261299b6 ==============================
[0m07:24:19.678052 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:24:19.679045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:24:19.967652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '819711a8-8e08-469a-b4f3-3d9f261299b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381dfb75b0>]}
[0m07:24:20.030626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '819711a8-8e08-469a-b4f3-3d9f261299b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38213b2df0>]}
[0m07:24:20.032150 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:24:20.124287 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:24:20.429054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:24:20.430432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:24:20.438947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:24:20.498711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '819711a8-8e08-469a-b4f3-3d9f261299b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381d9de130>]}
[0m07:24:20.725154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '819711a8-8e08-469a-b4f3-3d9f261299b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381dfa5760>]}
[0m07:24:20.726241 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 500 macros
[0m07:24:20.727249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '819711a8-8e08-469a-b4f3-3d9f261299b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381da1e880>]}
[0m07:24:20.730009 [info ] [MainThread]: 
[0m07:24:20.731442 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:24:20.738822 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:24:20.758689 [debug] [ThreadPool]: dbt-sqlserver
[0m07:24:20.759871 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:24:20.760932 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:24:20.761896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:20.762759 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:24:20.795250 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:24:20.822477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:24:20.824952 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:24:20.826217 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:24:20.828802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '819711a8-8e08-469a-b4f3-3d9f261299b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381d995a00>]}
[0m07:24:20.829589 [debug] [MainThread]: On master: COMMIT
[0m07:24:20.830432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:24:20.831257 [info ] [MainThread]: 
[0m07:24:20.841495 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:24:20.842239 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:24:20.842798 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:24:20.843867 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m07:24:20.845190 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m07:24:20.846687 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:24:20.847973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m07:24:20.848965 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m07:24:20.849775 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:24:20.850495 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:24:20.851185 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:24:20.851939 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:24:20.877516 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:24:20.879081 [debug] [Thread-1  ]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:24:20.884321 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:24:20.886812 [error] [Thread-1  ]: 1 of 3 ERROR dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[31mERROR[0m in 0.04s]
[0m07:24:20.889252 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:24:20.891027 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:24:20.897739 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:24:20.923766 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m07:24:20.926861 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:24:20.928201 [debug] [Thread-2  ]: local_md5(invocation_id): 4fd49b85c27e33976284e4cac7f8083a
[0m07:24:20.929536 [debug] [Thread-3  ]: local_md5(invocation_id): 4fd49b85c27e33976284e4cac7f8083a
[0m07:24:20.931356 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:24:20.932969 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:24:20.938252 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:24:20.939226 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:24:20.939714 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_e28f48a39aa6a35e732e00043806fd01]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_e28f48a39aa6a35e732e00043806fd01]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_e28f48a39aa6a35e732e00043806fd01]
  ;')
[0m07:24:20.940626 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_7887b0fa1c4401c311420d8e0bc2cec3]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_7887b0fa1c4401c311420d8e0bc2cec3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_7887b0fa1c4401c311420d8e0bc2cec3]
  ;')
[0m07:24:20.941473 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:24:20.942380 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:24:20.943606 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:24:20.944593 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:24:20.957509 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:24:20.957944 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:24:20.974901 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:24:20.983260 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:24:20.984758 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:24:20.986121 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.14s]
[0m07:24:20.987768 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:24:21.014359 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:24:21.017035 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m07:24:21.018200 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m07:24:21.019522 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.17s]
[0m07:24:21.021197 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:24:21.023852 [debug] [MainThread]: On master: COMMIT
[0m07:24:21.024763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:21.025365 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m07:24:21.025962 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m07:24:21.026532 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:24:21.027152 [info ] [MainThread]: 
[0m07:24:21.027962 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m07:24:21.029437 [debug] [MainThread]: Command end result
[0m07:24:21.087990 [info ] [MainThread]: 
[0m07:24:21.089216 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:24:21.090240 [info ] [MainThread]: 
[0m07:24:21.091347 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:24:21.092185 [info ] [MainThread]: 
[0m07:24:21.093210 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:24:21.094791 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.4921794, "process_user_time": 2.632609, "process_kernel_time": 0.190309, "process_mem_max_rss": "125432", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m07:24:21.095612 [debug] [MainThread]: Command `dbt test` failed at 07:24:21.095498 after 1.49 seconds
[0m07:24:21.096315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38211def10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381f7a84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381c095850>]}
[0m07:24:21.097057 [debug] [MainThread]: Flushing usage events
[0m07:25:40.289337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff518ab4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff516952640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5169525e0>]}


============================== 07:25:40.293007 | 85af27a2-673d-4131-8565-e7e31c4574d2 ==============================
[0m07:25:40.293007 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:25:40.294679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m07:25:40.591698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85af27a2-673d-4131-8565-e7e31c4574d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5188a3f40>]}
[0m07:25:40.654266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85af27a2-673d-4131-8565-e7e31c4574d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff517655760>]}
[0m07:25:40.655842 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:25:40.756029 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:25:41.033633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:25:41.035225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:25:41.044152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:25:41.106367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85af27a2-673d-4131-8565-e7e31c4574d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5152b7130>]}
[0m07:25:41.332018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85af27a2-673d-4131-8565-e7e31c4574d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51526ec70>]}
[0m07:25:41.333168 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 500 macros
[0m07:25:41.334249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85af27a2-673d-4131-8565-e7e31c4574d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5152f6bb0>]}
[0m07:25:41.337481 [info ] [MainThread]: 
[0m07:25:41.338951 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:25:41.346872 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:25:41.370050 [debug] [ThreadPool]: dbt-sqlserver
[0m07:25:41.371099 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:25:41.371958 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:25:41.372785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:41.373778 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:25:41.409266 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:25:41.440610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:41.443289 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:25:41.444653 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:25:41.447753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85af27a2-673d-4131-8565-e7e31c4574d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff515273820>]}
[0m07:25:41.448673 [debug] [MainThread]: On master: COMMIT
[0m07:25:41.449622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:25:41.450523 [info ] [MainThread]: 
[0m07:25:41.460621 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:25:41.461144 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:41.461568 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:41.462332 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m07:25:41.463172 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m07:25:41.464249 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:25:41.465332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m07:25:41.466612 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m07:25:41.467690 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:25:41.468554 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:25:41.469332 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:41.470097 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:41.499039 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:25:41.507459 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:25:41.510122 [debug] [Thread-1  ]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:25:41.511900 [error] [Thread-1  ]: 1 of 3 ERROR dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[31mERROR[0m in 0.05s]
[0m07:25:41.513263 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:25:41.515461 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:41.516274 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:41.556600 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m07:25:41.570895 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:25:41.571567 [debug] [Thread-2  ]: local_md5(invocation_id): c6daf4404d3761fc863e4cc41fd1c530
[0m07:25:41.573000 [debug] [Thread-3  ]: local_md5(invocation_id): c6daf4404d3761fc863e4cc41fd1c530
[0m07:25:41.574540 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:25:41.575930 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:25:41.582542 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:25:41.583295 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:25:41.584304 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_9d3c07429d34e302dd78917126f40fca]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_9d3c07429d34e302dd78917126f40fca]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_9d3c07429d34e302dd78917126f40fca]
  ;')
[0m07:25:41.585722 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_332b1496811d5786a3bfb62518864865]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_332b1496811d5786a3bfb62518864865]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_332b1496811d5786a3bfb62518864865]
  ;')
[0m07:25:41.587243 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:25:41.588208 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:25:41.589231 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:25:41.590530 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:25:41.608020 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:25:41.608529 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:25:41.619516 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:25:41.626186 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:25:41.627703 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:25:41.629836 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.16s]
[0m07:25:41.631957 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:41.670125 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:25:41.672689 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m07:25:41.673633 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m07:25:41.675554 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.21s]
[0m07:25:41.677600 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:41.680833 [debug] [MainThread]: On master: COMMIT
[0m07:25:41.681937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:41.682891 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m07:25:41.683578 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m07:25:41.684117 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:25:41.684785 [info ] [MainThread]: 
[0m07:25:41.685552 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m07:25:41.687861 [debug] [MainThread]: Command end result
[0m07:25:41.754610 [info ] [MainThread]: 
[0m07:25:41.755852 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:25:41.757242 [info ] [MainThread]: 
[0m07:25:41.758889 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:25:41.760631 [info ] [MainThread]: 
[0m07:25:41.761814 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:25:41.763568 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.5469164, "process_user_time": 2.573195, "process_kernel_time": 0.202027, "process_mem_max_rss": "125820", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m07:25:41.765077 [debug] [MainThread]: Command `dbt test` failed at 07:25:41.764849 after 1.55 seconds
[0m07:25:41.766353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff518ab4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51707c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff515818850>]}
[0m07:25:41.767437 [debug] [MainThread]: Flushing usage events
[0m07:25:44.356324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f7448fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f6680700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f5377ca0>]}


============================== 07:25:44.359987 | bb63085e-5dbb-4404-bba6-ef7d49be1ec1 ==============================
[0m07:25:44.359987 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:25:44.361521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:25:44.654907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb63085e-5dbb-4404-bba6-ef7d49be1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f421d7c0>]}
[0m07:25:44.719276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb63085e-5dbb-4404-bba6-ef7d49be1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f41842e0>]}
[0m07:25:44.720996 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:25:44.818701 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:25:45.098184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:25:45.099874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:25:45.109520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:25:45.173732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb63085e-5dbb-4404-bba6-ef7d49be1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c4a130>]}
[0m07:25:45.400439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb63085e-5dbb-4404-bba6-ef7d49be1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c019a0>]}
[0m07:25:45.401662 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 500 macros
[0m07:25:45.403035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb63085e-5dbb-4404-bba6-ef7d49be1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c8ab20>]}
[0m07:25:45.406330 [info ] [MainThread]: 
[0m07:25:45.408179 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:25:45.416224 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:25:45.437219 [debug] [ThreadPool]: dbt-sqlserver
[0m07:25:45.438671 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:25:45.439835 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:25:45.440761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:45.441732 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:25:45.472810 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:25:45.502958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:45.505527 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:25:45.506600 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:25:45.510182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb63085e-5dbb-4404-bba6-ef7d49be1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f421d6a0>]}
[0m07:25:45.511388 [debug] [MainThread]: On master: COMMIT
[0m07:25:45.512398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:25:45.513262 [info ] [MainThread]: 
[0m07:25:45.522001 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:25:45.522551 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:45.523045 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:45.524236 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m07:25:45.525262 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m07:25:45.526413 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:25:45.527560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m07:25:45.528935 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m07:25:45.530577 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:25:45.532869 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:25:45.534126 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:45.535374 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:45.566399 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:25:45.569256 [debug] [Thread-1  ]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:25:45.576435 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:25:45.578985 [error] [Thread-1  ]: 1 of 3 ERROR dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[31mERROR[0m in 0.05s]
[0m07:25:45.581590 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:25:45.583300 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:45.590286 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:45.625937 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m07:25:45.639954 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:25:45.640527 [debug] [Thread-2  ]: local_md5(invocation_id): 6a6f37aed53e9ecfc46f6f90c180ddd2
[0m07:25:45.642178 [debug] [Thread-3  ]: local_md5(invocation_id): 6a6f37aed53e9ecfc46f6f90c180ddd2
[0m07:25:45.643817 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:25:45.645310 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:25:45.651279 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:25:45.652384 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:25:45.653252 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_d864c1c5fcba960abc6bb6377455646d]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_d864c1c5fcba960abc6bb6377455646d]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_d864c1c5fcba960abc6bb6377455646d]
  ;')
[0m07:25:45.654429 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_1780b7160e078615da1392d457f408f5]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_1780b7160e078615da1392d457f408f5]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_1780b7160e078615da1392d457f408f5]
  ;')
[0m07:25:45.655625 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:25:45.656669 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:25:45.657696 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:25:45.658783 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:25:45.674409 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:25:46.623589 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:25:46.632815 [debug] [Thread-3  ]: SQL status: OK in 1.000 seconds
[0m07:25:46.638466 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:25:46.639383 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:25:46.640517 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 1.11s]
[0m07:25:46.641907 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:25:46.673273 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m07:25:46.676106 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m07:25:46.677593 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m07:25:46.679294 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 1.15s]
[0m07:25:46.680913 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:25:46.683172 [debug] [MainThread]: On master: COMMIT
[0m07:25:46.684068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:46.684825 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m07:25:46.685563 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m07:25:46.686230 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:25:46.686902 [info ] [MainThread]: 
[0m07:25:46.687836 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m07:25:46.689390 [debug] [MainThread]: Command end result
[0m07:25:46.750866 [info ] [MainThread]: 
[0m07:25:46.751975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:25:48.211184 [info ] [MainThread]: 
[0m07:25:48.212494 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:25:48.213513 [info ] [MainThread]: 
[0m07:25:48.214559 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:25:48.216052 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.5353007, "process_user_time": 2.894575, "process_kernel_time": 0.163227, "process_mem_max_rss": "126308", "process_out_blocks": "216", "command_success": false, "process_in_blocks": "0"}
[0m07:25:48.217070 [debug] [MainThread]: Command `dbt test` failed at 07:25:48.216932 after 1.54 seconds
[0m07:25:48.217864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f7448fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f5fc1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3a82d00>]}
[0m07:25:48.218601 [debug] [MainThread]: Flushing usage events
[0m07:26:00.848499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f0527fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee3c4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee3c4520>]}


============================== 07:26:00.852073 | b26802e9-ce86-4095-90e3-02d530388c14 ==============================
[0m07:26:00.852073 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:26:00.853789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:26:00.979955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b26802e9-ce86-4095-90e3-02d530388c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee5c01c0>]}
[0m07:26:00.994930 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hkc2efo5'
[0m07:26:00.996441 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:26:01.270379 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:26:01.271946 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:26:01.323762 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:26:01.343862 [info ] [MainThread]: Updating lock file in file path: /usr/app/dbt/package-lock.yml
[0m07:26:01.355402 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zbyzpkiq'
[0m07:26:01.361000 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:26:05.374216 [info ] [MainThread]: Installed from version 1.1.1
[0m07:26:05.375539 [info ] [MainThread]: Updated version available: 1.3.0
[0m07:26:05.376745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b26802e9-ce86-4095-90e3-02d530388c14', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee337940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee38c790>]}
[0m07:26:05.377544 [info ] [MainThread]: 
[0m07:26:05.378446 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:26:05.380333 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.6066737, "process_user_time": 1.698308, "process_kernel_time": 0.250756, "process_mem_max_rss": "91804", "process_in_blocks": "216", "process_out_blocks": "200"}
[0m07:26:05.381245 [debug] [MainThread]: Command `dbt deps` succeeded at 07:26:05.381110 after 4.61 seconds
[0m07:26:05.382047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f0527fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee385d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee337940>]}
[0m07:26:05.382821 [debug] [MainThread]: Flushing usage events
[0m07:26:12.400413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3886fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a366735b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a36673550>]}


============================== 07:26:12.404067 | 82940432-c37b-4f5e-91d9-c16ac92296c4 ==============================
[0m07:26:12.404067 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:26:12.405199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sales_orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:26:12.717730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a389e6220>]}
[0m07:26:12.780112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a37ab7340>]}
[0m07:26:12.781613 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:26:12.897705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:26:13.050700 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m07:26:13.052542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a373513d0>]}
[0m07:26:15.761311 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:26:15.762865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a34f82eb0>]}
[0m07:26:16.158065 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:26:16.178796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a34f9f6a0>]}
[0m07:26:16.361341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a35111160>]}
[0m07:26:16.362770 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m07:26:16.364144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a1f454a90>]}
[0m07:26:16.367093 [info ] [MainThread]: 
[0m07:26:16.368882 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:26:16.371908 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m07:26:16.392635 [debug] [ThreadPool]: dbt-sqlserver
[0m07:26:16.394122 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m07:26:16.395370 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:26:16.396801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:16.397815 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:26:16.431202 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:26:16.434565 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:16.436512 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m07:26:16.444886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m07:26:16.454526 [debug] [ThreadPool]: dbt-sqlserver
[0m07:26:16.455806 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:26:16.456875 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:26:16.458139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:16.459381 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:26:16.472067 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:26:16.503638 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:16.506618 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:26:16.508017 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:26:16.511307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a355a9e20>]}
[0m07:26:16.512311 [debug] [MainThread]: On master: COMMIT
[0m07:26:16.513263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:26:16.514208 [info ] [MainThread]: 
[0m07:26:16.523867 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:26:16.525154 [info ] [Thread-1  ]: 1 of 1 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m07:26:16.526472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_sales_orders)
[0m07:26:16.527600 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m07:26:16.539612 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:26:16.545809 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m07:26:16.591501 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:26:16.600034 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:26:16.601023 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m07:26:16.601758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:16.602577 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:26:16.614560 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:26:16.619588 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:26:16.627829 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:26:16.629047 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m07:26:16.783201 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:26:16.790395 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:26:16.791892 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m07:26:16.795817 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:26:16.817396 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m07:26:16.826891 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m07:26:16.837021 [debug] [Thread-1  ]: dbt-sqlserver
[0m07:26:16.838656 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:26:16.839968 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m07:26:16.854970 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:26:16.857653 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m07:26:16.859003 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m07:26:16.861909 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:26:16.865831 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m07:26:16.866935 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m07:26:16.869328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82940432-c37b-4f5e-91d9-c16ac92296c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a354bb1c0>]}
[0m07:26:16.870505 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.34s]
[0m07:26:16.871879 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m07:26:16.874211 [debug] [MainThread]: On master: COMMIT
[0m07:26:16.875055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:16.875680 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m07:26:16.876345 [info ] [MainThread]: 
[0m07:26:16.877153 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m07:26:16.878938 [debug] [MainThread]: Command end result
[0m07:26:16.948686 [info ] [MainThread]: 
[0m07:26:16.950126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:26:16.951668 [info ] [MainThread]: 
[0m07:26:16.952858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:26:16.954367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6304803, "process_user_time": 5.021856, "process_kernel_time": 0.173541, "process_mem_max_rss": "130108", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m07:26:16.955304 [debug] [MainThread]: Command `dbt run` succeeded at 07:26:16.955167 after 4.63 seconds
[0m07:26:16.956273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3886fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a36d96ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a35095430>]}
[0m07:26:16.957386 [debug] [MainThread]: Flushing usage events
[0m07:27:09.480799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a96772a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a94c997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a94609c40>]}


============================== 07:27:09.485226 | e8dd5f42-ff05-440c-ae9f-8505974b5c39 ==============================
[0m07:27:09.485226 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:27:09.486851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m07:27:09.614441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8dd5f42-ff05-440c-ae9f-8505974b5c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9476f430>]}
[0m07:27:09.836918 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vwsbcsvv'
[0m07:27:09.837775 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:27:10.010213 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:27:10.012472 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:27:10.071713 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:27:10.083205 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:27:13.169402 [info ] [MainThread]: Installed from version 1.1.1
[0m07:27:13.170623 [info ] [MainThread]: Updated version available: 1.3.0
[0m07:27:13.172062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e8dd5f42-ff05-440c-ae9f-8505974b5c39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a959553d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a959caee0>]}
[0m07:27:13.173014 [info ] [MainThread]: 
[0m07:27:13.173845 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:27:13.175409 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.7710226, "process_user_time": 1.705403, "process_kernel_time": 0.249836, "process_mem_max_rss": "91732", "process_out_blocks": "200", "process_in_blocks": "0"}
[0m07:27:13.176249 [debug] [MainThread]: Command `dbt deps` succeeded at 07:27:13.176119 after 3.77 seconds
[0m07:27:13.176973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a96772a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a959553d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a945bcaf0>]}
[0m07:27:13.177668 [debug] [MainThread]: Flushing usage events
[0m07:27:21.217726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a706bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a4f08640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a4f085e0>]}


============================== 07:27:21.221652 | ae06330c-5690-4a26-b90c-6114d3bea83f ==============================
[0m07:27:21.221652 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:27:21.222873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select stg_sales_orders', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:27:21.511279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae06330c-5690-4a26-b90c-6114d3bea83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a4fa5bb0>]}
[0m07:27:21.572513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae06330c-5690-4a26-b90c-6114d3bea83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3d2ef70>]}
[0m07:27:21.574145 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:27:21.691307 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:27:22.427876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:22.428606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:22.436823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:27:22.495131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae06330c-5690-4a26-b90c-6114d3bea83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a37e0130>]}
[0m07:27:22.729733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae06330c-5690-4a26-b90c-6114d3bea83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3bff100>]}
[0m07:27:22.731048 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m07:27:23.643428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae06330c-5690-4a26-b90c-6114d3bea83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3bffb20>]}
[0m07:27:23.645754 [info ] [MainThread]: 
[0m07:27:23.647363 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:27:23.657145 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:27:23.686892 [debug] [ThreadPool]: dbt-sqlserver
[0m07:27:23.688506 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:27:23.690090 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:27:23.691466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:23.692556 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:23.731946 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:23.765165 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:27:23.767873 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:27:23.769130 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:27:23.772959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae06330c-5690-4a26-b90c-6114d3bea83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3982ac0>]}
[0m07:27:23.774277 [debug] [MainThread]: On master: COMMIT
[0m07:27:23.775282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:27:23.776190 [info ] [MainThread]: 
[0m07:27:23.781141 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:23.781693 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:25.237389 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:25.238365 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m07:27:25.239331 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m07:27:25.240444 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:27:25.241589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m07:27:25.242773 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m07:27:25.244189 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:27:25.245362 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:25.246242 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:25.247036 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:25.300560 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:25.301537 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:25.310695 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:25.317759 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:25.325365 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:25.326513 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:25.376826 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m07:27:25.390240 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m07:27:25.394056 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:27:25.395224 [debug] [Thread-1  ]: local_md5(invocation_id): e939a4f61f0ab845b3467683a78d2cd2
[0m07:27:25.396116 [debug] [Thread-2  ]: local_md5(invocation_id): e939a4f61f0ab845b3467683a78d2cd2
[0m07:27:25.396888 [debug] [Thread-3  ]: local_md5(invocation_id): e939a4f61f0ab845b3467683a78d2cd2
[0m07:27:25.398434 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:25.399836 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:25.401252 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:25.406179 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:25.407541 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b2fe3ede105c66871644d97334812e93]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b2fe3ede105c66871644d97334812e93]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b2fe3ede105c66871644d97334812e93]
  ;')
[0m07:27:25.408367 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:25.409271 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:25.410142 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:27:25.411359 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_100bb866856bca62771c0f81a07b5a65]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_100bb866856bca62771c0f81a07b5a65]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_100bb866856bca62771c0f81a07b5a65]
  ;')
[0m07:27:25.412583 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_9029a86123d725c8690a6e6f1e4976c5]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_9029a86123d725c8690a6e6f1e4976c5]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_9029a86123d725c8690a6e6f1e4976c5]
  ;')
[0m07:27:25.413894 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:25.415339 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:27:25.416874 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:27:25.418668 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:25.419906 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:25.432319 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:25.433409 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:25.435234 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:25.444796 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:27:25.452072 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:27:25.453479 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:27:25.455769 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.21s]
[0m07:27:25.457829 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:25.499416 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:27:25.502290 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m07:27:25.503455 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m07:27:25.504837 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.26s]
[0m07:27:25.506500 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:25.554728 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:27:25.557792 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m07:27:25.558892 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m07:27:25.560072 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.32s]
[0m07:27:25.561524 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:25.563664 [debug] [MainThread]: On master: COMMIT
[0m07:27:25.564552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:25.565197 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m07:27:25.565752 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m07:27:25.566238 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:27:25.566842 [info ] [MainThread]: 
[0m07:27:25.567620 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m07:27:25.569306 [debug] [MainThread]: Command end result
[0m07:27:25.635848 [info ] [MainThread]: 
[0m07:27:25.636973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:27:25.638180 [info ] [MainThread]: 
[0m07:27:25.639084 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:27:25.640636 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1317492, "process_user_time": 2.609865, "process_kernel_time": 0.194122, "process_mem_max_rss": "127696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:27:25.641605 [debug] [MainThread]: Command `dbt test` succeeded at 07:27:25.641472 after 2.13 seconds
[0m07:27:25.642512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a706bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a5c09790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3876af0>]}
[0m07:27:25.643407 [debug] [MainThread]: Flushing usage events
[0m07:27:30.144619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ecf0ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ead13700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ead136a0>]}


============================== 07:27:30.148565 | f24c56c3-e75f-483e-8794-ffda2e2e2a2a ==============================
[0m07:27:30.148565 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:27:30.149886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select stg_sales_orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:27:30.440975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f24c56c3-e75f-483e-8794-ffda2e2e2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e9b28e50>]}
[0m07:27:30.507787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f24c56c3-e75f-483e-8794-ffda2e2e2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e9ad7490>]}
[0m07:27:30.509475 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:27:30.625790 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:27:31.449041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:31.449753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:31.458458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m07:27:31.517409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f24c56c3-e75f-483e-8794-ffda2e2e2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e95ea130>]}
[0m07:27:31.754706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f24c56c3-e75f-483e-8794-ffda2e2e2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e978ed90>]}
[0m07:27:31.756129 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m07:27:31.757251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24c56c3-e75f-483e-8794-ffda2e2e2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e9681c40>]}
[0m07:27:31.759662 [info ] [MainThread]: 
[0m07:27:31.761424 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:27:31.769022 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:27:31.792635 [debug] [ThreadPool]: dbt-sqlserver
[0m07:27:31.794139 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:27:31.795356 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:27:31.796597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:31.797619 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:31.816515 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:31.822385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:27:31.824602 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:27:31.825429 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:27:31.828119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24c56c3-e75f-483e-8794-ffda2e2e2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e9b700a0>]}
[0m07:27:31.829041 [debug] [MainThread]: On master: COMMIT
[0m07:27:31.830014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:27:31.831057 [info ] [MainThread]: 
[0m07:27:31.836463 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:31.836984 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:31.837437 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:31.838328 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m07:27:31.839357 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m07:27:31.840517 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:27:31.841679 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m07:27:31.842657 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m07:27:31.843511 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:27:31.844267 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:31.844994 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:31.845722 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:31.878573 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:31.882189 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:31.888210 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:31.894506 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:31.895371 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:31.901848 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:31.932833 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m07:27:31.936226 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m07:27:31.940129 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:27:31.941836 [debug] [Thread-1  ]: local_md5(invocation_id): 5d75cd2c49d692d3d25f22cf257bc989
[0m07:27:31.943848 [debug] [Thread-2  ]: local_md5(invocation_id): 5d75cd2c49d692d3d25f22cf257bc989
[0m07:27:31.945136 [debug] [Thread-3  ]: local_md5(invocation_id): 5d75cd2c49d692d3d25f22cf257bc989
[0m07:27:31.947026 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:31.948747 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:31.950224 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:31.955416 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:31.955877 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:31.957134 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_90d882024191eda9d1c6ccf055c307bd]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_90d882024191eda9d1c6ccf055c307bd]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_90d882024191eda9d1c6ccf055c307bd]
  ;')
[0m07:27:31.958167 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:31.959364 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_599f62bd94f3225ced297493dbfede32]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_599f62bd94f3225ced297493dbfede32]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_599f62bd94f3225ced297493dbfede32]
  ;')
[0m07:27:31.960433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:27:31.961590 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_45ad2a2a0418ac137a8afebe55ed8351]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_45ad2a2a0418ac137a8afebe55ed8351]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_45ad2a2a0418ac137a8afebe55ed8351]
  ;')
[0m07:27:31.962639 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:27:31.963908 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:31.965259 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:27:31.966207 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:31.967578 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:31.979556 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:31.980223 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:31.980650 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:31.994623 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:27:32.000870 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:27:32.002295 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:27:32.004243 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.16s]
[0m07:27:32.006896 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:32.048102 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:27:32.051192 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m07:27:32.053225 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m07:27:32.055219 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.21s]
[0m07:27:32.057213 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:32.102448 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:27:32.105117 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m07:27:32.106266 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m07:27:32.107854 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.27s]
[0m07:27:32.109630 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:32.111802 [debug] [MainThread]: On master: COMMIT
[0m07:27:32.112707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:32.113438 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m07:27:32.114529 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m07:27:32.115415 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:27:32.116196 [info ] [MainThread]: 
[0m07:27:32.117391 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m07:27:32.119149 [debug] [MainThread]: Command end result
[0m07:27:32.189583 [info ] [MainThread]: 
[0m07:27:32.191049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:27:32.192519 [info ] [MainThread]: 
[0m07:27:32.194637 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:27:32.196430 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1255462, "process_user_time": 2.632832, "process_kernel_time": 0.181207, "process_mem_max_rss": "125160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:27:32.197487 [debug] [MainThread]: Command `dbt test` succeeded at 07:27:32.197334 after 2.13 seconds
[0m07:27:32.198359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ecf0ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18eb43a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18eb43f7f0>]}
[0m07:27:32.199345 [debug] [MainThread]: Flushing usage events
[0m07:27:39.454255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44774f6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4475394670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4475394610>]}


============================== 07:27:39.458167 | 3613cbad-e5b2-425b-8c18-5f918b98650c ==============================
[0m07:27:39.458167 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:27:39.459438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m07:27:39.757516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3613cbad-e5b2-425b-8c18-5f918b98650c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4475425580>]}
[0m07:27:39.818551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3613cbad-e5b2-425b-8c18-5f918b98650c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4474158af0>]}
[0m07:27:39.820090 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m07:27:39.930632 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:27:40.687016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:40.687715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:40.695627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m07:27:40.748458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3613cbad-e5b2-425b-8c18-5f918b98650c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4473c6d130>]}
[0m07:27:40.951076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3613cbad-e5b2-425b-8c18-5f918b98650c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4473e13910>]}
[0m07:27:40.952302 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m07:27:40.953375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3613cbad-e5b2-425b-8c18-5f918b98650c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4473d8a580>]}
[0m07:27:40.955767 [info ] [MainThread]: 
[0m07:27:40.957110 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m07:27:40.964314 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m07:27:40.984057 [debug] [ThreadPool]: dbt-sqlserver
[0m07:27:40.985416 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m07:27:40.986624 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m07:27:40.987657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:40.988773 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:41.007341 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:41.011642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:27:41.013467 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m07:27:41.014227 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m07:27:41.016619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3613cbad-e5b2-425b-8c18-5f918b98650c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447548fac0>]}
[0m07:27:41.017495 [debug] [MainThread]: On master: COMMIT
[0m07:27:41.018411 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:27:41.019528 [info ] [MainThread]: 
[0m07:27:41.028273 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:41.028691 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:41.029109 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:41.029991 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m07:27:41.031041 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m07:27:41.032273 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m07:27:41.033452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m07:27:41.034374 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m07:27:41.035327 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m07:27:41.036082 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:41.036866 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:41.037606 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:41.066363 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:41.072331 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:41.082146 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:41.092690 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:41.093408 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:41.099932 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:41.133997 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m07:27:41.137354 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m07:27:41.141999 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m07:27:41.143502 [debug] [Thread-2  ]: local_md5(invocation_id): 78192861c1c589b203f2cb4320a8eaaa
[0m07:27:41.144749 [debug] [Thread-1  ]: local_md5(invocation_id): 78192861c1c589b203f2cb4320a8eaaa
[0m07:27:41.146215 [debug] [Thread-3  ]: local_md5(invocation_id): 78192861c1c589b203f2cb4320a8eaaa
[0m07:27:41.147509 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:41.148631 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:41.149675 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:41.154206 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m07:27:41.154902 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m07:27:41.156037 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_bdbd943e8324b0a5859e59638faa0121]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_bdbd943e8324b0a5859e59638faa0121]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_bdbd943e8324b0a5859e59638faa0121]
  ;')
[0m07:27:41.156758 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m07:27:41.157582 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6a6e0f90ba0fccf0edec4c387e1b509c]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6a6e0f90ba0fccf0edec4c387e1b509c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6a6e0f90ba0fccf0edec4c387e1b509c]
  ;')
[0m07:27:41.158484 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:27:41.160051 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_4bc11c0a8d8b55ae4228b906088c0342]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_4bc11c0a8d8b55ae4228b906088c0342]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_4bc11c0a8d8b55ae4228b906088c0342]
  ;')
[0m07:27:41.161275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:27:41.162200 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:41.163171 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:27:41.164160 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:41.165556 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m07:27:41.177980 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:41.178625 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:41.179124 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m07:27:41.186668 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m07:27:41.193360 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m07:27:41.194385 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m07:27:41.195730 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.16s]
[0m07:27:41.197340 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m07:27:41.239267 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m07:27:41.242203 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m07:27:41.243208 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m07:27:41.244449 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.21s]
[0m07:27:41.246188 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m07:27:41.295998 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m07:27:41.298918 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m07:27:41.299961 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m07:27:41.302069 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.27s]
[0m07:27:41.303834 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m07:27:41.306041 [debug] [MainThread]: On master: COMMIT
[0m07:27:41.306812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:41.307430 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m07:27:41.307991 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m07:27:41.308563 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m07:27:41.309586 [info ] [MainThread]: 
[0m07:27:41.310662 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m07:27:41.312523 [debug] [MainThread]: Command end result
[0m07:27:41.390200 [info ] [MainThread]: 
[0m07:27:41.392751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:27:41.393949 [info ] [MainThread]: 
[0m07:27:41.395100 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:27:41.396640 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0180151, "process_user_time": 2.562351, "process_kernel_time": 0.256235, "process_mem_max_rss": "125100", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m07:27:41.397729 [debug] [MainThread]: Command `dbt test` succeeded at 07:27:41.397530 after 2.02 seconds
[0m07:27:41.398864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44774f6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4473f27c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4475456550>]}
[0m07:27:41.400147 [debug] [MainThread]: Flushing usage events
[0m06:36:31.362930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad626ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad551a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad4207370>]}


============================== 06:36:31.368356 | c03c0cab-f3f6-4036-9aa5-0893f8960d12 ==============================
[0m06:36:31.368356 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:36:31.369840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:36:31.832710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad2fd2490>]}
[0m06:36:31.907189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad41f84f0>]}
[0m06:36:31.909190 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:36:32.104359 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:36:33.738929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:36:33.739857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:36:33.750576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m06:36:33.826835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad29e5130>]}
[0m06:36:34.114023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad2b60070>]}
[0m06:36:34.115349 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m06:36:34.116895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad2b60610>]}
[0m06:36:34.120352 [info ] [MainThread]: 
[0m06:36:34.122245 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:36:34.131577 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:36:34.155704 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:34.157126 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:36:34.158296 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:34.159293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:34.160301 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:34.224088 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:34.228325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:34.230496 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:36:34.233173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m06:36:34.245396 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:34.246431 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:36:34.247161 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:34.247973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:34.249247 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:34.264457 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:34.303128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:34.305715 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:36:34.306798 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:36:34.309828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad2f5b5b0>]}
[0m06:36:34.311062 [debug] [MainThread]: On master: COMMIT
[0m06:36:34.312173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:36:34.313410 [info ] [MainThread]: 
[0m06:36:34.324717 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m06:36:34.325413 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m06:36:34.325921 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m06:36:34.326508 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m06:36:34.327435 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m06:36:34.328741 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m06:36:34.330290 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m06:36:34.331766 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m06:36:34.333078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m06:36:34.334244 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m06:36:34.335286 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m06:36:34.336289 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m06:36:34.337156 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m06:36:34.338115 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m06:36:34.339117 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m06:36:34.340252 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m06:36:34.353622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m06:36:34.358512 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m06:36:34.364050 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m06:36:34.369848 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:36:34.376174 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m06:36:34.376882 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m06:36:34.383371 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m06:36:34.384137 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m06:36:34.461109 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m06:36:34.463392 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m06:36:34.465704 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m06:36:34.471716 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:36:34.477812 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:36:34.478688 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:36:34.480185 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m06:36:34.481062 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:36:34.481590 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:36:34.482900 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:36:34.484549 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:36:34.486300 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m06:36:34.488372 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m06:36:34.490051 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:36:34.491466 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:34.492697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:34.494079 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:36:34.495358 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:34.496762 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:34.497828 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:34.511712 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:34.513456 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:34.514106 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:34.514815 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:34.524356 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.524970 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.525414 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.527176 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.535775 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:36:34.541801 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:36:34.547307 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:36:34.552786 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:36:34.553853 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m06:36:34.555029 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m06:36:34.556216 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m06:36:34.557241 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m06:36:34.764263 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.764817 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.765343 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.765772 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.771169 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:36:34.776949 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:36:34.782270 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:36:34.788840 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:36:34.790183 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m06:36:34.791463 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m06:36:34.792456 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m06:36:34.793801 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m06:36:34.799819 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.801019 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.802138 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.802871 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.840760 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m06:36:34.841853 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m06:36:34.843816 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m06:36:34.846137 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m06:36:34.856187 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m06:36:34.860843 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m06:36:34.866011 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m06:36:34.871494 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m06:36:34.881784 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:36:34.883316 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:36:34.884713 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:36:34.886218 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:36:34.887383 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:36:34.888552 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:36:34.889976 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:36:34.891100 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:36:34.892352 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:34.894481 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:34.897255 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:34.899601 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:34.920811 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.921659 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.922760 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.923359 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.925758 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:36:34.927883 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:36:34.930283 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:36:34.932395 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:36:34.933131 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m06:36:34.934009 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m06:36:34.934914 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m06:36:34.935769 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m06:36:34.941944 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.942643 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.943149 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.943612 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:34.947362 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m06:36:34.949978 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m06:36:34.952251 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m06:36:34.954446 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m06:36:34.955458 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m06:36:34.956532 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m06:36:34.958064 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m06:36:34.959230 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m06:36:34.965866 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad1b42b50>]}
[0m06:36:34.969606 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad1b42760>]}
[0m06:36:34.972519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad1b42fd0>]}
[0m06:36:34.984061 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03c0cab-f3f6-4036-9aa5-0893f8960d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad1b428e0>]}
[0m06:36:34.989592 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.62s]
[0m06:36:34.993105 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.63s]
[0m06:36:34.995620 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.64s]
[0m06:36:34.997783 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.65s]
[0m06:36:35.000710 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m06:36:35.002652 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m06:36:35.004555 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m06:36:35.006406 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m06:36:35.012985 [debug] [MainThread]: On master: COMMIT
[0m06:36:35.014685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:35.015937 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m06:36:35.016903 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m06:36:35.017825 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m06:36:35.018793 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m06:36:35.020028 [info ] [MainThread]: 
[0m06:36:35.021561 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m06:36:35.024320 [debug] [MainThread]: Command end result
[0m06:36:35.120629 [info ] [MainThread]: 
[0m06:36:35.122249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:36:35.123682 [info ] [MainThread]: 
[0m06:36:35.125099 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:36:35.128360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8851843, "process_user_time": 3.07021, "process_kernel_time": 0.439967, "process_mem_max_rss": "125136", "process_in_blocks": "103704", "process_out_blocks": "216"}
[0m06:36:35.129789 [debug] [MainThread]: Command `dbt run` succeeded at 06:36:35.129605 after 3.89 seconds
[0m06:36:35.130863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad626ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad48328b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad2e7a490>]}
[0m06:36:35.132312 [debug] [MainThread]: Flushing usage events
[0m06:36:43.057626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebce66f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebad02640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebad025e0>]}


============================== 06:36:43.061676 | b2a529f0-fc1c-41c6-8620-fdcfb161b392 ==============================
[0m06:36:43.061676 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:36:43.063402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:36:43.388220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2a529f0-fc1c-41c6-8620-fdcfb161b392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebadaabe0>]}
[0m06:36:43.462391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2a529f0-fc1c-41c6-8620-fdcfb161b392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebd08a3d0>]}
[0m06:36:43.464417 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:36:43.617125 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:36:44.539423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:36:44.540141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:36:44.548512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m06:36:44.610100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2a529f0-fc1c-41c6-8620-fdcfb161b392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb95db130>]}
[0m06:36:45.070242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2a529f0-fc1c-41c6-8620-fdcfb161b392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb962b610>]}
[0m06:36:45.071291 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m06:36:45.072338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2a529f0-fc1c-41c6-8620-fdcfb161b392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb99f84f0>]}
[0m06:36:45.075599 [info ] [MainThread]: 
[0m06:36:45.077260 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:36:45.085640 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m06:36:45.107822 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:45.109269 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:36:45.110429 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:45.111516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:45.112607 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:45.135330 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:45.143610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:45.146024 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:36:45.147081 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:36:45.149775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2a529f0-fc1c-41c6-8620-fdcfb161b392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb974ba30>]}
[0m06:36:45.150604 [debug] [MainThread]: On master: COMMIT
[0m06:36:45.151418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:36:45.152629 [info ] [MainThread]: 
[0m06:36:45.164129 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:36:45.164796 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:36:45.165329 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:36:45.166191 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:36:45.167210 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m06:36:45.168626 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m06:36:45.170230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m06:36:45.171841 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m06:36:45.173557 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m06:36:45.174978 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:36:45.176459 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:36:45.177729 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:36:45.232733 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m06:36:45.234532 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m06:36:45.239932 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m06:36:45.246176 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:36:45.247160 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:36:45.254298 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:36:45.302380 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m06:36:45.312081 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m06:36:45.315654 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m06:36:45.317065 [debug] [Thread-1  ]: local_md5(invocation_id): 84ebcf49d898ec0326cf04955ba28b5f
[0m06:36:45.318374 [debug] [Thread-3  ]: local_md5(invocation_id): 84ebcf49d898ec0326cf04955ba28b5f
[0m06:36:45.319549 [debug] [Thread-2  ]: local_md5(invocation_id): 84ebcf49d898ec0326cf04955ba28b5f
[0m06:36:45.320831 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m06:36:45.322396 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m06:36:45.323713 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m06:36:45.329487 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m06:36:45.330400 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m06:36:45.331898 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_1f5e4030ddf85d9950e289bf750d82a9]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_1f5e4030ddf85d9950e289bf750d82a9]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_1f5e4030ddf85d9950e289bf750d82a9]
  ;')
[0m06:36:45.332845 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m06:36:45.334085 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_df3ce288cba4923979d4a2855706f6e5]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_df3ce288cba4923979d4a2855706f6e5]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_df3ce288cba4923979d4a2855706f6e5]
  ;')
[0m06:36:45.335461 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:45.336658 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_fb82b252b7cbd03fb48a465917526642]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_fb82b252b7cbd03fb48a465917526642]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_fb82b252b7cbd03fb48a465917526642]
  ;')
[0m06:36:45.337937 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:36:45.339507 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:45.340793 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:36:45.342225 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:45.343989 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:45.357306 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:45.358822 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:45.359571 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:45.835056 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:45.843072 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m06:36:45.844585 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m06:36:45.846482 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.67s]
[0m06:36:45.849114 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:36:45.898593 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m06:36:45.902115 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m06:36:45.903845 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m06:36:45.905731 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.73s]
[0m06:36:45.907845 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:36:45.975453 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m06:36:45.978605 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m06:36:45.979948 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m06:36:45.981775 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.81s]
[0m06:36:45.983740 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:36:45.987345 [debug] [MainThread]: On master: COMMIT
[0m06:36:45.988741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:45.989753 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m06:36:45.990765 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m06:36:45.991794 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m06:36:45.992819 [info ] [MainThread]: 
[0m06:36:45.994325 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m06:36:45.997497 [debug] [MainThread]: Command end result
[0m06:36:46.089803 [info ] [MainThread]: 
[0m06:36:46.091643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:36:46.093201 [info ] [MainThread]: 
[0m06:36:46.094869 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:36:46.097255 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1186314, "process_user_time": 3.369186, "process_kernel_time": 0.564776, "process_mem_max_rss": "124972", "process_in_blocks": "1440", "process_out_blocks": "216"}
[0m06:36:46.098650 [debug] [MainThread]: Command `dbt test` succeeded at 06:36:46.098452 after 3.12 seconds
[0m06:36:46.099976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebce66f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebadc54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebadaabe0>]}
[0m06:36:46.101263 [debug] [MainThread]: Flushing usage events
[0m06:37:40.313867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18cb77fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18aa15670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18aa15610>]}


============================== 06:37:40.456154 | 8b150be4-df31-45b8-b9e9-5c49e1de3fa0 ==============================
[0m06:37:40.456154 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:37:40.510829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:37:41.385805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18aaa6580>]}
[0m06:37:41.520861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1897d9af0>]}
[0m06:37:41.523084 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:37:41.696473 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:37:43.242244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:37:43.310663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:37:43.792714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m06:37:44.335766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1892ee130>]}
[0m06:37:52.203661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1898d6970>]}
[0m06:37:52.205997 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m06:37:52.209140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18cd8a460>]}
[0m06:37:52.216347 [info ] [MainThread]: 
[0m06:37:52.226332 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:37:52.244262 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:37:52.292652 [debug] [ThreadPool]: dbt-sqlserver
[0m06:37:52.296487 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:37:52.305496 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:37:52.313579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:37:52.321417 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:37:52.408566 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:37:52.422509 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:37:52.431690 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:37:52.442019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m06:37:52.462090 [debug] [ThreadPool]: dbt-sqlserver
[0m06:37:52.465093 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:37:52.467213 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:37:52.468728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:37:52.470257 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:37:52.493458 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:37:52.568420 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:37:52.574036 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:37:52.580850 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:37:52.586046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1897ca130>]}
[0m06:37:52.587911 [debug] [MainThread]: On master: COMMIT
[0m06:37:52.589561 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:37:52.593094 [info ] [MainThread]: 
[0m06:37:52.616101 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m06:37:52.616727 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m06:37:52.617246 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m06:37:52.617798 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m06:37:52.618922 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m06:37:52.621045 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m06:37:52.627059 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m06:37:52.630393 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m06:37:52.638480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m06:37:52.647916 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m06:37:52.650408 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m06:37:52.652443 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m06:37:52.654386 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m06:37:52.656083 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m06:37:52.667040 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m06:37:52.669076 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m06:37:52.692812 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m06:37:52.704688 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m06:37:59.618518 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m06:37:59.631779 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:37:59.650034 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m06:37:59.651068 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m06:37:59.664281 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m06:37:59.700006 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m06:37:59.870211 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m06:37:59.875073 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m06:37:59.880178 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:37:59.882796 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m06:37:59.891790 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:37:59.894282 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:37:59.896366 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:37:59.900600 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:37:59.906332 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m06:37:59.910342 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m06:37:59.915706 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:37:59.923908 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:37:59.931113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:37:59.937641 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:37:59.942920 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:37:59.953412 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:37:59.960889 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:37:59.983578 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m06:38:00.065730 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:38:00.074844 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:38:00.084423 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:00.085225 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:00.086026 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:00.107860 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.108676 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.142583 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:00.148116 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:38:00.149120 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.159995 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:38:00.189075 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m06:38:00.202733 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.211318 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:38:00.212150 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m06:38:00.250697 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:38:00.262990 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m06:38:00.295116 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m06:38:00.746078 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.747208 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.748126 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m06:38:00.748739 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.759175 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:38:00.767540 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:38:00.780692 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:38:00.794230 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:38:00.800043 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m06:38:00.803769 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m06:38:00.809451 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m06:38:00.818485 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m06:38:00.830170 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.831138 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.834908 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.841132 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:38:00.875101 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m06:38:00.877535 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m06:38:00.881277 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m06:38:00.890280 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m06:38:00.906837 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m06:38:00.920394 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m06:38:00.926671 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m06:38:00.936419 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m06:38:00.953178 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:38:00.957498 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:38:00.967240 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:38:00.969691 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:38:00.971421 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:38:00.973126 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:38:00.977196 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:38:00.983697 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:38:00.988241 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:38:00.995419 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:38:01.000785 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:38:01.007982 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:38:01.047802 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.048964 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.051610 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.058142 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m06:38:01.062455 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.066111 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m06:38:01.072002 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m06:38:01.073117 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m06:38:01.077858 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m06:38:01.079213 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m06:38:01.084219 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m06:38:01.095935 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.097079 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m06:38:01.104776 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m06:38:01.105837 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.106471 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.114541 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m06:38:01.115428 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:38:01.121197 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m06:38:01.128821 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m06:38:01.134700 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd188493b20>]}
[0m06:38:01.141697 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m06:38:01.148176 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m06:38:01.153700 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m06:38:01.158006 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 8.48s]
[0m06:38:01.166467 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m06:38:01.168605 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd188476460>]}
[0m06:38:01.176025 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18844c160>]}
[0m06:38:01.178061 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m06:38:01.183159 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b150be4-df31-45b8-b9e9-5c49e1de3fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd188493d90>]}
[0m06:38:01.257485 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 8.52s]
[0m06:38:01.261645 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 8.54s]
[0m06:38:01.267368 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 8.53s]
[0m06:38:01.270007 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m06:38:01.272320 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m06:38:01.274608 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m06:38:01.281144 [debug] [MainThread]: On master: COMMIT
[0m06:38:01.283552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:01.287025 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m06:38:01.288408 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m06:38:01.289482 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m06:38:01.291892 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m06:38:01.293936 [info ] [MainThread]: 
[0m06:38:01.302940 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m06:38:01.307258 [debug] [MainThread]: Command end result
[0m06:38:07.617829 [info ] [MainThread]: 
[0m06:38:07.890913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:07.893287 [info ] [MainThread]: 
[0m06:38:07.937164 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:38:08.040104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.741705, "process_user_time": 4.070159, "process_kernel_time": 0.486433, "process_mem_max_rss": "125324", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m06:38:08.041915 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:08.041701 after 27.74 seconds
[0m06:38:08.043407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18cb77fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18c8bf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18aad7550>]}
[0m06:38:08.044941 [debug] [MainThread]: Flushing usage events
[0m06:38:19.319985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ef43fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78cde1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78cde1610>]}


============================== 06:38:19.323964 | d9090a1c-687d-4b75-8f7d-0a0571a21ff4 ==============================
[0m06:38:19.323964 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:38:19.680116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m06:38:20.006290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9090a1c-687d-4b75-8f7d-0a0571a21ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ce72580>]}
[0m06:38:20.139486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9090a1c-687d-4b75-8f7d-0a0571a21ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78bba4af0>]}
[0m06:38:20.141427 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:38:20.278818 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:38:21.524713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:21.587893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:21.829108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m06:38:22.156906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9090a1c-687d-4b75-8f7d-0a0571a21ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78b6ba130>]}
[0m06:38:45.035759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9090a1c-687d-4b75-8f7d-0a0571a21ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78b860910>]}
[0m06:38:45.039714 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m06:38:45.046604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9090a1c-687d-4b75-8f7d-0a0571a21ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78b7d7580>]}
[0m06:38:45.078360 [info ] [MainThread]: 
[0m06:38:45.089063 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:38:45.132095 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m06:38:45.222776 [debug] [ThreadPool]: dbt-sqlserver
[0m06:38:45.230171 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m06:38:45.244841 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:38:45.257958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:45.267215 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:38:45.360834 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:45.438690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:38:45.448097 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m06:38:45.451184 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m06:38:45.456687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9090a1c-687d-4b75-8f7d-0a0571a21ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ceddac0>]}
[0m06:38:45.459042 [debug] [MainThread]: On master: COMMIT
[0m06:38:45.465589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:45.473811 [info ] [MainThread]: 
[0m06:38:45.496275 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:38:45.497255 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:38:45.498132 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:38:45.499815 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:38:45.507334 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m06:38:45.509967 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m06:38:45.512730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m06:38:45.514975 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m06:38:45.517238 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m06:38:45.526741 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:38:45.529997 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:38:45.538940 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:38:45.613736 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m06:38:45.616118 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m06:38:45.628211 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m06:38:45.640296 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:38:45.657765 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:38:45.664427 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:38:45.735050 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m06:38:45.753562 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m06:38:45.755079 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m06:38:45.761059 [debug] [Thread-2  ]: local_md5(invocation_id): e622bac898c58177f86bded59f77b2ce
[0m06:38:45.766877 [debug] [Thread-3  ]: local_md5(invocation_id): e622bac898c58177f86bded59f77b2ce
[0m06:38:45.775586 [debug] [Thread-1  ]: local_md5(invocation_id): e622bac898c58177f86bded59f77b2ce
[0m06:38:45.779552 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m06:38:45.785521 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m06:38:45.788089 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m06:38:45.804610 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m06:38:45.805654 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m06:38:45.806425 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m06:38:45.808206 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_75475f684e278da36bb08b106c3f7ba7]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_75475f684e278da36bb08b106c3f7ba7]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_75475f684e278da36bb08b106c3f7ba7]
  ;')
[0m06:38:45.810091 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_db0887387872ae978ab5e7efd3fee96a]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_db0887387872ae978ab5e7efd3fee96a]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_db0887387872ae978ab5e7efd3fee96a]
  ;')
[0m06:38:45.822419 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b54813c9b057091493e9ed7a867cb9cf]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b54813c9b057091493e9ed7a867cb9cf]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b54813c9b057091493e9ed7a867cb9cf]
  ;')
[0m06:38:45.831537 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:38:45.840455 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:38:45.848327 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:38:45.850171 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:38:45.851794 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:38:45.856370 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:38:45.891371 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:45.901284 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:45.915608 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:38:45.927402 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:38:45.992807 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:38:46.071807 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:38:46.152939 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m06:38:46.687163 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m06:38:47.169186 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m06:38:47.241681 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m06:38:47.769168 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m06:38:47.972401 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m06:38:48.092856 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 2.58s]
[0m06:38:48.099912 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 2.59s]
[0m06:38:48.107078 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 2.59s]
[0m06:38:48.109967 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m06:38:48.116861 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m06:38:48.122486 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m06:38:48.132791 [debug] [MainThread]: On master: COMMIT
[0m06:38:48.134781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:48.136508 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m06:38:48.137850 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m06:38:48.138806 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m06:38:48.139887 [info ] [MainThread]: 
[0m06:38:48.141022 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m06:38:48.143481 [debug] [MainThread]: Command end result
[0m06:38:52.047794 [info ] [MainThread]: 
[0m06:38:52.049200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:52.050603 [info ] [MainThread]: 
[0m06:38:52.051880 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:38:52.054117 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 32.923958, "process_user_time": 3.10422, "process_kernel_time": 0.252786, "process_mem_max_rss": "125612", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m06:38:52.055846 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:52.055625 after 32.93 seconds
[0m06:38:52.056727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ef43fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78b974c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78cea3550>]}
[0m06:38:52.057786 [debug] [MainThread]: Flushing usage events
[0m09:36:26.118188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b744ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b52ed670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b52ed610>]}


============================== 09:36:26.124584 | ebf950c8-8378-46de-b083-a47536c86154 ==============================
[0m09:36:26.124584 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:36:26.125895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:26.635953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b53a05b0>]}
[0m09:36:26.716432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b5ff0b50>]}
[0m09:36:26.717779 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m09:36:26.882245 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:36:27.959831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:27.960854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:27.971204 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m09:36:28.058826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b3bc6130>]}
[0m09:36:28.344054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b40a24c0>]}
[0m09:36:28.345200 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m09:36:28.346194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b3d32fa0>]}
[0m09:36:28.349914 [info ] [MainThread]: 
[0m09:36:28.351913 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:36:28.360804 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m09:36:28.398091 [debug] [ThreadPool]: dbt-sqlserver
[0m09:36:28.399919 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m09:36:28.401399 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m09:36:28.402732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:28.403736 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:28.531847 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:28.538728 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:28.541084 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m09:36:28.543950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m09:36:28.556098 [debug] [ThreadPool]: dbt-sqlserver
[0m09:36:28.558521 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m09:36:28.560679 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m09:36:28.562119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:36:28.563433 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:28.580925 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:28.647942 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:28.650303 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m09:36:28.651531 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m09:36:28.654460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b921fca0>]}
[0m09:36:28.655451 [debug] [MainThread]: On master: COMMIT
[0m09:36:28.656739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:36:28.657904 [info ] [MainThread]: 
[0m09:36:28.671351 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m09:36:28.672298 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m09:36:28.673011 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m09:36:28.673788 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m09:36:28.676560 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m09:36:28.679116 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m09:36:28.681860 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m09:36:28.684279 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m09:36:28.686187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m09:36:28.688079 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m09:36:28.689823 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m09:36:28.691539 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m09:36:28.692735 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m09:36:28.693886 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m09:36:28.695143 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m09:36:28.696280 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m09:36:28.717855 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m09:36:28.724157 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m09:36:28.730694 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m09:36:28.738706 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:36:28.747747 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m09:36:28.749126 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m09:36:28.750111 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m09:36:28.756880 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m09:36:28.885958 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m09:36:28.888219 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m09:36:28.890472 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m09:36:28.892379 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:36:28.901137 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:36:28.902440 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:36:28.904313 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:36:28.905304 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m09:36:28.907353 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:36:28.908336 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m09:36:28.910500 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m09:36:28.913015 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:36:28.915088 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m09:36:28.917065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:36:28.919203 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:36:28.921092 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:28.922959 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:36:28.924475 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:28.925949 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:28.927724 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:28.945764 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:28.946747 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:28.947659 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:28.949989 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:28.962357 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:36:28.963096 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:36:28.963551 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:36:28.964006 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:36:28.975851 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:36:28.982150 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:36:28.988782 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:36:28.994659 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:36:28.996340 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m09:36:28.997767 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m09:36:28.998981 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m09:36:29.000066 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m09:36:29.210373 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.210889 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.211317 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.211875 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.217817 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:36:29.223144 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:36:29.228230 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:36:29.235859 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:36:29.236763 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m09:36:29.237726 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m09:36:29.238899 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m09:36:29.239856 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m09:36:29.243254 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.243788 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.244255 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.244765 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.270687 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m09:36:29.272185 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m09:36:29.274745 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m09:36:29.277047 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m09:36:29.288086 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m09:36:29.292806 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m09:36:29.297792 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m09:36:29.303111 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m09:36:29.313789 [debug] [Thread-4  ]: dbt-sqlserver
[0m09:36:29.315182 [debug] [Thread-3  ]: dbt-sqlserver
[0m09:36:29.318018 [debug] [Thread-2  ]: dbt-sqlserver
[0m09:36:29.319932 [debug] [Thread-1  ]: dbt-sqlserver
[0m09:36:29.321045 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:36:29.322137 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:36:29.323124 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:36:29.324216 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:36:29.325094 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:36:29.325944 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:36:29.326834 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:36:29.327661 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:36:29.354347 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.355016 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.355616 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.356196 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.358695 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:36:29.360987 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:36:29.362860 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:36:29.364893 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:36:29.365500 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m09:36:29.366317 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m09:36:29.367182 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m09:36:29.368245 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m09:36:29.373637 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.374327 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.374806 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.375271 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:36:29.378921 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m09:36:29.381005 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m09:36:29.382889 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m09:36:29.385918 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m09:36:29.386816 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m09:36:29.387649 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m09:36:29.388620 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m09:36:29.389500 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m09:36:29.392069 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b2d26a60>]}
[0m09:36:29.393242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b2d26ee0>]}
[0m09:36:29.394364 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b2d26e50>]}
[0m09:36:29.395406 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebf950c8-8378-46de-b083-a47536c86154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b2d26f70>]}
[0m09:36:29.396585 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.70s]
[0m09:36:29.398107 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.71s]
[0m09:36:29.399745 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.70s]
[0m09:36:29.401257 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.70s]
[0m09:36:29.402954 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m09:36:29.404263 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m09:36:29.405444 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m09:36:29.406587 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m09:36:29.410910 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.411950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:29.412667 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m09:36:29.413403 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m09:36:29.414067 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m09:36:29.414853 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m09:36:29.415920 [info ] [MainThread]: 
[0m09:36:29.417613 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m09:36:29.421270 [debug] [MainThread]: Command end result
[0m09:36:29.527686 [info ] [MainThread]: 
[0m09:36:29.531044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:36:29.535071 [info ] [MainThread]: 
[0m09:36:29.540098 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:36:29.552867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5225906, "process_user_time": 3.562731, "process_kernel_time": 0.445341, "process_mem_max_rss": "125596", "process_in_blocks": "99816", "process_out_blocks": "216"}
[0m09:36:29.556082 [debug] [MainThread]: Command `dbt run` succeeded at 09:36:29.555796 after 3.53 seconds
[0m09:36:29.557726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b744ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b03dcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b5ff0b50>]}
[0m09:36:29.559783 [debug] [MainThread]: Flushing usage events
[0m09:36:36.066108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa63a8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa4246670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa4246610>]}


============================== 09:36:36.071986 | ed862fb3-b8c9-4726-872e-4f8846af4e5e ==============================
[0m09:36:36.071986 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:36:36.073501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:36:36.620392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed862fb3-b8c9-4726-872e-4f8846af4e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa42d7580>]}
[0m09:36:36.747506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed862fb3-b8c9-4726-872e-4f8846af4e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa3009af0>]}
[0m09:36:36.749042 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m09:36:36.965171 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:36:38.388958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:38.389994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:38.401086 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m09:36:38.494175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed862fb3-b8c9-4726-872e-4f8846af4e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa2b1f130>]}
[0m09:36:38.851194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed862fb3-b8c9-4726-872e-4f8846af4e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa2cc5910>]}
[0m09:36:38.854659 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m09:36:38.857894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed862fb3-b8c9-4726-872e-4f8846af4e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa2c3c580>]}
[0m09:36:38.863029 [info ] [MainThread]: 
[0m09:36:38.866533 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:36:38.877944 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m09:36:38.910267 [debug] [ThreadPool]: dbt-sqlserver
[0m09:36:38.911638 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m09:36:38.912708 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m09:36:38.913732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:38.914717 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:38.938704 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:38.945255 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:38.948115 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m09:36:38.949262 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m09:36:38.952441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed862fb3-b8c9-4726-872e-4f8846af4e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa4342ac0>]}
[0m09:36:38.953726 [debug] [MainThread]: On master: COMMIT
[0m09:36:38.955361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:36:38.956916 [info ] [MainThread]: 
[0m09:36:38.970805 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:36:38.971591 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:36:38.972266 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:36:38.973551 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m09:36:38.974946 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m09:36:38.976174 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m09:36:38.977607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m09:36:38.979112 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m09:36:38.980679 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m09:36:38.981906 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:36:38.983052 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:36:38.983942 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:36:39.026520 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m09:36:39.030579 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m09:36:39.038534 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m09:36:39.044707 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:36:39.045527 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:36:39.052078 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:36:39.114656 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m09:36:39.132767 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m09:36:39.133469 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m09:36:39.134000 [debug] [Thread-1  ]: local_md5(invocation_id): 6bf49300ca242daed02fcb56573c9249
[0m09:36:39.135123 [debug] [Thread-3  ]: local_md5(invocation_id): 6bf49300ca242daed02fcb56573c9249
[0m09:36:39.136135 [debug] [Thread-2  ]: local_md5(invocation_id): 6bf49300ca242daed02fcb56573c9249
[0m09:36:39.137570 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m09:36:39.139274 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m09:36:39.141279 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m09:36:39.148546 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m09:36:39.149554 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m09:36:39.150880 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_57a5b34078e0f6ab31d0f0c9798e5c46]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_57a5b34078e0f6ab31d0f0c9798e5c46]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_57a5b34078e0f6ab31d0f0c9798e5c46]
  ;')
[0m09:36:39.151679 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m09:36:39.152939 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_131858f1d8dcc8b01c84601a2cd0ec8e]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_131858f1d8dcc8b01c84601a2cd0ec8e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_131858f1d8dcc8b01c84601a2cd0ec8e]
  ;')
[0m09:36:39.154612 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:36:39.156245 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_2c72dabba5ab0a9bc18b57027655bdf3]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_2c72dabba5ab0a9bc18b57027655bdf3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_2c72dabba5ab0a9bc18b57027655bdf3]
  ;')
[0m09:36:39.158122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:36:39.160179 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:39.161759 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:36:39.163473 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:39.166154 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:36:39.184842 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:39.185665 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:39.187286 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:36:39.203366 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:36:39.215360 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m09:36:39.216822 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m09:36:39.219361 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.24s]
[0m09:36:39.223497 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:36:39.286275 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:36:39.290086 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m09:36:39.291777 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m09:36:39.294106 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.31s]
[0m09:36:39.296318 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:36:39.367695 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:36:39.370750 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m09:36:39.372071 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m09:36:39.373965 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.40s]
[0m09:36:39.375600 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:36:39.378677 [debug] [MainThread]: On master: COMMIT
[0m09:36:39.379831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:39.380658 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m09:36:39.381563 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m09:36:39.382383 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m09:36:39.383390 [info ] [MainThread]: 
[0m09:36:39.384693 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m09:36:39.387032 [debug] [MainThread]: Command end result
[0m09:36:39.482289 [info ] [MainThread]: 
[0m09:36:39.484002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:36:39.485393 [info ] [MainThread]: 
[0m09:36:39.487514 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:36:39.490853 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.5282671, "process_user_time": 4.110421, "process_kernel_time": 0.374595, "process_mem_max_rss": "125724", "process_in_blocks": "1568", "process_out_blocks": "216"}
[0m09:36:39.493793 [debug] [MainThread]: Command `dbt test` succeeded at 09:36:39.493527 after 3.53 seconds
[0m09:36:39.495118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa63a8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa2dd8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa4308550>]}
[0m09:36:39.496452 [debug] [MainThread]: Flushing usage events
[0m09:37:35.494330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a4cbdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a2b5b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a2b5b490>]}


============================== 09:37:35.498947 | db8702fd-921d-41ac-85c9-afc5618b0b6b ==============================
[0m09:37:35.498947 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:37:35.500515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:37:35.896999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a1a95b50>]}
[0m09:37:36.091956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a2c18970>]}
[0m09:37:36.097559 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m09:37:36.453952 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:37:37.541237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:37.544510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:37.557903 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m09:37:37.624159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a1434130>]}
[0m09:37:37.902428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a1908e80>]}
[0m09:37:37.903819 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m09:37:37.904991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a16b2e80>]}
[0m09:37:37.907998 [info ] [MainThread]: 
[0m09:37:37.909817 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:37:37.926674 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m09:37:37.952953 [debug] [ThreadPool]: dbt-sqlserver
[0m09:37:37.954397 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m09:37:37.955538 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m09:37:37.956680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:37.957652 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:38.024496 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:38.029016 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:37:38.031293 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m09:37:38.033868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m09:37:38.043919 [debug] [ThreadPool]: dbt-sqlserver
[0m09:37:38.045216 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m09:37:38.046338 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m09:37:38.047280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:38.048152 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:38.062564 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:38.114458 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:37:38.117216 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m09:37:38.118012 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m09:37:38.120435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a2c477f0>]}
[0m09:37:38.121320 [debug] [MainThread]: On master: COMMIT
[0m09:37:38.122216 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:38.123220 [info ] [MainThread]: 
[0m09:37:38.134025 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m09:37:38.134561 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m09:37:38.135030 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m09:37:38.135505 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m09:37:38.136352 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m09:37:38.137471 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m09:37:38.138892 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m09:37:38.140291 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m09:37:38.141829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m09:37:38.143609 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m09:37:38.146344 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m09:37:38.147530 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m09:37:38.148462 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m09:37:38.149217 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m09:37:38.150064 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m09:37:38.150883 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m09:37:38.166089 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m09:37:38.171115 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m09:37:38.178888 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m09:37:38.184986 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:37:38.191251 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m09:37:38.192123 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m09:37:38.192942 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m09:37:38.199240 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m09:37:38.265839 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m09:37:38.264217 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m09:37:38.273217 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m09:37:38.284466 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:37:38.297575 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:37:38.298478 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:37:38.299248 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:37:38.300282 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:37:38.302151 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m09:37:38.304129 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m09:37:38.306034 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m09:37:38.307863 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m09:37:38.309308 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:37:38.311509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:37:38.314336 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:37:38.316296 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:37:38.318622 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:38.320851 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:38.324331 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:38.330831 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:38.362506 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:38.364145 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:38.364792 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:38.365607 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:38.378319 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.382826 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.384246 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.386876 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.406379 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:37:38.417472 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:37:38.423863 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:37:38.435048 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:37:38.436809 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m09:37:38.438986 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m09:37:38.441264 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m09:37:38.444003 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m09:37:38.675392 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.676205 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.676916 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.677397 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.683644 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:37:38.690682 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:37:38.701695 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:37:38.718860 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:37:38.720034 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m09:37:38.722378 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m09:37:38.723932 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m09:37:38.725226 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m09:37:38.729580 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.730293 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.731087 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.731701 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.762967 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m09:37:38.764109 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m09:37:38.766779 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m09:37:38.770095 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m09:37:38.781151 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m09:37:38.787460 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m09:37:38.791994 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m09:37:38.797076 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m09:37:38.809889 [debug] [Thread-2  ]: dbt-sqlserver
[0m09:37:38.811336 [debug] [Thread-3  ]: dbt-sqlserver
[0m09:37:38.813170 [debug] [Thread-1  ]: dbt-sqlserver
[0m09:37:38.814660 [debug] [Thread-4  ]: dbt-sqlserver
[0m09:37:38.815690 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:37:38.816840 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:37:38.817890 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:37:38.818803 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:37:38.819927 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:37:38.821475 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:37:38.822494 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:37:38.823602 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m09:37:38.849465 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.850042 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.850636 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.851145 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.854032 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m09:37:38.857410 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m09:37:38.859963 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m09:37:38.862222 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m09:37:38.863131 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m09:37:38.863977 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m09:37:38.864860 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m09:37:38.865680 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m09:37:38.870030 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.870929 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.871682 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.872266 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:37:38.877377 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m09:37:38.879863 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m09:37:38.882665 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m09:37:38.885509 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m09:37:38.887546 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m09:37:38.889482 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m09:37:38.891573 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m09:37:38.893189 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m09:37:38.897857 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a0594910>]}
[0m09:37:38.900010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a0594d90>]}
[0m09:37:38.902520 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a0594e20>]}
[0m09:37:38.905158 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db8702fd-921d-41ac-85c9-afc5618b0b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a0594d00>]}
[0m09:37:38.907610 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.75s]
[0m09:37:38.909868 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.76s]
[0m09:37:38.911766 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.75s]
[0m09:37:38.913613 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.76s]
[0m09:37:38.915539 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m09:37:38.917122 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m09:37:38.918641 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m09:37:38.920789 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m09:37:38.926513 [debug] [MainThread]: On master: COMMIT
[0m09:37:38.928089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:38.929007 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m09:37:38.929910 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m09:37:38.931388 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m09:37:38.932445 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m09:37:38.934017 [info ] [MainThread]: 
[0m09:37:38.939599 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m09:37:38.942863 [debug] [MainThread]: Command end result
[0m09:37:39.033587 [info ] [MainThread]: 
[0m09:37:39.035064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:37:39.037398 [info ] [MainThread]: 
[0m09:37:39.038578 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:37:39.040300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.630932, "process_user_time": 3.963123, "process_kernel_time": 0.530417, "process_mem_max_rss": "125508", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m09:37:39.041441 [debug] [MainThread]: Command `dbt run` succeeded at 09:37:39.041285 after 3.63 seconds
[0m09:37:39.042493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a4cbdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a32809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a1a95b50>]}
[0m09:37:39.043525 [debug] [MainThread]: Flushing usage events
[0m09:37:46.350368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134cbca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134e2d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134e2d640>]}


============================== 09:37:46.355095 | 62199a03-024e-4232-bd6e-2a11e8a2088a ==============================
[0m09:37:46.355095 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:37:46.356925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:46.891712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62199a03-024e-4232-bd6e-2a11e8a2088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9132b7c250>]}
[0m09:37:46.984895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62199a03-024e-4232-bd6e-2a11e8a2088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131883610>]}
[0m09:37:46.986608 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m09:37:47.146753 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:37:48.862737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:48.863854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:48.882952 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m09:37:48.956256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62199a03-024e-4232-bd6e-2a11e8a2088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131398130>]}
[0m09:37:49.292544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62199a03-024e-4232-bd6e-2a11e8a2088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913178e100>]}
[0m09:37:49.294029 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m09:37:49.295923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62199a03-024e-4232-bd6e-2a11e8a2088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91315127f0>]}
[0m09:37:49.299446 [info ] [MainThread]: 
[0m09:37:49.301785 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:37:49.311472 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m09:37:49.341075 [debug] [ThreadPool]: dbt-sqlserver
[0m09:37:49.343008 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m09:37:49.344281 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m09:37:49.345523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:49.346664 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:49.451812 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:49.458229 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:37:49.466069 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m09:37:49.468334 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m09:37:49.473708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62199a03-024e-4232-bd6e-2a11e8a2088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91318dbaf0>]}
[0m09:37:49.474982 [debug] [MainThread]: On master: COMMIT
[0m09:37:49.476059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:49.477119 [info ] [MainThread]: 
[0m09:37:49.489189 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:37:49.489699 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:37:49.490155 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:37:49.490947 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m09:37:49.492066 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m09:37:49.493571 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m09:37:49.494916 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m09:37:49.496392 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m09:37:49.497827 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m09:37:49.498827 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:37:49.499595 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:37:49.500363 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:37:49.541242 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m09:37:49.542710 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m09:37:49.549125 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m09:37:49.562503 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:37:49.563495 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:37:49.564453 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:37:49.629629 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m09:37:49.630338 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m09:37:49.633626 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m09:37:49.634902 [debug] [Thread-1  ]: local_md5(invocation_id): 031bcf1e999946ce8c85783f40b09b10
[0m09:37:49.636257 [debug] [Thread-3  ]: local_md5(invocation_id): 031bcf1e999946ce8c85783f40b09b10
[0m09:37:49.638035 [debug] [Thread-2  ]: local_md5(invocation_id): 031bcf1e999946ce8c85783f40b09b10
[0m09:37:49.639691 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m09:37:49.641678 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m09:37:49.644104 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m09:37:49.659393 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m09:37:49.660297 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m09:37:49.662068 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_f166fe2af02457e6723404a238af2e40]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_f166fe2af02457e6723404a238af2e40]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_f166fe2af02457e6723404a238af2e40]
  ;')
[0m09:37:49.663402 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m09:37:49.664169 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_39a489350bc95985000ecb0d8f9c02da]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_39a489350bc95985000ecb0d8f9c02da]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_39a489350bc95985000ecb0d8f9c02da]
  ;')
[0m09:37:49.665314 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:37:49.666592 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_e8a28c0f9589d867136c7964b203f950]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_e8a28c0f9589d867136c7964b203f950]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_e8a28c0f9589d867136c7964b203f950]
  ;')
[0m09:37:49.667793 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:37:49.669407 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:49.671246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:37:49.672430 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:49.675192 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m09:37:49.691430 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:49.696682 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:49.698015 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m09:37:49.710381 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m09:37:49.717685 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m09:37:49.719293 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m09:37:49.721455 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.22s]
[0m09:37:49.723687 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m09:37:49.779310 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m09:37:49.787551 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m09:37:49.789788 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m09:37:49.792026 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.30s]
[0m09:37:49.794602 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m09:37:49.871771 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m09:37:49.875485 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m09:37:49.879124 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m09:37:49.881764 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.39s]
[0m09:37:49.883771 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m09:37:49.887420 [debug] [MainThread]: On master: COMMIT
[0m09:37:49.888935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:49.889800 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m09:37:49.890565 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m09:37:49.891294 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m09:37:49.892057 [info ] [MainThread]: 
[0m09:37:49.892965 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m09:37:49.894942 [debug] [MainThread]: Command end result
[0m09:37:49.987884 [info ] [MainThread]: 
[0m09:37:49.989378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:37:49.991236 [info ] [MainThread]: 
[0m09:37:49.992653 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:37:49.994801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.701419, "process_user_time": 4.640896, "process_kernel_time": 0.478337, "process_mem_max_rss": "125584", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m09:37:49.995972 [debug] [MainThread]: Command `dbt test` succeeded at 09:37:49.995818 after 3.70 seconds
[0m09:37:49.996919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134cbca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913379e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913187a940>]}
[0m09:37:49.997879 [debug] [MainThread]: Flushing usage events
[0m05:49:48.103274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7a16f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c6cc2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c59af370>]}


============================== 05:49:48.107612 | 6f56dbd7-7602-41b7-a5fa-4d86b7fe1462 ==============================
[0m05:49:48.107612 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:49:48.108915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:49:48.523176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c477a490>]}
[0m05:49:48.588584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c59a04f0>]}
[0m05:49:48.590111 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m05:49:48.715112 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:49:49.908185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:49:49.908911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:49:49.917471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m05:49:49.974735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c418d130>]}
[0m05:49:50.193533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c4309070>]}
[0m05:49:50.194512 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m05:49:50.195610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c4309610>]}
[0m05:49:50.198618 [info ] [MainThread]: 
[0m05:49:50.200060 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m05:49:50.207885 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m05:49:50.227806 [debug] [ThreadPool]: dbt-sqlserver
[0m05:49:50.229237 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m05:49:50.230670 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m05:49:50.232041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:49:50.233197 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:50.306894 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:50.312289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:49:50.314330 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m05:49:50.316588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m05:49:50.324917 [debug] [ThreadPool]: dbt-sqlserver
[0m05:49:50.326080 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m05:49:50.326926 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m05:49:50.327640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:49:50.328361 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:50.340662 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:50.392624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:49:50.396329 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m05:49:50.398208 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m05:49:50.402051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c47035b0>]}
[0m05:49:50.403283 [debug] [MainThread]: On master: COMMIT
[0m05:49:50.404796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:49:50.406238 [info ] [MainThread]: 
[0m05:49:50.416045 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m05:49:50.416784 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m05:49:50.417390 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m05:49:50.417861 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m05:49:50.418646 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m05:49:50.419775 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m05:49:50.420940 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m05:49:50.422123 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m05:49:50.423641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m05:49:50.424736 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m05:49:50.425726 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m05:49:50.426853 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m05:49:50.427678 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m05:49:50.428444 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m05:49:50.429529 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m05:49:50.430751 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m05:49:50.443319 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m05:49:50.448610 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m05:49:50.453454 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m05:49:50.458415 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m05:49:50.465082 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m05:49:50.465827 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m05:49:50.472372 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m05:49:50.472896 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m05:49:50.530543 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m05:49:50.531228 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m05:49:50.537040 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m05:49:50.543536 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m05:49:50.549760 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m05:49:50.550444 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m05:49:50.551495 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m05:49:50.552060 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m05:49:50.552532 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m05:49:50.553246 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m05:49:50.554427 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:49:50.555414 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m05:49:50.556817 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m05:49:50.558413 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:49:50.559644 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:50.560798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:49:50.561952 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:49:50.562937 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:50.564704 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:50.565765 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:50.579616 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:50.581326 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:50.581735 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:50.582173 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:50.595168 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.595683 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.596135 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.605454 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m05:49:50.605949 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.611301 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m05:49:50.616040 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m05:49:50.617243 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m05:49:50.622930 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m05:49:50.623985 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m05:49:50.625175 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m05:49:50.626869 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m05:49:50.827897 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.828995 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.829766 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.830228 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.835256 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m05:49:50.841219 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m05:49:50.846862 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m05:49:50.853562 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m05:49:50.854678 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m05:49:50.855765 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m05:49:50.857021 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m05:49:50.858135 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m05:49:50.861790 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.862331 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.862845 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.863268 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.887045 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m05:49:50.888288 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m05:49:50.890162 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m05:49:50.893100 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m05:49:50.902434 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m05:49:50.907109 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m05:49:50.912639 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m05:49:50.917935 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m05:49:50.929907 [debug] [Thread-4  ]: dbt-sqlserver
[0m05:49:50.931310 [debug] [Thread-3  ]: dbt-sqlserver
[0m05:49:50.933127 [debug] [Thread-1  ]: dbt-sqlserver
[0m05:49:50.934863 [debug] [Thread-2  ]: dbt-sqlserver
[0m05:49:50.936238 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m05:49:50.937606 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m05:49:50.938662 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m05:49:50.939937 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m05:49:50.941240 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m05:49:50.942403 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m05:49:50.943384 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m05:49:50.944328 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m05:49:50.969901 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.970522 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.974253 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m05:49:50.977597 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m05:49:50.978498 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m05:49:50.979689 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m05:49:50.981426 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.982019 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.985831 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m05:49:50.986420 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.987144 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m05:49:50.989313 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m05:49:50.990291 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m05:49:50.993954 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m05:49:50.996306 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m05:49:50.997189 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m05:49:50.998545 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m05:49:51.000115 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m05:49:51.001156 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m05:49:51.005022 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c32d2b50>]}
[0m05:49:51.005549 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m05:49:51.006724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c32d2fd0>]}
[0m05:49:51.009025 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m05:49:51.010208 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.58s]
[0m05:49:51.013078 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m05:49:51.014348 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.58s]
[0m05:49:51.015500 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m05:49:51.017018 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m05:49:51.018120 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m05:49:51.019483 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m05:49:51.020858 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c32d2760>]}
[0m05:49:51.022951 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f56dbd7-7602-41b7-a5fa-4d86b7fe1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c026bb80>]}
[0m05:49:51.024821 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.60s]
[0m05:49:51.026720 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.60s]
[0m05:49:51.028152 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m05:49:51.029377 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m05:49:51.032821 [debug] [MainThread]: On master: COMMIT
[0m05:49:51.033824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:49:51.034561 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m05:49:51.035399 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m05:49:51.036239 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m05:49:51.036852 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m05:49:51.037773 [info ] [MainThread]: 
[0m05:49:51.038616 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m05:49:51.040716 [debug] [MainThread]: Command end result
[0m05:49:51.113145 [info ] [MainThread]: 
[0m05:49:51.114541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:49:51.116113 [info ] [MainThread]: 
[0m05:49:51.117414 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:49:51.119839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0964732, "process_user_time": 2.700471, "process_kernel_time": 0.356665, "process_mem_max_rss": "124024", "process_in_blocks": "98752", "process_out_blocks": "216"}
[0m05:49:51.120848 [debug] [MainThread]: Command `dbt run` succeeded at 05:49:51.120710 after 3.10 seconds
[0m05:49:51.121650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7a16f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c4309070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c59a04f0>]}
[0m05:49:51.122412 [debug] [MainThread]: Flushing usage events
[0m05:49:56.779652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515c236a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515a0395b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515a039550>]}


============================== 05:49:56.783206 | e6d25816-5a42-4132-ad10-05b618ee20da ==============================
[0m05:49:56.783206 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:49:56.784513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m05:49:57.113845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d25816-5a42-4132-ad10-05b618ee20da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515b42a340>]}
[0m05:49:57.180545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d25816-5a42-4132-ad10-05b618ee20da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5158dfdeb0>]}
[0m05:49:57.182148 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m05:49:57.302781 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:49:58.184056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:49:58.184797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:49:58.194654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m05:49:58.255523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d25816-5a42-4132-ad10-05b618ee20da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5158912130>]}
[0m05:49:58.494048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d25816-5a42-4132-ad10-05b618ee20da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5158d28640>]}
[0m05:49:58.495243 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m05:49:58.497129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d25816-5a42-4132-ad10-05b618ee20da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515acc2460>]}
[0m05:49:58.500755 [info ] [MainThread]: 
[0m05:49:58.502552 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m05:49:58.510609 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m05:49:58.532831 [debug] [ThreadPool]: dbt-sqlserver
[0m05:49:58.534092 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m05:49:58.535243 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m05:49:58.536231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:49:58.537155 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:58.558467 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:58.564360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:49:58.566708 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m05:49:58.567496 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m05:49:58.569889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d25816-5a42-4132-ad10-05b618ee20da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515a0ca910>]}
[0m05:49:58.570777 [debug] [MainThread]: On master: COMMIT
[0m05:49:58.571663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:49:58.572760 [info ] [MainThread]: 
[0m05:49:58.583071 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m05:49:58.583538 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m05:49:58.583958 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m05:49:58.584717 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m05:49:58.585989 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m05:49:58.587465 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m05:49:58.589115 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m05:49:58.590297 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m05:49:58.591777 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m05:49:58.592646 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m05:49:58.593441 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m05:49:58.594280 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m05:49:58.628132 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m05:49:58.629162 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m05:49:58.634781 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m05:49:58.641738 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m05:49:58.642493 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m05:49:58.653773 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m05:49:58.680484 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m05:49:58.683440 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m05:49:58.687970 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m05:49:58.689574 [debug] [Thread-2  ]: local_md5(invocation_id): c789cfcb02d791d672b9565d325922ec
[0m05:49:58.690952 [debug] [Thread-3  ]: local_md5(invocation_id): c789cfcb02d791d672b9565d325922ec
[0m05:49:58.692188 [debug] [Thread-1  ]: local_md5(invocation_id): c789cfcb02d791d672b9565d325922ec
[0m05:49:58.693842 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m05:49:58.694981 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m05:49:58.696099 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m05:49:58.700729 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m05:49:58.701537 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m05:49:58.702294 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_83931deed747007c1ce1b67f024b755c]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_83931deed747007c1ce1b67f024b755c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_83931deed747007c1ce1b67f024b755c]
  ;')
[0m05:49:58.703174 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m05:49:58.704102 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_4894cd2ff9923b4a9f170fa1bdbbe303]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_4894cd2ff9923b4a9f170fa1bdbbe303]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_4894cd2ff9923b4a9f170fa1bdbbe303]
  ;')
[0m05:49:58.705008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:49:58.706269 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_faa5a94a21da19b6dd7005ec60c72d4a]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_faa5a94a21da19b6dd7005ec60c72d4a]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_faa5a94a21da19b6dd7005ec60c72d4a]
  ;')
[0m05:49:58.707361 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:49:58.708377 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:58.709485 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:49:58.710474 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:58.711856 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m05:49:58.725027 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:58.725525 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:58.725941 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m05:49:58.758230 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m05:49:58.764143 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m05:49:58.765065 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m05:49:58.766557 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.17s]
[0m05:49:58.768503 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m05:49:58.799345 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m05:49:58.802239 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m05:49:58.803221 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m05:49:58.804414 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.21s]
[0m05:49:58.805859 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m05:49:58.858089 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m05:49:58.860511 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m05:49:58.861406 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m05:49:58.863104 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.27s]
[0m05:49:58.865137 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m05:49:58.867555 [debug] [MainThread]: On master: COMMIT
[0m05:49:58.868492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:49:58.869161 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m05:49:58.869840 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m05:49:58.870571 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m05:49:58.871332 [info ] [MainThread]: 
[0m05:49:58.872489 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m05:49:58.874525 [debug] [MainThread]: Command end result
[0m05:49:58.948918 [info ] [MainThread]: 
[0m05:49:58.950261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:49:58.951701 [info ] [MainThread]: 
[0m05:49:58.953068 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:49:58.954841 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2549822, "process_user_time": 2.579026, "process_kernel_time": 0.278235, "process_mem_max_rss": "123672", "process_in_blocks": "1568", "process_out_blocks": "216"}
[0m05:49:58.955863 [debug] [MainThread]: Command `dbt test` succeeded at 05:49:58.955724 after 2.26 seconds
[0m05:49:58.957000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515c236a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5158a933a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5158d55fa0>]}
[0m05:49:58.958145 [debug] [MainThread]: Flushing usage events
[0m13:29:23.005413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e9b764a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e9b8d55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e9b8d5640>]}


============================== 13:29:23.014612 | b3f55ba6-f8bb-42d2-abd9-3db6531abd3c ==============================
[0m13:29:23.014612 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:29:23.016120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:23.518529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e99624250>]}
[0m13:29:23.599209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e98329610>]}
[0m13:29:23.600963 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m13:29:23.765381 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:29:25.754769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:25.756129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:25.766642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m13:29:25.834475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e97e40130>]}
[0m13:29:26.103687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e97ff50d0>]}
[0m13:29:26.105132 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m13:29:26.106436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e97fb61c0>]}
[0m13:29:26.109393 [info ] [MainThread]: 
[0m13:29:26.111407 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:29:26.120042 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m13:29:26.145409 [debug] [ThreadPool]: dbt-sqlserver
[0m13:29:26.146994 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m13:29:26.148094 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:29:26.149115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:26.150231 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:26.246016 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:26.267702 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:26.271477 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m13:29:26.276252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m13:29:26.286645 [debug] [ThreadPool]: dbt-sqlserver
[0m13:29:26.287987 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m13:29:26.288992 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:29:26.291392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:26.292849 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:26.309354 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:26.369710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:26.373315 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m13:29:26.374586 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m13:29:26.377260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e97ff5130>]}
[0m13:29:26.378716 [debug] [MainThread]: On master: COMMIT
[0m13:29:26.380098 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:26.381475 [info ] [MainThread]: 
[0m13:29:26.392167 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m13:29:26.392676 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m13:29:26.393190 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m13:29:26.393656 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m13:29:26.394485 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m13:29:26.395927 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m13:29:26.397706 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m13:29:26.399572 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m13:29:26.401177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m13:29:26.402852 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m13:29:26.404452 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m13:29:26.405945 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m13:29:26.407109 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m13:29:26.408255 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m13:29:26.409471 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m13:29:26.410788 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m13:29:26.425734 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m13:29:26.431399 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m13:29:26.437187 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m13:29:26.443538 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:29:26.449785 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m13:29:26.451293 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m13:29:26.452124 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m13:29:26.458366 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m13:29:26.530627 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m13:29:26.532170 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m13:29:26.538897 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m13:29:26.544878 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:29:26.552081 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:29:26.553021 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:29:26.554483 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:29:26.555302 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m13:29:26.556029 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:29:26.557032 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m13:29:26.559519 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m13:29:26.561500 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:29:26.563446 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m13:29:26.567113 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:29:26.568757 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:26.570291 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:26.571644 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:29:26.572926 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:26.574365 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:26.576373 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:26.593063 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:26.594571 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:26.595519 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:26.597009 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:26.613875 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.614499 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.615085 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.615586 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.625598 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:29:26.631995 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:29:26.638189 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:29:26.643782 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:29:26.644810 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m13:29:26.645928 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m13:29:26.646957 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m13:29:26.648042 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m13:29:26.923427 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.924094 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.924661 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.925190 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.930978 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:29:26.936265 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:29:26.941969 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:29:26.948039 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:29:26.949198 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m13:29:26.950454 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m13:29:26.951636 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m13:29:26.952737 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m13:29:26.956823 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.957367 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.958062 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.959881 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:29:26.984859 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m13:29:26.986194 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m13:29:26.988711 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m13:29:26.991670 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m13:29:27.001623 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m13:29:27.006774 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m13:29:27.012060 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m13:29:27.017511 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m13:29:27.028896 [debug] [Thread-2  ]: dbt-sqlserver
[0m13:29:27.030745 [debug] [Thread-1  ]: dbt-sqlserver
[0m13:29:27.032874 [debug] [Thread-3  ]: dbt-sqlserver
[0m13:29:27.034883 [debug] [Thread-4  ]: dbt-sqlserver
[0m13:29:27.036244 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:29:27.037451 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:29:27.038676 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:29:27.039910 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:29:27.041231 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:29:27.042373 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:29:27.043747 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:29:27.044996 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:29:27.071454 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.071997 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.072564 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.072973 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.075528 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:29:27.078048 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:29:27.080332 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:29:27.082775 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:29:27.083444 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m13:29:27.084557 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m13:29:27.085575 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m13:29:27.086580 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m13:29:27.095108 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.095737 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.096485 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.097217 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:29:27.102531 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m13:29:27.105285 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m13:29:27.124125 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m13:29:27.157817 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m13:29:27.159305 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m13:29:27.164736 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m13:29:27.170898 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m13:29:27.172771 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m13:29:27.177415 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e96fe1cd0>]}
[0m13:29:27.180281 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e96fe1a60>]}
[0m13:29:27.182728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e96fe18e0>]}
[0m13:29:27.186223 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f55ba6-f8bb-42d2-abd9-3db6531abd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e96fe1040>]}
[0m13:29:27.188099 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.77s]
[0m13:29:27.192172 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.78s]
[0m13:29:27.195803 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.78s]
[0m13:29:27.203451 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.78s]
[0m13:29:27.207162 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m13:29:27.211691 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m13:29:27.221200 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m13:29:27.224613 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m13:29:27.239446 [debug] [MainThread]: On master: COMMIT
[0m13:29:27.249504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:27.251032 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m13:29:27.253164 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m13:29:27.255766 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m13:29:27.257117 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m13:29:27.261362 [info ] [MainThread]: 
[0m13:29:27.265324 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m13:29:27.269178 [debug] [MainThread]: Command end result
[0m13:29:27.449397 [info ] [MainThread]: 
[0m13:29:27.453043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:27.456826 [info ] [MainThread]: 
[0m13:29:27.464188 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:29:27.470425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.625935, "process_user_time": 3.959765, "process_kernel_time": 0.496349, "process_mem_max_rss": "125296", "process_in_blocks": "106304", "process_out_blocks": "216"}
[0m13:29:27.477360 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:27.477010 after 4.63 seconds
[0m13:29:27.482437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e9b764a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e99c8bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e9a1f0460>]}
[0m13:29:27.484317 [debug] [MainThread]: Flushing usage events
[0m13:29:33.692231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead0709fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feace5a74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feace5a7490>]}


============================== 13:29:33.696195 | a83ff453-0367-4654-b8a7-d821bf58f255 ==============================
[0m13:29:33.696195 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:29:33.697718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:29:34.094049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a83ff453-0367-4654-b8a7-d821bf58f255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacd4e1b50>]}
[0m13:29:34.179409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a83ff453-0367-4654-b8a7-d821bf58f255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feace664970>]}
[0m13:29:34.181023 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m13:29:34.332943 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:29:35.643757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:35.644930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:35.656969 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m13:29:35.736735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a83ff453-0367-4654-b8a7-d821bf58f255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacce80130>]}
[0m13:29:35.991597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a83ff453-0367-4654-b8a7-d821bf58f255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacd0febe0>]}
[0m13:29:35.993013 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m13:29:35.994380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a83ff453-0367-4654-b8a7-d821bf58f255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaccff3fa0>]}
[0m13:29:35.997573 [info ] [MainThread]: 
[0m13:29:35.999532 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:29:36.009265 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m13:29:36.035719 [debug] [ThreadPool]: dbt-sqlserver
[0m13:29:36.037442 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m13:29:36.038712 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:29:36.039867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:36.041047 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:36.064553 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:36.070420 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:36.072848 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m13:29:36.073849 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m13:29:36.077055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a83ff453-0367-4654-b8a7-d821bf58f255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaccea4190>]}
[0m13:29:36.078396 [debug] [MainThread]: On master: COMMIT
[0m13:29:36.079540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:36.080961 [info ] [MainThread]: 
[0m13:29:36.092959 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m13:29:36.093674 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m13:29:36.094167 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m13:29:36.095190 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m13:29:36.096597 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m13:29:36.098218 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m13:29:36.099675 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m13:29:36.101092 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m13:29:36.102672 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m13:29:36.103942 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m13:29:36.105228 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m13:29:36.106497 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m13:29:36.138644 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m13:29:36.145703 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m13:29:36.151851 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m13:29:36.158746 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m13:29:36.159529 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m13:29:36.165989 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m13:29:36.196049 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m13:29:36.202100 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m13:29:36.206239 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m13:29:36.207689 [debug] [Thread-1  ]: local_md5(invocation_id): bf87a2d339d3f6488bd27afd2d583fbf
[0m13:29:36.209075 [debug] [Thread-3  ]: local_md5(invocation_id): bf87a2d339d3f6488bd27afd2d583fbf
[0m13:29:36.210066 [debug] [Thread-2  ]: local_md5(invocation_id): bf87a2d339d3f6488bd27afd2d583fbf
[0m13:29:36.211634 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m13:29:36.213104 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m13:29:36.214527 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m13:29:36.220531 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m13:29:36.221516 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m13:29:36.222299 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_011209b7ebebe932bd0d1e4ca395d3a8]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_011209b7ebebe932bd0d1e4ca395d3a8]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_011209b7ebebe932bd0d1e4ca395d3a8]
  ;')
[0m13:29:36.223407 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m13:29:36.223926 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_cd0fbe5f984d0cea5a86306dfe93b098]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_cd0fbe5f984d0cea5a86306dfe93b098]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_cd0fbe5f984d0cea5a86306dfe93b098]
  ;')
[0m13:29:36.225136 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:29:36.226250 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_62516ffea23c1062e6ed08f4d73d8a71]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_62516ffea23c1062e6ed08f4d73d8a71]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_62516ffea23c1062e6ed08f4d73d8a71]
  ;')
[0m13:29:36.227305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:36.228468 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:36.229584 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:29:36.230842 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:36.233209 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:29:36.245883 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:36.246655 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:36.247144 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:29:36.264291 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:29:36.270962 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m13:29:36.272387 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m13:29:36.274312 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.17s]
[0m13:29:36.276532 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m13:29:36.332392 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:29:36.335054 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m13:29:36.336249 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m13:29:36.337762 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.24s]
[0m13:29:36.339597 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m13:29:36.391877 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:29:36.394606 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m13:29:36.395763 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m13:29:36.397131 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.30s]
[0m13:29:36.398702 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m13:29:36.401245 [debug] [MainThread]: On master: COMMIT
[0m13:29:36.402715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:36.403696 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m13:29:36.404536 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m13:29:36.405421 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m13:29:36.406376 [info ] [MainThread]: 
[0m13:29:36.407348 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m13:29:36.409235 [debug] [MainThread]: Command end result
[0m13:29:36.485589 [info ] [MainThread]: 
[0m13:29:36.488386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:36.489818 [info ] [MainThread]: 
[0m13:29:36.491175 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:29:36.493172 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9010031, "process_user_time": 3.529555, "process_kernel_time": 0.406833, "process_mem_max_rss": "124952", "process_in_blocks": "1568", "process_out_blocks": "216"}
[0m13:29:36.494675 [debug] [MainThread]: Command `dbt test` succeeded at 13:29:36.494485 after 2.90 seconds
[0m13:29:36.495787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead0709fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacecd1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacd0fec70>]}
[0m13:29:36.496870 [debug] [MainThread]: Flushing usage events
[0m13:29:51.885595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a859a1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8389e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8399f130>]}


============================== 13:29:51.891464 | c0a7af0a-faaa-4153-a441-10ffbb58093f ==============================
[0m13:29:51.891464 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:29:51.893749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:52.060769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0a7af0a-faaa-4153-a441-10ffbb58093f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a856e2df0>]}
[0m13:29:52.465148 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yzd2t71e'
[0m13:29:52.466308 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:29:52.604033 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:29:52.605811 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:29:52.685591 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:29:52.692842 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:29:57.516023 [info ] [MainThread]: Installed from version 1.1.1
[0m13:29:57.517784 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:29:57.519383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0a7af0a-faaa-4153-a441-10ffbb58093f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8372c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a84beab50>]}
[0m13:29:57.520954 [info ] [MainThread]: 
[0m13:29:57.522585 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:29:57.525577 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.730376, "process_user_time": 2.008944, "process_kernel_time": 0.432031, "process_mem_max_rss": "91480", "process_in_blocks": "344", "process_out_blocks": "200"}
[0m13:29:57.527224 [debug] [MainThread]: Command `dbt deps` succeeded at 13:29:57.526923 after 5.73 seconds
[0m13:29:57.528662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a859a1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8372c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a836a2eb0>]}
[0m13:29:57.529968 [debug] [MainThread]: Flushing usage events
[0m13:30:04.973904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2620dc1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261ecbe8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261edbf130>]}


============================== 13:30:04.980372 | c1e4dc76-c4d2-4ef6-832b-cca716253585 ==============================
[0m13:30:04.980372 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:30:04.982169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:30:05.002839 [info ] [MainThread]: dbt version: 1.8.7
[0m13:30:05.004923 [info ] [MainThread]: python version: 3.9.22
[0m13:30:05.006621 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m13:30:05.008172 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m13:30:05.256181 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m13:30:05.257708 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m13:30:05.259328 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m13:30:05.260893 [info ] [MainThread]: adapter type: sqlserver
[0m13:30:05.262514 [info ] [MainThread]: adapter version: 1.8.7
[0m13:30:05.435140 [info ] [MainThread]: Configuration:
[0m13:30:05.436587 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:30:05.437932 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:30:05.439248 [info ] [MainThread]: Required dependencies:
[0m13:30:05.440626 [debug] [MainThread]: Executing "git --help"
[0m13:30:05.462627 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:30:05.464854 [debug] [MainThread]: STDERR: "b''"
[0m13:30:05.466459 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:30:05.468042 [info ] [MainThread]: Connection:
[0m13:30:05.469686 [info ] [MainThread]:   server: host.docker.internal
[0m13:30:05.471849 [info ] [MainThread]:   database: AdventureWorks2014
[0m13:30:05.473664 [info ] [MainThread]:   schema: dbo
[0m13:30:05.476242 [info ] [MainThread]:   UID: imrandbtnew
[0m13:30:05.479264 [info ] [MainThread]:   client_id: None
[0m13:30:05.481188 [info ] [MainThread]:   authentication: sql
[0m13:30:05.492013 [info ] [MainThread]:   encrypt: False
[0m13:30:05.494190 [info ] [MainThread]:   trust_cert: True
[0m13:30:05.520706 [info ] [MainThread]:   retries: 3
[0m13:30:05.528408 [info ] [MainThread]:   login_timeout: 0
[0m13:30:05.536723 [info ] [MainThread]:   query_timeout: 0
[0m13:30:05.539480 [info ] [MainThread]:   trace_flag: False
[0m13:30:05.543437 [info ] [MainThread]:   port: 1433
[0m13:30:05.545634 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m13:30:05.674664 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:30:05.676170 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:30:05.677223 [debug] [MainThread]: On debug: select 1 as id
[0m13:30:05.678324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:05.679429 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:30:05.738034 [debug] [MainThread]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:30:05.740703 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:30:05.742841 [debug] [MainThread]: On debug: Close
[0m13:30:05.744299 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:30:05.745868 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:30:05.747768 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.87660146, "process_user_time": 2.322276, "process_kernel_time": 0.187993, "process_mem_max_rss": "111816", "process_in_blocks": "224", "process_out_blocks": "0"}
[0m13:30:05.749071 [debug] [MainThread]: Command `dbt debug` succeeded at 13:30:05.748906 after 0.88 seconds
[0m13:30:05.750242 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:30:05.751715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2620dc1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261f2e8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261f2f22b0>]}
[0m13:30:05.753059 [debug] [MainThread]: Flushing usage events
[0m13:32:24.645036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5519ddaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54f7df550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54f7df4f0>]}


============================== 13:32:24.649204 | 14c025eb-61de-4522-bef9-15794175aff2 ==============================
[0m13:32:24.649204 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:32:24.650738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:24.660108 [info ] [MainThread]: dbt version: 1.8.7
[0m13:32:24.661735 [info ] [MainThread]: python version: 3.9.22
[0m13:32:24.663590 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m13:32:24.664658 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m13:32:24.891153 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m13:32:24.893047 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m13:32:24.894536 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m13:32:24.895722 [info ] [MainThread]: adapter type: sqlserver
[0m13:32:24.896851 [info ] [MainThread]: adapter version: 1.8.7
[0m13:32:25.030954 [info ] [MainThread]: Configuration:
[0m13:32:25.032307 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:32:25.033417 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:32:25.034419 [info ] [MainThread]: Required dependencies:
[0m13:32:25.035575 [debug] [MainThread]: Executing "git --help"
[0m13:32:25.040236 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:32:25.041566 [debug] [MainThread]: STDERR: "b''"
[0m13:32:25.042813 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:32:25.044271 [info ] [MainThread]: Connection:
[0m13:32:25.046007 [info ] [MainThread]:   server: host.docker.internal
[0m13:32:25.048657 [info ] [MainThread]:   database: AdventureWorks2014
[0m13:32:25.049932 [info ] [MainThread]:   schema: dbo
[0m13:32:25.051160 [info ] [MainThread]:   UID: imrandbtnew
[0m13:32:25.052234 [info ] [MainThread]:   client_id: None
[0m13:32:25.053623 [info ] [MainThread]:   authentication: sql
[0m13:32:25.054761 [info ] [MainThread]:   encrypt: False
[0m13:32:25.055873 [info ] [MainThread]:   trust_cert: True
[0m13:32:25.057136 [info ] [MainThread]:   retries: 3
[0m13:32:25.058566 [info ] [MainThread]:   login_timeout: 0
[0m13:32:25.059936 [info ] [MainThread]:   query_timeout: 0
[0m13:32:25.061432 [info ] [MainThread]:   trace_flag: False
[0m13:32:25.063037 [info ] [MainThread]:   port: 1433
[0m13:32:25.066083 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m13:32:25.154440 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:32:25.156052 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:32:25.157298 [debug] [MainThread]: On debug: select 1 as id
[0m13:32:25.158378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:25.159559 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:32:25.198855 [debug] [MainThread]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:32:25.201228 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:32:25.203171 [debug] [MainThread]: On debug: Close
[0m13:32:25.204487 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:32:25.205952 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:32:25.208022 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6428179, "process_user_time": 1.844925, "process_kernel_time": 0.204991, "process_mem_max_rss": "111796", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:25.209387 [debug] [MainThread]: Command `dbt debug` succeeded at 13:32:25.209184 after 0.64 seconds
[0m13:32:25.210547 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:32:25.211872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5519ddaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54f81ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54e5c0cd0>]}
[0m13:32:25.213389 [debug] [MainThread]: Flushing usage events
[0m13:32:32.196839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa097e2fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa095c32760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa095c32700>]}


============================== 13:32:32.200785 | 6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51 ==============================
[0m13:32:32.200785 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:32:32.202062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:32.505069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa097b80640>]}
[0m13:32:32.573104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0949f6580>]}
[0m13:32:32.574760 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m13:32:32.691897 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:32:33.751801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:33.752957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:33.762737 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m13:32:33.825251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa094509130>]}
[0m13:32:34.050104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0944f8640>]}
[0m13:32:34.051351 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m13:32:34.052605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0946801c0>]}
[0m13:32:34.055825 [info ] [MainThread]: 
[0m13:32:34.057975 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:32:34.067564 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m13:32:34.094368 [debug] [ThreadPool]: dbt-sqlserver
[0m13:32:34.095734 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m13:32:34.096908 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:32:34.097983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:34.098986 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:32:34.122725 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:32:34.128139 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:32:34.130816 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m13:32:34.134219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m13:32:34.142908 [debug] [ThreadPool]: dbt-sqlserver
[0m13:32:34.144119 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m13:32:34.145212 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:32:34.146299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:34.147542 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:32:34.161110 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:32:34.213631 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:32:34.216220 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m13:32:34.217390 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m13:32:34.220344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0969474f0>]}
[0m13:32:34.221667 [debug] [MainThread]: On master: COMMIT
[0m13:32:34.222870 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:34.224154 [info ] [MainThread]: 
[0m13:32:34.228624 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m13:32:34.229350 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m13:32:34.229772 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m13:32:34.230253 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m13:32:34.231103 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m13:32:34.232306 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m13:32:34.233803 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m13:32:34.235412 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m13:32:34.237672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m13:32:34.239861 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m13:32:34.241317 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m13:32:34.242802 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m13:32:34.244025 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m13:32:34.245100 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m13:32:34.246033 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m13:32:34.247093 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m13:32:34.261200 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m13:32:34.267896 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m13:32:34.275588 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m13:32:34.281092 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:32:34.288569 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m13:32:34.289403 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m13:32:34.296330 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m13:32:34.296884 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m13:32:34.364112 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m13:32:34.365137 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m13:32:34.370559 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:32:34.377780 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m13:32:34.383818 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:32:34.384574 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:32:34.385676 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:32:34.386314 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m13:32:34.386831 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:32:34.387733 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m13:32:34.388969 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m13:32:34.390335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:32:34.391740 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m13:32:34.393243 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:32:34.394394 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:32:34.395454 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:32:34.396410 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:32:34.397341 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:32:34.398370 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:32:34.400507 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m13:32:34.415672 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:32:34.419243 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:32:34.421194 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:32:34.421778 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m13:32:34.427370 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.427884 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.435068 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.435630 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.438912 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:32:34.444584 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:32:34.450131 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:32:34.456400 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:32:34.457866 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m13:32:34.459650 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m13:32:34.461440 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m13:32:34.463336 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m13:32:34.699426 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.700099 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.700522 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.701019 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.705837 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:32:34.711233 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:32:34.716530 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:32:34.722367 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:32:34.723402 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m13:32:34.724717 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m13:32:34.725915 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m13:32:34.727240 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m13:32:34.730734 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.731521 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.732153 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.739378 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.762042 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m13:32:34.761415 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m13:32:34.764616 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m13:32:34.766922 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m13:32:34.776266 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m13:32:34.780745 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m13:32:34.785091 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m13:32:34.791143 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m13:32:34.799904 [debug] [Thread-2  ]: dbt-sqlserver
[0m13:32:34.801495 [debug] [Thread-1  ]: dbt-sqlserver
[0m13:32:34.803481 [debug] [Thread-3  ]: dbt-sqlserver
[0m13:32:34.805540 [debug] [Thread-4  ]: dbt-sqlserver
[0m13:32:34.806793 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:32:34.808088 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:32:34.809187 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:32:34.810339 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:32:34.811370 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:32:34.812353 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:32:34.813327 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:32:34.814304 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:32:34.838808 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.839432 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.840056 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.840514 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.842963 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m13:32:34.845358 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m13:32:34.847771 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m13:32:34.850354 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m13:32:34.851166 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m13:32:34.852348 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m13:32:34.853353 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m13:32:34.854322 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m13:32:34.858396 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.858987 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.859847 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.860358 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:32:34.863500 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m13:32:34.865954 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m13:32:34.867909 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m13:32:34.869802 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m13:32:34.870633 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m13:32:34.871466 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m13:32:34.872305 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m13:32:34.873439 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m13:32:34.876264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa097b6c340>]}
[0m13:32:34.877719 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0969474f0>]}
[0m13:32:34.879157 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa097a3f3a0>]}
[0m13:32:34.880731 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff6aaf2-a5f2-4691-84bb-2dcf68c41d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa093c8eeb0>]}
[0m13:32:34.882054 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.64s]
[0m13:32:34.883591 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.64s]
[0m13:32:34.885026 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.64s]
[0m13:32:34.886449 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.64s]
[0m13:32:34.887831 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m13:32:34.889395 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m13:32:34.891312 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m13:32:34.893232 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m13:32:34.899046 [debug] [MainThread]: On master: COMMIT
[0m13:32:34.900188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:34.901032 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m13:32:34.901834 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m13:32:34.902634 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m13:32:34.903512 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m13:32:34.904533 [info ] [MainThread]: 
[0m13:32:34.905612 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m13:32:34.907763 [debug] [MainThread]: Command end result
[0m13:32:34.984528 [info ] [MainThread]: 
[0m13:32:34.985952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:34.987477 [info ] [MainThread]: 
[0m13:32:34.989236 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:32:34.991722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8727033, "process_user_time": 2.883028, "process_kernel_time": 0.245591, "process_mem_max_rss": "124064", "process_in_blocks": "80", "process_out_blocks": "0"}
[0m13:32:34.993238 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:34.993045 after 2.87 seconds
[0m13:32:34.994465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa097e2fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0904be850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa094680400>]}
[0m13:32:34.995552 [debug] [MainThread]: Flushing usage events
[0m14:02:00.373671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3951000af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f394ee025e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f394ee02580>]}


============================== 14:02:00.385880 | dac202ab-a802-464b-9ddd-3579bd7e7983 ==============================
[0m14:02:00.385880 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:02:00.389853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:02:00.410493 [info ] [MainThread]: dbt version: 1.8.7
[0m14:02:00.418764 [info ] [MainThread]: python version: 3.9.22
[0m14:02:00.420981 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m14:02:00.422933 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m14:02:00.846375 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m14:02:00.849024 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m14:02:00.851430 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m14:02:00.853551 [info ] [MainThread]: adapter type: sqlserver
[0m14:02:00.855517 [info ] [MainThread]: adapter version: 1.8.7
[0m14:02:01.078963 [info ] [MainThread]: Configuration:
[0m14:02:01.080658 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:02:01.082213 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:02:01.083714 [info ] [MainThread]: Required dependencies:
[0m14:02:01.085601 [debug] [MainThread]: Executing "git --help"
[0m14:02:01.094611 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:02:01.096644 [debug] [MainThread]: STDERR: "b''"
[0m14:02:01.098442 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:02:01.101366 [info ] [MainThread]: Connection:
[0m14:02:01.107352 [info ] [MainThread]:   server: host.docker.internal
[0m14:02:01.110428 [info ] [MainThread]:   database: AdventureWorks2014
[0m14:02:01.114994 [info ] [MainThread]:   schema: dbo
[0m14:02:01.120836 [info ] [MainThread]:   UID: imrandbtnew
[0m14:02:01.126913 [info ] [MainThread]:   client_id: None
[0m14:02:01.129493 [info ] [MainThread]:   authentication: sql
[0m14:02:01.135463 [info ] [MainThread]:   encrypt: False
[0m14:02:01.139481 [info ] [MainThread]:   trust_cert: True
[0m14:02:01.142598 [info ] [MainThread]:   retries: 3
[0m14:02:01.145314 [info ] [MainThread]:   login_timeout: 0
[0m14:02:01.148349 [info ] [MainThread]:   query_timeout: 0
[0m14:02:01.151742 [info ] [MainThread]:   trace_flag: False
[0m14:02:01.154753 [info ] [MainThread]:   port: 1433
[0m14:02:01.157306 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:02:01.318584 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m14:02:01.320560 [debug] [MainThread]: Using sqlserver connection "debug"
[0m14:02:01.321567 [debug] [MainThread]: On debug: select 1 as id
[0m14:02:01.322698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:01.323721 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:01.399940 [debug] [MainThread]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:01.403531 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:02:01.406518 [debug] [MainThread]: On debug: Close
[0m14:02:01.407948 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:02:01.409430 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:02:01.411906 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1997916, "process_user_time": 3.304831, "process_kernel_time": 0.543411, "process_mem_max_rss": "111568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:02:01.414102 [debug] [MainThread]: Command `dbt debug` succeeded at 14:02:01.413823 after 1.20 seconds
[0m14:02:01.415684 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:02:01.417752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3951000af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f394ee4ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f394ee41310>]}
[0m14:02:01.420094 [debug] [MainThread]: Flushing usage events
[0m14:02:27.792721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c364cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c159b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c159b070>]}


============================== 14:02:27.797891 | 9c87884b-e553-48f5-a1a6-8ffa73548517 ==============================
[0m14:02:27.797891 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:02:27.799790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:02:28.374803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c1510220>]}
[0m14:02:28.522999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c024a940>]}
[0m14:02:28.525886 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:02:28.729888 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:02:30.577238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:30.579003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:30.600575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m14:02:30.712900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bfdc1130>]}
[0m14:02:31.243808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c037fd30>]}
[0m14:02:31.246502 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m14:02:31.248545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c01bc760>]}
[0m14:02:31.252333 [info ] [MainThread]: 
[0m14:02:31.254580 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:02:31.266405 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m14:02:31.294436 [debug] [ThreadPool]: dbt-sqlserver
[0m14:02:31.296241 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m14:02:31.297473 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:02:31.298394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:31.299401 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:31.328451 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:31.336658 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:02:31.340340 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m14:02:31.345267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m14:02:31.364288 [debug] [ThreadPool]: dbt-sqlserver
[0m14:02:31.367890 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m14:02:31.371189 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:02:31.377859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:31.385241 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:31.426374 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:31.536625 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:02:31.540959 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m14:02:31.544066 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m14:02:31.550643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c21c57c0>]}
[0m14:02:31.552588 [debug] [MainThread]: On master: COMMIT
[0m14:02:31.554092 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:31.556649 [info ] [MainThread]: 
[0m14:02:31.583574 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m14:02:31.584466 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m14:02:31.585447 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m14:02:31.586494 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:02:31.587956 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m14:02:31.590429 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m14:02:31.593625 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m14:02:31.597285 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m14:02:31.600104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m14:02:31.603044 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m14:02:31.606497 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m14:02:31.608196 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m14:02:31.609581 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m14:02:31.610859 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m14:02:31.612054 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m14:02:31.613674 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m14:02:31.647987 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m14:02:31.650210 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m14:02:31.659568 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m14:02:31.670326 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:02:31.687507 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m14:02:31.688697 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m14:02:31.690888 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m14:02:31.697193 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m14:02:32.160748 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m14:02:32.164713 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:02:32.167689 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m14:02:32.169366 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m14:02:32.189898 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:02:32.196368 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m14:02:32.198386 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:02:32.200680 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:02:32.201867 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:02:32.202553 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:02:32.204569 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m14:02:32.207094 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m14:02:32.210176 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:32.212744 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m14:02:32.217012 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:02:32.222776 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:02:32.234318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:02:32.237627 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:32.241611 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:32.244197 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:32.278037 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:32.282909 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:32.287031 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:32.287780 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:32.297306 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.299898 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.322393 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.327497 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:02:32.328115 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.341087 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:02:32.353693 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:02:32.355420 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m14:02:32.366164 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:02:32.368044 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m14:02:32.371821 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m14:02:32.382093 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m14:02:32.755128 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.764896 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:02:32.766159 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.766725 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.767214 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.768305 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m14:02:32.777121 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:02:32.785383 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:02:32.793530 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:02:32.795963 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m14:02:32.798718 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m14:02:32.799555 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.800825 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m14:02:32.806027 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.822933 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.838009 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m14:02:32.838782 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.842041 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m14:02:32.845165 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m14:02:32.859128 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m14:02:32.862157 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m14:02:32.868070 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m14:02:32.876424 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m14:02:32.889574 [debug] [Thread-1  ]: dbt-sqlserver
[0m14:02:32.894777 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m14:02:32.897598 [debug] [Thread-2  ]: dbt-sqlserver
[0m14:02:32.900681 [debug] [Thread-3  ]: dbt-sqlserver
[0m14:02:32.902738 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:02:32.904872 [debug] [Thread-4  ]: dbt-sqlserver
[0m14:02:32.908059 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:02:32.911100 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:02:32.913653 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:02:32.915814 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:02:32.917578 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:02:32.918992 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:02:32.921592 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:02:32.948673 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.949396 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.950222 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.950835 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.955225 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:02:32.959887 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:02:32.963103 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:02:32.966992 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:02:32.968986 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m14:02:32.971085 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m14:02:32.975868 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m14:02:32.978275 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m14:02:32.987744 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.989136 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.990962 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:02:32.998354 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m14:02:32.999174 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:02:33.003067 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m14:02:33.006814 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m14:02:33.009048 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m14:02:33.012727 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m14:02:33.014460 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m14:02:33.017393 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m14:02:33.022545 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bef1bf10>]}
[0m14:02:33.024127 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m14:02:33.025622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bef1be80>]}
[0m14:02:33.027680 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bef1ba00>]}
[0m14:02:33.029698 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 1.41s]
[0m14:02:33.033014 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87884b-e553-48f5-a1a6-8ffa73548517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bef1bdf0>]}
[0m14:02:33.034737 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 1.43s]
[0m14:02:33.036913 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 1.43s]
[0m14:02:33.039239 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:02:33.041822 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 1.43s]
[0m14:02:33.045333 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m14:02:33.048838 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m14:02:33.053709 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m14:02:33.064352 [debug] [MainThread]: On master: COMMIT
[0m14:02:33.066021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:33.067300 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m14:02:33.068764 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m14:02:33.070021 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m14:02:33.072315 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m14:02:33.074403 [info ] [MainThread]: 
[0m14:02:33.076511 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m14:02:33.083086 [debug] [MainThread]: Command end result
[0m14:02:33.395272 [info ] [MainThread]: 
[0m14:02:33.397469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:33.399941 [info ] [MainThread]: 
[0m14:02:33.402286 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:02:33.406043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7498574, "process_user_time": 6.04375, "process_kernel_time": 0.683583, "process_mem_max_rss": "125192", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m14:02:33.407972 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:33.407677 after 5.75 seconds
[0m14:02:33.409921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c364cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c1c142b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c028dc10>]}
[0m14:02:33.412347 [debug] [MainThread]: Flushing usage events
[0m14:02:43.532181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb337e04fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb335ca2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb335ca2610>]}


============================== 14:02:43.538114 | d6722bdc-5323-40bd-8099-d31351c92715 ==============================
[0m14:02:43.538114 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:02:43.540793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:44.486971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6722bdc-5323-40bd-8099-d31351c92715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb335d33580>]}
[0m14:02:44.665899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6722bdc-5323-40bd-8099-d31351c92715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334a66af0>]}
[0m14:02:44.668844 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:02:44.954286 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:02:47.359977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:47.361361 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:47.373067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m14:02:47.458413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6722bdc-5323-40bd-8099-d31351c92715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33457b130>]}
[0m14:02:47.847449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6722bdc-5323-40bd-8099-d31351c92715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334721910>]}
[0m14:02:47.849078 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m14:02:47.850897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6722bdc-5323-40bd-8099-d31351c92715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334698580>]}
[0m14:02:47.855173 [info ] [MainThread]: 
[0m14:02:47.857574 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:02:47.869351 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m14:02:47.910267 [debug] [ThreadPool]: dbt-sqlserver
[0m14:02:47.911972 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m14:02:47.913000 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:02:47.914123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:47.915288 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:47.947140 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:47.957508 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:02:47.960342 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m14:02:47.961458 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m14:02:47.964388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6722bdc-5323-40bd-8099-d31351c92715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb335d9eac0>]}
[0m14:02:47.965675 [debug] [MainThread]: On master: COMMIT
[0m14:02:47.967141 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:47.968590 [info ] [MainThread]: 
[0m14:02:47.987606 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:02:47.988253 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:02:47.988887 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:02:47.990006 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m14:02:47.991657 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m14:02:47.993038 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m14:02:47.994367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m14:02:47.995786 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m14:02:47.997552 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m14:02:47.998986 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:02:48.000895 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:02:48.002759 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:02:48.064766 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:02:48.068018 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:02:48.073151 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:02:48.081289 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:02:48.081983 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:02:48.088628 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:02:48.192154 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m14:02:48.205808 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m14:02:48.206957 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m14:02:48.207800 [debug] [Thread-1  ]: local_md5(invocation_id): 170f8c9366832cb5c3056ebe4021da99
[0m14:02:48.209416 [debug] [Thread-3  ]: local_md5(invocation_id): 170f8c9366832cb5c3056ebe4021da99
[0m14:02:48.210844 [debug] [Thread-2  ]: local_md5(invocation_id): 170f8c9366832cb5c3056ebe4021da99
[0m14:02:48.212720 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:02:48.214346 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:02:48.215934 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:02:48.223372 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:02:48.224405 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:02:48.225479 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:02:48.226627 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_ae5c4d0b20e140f672912f2dc928d5f0]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_ae5c4d0b20e140f672912f2dc928d5f0]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_ae5c4d0b20e140f672912f2dc928d5f0]
  ;')
[0m14:02:48.228329 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_d0d651304a7a2dd753b7806aa46db4bd]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_d0d651304a7a2dd753b7806aa46db4bd]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_d0d651304a7a2dd753b7806aa46db4bd]
  ;')
[0m14:02:48.230456 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b6739490d7e3e8b273eb86c88f4fc4bc]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b6739490d7e3e8b273eb86c88f4fc4bc]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b6739490d7e3e8b273eb86c88f4fc4bc]
  ;')
[0m14:02:48.232725 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:02:48.234190 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:02:48.235726 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:02:48.239034 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:48.243117 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:48.245691 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:02:48.268002 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:48.269790 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:48.270804 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:02:48.286023 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:02:48.294665 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m14:02:48.297107 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m14:02:48.301007 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.30s]
[0m14:02:48.303997 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:02:48.360922 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:02:48.367623 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m14:02:48.369381 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m14:02:48.371221 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.38s]
[0m14:02:48.373487 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:02:48.454747 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:02:48.460021 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m14:02:48.463107 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m14:02:48.465922 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.47s]
[0m14:02:48.473615 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:02:48.480886 [debug] [MainThread]: On master: COMMIT
[0m14:02:48.483186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:48.486755 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m14:02:48.488655 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m14:02:48.490327 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m14:02:48.492258 [info ] [MainThread]: 
[0m14:02:48.494554 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m14:02:48.498451 [debug] [MainThread]: Command end result
[0m14:02:48.629741 [info ] [MainThread]: 
[0m14:02:48.632669 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:48.635355 [info ] [MainThread]: 
[0m14:02:48.637487 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:02:48.643052 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.3032355, "process_user_time": 7.277307, "process_kernel_time": 0.743261, "process_mem_max_rss": "124580", "process_in_blocks": "216", "process_out_blocks": "216"}
[0m14:02:48.644967 [debug] [MainThread]: Command `dbt test` succeeded at 14:02:48.644648 after 5.31 seconds
[0m14:02:48.647335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb337e04fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3363cc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb337b4c340>]}
[0m14:02:48.649761 [debug] [MainThread]: Flushing usage events
[0m23:17:42.436813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af51d6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af305f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af305f340>]}


============================== 23:17:42.443284 | 295300b5-c0f6-40eb-8a4f-c26974fc2adb ==============================
[0m23:17:42.443284 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:17:42.446191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:17:42.618183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '295300b5-c0f6-40eb-8a4f-c26974fc2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af309e4c0>]}
[0m23:17:43.724437 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xtau91us'
[0m23:17:43.726731 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:17:44.696878 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:17:44.700398 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:17:44.870975 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:17:44.883400 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:17:54.455937 [info ] [MainThread]: Installed from version 1.1.1
[0m23:17:54.458947 [info ] [MainThread]: Updated version available: 1.3.1
[0m23:17:54.460496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '295300b5-c0f6-40eb-8a4f-c26974fc2adb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af301b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af2fda0d0>]}
[0m23:17:54.461734 [info ] [MainThread]: 
[0m23:17:54.462887 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:17:54.466001 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 12.131376, "process_user_time": 1.831702, "process_kernel_time": 1.711523, "process_mem_max_rss": "93084", "process_in_blocks": "3000", "process_out_blocks": "200"}
[0m23:17:54.467523 [debug] [MainThread]: Command `dbt deps` succeeded at 23:17:54.467338 after 12.13 seconds
[0m23:17:54.468575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af51d6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af43d4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736af2f54970>]}
[0m23:17:54.470730 [debug] [MainThread]: Flushing usage events
[0m23:18:34.083217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c1026746d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c1004fe3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c1004fe370>]}


============================== 23:18:34.087163 | 3e4626b3-c493-4e01-8b0d-99a0462ad46a ==============================
[0m23:18:34.087163 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:18:34.088627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:34.098521 [info ] [MainThread]: dbt version: 1.8.7
[0m23:18:34.099665 [info ] [MainThread]: python version: 3.9.25
[0m23:18:34.100831 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m23:18:34.102721 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m23:18:34.602718 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m23:18:34.604275 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m23:18:34.605564 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m23:18:34.606870 [info ] [MainThread]: adapter type: sqlserver
[0m23:18:34.607977 [info ] [MainThread]: adapter version: 1.8.7
[0m23:18:34.705675 [info ] [MainThread]: Configuration:
[0m23:18:34.707611 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:18:34.709485 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:18:34.710712 [info ] [MainThread]: Required dependencies:
[0m23:18:34.711760 [debug] [MainThread]: Executing "git --help"
[0m23:18:34.734318 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:18:34.736255 [debug] [MainThread]: STDERR: "b''"
[0m23:18:34.738891 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:18:34.740656 [info ] [MainThread]: Connection:
[0m23:18:34.742021 [info ] [MainThread]:   server: host.docker.internal
[0m23:18:34.743210 [info ] [MainThread]:   database: AdventureWorks2014
[0m23:18:34.744378 [info ] [MainThread]:   schema: dbo
[0m23:18:34.745569 [info ] [MainThread]:   UID: imrandbtnew
[0m23:18:34.746859 [info ] [MainThread]:   client_id: None
[0m23:18:34.748300 [info ] [MainThread]:   authentication: sql
[0m23:18:34.749395 [info ] [MainThread]:   encrypt: False
[0m23:18:34.750477 [info ] [MainThread]:   trust_cert: True
[0m23:18:34.751678 [info ] [MainThread]:   retries: 3
[0m23:18:34.753603 [info ] [MainThread]:   login_timeout: 0
[0m23:18:34.755786 [info ] [MainThread]:   query_timeout: 0
[0m23:18:34.758042 [info ] [MainThread]:   trace_flag: False
[0m23:18:34.759355 [info ] [MainThread]:   port: 1433
[0m23:18:34.761415 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:18:34.851485 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m23:18:34.853474 [debug] [MainThread]: Using sqlserver connection "debug"
[0m23:18:34.855080 [debug] [MainThread]: On debug: select 1 as id
[0m23:18:34.856913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:34.858587 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:18:34.931815 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m23:18:34.933005 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m23:18:34.933906 [debug] [MainThread]: On debug: No close available on handle
[0m23:18:34.934807 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m23:18:34.935897 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:18:34.937015 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('28000', "[28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'imrandbtnew'. (18456) (SQLDriverConnect)")

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m23:18:34.938646 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.939534, "process_user_time": 1.261946, "process_kernel_time": 0.349647, "process_mem_max_rss": "112396", "process_in_blocks": "29304", "process_out_blocks": "184", "command_success": false}
[0m23:18:34.939618 [debug] [MainThread]: Command `dbt debug` failed at 23:18:34.939506 after 0.94 seconds
[0m23:18:34.940475 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:18:34.941329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c1026746d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c1018d42b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c0ff0abe20>]}
[0m23:18:34.942259 [debug] [MainThread]: Flushing usage events
[0m23:23:51.459813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e17140a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e16f2955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e16f295550>]}


============================== 23:23:51.465117 | de593ca3-11e7-4b2e-b042-e495e3656879 ==============================
[0m23:23:51.465117 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:23:51.467693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m23:23:51.477787 [info ] [MainThread]: dbt version: 1.8.7
[0m23:23:51.479416 [info ] [MainThread]: python version: 3.9.25
[0m23:23:51.480911 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m23:23:51.482093 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m23:23:51.650753 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m23:23:51.652648 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m23:23:51.654224 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m23:23:51.655438 [info ] [MainThread]: adapter type: sqlserver
[0m23:23:51.656458 [info ] [MainThread]: adapter version: 1.8.7
[0m23:23:51.757211 [info ] [MainThread]: Configuration:
[0m23:23:51.758700 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:23:51.760353 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:23:51.761465 [info ] [MainThread]: Required dependencies:
[0m23:23:51.763399 [debug] [MainThread]: Executing "git --help"
[0m23:23:51.768942 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:23:51.770684 [debug] [MainThread]: STDERR: "b''"
[0m23:23:51.772217 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:23:51.773259 [info ] [MainThread]: Connection:
[0m23:23:51.774918 [info ] [MainThread]:   server: host.docker.internal
[0m23:23:51.775944 [info ] [MainThread]:   database: AdventureWorks2014
[0m23:23:51.776996 [info ] [MainThread]:   schema: dbo
[0m23:23:51.778562 [info ] [MainThread]:   UID: imrandbtnew
[0m23:23:51.780012 [info ] [MainThread]:   client_id: None
[0m23:23:51.781385 [info ] [MainThread]:   authentication: sql
[0m23:23:51.782533 [info ] [MainThread]:   encrypt: False
[0m23:23:51.783541 [info ] [MainThread]:   trust_cert: True
[0m23:23:51.785505 [info ] [MainThread]:   retries: 3
[0m23:23:51.787239 [info ] [MainThread]:   login_timeout: 0
[0m23:23:51.788366 [info ] [MainThread]:   query_timeout: 0
[0m23:23:51.789955 [info ] [MainThread]:   trace_flag: False
[0m23:23:51.791385 [info ] [MainThread]:   port: 1433
[0m23:23:51.793439 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:23:51.865915 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m23:23:51.867617 [debug] [MainThread]: Using sqlserver connection "debug"
[0m23:23:51.868870 [debug] [MainThread]: On debug: select 1 as id
[0m23:23:51.869952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:51.871107 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:23:51.948508 [debug] [MainThread]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:23:51.952765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:23:51.954903 [debug] [MainThread]: On debug: Close
[0m23:23:51.956138 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:23:51.957398 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:23:51.959310 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6071001, "process_user_time": 1.415419, "process_kernel_time": 0.362825, "process_mem_max_rss": "112556", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:23:51.960631 [debug] [MainThread]: Command `dbt debug` succeeded at 23:23:51.960511 after 0.61 seconds
[0m23:23:51.962059 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:23:51.963183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e17140a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e16f2d3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e16ddce670>]}
[0m23:23:51.964774 [debug] [MainThread]: Flushing usage events
[0m23:30:35.518546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb3989ef6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb396878610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb3968785b0>]}


============================== 23:30:35.524163 | c98cfb4a-b34e-4331-b359-21bb4b4ea8e1 ==============================
[0m23:30:35.524163 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:30:35.526256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:30:35.832811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c98cfb4a-b34e-4331-b359-21bb4b4ea8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb3987cdd30>]}
[0m23:30:35.890481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c98cfb4a-b34e-4331-b359-21bb4b4ea8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb395638df0>]}
[0m23:30:35.892621 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:30:36.017398 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:30:37.148615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:37.149792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:37.157728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m23:30:37.215107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c98cfb4a-b34e-4331-b359-21bb4b4ea8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb394fddf10>]}
[0m23:30:37.495917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c98cfb4a-b34e-4331-b359-21bb4b4ea8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb394fddd00>]}
[0m23:30:37.499150 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m23:30:37.501236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98cfb4a-b34e-4331-b359-21bb4b4ea8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb3955feb20>]}
[0m23:30:37.504431 [info ] [MainThread]: 
[0m23:30:37.506214 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:30:37.515186 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:30:37.535166 [debug] [ThreadPool]: dbt-sqlserver
[0m23:30:37.537961 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:30:37.539290 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:30:37.540752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:37.543033 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:30:52.584379 [debug] [ThreadPool]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
[0m23:30:53.589646 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:31:08.598557 [debug] [ThreadPool]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
[0m23:31:09.601536 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:31:24.618293 [debug] [ThreadPool]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
[0m23:31:25.624388 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:31:40.634180 [debug] [ThreadPool]: fabric adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:31:40.638950 [debug] [ThreadPool]: fabric adapter: Rolling back transaction.
[0m23:31:40.641796 [debug] [ThreadPool]: On list_AdventureWorks2014: No close available on handle
[0m23:31:40.645270 [debug] [ThreadPool]: fabric adapter: Error running SQL: macro list_schemas
[0m23:31:40.647488 [debug] [ThreadPool]: fabric adapter: Rolling back transaction.
[0m23:31:40.651616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:40.654328 [debug] [MainThread]: Connection 'list_AdventureWorks2014' was properly closed.
[0m23:31:40.656673 [info ] [MainThread]: 
[0m23:31:40.658243 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 3.15 seconds (63.15s).
[0m23:31:40.660206 [error] [MainThread]: Encountered an error:
Database Error
  ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
[0m23:31:40.663899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 65.20932, "process_user_time": 1.980037, "process_kernel_time": 0.56401, "process_mem_max_rss": "115916", "process_in_blocks": "58088", "process_out_blocks": "16", "command_success": false}
[0m23:31:40.665592 [debug] [MainThread]: Command `dbt run` failed at 23:31:40.665415 after 65.21 seconds
[0m23:31:40.666669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb3989ef6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb39753c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb39475ed90>]}
[0m23:31:40.667699 [debug] [MainThread]: Flushing usage events
[0m23:43:58.307213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9e25046d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9e038d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9e038d610>]}


============================== 23:43:58.314665 | 7c1f195f-5f47-427f-8e00-19e2446b1024 ==============================
[0m23:43:58.314665 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:43:58.316313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:58.938748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1f195f-5f47-427f-8e00-19e2446b1024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9df113be0>]}
[0m23:43:58.988828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1f195f-5f47-427f-8e00-19e2446b1024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9e26db220>]}
[0m23:43:58.991329 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:43:59.143178 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:44:00.415015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:00.416110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:00.422711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m23:44:00.467580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1f195f-5f47-427f-8e00-19e2446b1024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9deaf2f70>]}
[0m23:44:00.681726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1f195f-5f47-427f-8e00-19e2446b1024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9deb37730>]}
[0m23:44:00.683149 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m23:44:00.684291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1f195f-5f47-427f-8e00-19e2446b1024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9def5e310>]}
[0m23:44:00.686619 [info ] [MainThread]: 
[0m23:44:00.688172 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:44:00.694216 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:44:00.716322 [debug] [ThreadPool]: dbt-sqlserver
[0m23:44:00.717889 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:44:00.719083 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:44:00.720144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:00.721065 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:44:01.036874 [debug] [ThreadPool]: fabric adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:44:01.038280 [debug] [ThreadPool]: fabric adapter: Rolling back transaction.
[0m23:44:01.039738 [debug] [ThreadPool]: On list_AdventureWorks2014: No close available on handle
[0m23:44:01.041396 [debug] [ThreadPool]: fabric adapter: Error running SQL: macro list_schemas
[0m23:44:01.042808 [debug] [ThreadPool]: fabric adapter: Rolling back transaction.
[0m23:44:01.044997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:01.046477 [debug] [MainThread]: Connection 'list_AdventureWorks2014' was properly closed.
[0m23:44:01.047928 [info ] [MainThread]: 
[0m23:44:01.049091 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m23:44:01.050608 [error] [MainThread]: Encountered an error:
Database Error
  ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Cannot open database "AdventureWorks2014" requested by the login. The login failed. (4060) (SQLDriverConnect)')
[0m23:44:01.052797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8312654, "process_user_time": 2.160344, "process_kernel_time": 1.761325, "process_mem_max_rss": "117796", "process_in_blocks": "44200", "command_success": false, "process_out_blocks": "0"}
[0m23:44:01.054007 [debug] [MainThread]: Command `dbt run` failed at 23:44:01.053904 after 2.83 seconds
[0m23:44:01.054895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9e25046d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9e04fba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9defd4e20>]}
[0m23:44:01.055923 [debug] [MainThread]: Flushing usage events
[0m23:51:09.100307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2b8140670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2b7338610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2b5fca2b0>]}


============================== 23:51:09.109497 | da1d8437-100c-472e-97b2-252cbe1b1707 ==============================
[0m23:51:09.109497 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:51:09.112431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m23:51:09.150717 [info ] [MainThread]: dbt version: 1.8.7
[0m23:51:09.152493 [info ] [MainThread]: python version: 3.9.25
[0m23:51:09.155080 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m23:51:09.158055 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m23:51:09.519720 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m23:51:09.521512 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m23:51:09.522769 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m23:51:09.524213 [info ] [MainThread]: adapter type: sqlserver
[0m23:51:09.525439 [info ] [MainThread]: adapter version: 1.8.7
[0m23:51:09.646954 [info ] [MainThread]: Configuration:
[0m23:51:09.648685 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:51:09.650450 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:51:09.651458 [info ] [MainThread]: Required dependencies:
[0m23:51:09.652609 [debug] [MainThread]: Executing "git --help"
[0m23:51:09.691066 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:51:09.693864 [debug] [MainThread]: STDERR: "b''"
[0m23:51:09.696221 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:51:09.698710 [info ] [MainThread]: Connection:
[0m23:51:09.700447 [info ] [MainThread]:   server: host.docker.internal
[0m23:51:09.702450 [info ] [MainThread]:   database: AdventureWorks2014
[0m23:51:09.704406 [info ] [MainThread]:   schema: dbo
[0m23:51:09.705799 [info ] [MainThread]:   UID: imrandbtnew
[0m23:51:09.708832 [info ] [MainThread]:   client_id: None
[0m23:51:09.710442 [info ] [MainThread]:   authentication: sql
[0m23:51:09.711745 [info ] [MainThread]:   encrypt: False
[0m23:51:09.715466 [info ] [MainThread]:   trust_cert: True
[0m23:51:09.717260 [info ] [MainThread]:   retries: 3
[0m23:51:09.718900 [info ] [MainThread]:   login_timeout: 0
[0m23:51:09.720190 [info ] [MainThread]:   query_timeout: 0
[0m23:51:09.722843 [info ] [MainThread]:   trace_flag: False
[0m23:51:09.726358 [info ] [MainThread]:   port: 1433
[0m23:51:09.729634 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:51:09.821864 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m23:51:09.824501 [debug] [MainThread]: Using sqlserver connection "debug"
[0m23:51:09.827152 [debug] [MainThread]: On debug: select 1 as id
[0m23:51:09.829355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:09.831310 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:51:09.925218 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m23:51:09.927813 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m23:51:09.930373 [debug] [MainThread]: On debug: No close available on handle
[0m23:51:09.932232 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m23:51:09.933931 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:51:09.935658 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Cannot open database "AdventureWorks2014" requested by the login. The login failed. (4060) (SQLDriverConnect)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m23:51:09.938616 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.9872266, "process_user_time": 1.66238, "process_kernel_time": 0.802669, "process_mem_max_rss": "110544", "process_in_blocks": "12520", "command_success": false, "process_out_blocks": "0"}
[0m23:51:09.940627 [debug] [MainThread]: Command `dbt debug` failed at 23:51:09.940281 after 0.99 seconds
[0m23:51:09.942120 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:51:09.943421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2b8140670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2b4b77b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2b4b896d0>]}
[0m23:51:09.944631 [debug] [MainThread]: Flushing usage events
[0m23:52:04.540967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac477fb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac45d9dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac46a5cc70>]}


============================== 23:52:04.545248 | 9476ed78-891d-4405-96e1-9277f357e1ea ==============================
[0m23:52:04.545248 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:52:04.547166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:52:04.557064 [info ] [MainThread]: dbt version: 1.8.7
[0m23:52:04.558350 [info ] [MainThread]: python version: 3.9.25
[0m23:52:04.559753 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m23:52:04.561078 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m23:52:04.728329 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m23:52:04.730464 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m23:52:04.732106 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m23:52:04.733324 [info ] [MainThread]: adapter type: sqlserver
[0m23:52:04.734730 [info ] [MainThread]: adapter version: 1.8.7
[0m23:52:04.842934 [info ] [MainThread]: Configuration:
[0m23:52:04.844764 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:52:04.846241 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:52:04.847643 [info ] [MainThread]: Required dependencies:
[0m23:52:04.848962 [debug] [MainThread]: Executing "git --help"
[0m23:52:04.857015 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:52:04.859710 [debug] [MainThread]: STDERR: "b''"
[0m23:52:04.861636 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:52:04.863222 [info ] [MainThread]: Connection:
[0m23:52:04.865420 [info ] [MainThread]:   server: host.docker.internal
[0m23:52:04.866854 [info ] [MainThread]:   database: AdventureWorks2014
[0m23:52:04.868068 [info ] [MainThread]:   schema: dbo
[0m23:52:04.869262 [info ] [MainThread]:   UID: imrandbtnew
[0m23:52:04.870456 [info ] [MainThread]:   client_id: None
[0m23:52:04.871552 [info ] [MainThread]:   authentication: sql
[0m23:52:04.873161 [info ] [MainThread]:   encrypt: False
[0m23:52:04.874531 [info ] [MainThread]:   trust_cert: True
[0m23:52:04.875820 [info ] [MainThread]:   retries: 3
[0m23:52:04.878067 [info ] [MainThread]:   login_timeout: 0
[0m23:52:04.879903 [info ] [MainThread]:   query_timeout: 0
[0m23:52:04.881596 [info ] [MainThread]:   trace_flag: False
[0m23:52:04.883206 [info ] [MainThread]:   port: 1433
[0m23:52:04.884779 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:52:04.954862 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m23:52:04.956756 [debug] [MainThread]: Using sqlserver connection "debug"
[0m23:52:04.958093 [debug] [MainThread]: On debug: select 1 as id
[0m23:52:04.959502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:04.960969 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:52:05.023120 [debug] [MainThread]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:52:05.027980 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:52:05.029993 [debug] [MainThread]: On debug: Close
[0m23:52:05.031387 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:52:05.032786 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:52:05.034979 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5911677, "process_user_time": 1.254955, "process_kernel_time": 0.157373, "process_mem_max_rss": "111540", "process_in_blocks": "104", "process_out_blocks": "0"}
[0m23:52:05.036194 [debug] [MainThread]: Command `dbt debug` succeeded at 23:52:05.036069 after 0.59 seconds
[0m23:52:05.037469 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:52:05.038951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac477fb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac442a8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac469a88b0>]}
[0m23:52:05.040170 [debug] [MainThread]: Flushing usage events
[0m23:52:21.067785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4ff7af6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fd6395b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fd639550>]}


============================== 23:52:21.071818 | 0186d78c-5189-41ad-b3d6-5511f7dfe83d ==============================
[0m23:52:21.071818 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:52:21.073554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:52:21.321782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fc3fae50>]}
[0m23:52:21.370175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fc336ca0>]}
[0m23:52:21.372557 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:52:21.511980 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:52:22.683686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:52:22.684730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:52:22.691738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m23:52:22.737930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fbd9ef40>]}
[0m23:52:22.944718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fbde3f10>]}
[0m23:52:22.946289 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m23:52:22.947389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fc3bee50>]}
[0m23:52:22.949701 [info ] [MainThread]: 
[0m23:52:22.951120 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:52:22.958473 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:52:22.976830 [debug] [ThreadPool]: dbt-sqlserver
[0m23:52:22.978860 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:52:22.980383 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:52:22.981886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:22.983483 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:52:23.016831 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:52:23.023020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:52:23.025622 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:52:23.028153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m23:52:23.036229 [debug] [ThreadPool]: dbt-sqlserver
[0m23:52:23.037948 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m23:52:23.039286 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:52:23.040526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:23.041839 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:52:23.043157 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:52:23.078599 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:52:23.081086 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m23:52:23.082149 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m23:52:23.084142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4ff4780a0>]}
[0m23:52:23.085336 [debug] [MainThread]: On master: COMMIT
[0m23:52:23.086408 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:52:23.087950 [info ] [MainThread]: 
[0m23:52:23.101771 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m23:52:23.102611 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m23:52:23.103378 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m23:52:23.103774 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m23:52:23.104906 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m23:52:23.106321 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m23:52:23.107870 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m23:52:23.109620 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m23:52:23.110994 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m23:52:23.112518 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m23:52:23.113674 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m23:52:23.114811 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m23:52:23.116780 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m23:52:23.118890 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m23:52:23.119928 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m23:52:23.121117 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m23:52:23.130696 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m23:52:23.137062 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m23:52:23.141089 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m23:52:23.144856 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m23:52:23.153253 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m23:52:23.161287 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m23:52:23.188214 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m23:52:23.194206 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m23:52:23.200733 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m23:52:23.201643 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m23:52:23.205538 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m23:52:23.209426 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m23:52:23.217077 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m23:52:23.218017 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m23:52:23.219424 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m23:52:23.220584 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m23:52:23.222403 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m23:52:23.223305 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m23:52:23.224514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:52:23.225648 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m23:52:23.226807 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:52:23.228076 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m23:52:23.229394 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:52:23.230701 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:52:23.231750 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:52:23.232947 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:52:23.234342 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:52:23.235499 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:52:23.237614 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:52:23.256847 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.257431 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:52:23.258841 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:52:23.265023 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m23:52:23.265548 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:52:23.270243 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m23:52:23.279891 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.280441 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.286338 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m23:52:23.286850 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.291210 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m23:52:23.292542 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m23:52:23.298173 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m23:52:23.299424 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m23:52:23.301598 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m23:52:23.502073 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.502713 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.503374 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.503808 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.519634 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m23:52:23.522003 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m23:52:23.525800 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m23:52:23.528918 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m23:52:23.537022 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m23:52:23.542351 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m23:52:23.549077 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m23:52:23.553724 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m23:52:23.560967 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:52:23.562776 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:52:23.565124 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:52:23.567045 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:52:23.569304 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m23:52:23.570989 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m23:52:23.573068 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m23:52:23.575661 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m23:52:23.577884 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:52:23.579184 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:52:23.581282 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:52:23.582591 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:52:23.640709 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.644555 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m23:52:23.645981 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m23:52:23.649077 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.649669 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.652396 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m23:52:23.656762 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m23:52:23.657887 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m23:52:23.658391 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.659256 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m23:52:23.663898 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m23:52:23.664333 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.666852 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m23:52:23.667993 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.669583 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m23:52:23.672042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4faf1d940>]}
[0m23:52:23.674161 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m23:52:23.675478 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m23:52:23.677170 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.56s]
[0m23:52:23.678594 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m23:52:23.680182 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4faed6eb0>]}
[0m23:52:23.681519 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m23:52:23.682933 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4faf1dbb0>]}
[0m23:52:23.684101 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.57s]
[0m23:52:23.686844 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.57s]
[0m23:52:23.688607 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m23:52:23.690527 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m23:52:23.691361 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.696288 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m23:52:23.697597 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m23:52:23.701384 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:52:23.703938 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m23:52:23.705280 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m23:52:23.706803 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0186d78c-5189-41ad-b3d6-5511f7dfe83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4faed6d90>]}
[0m23:52:23.707966 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.59s]
[0m23:52:23.709261 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m23:52:23.712106 [debug] [MainThread]: On master: COMMIT
[0m23:52:23.713167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:23.713996 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m23:52:23.714790 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m23:52:23.715522 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m23:52:23.716367 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m23:52:23.717307 [info ] [MainThread]: 
[0m23:52:23.718368 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m23:52:23.720691 [debug] [MainThread]: Command end result
[0m23:52:23.807153 [info ] [MainThread]: 
[0m23:52:23.808781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:23.810751 [info ] [MainThread]: 
[0m23:52:23.812343 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:52:23.814813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8160243, "process_user_time": 1.902933, "process_kernel_time": 0.31314, "process_mem_max_rss": "122936", "process_in_blocks": "728", "process_out_blocks": "56"}
[0m23:52:23.816226 [debug] [MainThread]: Command `dbt run` succeeded at 23:52:23.816077 after 2.82 seconds
[0m23:52:23.817260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4ff7af6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4fc336ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4ff44dfd0>]}
[0m23:52:23.818414 [debug] [MainThread]: Flushing usage events
[0m00:27:20.212097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884ed43b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884eb2c4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884eb2c45e0>]}


============================== 00:27:20.222795 | e3e175ae-ffca-40a3-abec-d6dabbd70a18 ==============================
[0m00:27:20.222795 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:27:20.224906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:27:20.886364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884eb96f4c0>]}
[0m00:27:20.942282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884ed626190>]}
[0m00:27:20.944635 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m00:27:21.127939 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:27:22.898845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:27:22.899932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:27:22.908272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m00:27:22.958608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884e9a29fd0>]}
[0m00:27:23.181582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884e9bb8b50>]}
[0m00:27:23.182712 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m00:27:23.183941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884ea04a4f0>]}
[0m00:27:23.187026 [info ] [MainThread]: 
[0m00:27:23.189392 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:27:23.197572 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m00:27:23.225523 [debug] [ThreadPool]: dbt-sqlserver
[0m00:27:23.227789 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m00:27:23.229364 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m00:27:23.230792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:23.232415 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:27:23.790485 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:27:23.802818 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m00:27:23.805810 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m00:27:23.808231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m00:27:23.825729 [debug] [ThreadPool]: dbt-sqlserver
[0m00:27:23.827577 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m00:27:23.829255 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m00:27:23.830305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:27:23.831546 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:27:23.833224 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:27:24.014015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:27:24.018026 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m00:27:24.020914 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m00:27:24.023705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884ec7ba040>]}
[0m00:27:24.025163 [debug] [MainThread]: On master: COMMIT
[0m00:27:24.026550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:27:24.028127 [info ] [MainThread]: 
[0m00:27:24.040794 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m00:27:24.042931 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m00:27:24.045994 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m00:27:24.047679 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m00:27:24.049060 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m00:27:24.051284 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m00:27:24.053498 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m00:27:24.055595 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m00:27:24.058944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m00:27:24.060831 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m00:27:24.062451 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m00:27:24.063767 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m00:27:24.064990 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m00:27:24.066430 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m00:27:24.067867 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m00:27:24.068987 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m00:27:24.086858 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m00:27:24.097885 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m00:27:24.109900 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m00:27:24.117972 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:27:24.126349 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m00:27:24.128347 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m00:27:24.140125 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m00:27:24.179854 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m00:27:24.210604 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:27:24.216583 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m00:27:24.217053 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m00:27:24.228616 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m00:27:24.238894 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:27:24.240589 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:27:24.241748 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:27:24.242715 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:27:24.243342 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m00:27:24.244959 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m00:27:24.246022 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m00:27:24.247323 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m00:27:24.248523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:27:24.249614 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:27:24.250609 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:27:24.251706 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:27:24.252883 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:27:24.254103 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:27:24.255242 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:27:24.256499 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:27:24.257789 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:27:24.287814 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:27:24.289790 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:27:24.290582 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:27:24.331743 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.332470 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.332940 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.333324 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.347895 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:27:24.353754 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:27:24.360762 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:27:24.366905 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:27:24.367867 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m00:27:24.369038 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m00:27:24.370284 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m00:27:24.371579 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m00:27:24.579852 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.580386 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.580949 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.581298 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.597350 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m00:27:24.598606 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m00:27:24.601268 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m00:27:24.603615 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m00:27:24.610682 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m00:27:24.613780 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m00:27:24.618035 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m00:27:24.621737 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m00:27:24.630166 [debug] [Thread-4  ]: dbt-sqlserver
[0m00:27:24.632179 [debug] [Thread-2  ]: dbt-sqlserver
[0m00:27:24.634452 [debug] [Thread-3  ]: dbt-sqlserver
[0m00:27:24.637135 [debug] [Thread-1  ]: dbt-sqlserver
[0m00:27:24.638543 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:27:24.639991 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:27:24.641566 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:27:24.643279 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:27:24.645056 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:27:24.646904 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:27:24.648726 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:27:24.650594 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:27:24.724060 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.727853 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:27:24.729464 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m00:27:24.734620 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.741112 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m00:27:24.743510 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m00:27:24.747224 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884e91b4dc0>]}
[0m00:27:24.748988 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.750084 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.68s]
[0m00:27:24.754924 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:27:24.757242 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m00:27:24.758997 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m00:27:24.766761 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.770942 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m00:27:24.773025 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m00:27:24.773768 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.774338 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.775485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884e91a9070>]}
[0m00:27:24.778587 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:27:24.781245 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:27:24.782284 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.72s]
[0m00:27:24.783682 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m00:27:24.785354 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m00:27:24.787611 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m00:27:24.792873 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.793653 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:27:24.797153 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m00:27:24.800456 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m00:27:24.801629 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m00:27:24.803221 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m00:27:24.804877 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884e91b4fd0>]}
[0m00:27:24.807000 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e175ae-ffca-40a3-abec-d6dabbd70a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884eb2ee7f0>]}
[0m00:27:24.808585 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.74s]
[0m00:27:24.809955 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.74s]
[0m00:27:24.811308 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m00:27:24.812866 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m00:27:24.816706 [debug] [MainThread]: On master: COMMIT
[0m00:27:24.817909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:24.818748 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m00:27:24.819795 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m00:27:24.820917 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m00:27:24.821901 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m00:27:24.823039 [info ] [MainThread]: 
[0m00:27:24.824054 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m00:27:24.825840 [debug] [MainThread]: Command end result
[0m00:27:24.897594 [info ] [MainThread]: 
[0m00:27:24.898875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:27:24.900205 [info ] [MainThread]: 
[0m00:27:24.901302 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:27:24.904435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7999735, "process_user_time": 3.183756, "process_kernel_time": 3.060487, "process_mem_max_rss": "123000", "process_in_blocks": "19608", "process_out_blocks": "0"}
[0m00:27:24.905665 [debug] [MainThread]: Command `dbt run` succeeded at 00:27:24.905541 after 4.80 seconds
[0m00:27:24.906664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884ed43b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884eb9dbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884eb96f4c0>]}
[0m00:27:24.907679 [debug] [MainThread]: Flushing usage events
[0m00:34:44.444252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755791b7e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578fa085b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578fa08550>]}


============================== 00:34:44.454343 | ba78c7fc-e22a-473f-a924-3772d2ea529e ==============================
[0m00:34:44.454343 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:34:44.456554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:45.319994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578e7c9e50>]}
[0m00:34:45.379797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578e705ca0>]}
[0m00:34:45.382029 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m00:34:45.528089 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:34:46.797853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:46.799034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:46.806244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m00:34:46.863038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578e16df40>]}
[0m00:34:47.132348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578e1b2f10>]}
[0m00:34:47.134586 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m00:34:47.136342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578e78ee50>]}
[0m00:34:47.138961 [info ] [MainThread]: 
[0m00:34:47.140674 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:34:47.150276 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m00:34:47.180894 [debug] [ThreadPool]: dbt-sqlserver
[0m00:34:47.183203 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m00:34:47.185590 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m00:34:47.187452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:47.188941 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:34:47.310028 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:34:47.314329 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:47.317029 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m00:34:47.319213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m00:34:47.331553 [debug] [ThreadPool]: dbt-sqlserver
[0m00:34:47.333240 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m00:34:47.334557 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m00:34:47.335870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:47.337522 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:34:47.339114 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:34:47.350087 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:47.352916 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m00:34:47.354444 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m00:34:47.356978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557918470a0>]}
[0m00:34:47.358326 [debug] [MainThread]: On master: COMMIT
[0m00:34:47.359387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:34:47.360461 [info ] [MainThread]: 
[0m00:34:47.366645 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m00:34:47.367518 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m00:34:47.368602 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m00:34:47.370019 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m00:34:47.371476 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m00:34:47.373162 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m00:34:47.374515 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m00:34:47.376328 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m00:34:47.378641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m00:34:47.380537 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m00:34:47.382531 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m00:34:47.384248 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m00:34:47.385393 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m00:34:47.386591 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m00:34:47.387692 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m00:34:47.388771 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m00:34:47.402548 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m00:34:47.406996 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m00:34:47.415197 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m00:34:47.424051 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:34:47.437484 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m00:34:47.451167 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m00:34:47.463825 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m00:34:47.470464 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m00:34:47.495392 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m00:34:47.496750 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m00:34:47.500800 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m00:34:47.506820 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:34:47.518387 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:34:47.521215 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:34:47.522018 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m00:34:47.522872 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:34:47.525169 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m00:34:47.526031 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:34:47.527770 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:34:47.529636 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m00:34:47.531418 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:34:47.532872 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m00:34:47.534841 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:34:47.536661 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:34:47.538466 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:34:47.540042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:34:47.541827 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:34:47.543349 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:34:47.546272 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m00:34:47.569027 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:34:47.580674 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:34:47.581657 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m00:34:47.587420 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.597642 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:34:47.598165 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.599558 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m00:34:47.611121 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:34:47.611711 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.612119 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.614185 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m00:34:47.635968 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:34:47.645444 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:34:47.648250 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m00:34:47.650570 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m00:34:47.656260 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.656952 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.670684 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.670994 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:34:47.671495 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.679454 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:34:47.689038 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:34:47.690720 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m00:34:47.700720 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:34:47.702356 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m00:34:47.704227 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m00:34:47.706898 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m00:34:47.723548 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.724054 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.724597 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.726188 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.773049 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m00:34:47.790635 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m00:34:47.793342 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m00:34:47.797118 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m00:34:47.805116 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m00:34:47.810993 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m00:34:47.820434 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m00:34:47.825392 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m00:34:47.836147 [debug] [Thread-3  ]: dbt-sqlserver
[0m00:34:47.838889 [debug] [Thread-2  ]: dbt-sqlserver
[0m00:34:47.841914 [debug] [Thread-4  ]: dbt-sqlserver
[0m00:34:47.846498 [debug] [Thread-1  ]: dbt-sqlserver
[0m00:34:47.849541 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:34:47.852741 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:34:47.854820 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:34:47.856819 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:34:47.858946 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:34:47.862123 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:34:47.865614 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:34:47.869786 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m00:34:47.882422 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.882926 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.886587 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m00:34:47.889469 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m00:34:47.890957 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m00:34:47.893318 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m00:34:47.915500 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.916422 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.921856 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m00:34:47.926459 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m00:34:47.927140 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.929341 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m00:34:47.931355 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m00:34:47.934933 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m00:34:47.938348 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578d8d7250>]}
[0m00:34:47.940951 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578d8eda60>]}
[0m00:34:47.942973 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m00:34:47.946459 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.945627 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.56s]
[0m00:34:47.948590 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.56s]
[0m00:34:47.953456 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m00:34:47.955599 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m00:34:47.958317 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m00:34:47.960057 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m00:34:47.961062 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.968299 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m00:34:47.970706 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m00:34:47.973372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578d8edcd0>]}
[0m00:34:47.976618 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.60s]
[0m00:34:47.979665 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m00:34:47.981461 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m00:34:47.985055 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m00:34:47.986338 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m00:34:47.987897 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba78c7fc-e22a-473f-a924-3772d2ea529e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578d8edc10>]}
[0m00:34:47.989524 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.60s]
[0m00:34:47.991025 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m00:34:47.994345 [debug] [MainThread]: On master: COMMIT
[0m00:34:47.996921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:47.998255 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m00:34:47.999351 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m00:34:48.000366 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m00:34:48.001337 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m00:34:48.002560 [info ] [MainThread]: 
[0m00:34:48.003923 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m00:34:48.005784 [debug] [MainThread]: Command end result
[0m00:34:48.172309 [info ] [MainThread]: 
[0m00:34:48.175540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:48.177356 [info ] [MainThread]: 
[0m00:34:48.179176 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:34:48.182935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8555818, "process_user_time": 2.583656, "process_kernel_time": 2.535736, "process_mem_max_rss": "123988", "process_in_blocks": "144", "process_out_blocks": "0"}
[0m00:34:48.184592 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:48.184350 after 3.86 seconds
[0m00:34:48.185794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755791b7e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578fb86ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75578e64f2b0>]}
[0m00:34:48.186804 [debug] [MainThread]: Flushing usage events
[0m14:52:30.488065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bfa9f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bd929580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bd929520>]}


============================== 14:52:30.493604 | 8837d054-b57b-49cf-9eb6-1fe6da3cdb50 ==============================
[0m14:52:30.493604 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:52:30.495512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:30.963809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bc62c0d0>]}
[0m14:52:31.010993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bd9539a0>]}
[0m14:52:31.013351 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:52:31.155699 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:52:32.144431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:32.145506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:32.153191 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m14:52:32.198270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bc08feb0>]}
[0m14:52:32.396257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bc1fd100>]}
[0m14:52:32.397261 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m14:52:32.398225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bc6aec10>]}
[0m14:52:32.400862 [info ] [MainThread]: 
[0m14:52:32.402529 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:52:32.409344 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m14:52:32.427313 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:32.430742 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m14:52:32.432188 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:32.434011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:32.435833 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:32.565076 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:32.577805 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:32.580310 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m14:52:32.582717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m14:52:32.592021 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:32.593363 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m14:52:32.594502 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:32.595672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:32.596825 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:32.597985 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:32.682508 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:32.685973 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m14:52:32.687332 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m14:52:32.689388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bc6dc0a0>]}
[0m14:52:32.690409 [debug] [MainThread]: On master: COMMIT
[0m14:52:32.691374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:32.692330 [info ] [MainThread]: 
[0m14:52:32.704468 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m14:52:32.705101 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m14:52:32.705535 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m14:52:32.705982 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:32.706696 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m14:52:32.707842 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m14:52:32.709016 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m14:52:32.710162 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m14:52:32.711392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m14:52:32.712466 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m14:52:32.713406 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m14:52:32.714321 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m14:52:32.715197 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m14:52:32.716146 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m14:52:32.717130 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m14:52:32.718114 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:32.728669 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m14:52:32.732852 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m14:52:32.741897 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m14:52:32.746340 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:32.754688 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m14:52:32.755699 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m14:52:32.762593 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:32.762938 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m14:52:32.809536 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m14:52:32.810302 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m14:52:32.815218 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:32.820630 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m14:52:32.829253 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:32.830202 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:32.831759 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m14:52:32.832406 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:32.833148 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:32.833910 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m14:52:32.835484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:32.836287 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m14:52:32.837364 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m14:52:32.838209 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:52:32.839083 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:32.840122 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:52:32.840951 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:52:32.841764 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:32.842714 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:32.843325 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:32.844254 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:32.863585 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:32.864196 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:32.867060 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:32.885216 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:32.894555 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:32.895677 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m14:52:32.897143 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:32.897605 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:32.898052 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:32.903950 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:32.909069 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:32.914969 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:32.916112 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m14:52:32.918451 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m14:52:32.921649 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m14:52:33.251643 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.252314 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.252783 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.253190 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.257242 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:33.262039 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:33.266894 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:33.272495 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:33.273415 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m14:52:33.274515 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m14:52:33.275566 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m14:52:33.276539 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m14:52:33.289319 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.290217 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.290775 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.291233 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.314116 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m14:52:33.315940 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m14:52:33.319841 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m14:52:33.325589 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m14:52:33.337141 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m14:52:33.343380 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m14:52:33.348636 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m14:52:33.354772 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m14:52:33.362856 [debug] [Thread-4  ]: dbt-sqlserver
[0m14:52:33.364878 [debug] [Thread-1  ]: dbt-sqlserver
[0m14:52:33.367052 [debug] [Thread-2  ]: dbt-sqlserver
[0m14:52:33.369997 [debug] [Thread-3  ]: dbt-sqlserver
[0m14:52:33.371428 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:33.372906 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:33.374199 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:33.375390 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:33.376522 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:33.377672 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:33.378784 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:33.379843 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:33.445445 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.449796 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:33.451742 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m14:52:33.459353 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.460204 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.460880 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.463158 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:33.466872 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:33.469549 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:33.470060 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.470688 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m14:52:33.471762 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m14:52:33.472782 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m14:52:33.476170 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m14:52:33.479602 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m14:52:33.482653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bb1805e0>]}
[0m14:52:33.485258 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.77s]
[0m14:52:33.487268 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.487816 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.488234 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:33.488934 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m14:52:33.491416 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m14:52:33.493325 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m14:52:33.496072 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m14:52:33.497987 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m14:52:33.498788 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m14:52:33.499665 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m14:52:33.500914 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bb1b1a90>]}
[0m14:52:33.502360 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bb1b1bb0>]}
[0m14:52:33.504076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8837d054-b57b-49cf-9eb6-1fe6da3cdb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bb1b16a0>]}
[0m14:52:33.505076 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.79s]
[0m14:52:33.506435 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.79s]
[0m14:52:33.507804 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.79s]
[0m14:52:33.509111 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m14:52:33.510158 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:33.511354 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m14:52:33.515255 [debug] [MainThread]: On master: COMMIT
[0m14:52:33.516798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:33.518143 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m14:52:33.519063 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m14:52:33.519977 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m14:52:33.520726 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m14:52:33.521595 [info ] [MainThread]: 
[0m14:52:33.522643 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m14:52:33.524407 [debug] [MainThread]: Command end result
[0m14:52:33.609816 [info ] [MainThread]: 
[0m14:52:33.611098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:33.612493 [info ] [MainThread]: 
[0m14:52:33.613998 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:52:33.616368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.220402, "process_user_time": 2.398468, "process_kernel_time": 1.261297, "process_mem_max_rss": "124268", "process_in_blocks": "97192", "process_out_blocks": "256"}
[0m14:52:33.617377 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:33.617257 after 3.22 seconds
[0m14:52:33.618310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bfa9f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bc6dc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4bd9539a0>]}
[0m14:52:33.619163 [debug] [MainThread]: Flushing usage events
[0m14:52:42.394060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3d3b75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3b2414f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3b241490>]}


============================== 14:52:42.403408 | 9a666600-543c-44dd-b6a6-3de5dbc414ef ==============================
[0m14:52:42.403408 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:52:42.406034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:43.380757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a666600-543c-44dd-b6a6-3de5dbc414ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3b262be0>]}
[0m14:52:43.486872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a666600-543c-44dd-b6a6-3de5dbc414ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3b2ae4f0>]}
[0m14:52:43.489172 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:52:43.711499 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:52:44.610200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5c3215e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5a1aa3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5a1aa370>]}
[0m14:52:44.610633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6971c6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696faf75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696faf7550>]}


============================== 14:52:44.616822 | 8a51eb32-20f5-4276-a2c2-236ea70bdf58 ==============================
[0m14:52:44.616822 [info ] [MainThread]: Running with dbt=1.8.7


============================== 14:52:44.616784 | aff5e0df-1003-4b4a-aab0-5272d85f3e7e ==============================
[0m14:52:44.616784 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:52:44.619232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:44.619416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:45.240955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696fb787c0>]}
[0m14:52:45.256817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5a1e09d0>]}
[0m14:52:45.409559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c69701a2580>]}
[0m14:52:45.413460 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:52:45.425402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5a1cab50>]}
[0m14:52:45.427851 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:52:45.717322 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:52:45.720413 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:52:45.750892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:45.752544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:45.765946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m14:52:45.876013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a666600-543c-44dd-b6a6-3de5dbc414ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b399a6fa0>]}
[0m14:52:46.358451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a666600-543c-44dd-b6a6-3de5dbc414ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3b2ae310>]}
[0m14:52:46.361525 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m14:52:46.366128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a666600-543c-44dd-b6a6-3de5dbc414ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b39e869d0>]}
[0m14:52:46.375917 [info ] [MainThread]: 
[0m14:52:46.384562 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:52:46.401077 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m14:52:46.476559 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:46.478585 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m14:52:46.480361 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:46.482450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:46.484293 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:46.777975 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:46.792668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:46.798491 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m14:52:46.800339 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m14:52:46.803952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a666600-543c-44dd-b6a6-3de5dbc414ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3b2d3130>]}
[0m14:52:46.806119 [debug] [MainThread]: On master: COMMIT
[0m14:52:46.808003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:46.809907 [info ] [MainThread]: 
[0m14:52:46.828839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:46.829314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:46.831094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:46.831065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:46.840832 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:46.842419 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:46.843382 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:46.848102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m14:52:46.847752 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m14:52:46.845380 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m14:52:46.847355 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m14:52:46.851212 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m14:52:46.853514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m14:52:46.855292 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m14:52:46.857465 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m14:52:46.859351 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:46.861217 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:46.862741 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:46.953543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c58910fd0>]}
[0m14:52:46.939493 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:52:46.953393 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:52:46.958856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696e25deb0>]}
[0m14:52:46.957029 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:52:46.969593 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:46.971117 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:46.979342 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:47.091083 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m14:52:47.109237 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m14:52:47.195180 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m14:52:47.195941 [debug] [Thread-1  ]: local_md5(invocation_id): 40d201fb3c3462222d8c62bec044d159
[0m14:52:47.198217 [debug] [Thread-2  ]: local_md5(invocation_id): 40d201fb3c3462222d8c62bec044d159
[0m14:52:47.200151 [debug] [Thread-3  ]: local_md5(invocation_id): 40d201fb3c3462222d8c62bec044d159
[0m14:52:47.202482 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:52:47.204668 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:52:47.206793 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:52:47.219427 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:52:47.221492 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:52:47.223914 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a45c5acb476203005ab70252a28158d7]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a45c5acb476203005ab70252a28158d7]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a45c5acb476203005ab70252a28158d7]
  ;')
[0m14:52:47.225096 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:52:47.227052 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_002b4463b4255d0e239cbc0be1ad3e5f]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_002b4463b4255d0e239cbc0be1ad3e5f]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_002b4463b4255d0e239cbc0be1ad3e5f]
  ;')
[0m14:52:47.229273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:47.231885 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_84bc6f50635d2041725de0ef129c2abe]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_84bc6f50635d2041725de0ef129c2abe]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_84bc6f50635d2041725de0ef129c2abe]
  ;')
[0m14:52:47.233606 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:52:47.235553 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:47.237345 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:52:47.239164 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:47.242596 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:47.282725 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:47.284381 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:47.294864 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:47.460080 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:47.479567 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m14:52:47.483040 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m14:52:47.486165 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.63s]
[0m14:52:47.490406 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:47.498032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5c05a2e0>]}
[0m14:52:47.499846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696e6da160>]}
[0m14:52:47.500629 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m14:52:47.504365 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m14:52:47.506231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5bfe9b80>]}
[0m14:52:47.507775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696e2a8070>]}
[0m14:52:47.514022 [info ] [MainThread]: 
[0m14:52:47.519093 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:52:47.516952 [info ] [MainThread]: 
[0m14:52:47.523330 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:52:47.542383 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m14:52:47.545224 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m14:52:47.622777 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:47.626294 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m14:52:47.627962 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:47.629020 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:47.631298 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m14:52:47.632810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:47.634501 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:47.635572 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:47.636332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:47.638653 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:47.760275 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:47.767190 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:47.768417 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:47.773744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:47.774044 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m14:52:47.778753 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m14:52:47.779176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m14:52:47.783808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m14:52:47.802802 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:47.805825 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m14:52:47.808167 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:47.808250 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:47.810713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:47.811153 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m14:52:47.814578 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:47.814847 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:47.816761 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:47.817036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:47.819276 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:47.821638 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:47.828793 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:47.834731 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:47.835756 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m14:52:47.837962 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m14:52:47.840620 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m14:52:47.842682 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m14:52:47.844695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696e8aad90>]}
[0m14:52:47.848837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c58f67d90>]}
[0m14:52:47.850402 [debug] [MainThread]: On master: COMMIT
[0m14:52:47.851384 [debug] [MainThread]: On master: COMMIT
[0m14:52:47.852729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:47.853937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:47.855981 [info ] [MainThread]: 
[0m14:52:47.856044 [info ] [MainThread]: 
[0m14:52:47.889692 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m14:52:47.891344 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m14:52:47.892751 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m14:52:47.894667 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:47.897372 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m14:52:47.900847 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m14:52:47.904289 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m14:52:47.903526 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m14:52:47.908294 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m14:52:47.907136 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m14:52:47.919897 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m14:52:47.911566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m14:52:47.911367 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m14:52:47.926359 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m14:52:47.913543 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:47.914373 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m14:52:47.930290 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m14:52:47.931885 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m14:52:47.922246 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m14:52:47.917579 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m14:52:47.937401 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 1.08s]
[0m14:52:47.925611 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m14:52:47.921550 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m14:52:47.946101 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:47.925192 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m14:52:47.915622 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m14:52:47.954352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m14:52:47.944932 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m14:52:47.950389 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m14:52:47.941050 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m14:52:47.934095 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m14:52:47.957619 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m14:52:47.970877 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m14:52:47.977881 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m14:52:47.981580 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m14:52:47.960032 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m14:52:47.985013 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 1.13s]
[0m14:52:47.962515 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m14:52:47.991858 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:47.997554 [debug] [MainThread]: On master: COMMIT
[0m14:52:48.000593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:48.003866 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m14:52:47.944818 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m14:52:48.020536 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m14:52:48.022842 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m14:52:48.025615 [info ] [MainThread]: 
[0m14:52:48.029282 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m14:52:48.035208 [debug] [MainThread]: Command end result
[0m14:52:47.949901 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:47.967230 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:48.016088 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.019586 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.037981 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.054000 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.051411 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.044511 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.053556 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.072127 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.085255 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m14:52:48.092588 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m14:52:48.087415 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m14:52:48.101972 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m14:52:48.090476 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:48.162152 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:48.254898 [info ] [MainThread]: 
[0m14:52:48.257429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:48.091786 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m14:52:48.195360 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m14:52:48.259528 [info ] [MainThread]: 
[0m14:52:48.265051 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:52:48.270365 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.1239476, "process_user_time": 4.229221, "process_kernel_time": 2.563533, "process_mem_max_rss": "124092", "process_in_blocks": "69848", "process_out_blocks": "256"}
[0m14:52:48.275977 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:48.275607 after 6.13 seconds
[0m14:52:48.277922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3d3b75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b3b8eb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b398bd520>]}
[0m14:52:48.279733 [debug] [MainThread]: Flushing usage events
[0m14:52:48.295862 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.304207 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.309234 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.311440 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.322096 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.324480 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.325987 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.327416 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m14:52:48.329121 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.331043 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m14:52:48.333855 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m14:52:48.335723 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:52:48.337119 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m14:52:48.338605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:48.339878 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.340232 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:52:48.342155 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.341807 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.343230 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.343120 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:52:48.345071 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.344855 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.347095 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.350922 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.363653 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.371755 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m14:52:48.368440 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.372938 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.374702 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.390700 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m14:52:48.392302 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.393462 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.380187 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m14:52:48.395756 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.383123 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m14:52:48.397287 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.376612 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:52:48.397498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:48.399830 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:52:48.402974 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:52:48.407753 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.409570 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.428471 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.411196 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.412759 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:48.460964 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.449797 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.467295 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.468332 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.469880 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:48.451269 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.463632 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.492081 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.464731 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.493307 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.476666 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.494140 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.486878 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.494806 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.496968 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.498545 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m14:52:48.497406 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m14:52:48.501049 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m14:52:48.503843 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m14:52:48.500460 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m14:52:48.505666 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m14:52:48.503291 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m14:52:48.506790 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m14:52:48.508835 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m14:52:48.516049 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m14:52:48.519223 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m14:52:48.522597 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m14:52:48.528378 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.524499 [error] [Thread-4  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_sales_orders.sql[0m
('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_sales_orders__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.526162 [error] [Thread-2  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_example.sql[0m
('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_example__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.528843 [error] [Thread-1  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_customers.sql[0m
('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_customers__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.530922 [error] [Thread-3  ]: [31mUnhandled error while executing target/run/dbt_sqlserver_project/models/staging/stg_products.sql[0m
('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_products__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.539232 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.541091 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m14:52:48.556920 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.557784 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.571420 [debug] [Thread-2  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_example__dbt_tmp' in the database. (2714) (SQLMoreResults)")

[0m14:52:48.558645 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.572321 [debug] [Thread-4  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_sales_orders__dbt_tmp' in the database. (2714) (SQLMoreResults)")

[0m14:52:48.573143 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_customers__dbt_tmp' in the database. (2714) (SQLMoreResults)")

[0m14:52:48.573846 [debug] [Thread-3  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 81, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 390, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_products__dbt_tmp' in the database. (2714) (SQLMoreResults)")

[0m14:52:48.577076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c58d85190>]}
[0m14:52:48.579482 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c58915ee0>]}
[0m14:52:48.581490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c509ec790>]}
[0m14:52:48.559162 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.583554 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff5e0df-1003-4b4a-aab0-5272d85f3e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c53e49a60>]}
[0m14:52:48.585935 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model dbo.stg_example ........................... [[31mERROR[0m in 0.66s]
[0m14:52:48.587893 [error] [Thread-4  ]: 4 of 4 ERROR creating sql view model dbo.stg_sales_orders ...................... [[31mERROR[0m in 0.66s]
[0m14:52:48.590009 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dbo.stg_customers ......................... [[31mERROR[0m in 0.67s]
[0m14:52:48.592991 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model dbo.stg_products .......................... [[31mERROR[0m in 0.67s]
[0m14:52:48.595380 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m14:52:48.597407 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:48.599511 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m14:52:48.601348 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m14:52:48.609630 [debug] [MainThread]: On master: COMMIT
[0m14:52:48.611648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:48.613361 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m14:52:48.616054 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m14:52:48.617419 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m14:52:48.618678 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m14:52:48.621792 [info ] [MainThread]: 
[0m14:52:48.623728 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m14:52:48.567928 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.627971 [debug] [MainThread]: Command end result
[0m14:52:48.577947 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.626793 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.628470 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m14:52:48.631906 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m14:52:48.633645 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m14:52:48.635434 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m14:52:48.652844 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m14:52:48.674605 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.675580 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.681634 [debug] [Thread-1  ]: dbt-sqlserver
[0m14:52:48.685877 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.692508 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m14:52:48.698442 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m14:52:48.700824 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.707242 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m14:52:48.721133 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m14:52:48.736831 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m14:52:48.738596 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:48.748893 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m14:52:48.751054 [debug] [Thread-2  ]: dbt-sqlserver
[0m14:52:48.753948 [debug] [Thread-3  ]: dbt-sqlserver
[0m14:52:48.758742 [debug] [Thread-4  ]: dbt-sqlserver
[0m14:52:48.761390 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.764065 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.766057 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.767315 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.769075 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:48.771001 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:48.776151 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m14:52:48.777461 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:52:48.781943 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m14:52:48.783420 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.784352 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.790176 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.791696 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m14:52:48.794977 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m14:52:48.799965 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m14:52:48.800742 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.801994 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m14:52:48.803697 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m14:52:48.805218 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m14:52:48.810570 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m14:52:48.816504 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m14:52:48.821336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696d3f6f70>]}
[0m14:52:48.823129 [info ] [MainThread]: 
[0m14:52:48.823746 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.86s]
[0m14:52:48.825565 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:52:48.827793 [info ] [MainThread]: 
[0m14:52:48.825620 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.829609 [error] [MainThread]:   ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_example__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.831765 [info ] [MainThread]: 
[0m14:52:48.828259 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m14:52:48.833904 [error] [MainThread]:   ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_sales_orders__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.836033 [info ] [MainThread]: 
[0m14:52:48.833367 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m14:52:48.835601 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.838156 [error] [MainThread]:   ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_customers__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.839948 [info ] [MainThread]: 
[0m14:52:48.841794 [error] [MainThread]:   ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'stg_products__dbt_tmp' in the database. (2714) (SQLMoreResults)")
[0m14:52:48.836439 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:52:48.843513 [info ] [MainThread]: 
[0m14:52:48.845666 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m14:52:48.838256 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m14:52:48.848423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.3751297, "process_user_time": 4.913393, "process_kernel_time": 1.858684, "process_mem_max_rss": "122604", "process_in_blocks": "3168", "process_out_blocks": "256", "command_success": false}
[0m14:52:48.841673 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m14:52:48.850095 [debug] [MainThread]: Command `dbt run` failed at 14:52:48.849922 after 4.38 seconds
[0m14:52:48.845733 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m14:52:48.848415 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696c34a730>]}
[0m14:52:48.851650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5c3215e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c5a8c3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c588b0c70>]}
[0m14:52:48.852956 [debug] [MainThread]: Flushing usage events
[0m14:52:48.850288 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m14:52:48.851650 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m14:52:48.853247 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.90s]
[0m14:52:48.855315 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696d3a2040>]}
[0m14:52:48.857229 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a51eb32-20f5-4276-a2c2-236ea70bdf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696d9ddbb0>]}
[0m14:52:48.859956 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m14:52:48.862813 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.91s]
[0m14:52:48.865862 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.92s]
[0m14:52:48.870276 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m14:52:48.872516 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m14:52:48.878072 [debug] [MainThread]: On master: COMMIT
[0m14:52:48.879750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:48.881218 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m14:52:48.882430 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m14:52:48.883736 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m14:52:48.884949 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m14:52:48.886512 [info ] [MainThread]: 
[0m14:52:48.888066 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m14:52:48.891171 [debug] [MainThread]: Command end result
[0m14:52:49.005293 [info ] [MainThread]: 
[0m14:52:49.007243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:49.009023 [info ] [MainThread]: 
[0m14:52:49.011426 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:52:49.014088 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.557546, "process_user_time": 5.176881, "process_kernel_time": 1.802411, "process_mem_max_rss": "124092", "process_in_blocks": "464", "process_out_blocks": "256"}
[0m14:52:49.015901 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:49.015710 after 4.56 seconds
[0m14:52:49.017368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6971c6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c696c366790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c69702c0fd0>]}
[0m14:52:49.019133 [debug] [MainThread]: Flushing usage events
[0m14:52:56.353671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be487b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be27065e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be2706580>]}


============================== 14:52:56.362550 | 1b479662-89e9-4bac-8bbc-2114d084a199 ==============================
[0m14:52:56.362550 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:52:56.364839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:52:56.864346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b479662-89e9-4bac-8bbc-2114d084a199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be141e6a0>]}
[0m14:52:56.940738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b479662-89e9-4bac-8bbc-2114d084a199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be4a551f0>]}
[0m14:52:56.943145 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m14:52:57.095495 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:52:58.691463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:58.693062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:58.703312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m14:52:58.769691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b479662-89e9-4bac-8bbc-2114d084a199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be0e6bee0>]}
[0m14:52:59.027789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b479662-89e9-4bac-8bbc-2114d084a199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be2772a60>]}
[0m14:52:59.029773 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m14:52:59.031365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b479662-89e9-4bac-8bbc-2114d084a199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be4a74940>]}
[0m14:52:59.034316 [info ] [MainThread]: 
[0m14:52:59.036012 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:52:59.044048 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m14:52:59.067938 [debug] [ThreadPool]: dbt-sqlserver
[0m14:52:59.070229 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m14:52:59.071926 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:52:59.073852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:59.075972 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:59.118217 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:59.124635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:52:59.127628 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m14:52:59.129171 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m14:52:59.132635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b479662-89e9-4bac-8bbc-2114d084a199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be13a0550>]}
[0m14:52:59.134189 [debug] [MainThread]: On master: COMMIT
[0m14:52:59.136017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:59.137400 [info ] [MainThread]: 
[0m14:52:59.147871 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:59.148502 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:59.149340 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:59.150580 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m14:52:59.151944 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m14:52:59.153362 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m14:52:59.155143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m14:52:59.156926 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m14:52:59.158585 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m14:52:59.159817 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:59.161000 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:59.162475 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:59.187226 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:52:59.199030 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:52:59.204639 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:52:59.216293 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:59.217077 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:59.223904 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:59.264631 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m14:52:59.271162 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m14:52:59.276342 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m14:52:59.278560 [debug] [Thread-1  ]: local_md5(invocation_id): 551c5fd373bf3896d5944a2aa1a8df8b
[0m14:52:59.280608 [debug] [Thread-3  ]: local_md5(invocation_id): 551c5fd373bf3896d5944a2aa1a8df8b
[0m14:52:59.281982 [debug] [Thread-2  ]: local_md5(invocation_id): 551c5fd373bf3896d5944a2aa1a8df8b
[0m14:52:59.283741 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:52:59.285514 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:52:59.287090 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:52:59.296242 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m14:52:59.297753 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m14:52:59.300143 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_385f380dba788d158e43d9b784084377]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_385f380dba788d158e43d9b784084377]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_385f380dba788d158e43d9b784084377]
  ;')
[0m14:52:59.301877 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m14:52:59.303078 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_c1ac0ddfc7703fc7e698bd607a24a9f9]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_c1ac0ddfc7703fc7e698bd607a24a9f9]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_c1ac0ddfc7703fc7e698bd607a24a9f9]
  ;')
[0m14:52:59.305229 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:52:59.306663 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b646e11d900a5a691e1aa983d7138837]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b646e11d900a5a691e1aa983d7138837]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b646e11d900a5a691e1aa983d7138837]
  ;')
[0m14:52:59.308386 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:52:59.310100 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:59.312073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:59.313390 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:59.314651 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:59.315536 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m14:52:59.334088 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:59.339246 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m14:52:59.351916 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:52:59.360734 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m14:52:59.362619 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m14:52:59.365124 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.21s]
[0m14:52:59.368565 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m14:52:59.394997 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:52:59.398402 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m14:52:59.400016 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m14:52:59.401595 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.24s]
[0m14:52:59.403598 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m14:52:59.478834 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:52:59.482268 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m14:52:59.483491 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m14:52:59.485199 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.33s]
[0m14:52:59.487139 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m14:52:59.490676 [debug] [MainThread]: On master: COMMIT
[0m14:52:59.492223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:59.493698 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m14:52:59.495218 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m14:52:59.496713 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m14:52:59.498433 [info ] [MainThread]: 
[0m14:52:59.500307 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m14:52:59.502454 [debug] [MainThread]: Command end result
[0m14:52:59.591989 [info ] [MainThread]: 
[0m14:52:59.593849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:59.595487 [info ] [MainThread]: 
[0m14:52:59.597155 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:52:59.599486 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.425635, "process_user_time": 3.192241, "process_kernel_time": 0.547008, "process_mem_max_rss": "123896", "process_in_blocks": "16376", "process_out_blocks": "256"}
[0m14:52:59.601123 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:59.600954 after 3.43 seconds
[0m14:52:59.602178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be487b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be2db03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774be4a551f0>]}
[0m14:52:59.603390 [debug] [MainThread]: Flushing usage events
[0m15:00:12.512114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76acd16e5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accf56e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accf56e580>]}


============================== 15:00:12.517525 | 34f2956b-44ab-4720-84bb-2ad2c6e581bf ==============================
[0m15:00:12.517525 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:00:12.519108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:00:12.955281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76acce2021c0>]}
[0m15:00:13.028003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accf5db580>]}
[0m15:00:13.030355 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m15:00:13.180101 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:00:14.471477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:14.472538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:14.479293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m15:00:14.519447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accdcd3ee0>]}
[0m15:00:14.713296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accde621c0>]}
[0m15:00:14.714504 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m15:00:14.715620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76acce1a49a0>]}
[0m15:00:14.718521 [info ] [MainThread]: 
[0m15:00:14.720248 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:00:14.728996 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m15:00:14.749144 [debug] [ThreadPool]: dbt-sqlserver
[0m15:00:14.751044 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m15:00:14.752644 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:00:14.754352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:14.755872 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:14.841565 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:14.845414 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:00:14.848559 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m15:00:14.850756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m15:00:14.858122 [debug] [ThreadPool]: dbt-sqlserver
[0m15:00:14.859358 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m15:00:14.860172 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:00:14.861043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:14.861887 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:14.862745 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:14.869495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:00:14.871671 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m15:00:14.872842 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m15:00:14.874873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76acce1a49a0>]}
[0m15:00:14.875883 [debug] [MainThread]: On master: COMMIT
[0m15:00:14.876923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:14.877923 [info ] [MainThread]: 
[0m15:00:14.883403 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m15:00:14.884144 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m15:00:14.884634 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m15:00:14.885158 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m15:00:14.886095 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m15:00:14.887415 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m15:00:14.888624 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m15:00:14.890038 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m15:00:14.891288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m15:00:14.892344 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m15:00:14.893316 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m15:00:14.894250 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m15:00:14.895095 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m15:00:14.895931 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m15:00:14.896872 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m15:00:14.897665 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m15:00:14.908350 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m15:00:14.912182 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m15:00:14.916605 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m15:00:14.923613 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:00:14.931229 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m15:00:14.932194 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m15:00:14.939429 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m15:00:14.939924 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m15:00:14.991834 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m15:00:14.993305 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m15:00:14.998290 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m15:00:15.005554 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:00:15.014074 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:00:15.014907 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:00:15.016686 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m15:00:15.017340 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:00:15.017980 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:00:15.018904 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m15:00:15.020734 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:00:15.021739 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m15:00:15.022727 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m15:00:15.023597 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:00:15.024538 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:15.025389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:15.026267 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:00:15.027248 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:15.028970 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:15.030280 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:15.046078 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:15.051089 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:15.051728 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:15.055740 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:15.071353 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.072088 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.079814 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.080403 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.082740 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:00:15.087638 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:00:15.092370 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:00:15.097087 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:00:15.097887 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m15:00:15.098988 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m15:00:15.100067 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m15:00:15.101095 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m15:00:15.127125 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.127554 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.127962 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.128310 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.132403 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:00:15.136423 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:00:15.140393 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:00:15.144738 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:00:15.145681 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m15:00:15.146650 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m15:00:15.147609 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m15:00:15.148530 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m15:00:15.157926 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.158356 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.158779 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.159115 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.175726 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m15:00:15.177197 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m15:00:15.179208 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m15:00:15.181537 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m15:00:15.188579 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m15:00:15.192010 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m15:00:15.196406 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m15:00:15.200789 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m15:00:15.208264 [debug] [Thread-4  ]: dbt-sqlserver
[0m15:00:15.209754 [debug] [Thread-2  ]: dbt-sqlserver
[0m15:00:15.211497 [debug] [Thread-3  ]: dbt-sqlserver
[0m15:00:15.212957 [debug] [Thread-1  ]: dbt-sqlserver
[0m15:00:15.214069 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:00:15.215221 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:00:15.216214 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:00:15.217173 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:00:15.218276 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:00:15.219318 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:00:15.220480 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:00:15.221279 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:00:15.225812 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.226340 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.226980 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.228828 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:00:15.229291 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.230832 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:00:15.232500 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:00:15.233107 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m15:00:15.234868 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:00:15.235470 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m15:00:15.236312 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m15:00:15.237738 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m15:00:15.245541 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.246753 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.247179 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.247523 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:00:15.249942 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m15:00:15.251950 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m15:00:15.253416 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m15:00:15.254977 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m15:00:15.255785 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m15:00:15.256394 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m15:00:15.257167 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m15:00:15.257812 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m15:00:15.259553 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accd453df0>]}
[0m15:00:15.260639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accd4530d0>]}
[0m15:00:15.261347 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76acce1a49a0>]}
[0m15:00:15.262289 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2956b-44ab-4720-84bb-2ad2c6e581bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accdcd8880>]}
[0m15:00:15.263915 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.36s]
[0m15:00:15.265254 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.37s]
[0m15:00:15.266404 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.37s]
[0m15:00:15.267545 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.37s]
[0m15:00:15.268764 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m15:00:15.269827 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m15:00:15.270847 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m15:00:15.271815 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m15:00:15.275686 [debug] [MainThread]: On master: COMMIT
[0m15:00:15.276598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:15.277415 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m15:00:15.278134 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m15:00:15.278812 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m15:00:15.279467 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m15:00:15.280184 [info ] [MainThread]: 
[0m15:00:15.281060 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m15:00:15.282611 [debug] [MainThread]: Command end result
[0m15:00:15.338107 [info ] [MainThread]: 
[0m15:00:15.339331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:15.340367 [info ] [MainThread]: 
[0m15:00:15.341473 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:00:15.343084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.926212, "process_user_time": 2.415395, "process_kernel_time": 0.750297, "process_mem_max_rss": "124860", "process_in_blocks": "936", "process_out_blocks": "0"}
[0m15:00:15.344016 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:15.343909 after 2.93 seconds
[0m15:00:15.344874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76acd16e5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accc56cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76accf5b7e80>]}
[0m15:00:15.345674 [debug] [MainThread]: Flushing usage events
[0m15:00:20.008591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b9a0006a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b97e8b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b97e8b550>]}


============================== 15:00:20.012429 | bf1f2a7f-43de-4972-9dd0-2e7a3c824af1 ==============================
[0m15:00:20.012429 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:00:20.013729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:00:20.238462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf1f2a7f-43de-4972-9dd0-2e7a3c824af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b96b2e340>]}
[0m15:00:20.284962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf1f2a7f-43de-4972-9dd0-2e7a3c824af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b97ef7e50>]}
[0m15:00:20.287241 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m15:00:20.388558 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:00:21.254287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:21.255277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:21.262214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m15:00:21.301236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf1f2a7f-43de-4972-9dd0-2e7a3c824af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b965eff40>]}
[0m15:00:21.503040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf1f2a7f-43de-4972-9dd0-2e7a3c824af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b97ef7a60>]}
[0m15:00:21.504958 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m15:00:21.506512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1f2a7f-43de-4972-9dd0-2e7a3c824af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b97ee99a0>]}
[0m15:00:21.509388 [info ] [MainThread]: 
[0m15:00:21.511050 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:00:21.517789 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m15:00:21.534523 [debug] [ThreadPool]: dbt-sqlserver
[0m15:00:21.536740 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m15:00:21.538384 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:00:21.540010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:21.541564 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:21.566946 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:21.571344 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:00:21.573584 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m15:00:21.574611 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m15:00:21.576767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1f2a7f-43de-4972-9dd0-2e7a3c824af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b97f1d1f0>]}
[0m15:00:21.578068 [debug] [MainThread]: On master: COMMIT
[0m15:00:21.579284 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:21.580493 [info ] [MainThread]: 
[0m15:00:21.584713 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:00:21.585166 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:00:21.585603 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:00:21.586526 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m15:00:21.587801 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m15:00:21.589013 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m15:00:21.590177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m15:00:21.591190 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m15:00:21.592151 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m15:00:21.593169 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:00:21.594109 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:00:21.595046 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:00:21.614283 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m15:00:21.622315 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m15:00:21.627121 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m15:00:21.636887 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:00:21.638113 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:00:21.644508 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:00:21.661406 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m15:00:21.663652 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m15:00:21.667400 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m15:00:21.669386 [debug] [Thread-1  ]: local_md5(invocation_id): 566367efcf3ed087e0335bf2590d1f97
[0m15:00:21.671198 [debug] [Thread-2  ]: local_md5(invocation_id): 566367efcf3ed087e0335bf2590d1f97
[0m15:00:21.672804 [debug] [Thread-3  ]: local_md5(invocation_id): 566367efcf3ed087e0335bf2590d1f97
[0m15:00:21.674853 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m15:00:21.676160 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m15:00:21.677402 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m15:00:21.684931 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m15:00:21.686878 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m15:00:21.688287 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_5bf707452a6b36b3df4c24f24903c188]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_5bf707452a6b36b3df4c24f24903c188]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_5bf707452a6b36b3df4c24f24903c188]
  ;')
[0m15:00:21.689110 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m15:00:21.690340 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3e07196234cc01f33617c4069b36c3c4]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3e07196234cc01f33617c4069b36c3c4]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3e07196234cc01f33617c4069b36c3c4]
  ;')
[0m15:00:21.691863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:21.693018 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_322c279e3d19956931d638922622aacd]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_322c279e3d19956931d638922622aacd]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_322c279e3d19956931d638922622aacd]
  ;')
[0m15:00:21.693949 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:00:21.694925 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:21.695925 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:00:21.696758 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:21.697655 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:21.698264 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:00:21.711561 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:21.714788 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:00:21.736386 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:00:21.744227 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m15:00:21.745754 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m15:00:21.746994 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.15s]
[0m15:00:21.748419 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:00:21.772188 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:00:21.774687 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m15:00:21.775620 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m15:00:21.776736 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.19s]
[0m15:00:21.778152 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:00:21.815211 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:00:21.818134 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m15:00:21.819675 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m15:00:21.821207 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.23s]
[0m15:00:21.822597 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:00:21.824658 [debug] [MainThread]: On master: COMMIT
[0m15:00:21.825583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:21.826312 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m15:00:21.826966 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m15:00:21.827598 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m15:00:21.828390 [info ] [MainThread]: 
[0m15:00:21.829277 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:00:21.830924 [debug] [MainThread]: Command end result
[0m15:00:21.899701 [info ] [MainThread]: 
[0m15:00:21.900828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:21.901872 [info ] [MainThread]: 
[0m15:00:21.902878 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:00:21.904224 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9707005, "process_user_time": 1.886975, "process_kernel_time": 0.236893, "process_mem_max_rss": "123108", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:00:21.905165 [debug] [MainThread]: Command `dbt test` succeeded at 15:00:21.905060 after 1.97 seconds
[0m15:00:21.905975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b9a0006a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b98af6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b97ef7a60>]}
[0m15:00:21.906760 [debug] [MainThread]: Flushing usage events
[0m15:02:04.891590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78179505e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781792ee75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781792ee7580>]}


============================== 15:02:04.895721 | 0cb080a1-13b5-47e7-8519-7b2cd389617a ==============================
[0m15:02:04.895721 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:02:04.897235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:02:05.128452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781791b7d1c0>]}
[0m15:02:05.179135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781792f54580>]}
[0m15:02:05.181325 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m15:02:05.282652 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:02:06.239880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:06.241005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:06.248759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m15:02:06.287745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78179164cee0>]}
[0m15:02:06.476998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7817917db1c0>]}
[0m15:02:06.479338 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m15:02:06.480695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781791b1d9a0>]}
[0m15:02:06.483263 [info ] [MainThread]: 
[0m15:02:06.484789 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:02:06.490901 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m15:02:06.506528 [debug] [ThreadPool]: dbt-sqlserver
[0m15:02:06.509085 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m15:02:06.511110 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:02:06.513290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:06.515407 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:06.544508 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:06.547731 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:06.549729 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m15:02:06.551672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m15:02:06.558487 [debug] [ThreadPool]: dbt-sqlserver
[0m15:02:06.559435 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m15:02:06.560250 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:02:06.561172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:06.562143 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:06.563023 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:06.567535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:06.569329 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m15:02:06.570097 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m15:02:06.572029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781791b1d9a0>]}
[0m15:02:06.572890 [debug] [MainThread]: On master: COMMIT
[0m15:02:06.573826 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:02:06.574736 [info ] [MainThread]: 
[0m15:02:06.578303 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m15:02:06.578916 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m15:02:06.579321 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m15:02:06.579662 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m15:02:06.580548 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m15:02:06.581590 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m15:02:06.582715 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m15:02:06.583746 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m15:02:06.584833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m15:02:06.585798 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m15:02:06.586798 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m15:02:06.587728 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m15:02:06.588616 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m15:02:06.589423 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m15:02:06.590273 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m15:02:06.591125 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m15:02:06.601119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m15:02:06.604731 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m15:02:06.608824 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m15:02:06.613619 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:02:06.621121 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m15:02:06.622216 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m15:02:06.622913 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m15:02:06.629250 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m15:02:06.664918 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m15:02:06.665562 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m15:02:06.669703 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m15:02:06.675077 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:02:06.683246 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:02:06.684751 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:02:06.686103 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m15:02:06.686943 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:02:06.688154 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m15:02:06.688748 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:02:06.689791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:02:06.690890 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m15:02:06.691943 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:02:06.692925 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m15:02:06.694367 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:06.695480 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:02:06.696606 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:06.697514 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:02:06.698876 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:06.699594 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:06.701379 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:06.713532 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.721131 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:06.723554 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:02:06.724030 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:06.724405 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:06.725567 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m15:02:06.735567 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.736068 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.736472 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.736825 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.740992 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:02:06.745089 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:02:06.749065 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:02:06.752609 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:02:06.753344 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m15:02:06.754275 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m15:02:06.755244 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m15:02:06.756147 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m15:02:06.766002 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.766507 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.766949 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.767319 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.771194 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:02:06.775476 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:02:06.779147 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:02:06.795164 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m15:02:06.796170 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m15:02:06.797726 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m15:02:06.799392 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m15:02:06.805644 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m15:02:06.817426 [debug] [Thread-1  ]: dbt-sqlserver
[0m15:02:06.818196 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.818643 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.819087 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.819977 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:02:06.822174 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m15:02:06.823973 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m15:02:06.826040 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m15:02:06.827193 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:02:06.831243 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m15:02:06.835261 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m15:02:06.839622 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m15:02:06.842386 [debug] [Thread-2  ]: dbt-sqlserver
[0m15:02:06.843803 [debug] [Thread-3  ]: dbt-sqlserver
[0m15:02:06.844414 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.845831 [debug] [Thread-4  ]: dbt-sqlserver
[0m15:02:06.847076 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:02:06.848051 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:02:06.849917 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m15:02:06.850520 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:02:06.851476 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:02:06.852405 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:02:06.853299 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m15:02:06.854246 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:02:06.857299 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.857926 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.860423 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m15:02:06.862596 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m15:02:06.863238 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.863584 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.863947 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m15:02:06.864897 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m15:02:06.867002 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m15:02:06.869765 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m15:02:06.871927 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m15:02:06.872961 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m15:02:06.875806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781790dcc4f0>]}
[0m15:02:06.877256 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.29s]
[0m15:02:06.879091 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m15:02:06.881486 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.881925 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.882468 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:02:06.884011 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m15:02:06.885634 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m15:02:06.887084 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m15:02:06.887988 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m15:02:06.888612 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m15:02:06.889307 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m15:02:06.890280 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781790dccdf0>]}
[0m15:02:06.891401 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781791651880>]}
[0m15:02:06.892156 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb080a1-13b5-47e7-8519-7b2cd389617a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781791b1d9a0>]}
[0m15:02:06.893259 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.30s]
[0m15:02:06.894542 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.30s]
[0m15:02:06.896158 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.31s]
[0m15:02:06.897545 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m15:02:06.898657 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m15:02:06.899710 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m15:02:06.902986 [debug] [MainThread]: On master: COMMIT
[0m15:02:06.903965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:06.904829 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m15:02:06.905584 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m15:02:06.906353 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m15:02:06.907059 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m15:02:06.907838 [info ] [MainThread]: 
[0m15:02:06.908720 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:02:06.910484 [debug] [MainThread]: Command end result
[0m15:02:06.970197 [info ] [MainThread]: 
[0m15:02:06.971415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:06.973668 [info ] [MainThread]: 
[0m15:02:06.975974 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:02:06.979769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1702209, "process_user_time": 1.845227, "process_kernel_time": 0.259049, "process_mem_max_rss": "124380", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:02:06.982281 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:06.982133 after 2.17 seconds
[0m15:02:06.983738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78179505e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7817935ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781792f54580>]}
[0m15:02:06.984673 [debug] [MainThread]: Flushing usage events
[0m15:02:10.910021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76786844c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7678662d65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7678662d6580>]}


============================== 15:02:10.914672 | ab914de4-d5ad-4b11-ab19-306d65cbe506 ==============================
[0m15:02:10.914672 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:02:10.916097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:02:11.164980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab914de4-d5ad-4b11-ab19-306d65cbe506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767864f6b1c0>]}
[0m15:02:11.214619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab914de4-d5ad-4b11-ab19-306d65cbe506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767866342580>]}
[0m15:02:11.216938 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m15:02:11.323931 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:02:12.265473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:12.266562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:12.273835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m15:02:12.317265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab914de4-d5ad-4b11-ab19-306d65cbe506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767864a3aee0>]}
[0m15:02:12.504056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab914de4-d5ad-4b11-ab19-306d65cbe506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767864a40b20>]}
[0m15:02:12.505114 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m15:02:12.506163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab914de4-d5ad-4b11-ab19-306d65cbe506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76786631fe20>]}
[0m15:02:12.508650 [info ] [MainThread]: 
[0m15:02:12.509947 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:02:12.516954 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m15:02:12.536005 [debug] [ThreadPool]: dbt-sqlserver
[0m15:02:12.537732 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m15:02:12.539757 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:02:12.541626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:12.543443 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:12.569125 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:12.574075 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:12.576114 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m15:02:12.577070 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m15:02:12.579257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab914de4-d5ad-4b11-ab19-306d65cbe506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767864a40ac0>]}
[0m15:02:12.580235 [debug] [MainThread]: On master: COMMIT
[0m15:02:12.581081 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:02:12.582027 [info ] [MainThread]: 
[0m15:02:12.585679 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:02:12.586226 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:02:12.586588 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:02:12.587323 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m15:02:12.588441 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m15:02:12.589375 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m15:02:12.590608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m15:02:12.591490 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m15:02:12.592430 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m15:02:12.593263 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:02:12.594096 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:02:12.594960 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:02:12.613197 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m15:02:12.621176 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m15:02:12.625917 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m15:02:12.637719 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:02:12.639434 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:02:12.645879 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:02:12.663181 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m15:02:12.666007 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m15:02:12.669181 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m15:02:12.670639 [debug] [Thread-3  ]: local_md5(invocation_id): a609ff9ae7dc8b20748537edd28b21b3
[0m15:02:12.672066 [debug] [Thread-1  ]: local_md5(invocation_id): a609ff9ae7dc8b20748537edd28b21b3
[0m15:02:12.673376 [debug] [Thread-2  ]: local_md5(invocation_id): a609ff9ae7dc8b20748537edd28b21b3
[0m15:02:12.675090 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m15:02:12.676778 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m15:02:12.678284 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m15:02:12.684891 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m15:02:12.685827 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m15:02:12.687484 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_768ca28fdf84b8cbf5a7744d8abc9f43]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_768ca28fdf84b8cbf5a7744d8abc9f43]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_768ca28fdf84b8cbf5a7744d8abc9f43]
  ;')
[0m15:02:12.688973 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m15:02:12.689575 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3aa829042c5646141ea2fe73f0aa5caf]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3aa829042c5646141ea2fe73f0aa5caf]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3aa829042c5646141ea2fe73f0aa5caf]
  ;')
[0m15:02:12.691239 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:02:12.692384 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_1889cc336d0da740893257e016e7e7a3]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_1889cc336d0da740893257e016e7e7a3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_1889cc336d0da740893257e016e7e7a3]
  ;')
[0m15:02:12.693274 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:02:12.694299 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:12.695248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:02:12.696295 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:12.697231 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:12.697826 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m15:02:12.712527 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:12.713798 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m15:02:12.715608 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m15:02:12.721130 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m15:02:12.722358 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m15:02:12.723647 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.13s]
[0m15:02:12.725122 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m15:02:12.804161 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m15:02:12.806769 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m15:02:12.808091 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m15:02:12.809245 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.22s]
[0m15:02:12.810557 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m15:02:12.845062 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:02:12.847978 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m15:02:12.848974 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m15:02:12.850040 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.26s]
[0m15:02:12.851268 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m15:02:12.853594 [debug] [MainThread]: On master: COMMIT
[0m15:02:12.854800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:12.855570 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m15:02:12.856313 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m15:02:12.856943 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m15:02:12.857663 [info ] [MainThread]: 
[0m15:02:12.858750 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:02:12.860524 [debug] [MainThread]: Command end result
[0m15:02:12.918267 [info ] [MainThread]: 
[0m15:02:12.919525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:12.920722 [info ] [MainThread]: 
[0m15:02:12.921731 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:02:12.923109 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0852757, "process_user_time": 1.844018, "process_kernel_time": 0.21885, "process_mem_max_rss": "123204", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:02:12.923998 [debug] [MainThread]: Command `dbt test` succeeded at 15:02:12.923892 after 2.09 seconds
[0m15:02:12.924857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76786844c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7678669803d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767866342580>]}
[0m15:02:12.925635 [debug] [MainThread]: Flushing usage events
[0m22:24:40.741469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127c3b8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127a26b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127a26ba30>]}


============================== 22:24:40.751388 | bf1ba2b8-6d48-49e6-b0c5-2af0620f5475 ==============================
[0m22:24:40.751388 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:24:40.753600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:24:41.508584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1278ee21c0>]}
[0m22:24:41.599530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127a241550>]}
[0m22:24:41.616138 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:24:41.872827 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:24:43.506486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:43.507867 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:43.518823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m22:24:43.588351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12789a6e80>]}
[0m22:24:43.923277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1278b354c0>]}
[0m22:24:43.924836 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:24:43.926505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127aa100a0>]}
[0m22:24:43.930084 [info ] [MainThread]: 
[0m22:24:43.932124 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:24:43.941667 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:24:43.973405 [debug] [ThreadPool]: dbt-sqlserver
[0m22:24:43.975238 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:24:43.976689 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:24:43.978281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:43.979978 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:44.435280 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:44.452382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:44.455700 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:24:44.458820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m22:24:44.469131 [debug] [ThreadPool]: dbt-sqlserver
[0m22:24:44.470871 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:24:44.472469 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:24:44.473957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:44.475593 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:44.477210 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:44.627361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:44.630936 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:24:44.632293 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:24:44.635085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127aa100a0>]}
[0m22:24:44.636989 [debug] [MainThread]: On master: COMMIT
[0m22:24:44.638894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:44.640362 [info ] [MainThread]: 
[0m22:24:44.648343 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m22:24:44.649361 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m22:24:44.650027 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m22:24:44.650649 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:24:44.651700 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m22:24:44.653119 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m22:24:44.654695 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m22:24:44.656258 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m22:24:44.657890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m22:24:44.659539 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m22:24:44.662152 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m22:24:44.663821 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m22:24:44.664900 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m22:24:44.666084 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m22:24:44.667128 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m22:24:44.668469 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m22:24:44.684857 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m22:24:44.690486 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m22:24:44.699545 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m22:24:44.706713 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:24:44.716770 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m22:24:44.718357 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m22:24:44.741944 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m22:24:44.742525 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m22:24:44.804186 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m22:24:44.802657 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m22:24:44.807023 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:24:44.815779 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m22:24:44.832309 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:24:44.833142 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:24:44.834685 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:24:44.835431 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:24:44.837168 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:24:44.837866 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:24:44.839215 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:24:44.840740 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:24:44.842075 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:24:44.843609 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:24:44.845359 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:24:44.847116 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:44.848769 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:44.850566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:44.852010 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:44.853638 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:44.855644 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:44.895059 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:44.895936 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:44.904708 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:44.913113 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:24:44.932708 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:24:44.933404 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:24:44.934058 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:24:44.935051 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m22:24:44.937398 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:24:44.944007 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:24:44.951176 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:24:44.959884 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:24:44.962633 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m22:24:44.967176 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m22:24:44.968879 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m22:24:45.320446 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.321194 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.321863 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.322624 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.331203 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:24:45.339112 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:24:45.348924 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:24:45.354382 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:24:45.355477 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m22:24:45.356819 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m22:24:45.358114 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m22:24:45.359487 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m22:24:45.372293 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.373084 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.381891 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.382753 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.411767 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m22:24:45.413245 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m22:24:45.415989 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m22:24:45.418484 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m22:24:45.429457 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m22:24:45.435630 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m22:24:45.440919 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m22:24:45.446894 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m22:24:45.457975 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:24:45.459596 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:24:45.462539 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:24:45.464690 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:24:45.466443 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:24:45.467784 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:24:45.469185 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:24:45.470758 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:24:45.472250 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:24:45.474089 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:24:45.475395 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:24:45.476871 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:24:45.550288 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.551148 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.551807 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.552336 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.555678 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:24:45.558001 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:24:45.561309 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:24:45.564387 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:24:45.565874 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m22:24:45.567567 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m22:24:45.568944 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m22:24:45.570406 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m22:24:45.588847 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.589497 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.590101 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.590553 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:24:45.595565 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m22:24:45.598441 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m22:24:45.601018 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m22:24:45.603512 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m22:24:45.604807 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m22:24:45.605824 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m22:24:45.606861 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m22:24:45.607738 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m22:24:45.611426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127811a6a0>]}
[0m22:24:45.613585 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127aa100a0>]}
[0m22:24:45.615014 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127811a940>]}
[0m22:24:45.616527 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1ba2b8-6d48-49e6-b0c5-2af0620f5475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127a2ae580>]}
[0m22:24:45.618244 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.95s]
[0m22:24:45.620204 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.95s]
[0m22:24:45.622040 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.95s]
[0m22:24:45.623942 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.96s]
[0m22:24:45.625800 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m22:24:45.628606 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m22:24:45.630792 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:24:45.632833 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m22:24:45.638588 [debug] [MainThread]: On master: COMMIT
[0m22:24:45.640020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:45.641137 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m22:24:45.642206 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m22:24:45.643314 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m22:24:45.644802 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m22:24:45.646553 [info ] [MainThread]: 
[0m22:24:45.647905 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m22:24:45.651075 [debug] [MainThread]: Command end result
[0m22:24:45.754536 [info ] [MainThread]: 
[0m22:24:45.756390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:45.758024 [info ] [MainThread]: 
[0m22:24:45.759871 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:24:45.763757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.144583, "process_user_time": 3.823694, "process_kernel_time": 1.021286, "process_mem_max_rss": "124836", "process_in_blocks": "95168", "process_out_blocks": "0"}
[0m22:24:45.765498 [debug] [MainThread]: Command `dbt run` succeeded at 22:24:45.765322 after 5.15 seconds
[0m22:24:45.766733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b127c3b8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1278126310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1278b35ca0>]}
[0m22:24:45.767908 [debug] [MainThread]: Flushing usage events
[0m22:24:51.438436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ade6b1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adc53b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adc53b580>]}


============================== 22:24:51.444574 | 1523251c-66f9-49a4-b5a6-d0e6429f6655 ==============================
[0m22:24:51.444574 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:24:51.447019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:51.922260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1523251c-66f9-49a4-b5a6-d0e6429f6655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adb1d01c0>]}
[0m22:24:52.015717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1523251c-66f9-49a4-b5a6-d0e6429f6655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adc5a7580>]}
[0m22:24:52.018031 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:24:52.205865 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:24:54.020152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:54.022912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:54.037145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.intermediate
- models.dbt_sqlserver_project.marts
[0m22:24:54.113405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1523251c-66f9-49a4-b5a6-d0e6429f6655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adac9fee0>]}
[0m22:24:54.467086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1523251c-66f9-49a4-b5a6-d0e6429f6655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adaca5b20>]}
[0m22:24:54.469050 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:24:54.470927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1523251c-66f9-49a4-b5a6-d0e6429f6655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adc583e20>]}
[0m22:24:54.474160 [info ] [MainThread]: 
[0m22:24:54.476393 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:24:54.486785 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m22:24:54.521762 [debug] [ThreadPool]: dbt-sqlserver
[0m22:24:54.523555 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:24:54.524935 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:24:54.529252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:54.531140 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:54.619029 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:54.629005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:54.633148 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:24:54.634679 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:24:54.637546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1523251c-66f9-49a4-b5a6-d0e6429f6655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adaca5ac0>]}
[0m22:24:54.638794 [debug] [MainThread]: On master: COMMIT
[0m22:24:54.640037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:54.641161 [info ] [MainThread]: 
[0m22:24:54.649009 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:24:54.649882 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:24:54.650615 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:24:54.651875 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:24:54.653555 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m22:24:54.655472 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m22:24:54.657137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m22:24:54.658799 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m22:24:54.660962 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m22:24:54.662677 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:24:54.664247 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:24:54.665971 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:24:54.738851 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:24:54.757386 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:24:54.758162 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:24:54.771539 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:24:54.773517 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:24:54.779867 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:24:54.837870 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m22:24:54.861676 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m22:24:54.866238 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m22:24:54.868583 [debug] [Thread-3  ]: local_md5(invocation_id): 06f26c88ff24922285e9d4305c06b9f3
[0m22:24:54.870638 [debug] [Thread-2  ]: local_md5(invocation_id): 06f26c88ff24922285e9d4305c06b9f3
[0m22:24:54.872455 [debug] [Thread-1  ]: local_md5(invocation_id): 06f26c88ff24922285e9d4305c06b9f3
[0m22:24:54.874557 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:24:54.877098 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:24:54.879579 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:24:54.889174 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:24:54.890738 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:24:54.891842 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_1390e963c60fb5233bccb01b062d1c86]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_1390e963c60fb5233bccb01b062d1c86]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_1390e963c60fb5233bccb01b062d1c86]
  ;')
[0m22:24:54.893880 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:24:54.895378 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_e41bde40f741a0075525462ccd89a969]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_e41bde40f741a0075525462ccd89a969]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_e41bde40f741a0075525462ccd89a969]
  ;')
[0m22:24:54.897222 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:24:54.898899 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_1405475d46d78ffcf295f70eaee7a303]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_1405475d46d78ffcf295f70eaee7a303]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_1405475d46d78ffcf295f70eaee7a303]
  ;')
[0m22:24:54.900226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:54.901446 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:54.902728 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:24:54.903934 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:54.905412 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:54.906371 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:24:54.933529 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:54.934273 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:24:54.983158 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:24:54.996227 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m22:24:54.999684 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m22:24:55.002015 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.34s]
[0m22:24:55.004027 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:24:55.149825 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:24:55.153289 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m22:24:55.154888 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m22:24:55.156539 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.50s]
[0m22:24:55.158800 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:24:55.231668 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:24:55.235154 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m22:24:55.237189 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m22:24:55.239191 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.58s]
[0m22:24:55.241434 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:24:55.245703 [debug] [MainThread]: On master: COMMIT
[0m22:24:55.247532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:55.248808 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m22:24:55.250053 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m22:24:55.251299 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m22:24:55.252778 [info ] [MainThread]: 
[0m22:24:55.254258 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m22:24:55.257377 [debug] [MainThread]: Command end result
[0m22:24:55.380569 [info ] [MainThread]: 
[0m22:24:55.382714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:55.384642 [info ] [MainThread]: 
[0m22:24:55.386863 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:24:55.390744 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.0734487, "process_user_time": 3.230352, "process_kernel_time": 1.020544, "process_mem_max_rss": "124028", "process_in_blocks": "7952", "process_out_blocks": "0"}
[0m22:24:55.392456 [debug] [MainThread]: Command `dbt test` succeeded at 22:24:55.392189 after 4.08 seconds
[0m22:24:55.395612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ade6b1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adcbe53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794adc5a7580>]}
[0m22:24:55.397773 [debug] [MainThread]: Flushing usage events
[0m22:29:38.335168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37efc1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37ce74610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37ce74a30>]}


============================== 22:29:38.342672 | e2340a24-dad1-4fc0-9943-caa8a1b3d656 ==============================
[0m22:29:38.342672 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:38.344470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:39.115496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37baeb1c0>]}
[0m22:29:39.224517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37ce4a550>]}
[0m22:29:39.226473 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:29:39.438230 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:29:40.855748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:40.857318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:40.867792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m22:29:40.926748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37b5afe80>]}
[0m22:29:41.176633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37b73b4c0>]}
[0m22:29:41.177851 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:29:41.178935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37d61a0a0>]}
[0m22:29:41.181596 [info ] [MainThread]: 
[0m22:29:41.183108 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:29:41.193989 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:29:41.216330 [debug] [ThreadPool]: dbt-sqlserver
[0m22:29:41.217883 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:29:41.219213 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:29:41.220611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:41.222271 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:41.335521 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:41.342751 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:41.345655 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:29:41.348157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m22:29:41.358503 [debug] [ThreadPool]: dbt-sqlserver
[0m22:29:41.360446 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:29:41.362886 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:29:41.365673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:41.367495 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:41.369142 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:41.387174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:41.391329 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:29:41.392801 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:29:41.395731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37d61a0a0>]}
[0m22:29:41.397267 [debug] [MainThread]: On master: COMMIT
[0m22:29:41.398979 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:41.400405 [info ] [MainThread]: 
[0m22:29:41.407849 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m22:29:41.408688 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m22:29:41.409195 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m22:29:41.409858 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:29:41.410799 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m22:29:41.412219 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m22:29:41.413994 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m22:29:41.415744 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m22:29:41.417679 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m22:29:41.419699 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m22:29:41.422152 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m22:29:41.424598 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m22:29:41.425845 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m22:29:41.427013 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m22:29:41.428397 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m22:29:41.429876 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m22:29:41.446045 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m22:29:41.452177 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m22:29:41.459851 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m22:29:41.466520 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:29:41.479422 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m22:29:41.480703 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m22:29:41.481974 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m22:29:41.489346 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m22:29:41.591846 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m22:29:41.592810 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m22:29:41.594869 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m22:29:41.600845 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:29:41.609258 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:29:41.611488 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:29:41.612154 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:29:41.612796 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:29:41.614391 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:29:41.616212 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:29:41.616873 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:29:41.617797 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:29:41.619181 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:41.620662 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:29:41.622319 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:29:41.623929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:29:41.625322 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:41.626264 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:41.627437 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:29:41.628752 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:41.631803 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:41.654626 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:41.657637 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:41.659395 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:41.676653 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.690320 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.691015 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.692033 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:29:41.694232 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.699429 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:29:41.706077 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:29:41.707430 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m22:29:41.713569 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:29:41.714701 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m22:29:41.716189 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m22:29:41.718572 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m22:29:41.754530 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.755563 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.756772 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.764359 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:29:41.765029 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.770063 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:29:41.777860 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:29:41.779224 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m22:29:41.784706 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:29:41.786484 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m22:29:41.787984 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m22:29:41.791078 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m22:29:41.804025 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.804954 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.805910 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.806409 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.834971 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m22:29:41.835670 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m22:29:41.838181 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m22:29:41.841744 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m22:29:41.852014 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m22:29:41.857813 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m22:29:41.862870 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m22:29:41.868571 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m22:29:41.879547 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:29:41.881352 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:29:41.883081 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:29:41.884707 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:29:41.885855 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:29:41.887149 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:29:41.889128 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:29:41.890483 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:29:41.891659 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:29:41.893100 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:29:41.894272 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:29:41.895534 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:29:41.902260 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.902899 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.907920 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:29:41.908611 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.909264 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.911014 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:29:41.911892 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m22:29:41.914754 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:29:41.917354 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:29:41.918313 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m22:29:41.920877 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m22:29:41.925600 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m22:29:41.930452 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.935109 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m22:29:41.936717 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m22:29:41.940423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37ad236a0>]}
[0m22:29:41.941132 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.941648 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.942055 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:29:41.943313 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.52s]
[0m22:29:41.946809 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m22:29:41.949648 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m22:29:41.954973 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m22:29:41.958507 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m22:29:41.961096 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m22:29:41.963357 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m22:29:41.965591 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m22:29:41.969024 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3786b0df0>]}
[0m22:29:41.970818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37d61a0a0>]}
[0m22:29:41.973138 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2340a24-dad1-4fc0-9943-caa8a1b3d656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37ad23940>]}
[0m22:29:41.974854 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.55s]
[0m22:29:41.976983 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.55s]
[0m22:29:41.978781 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.55s]
[0m22:29:41.980550 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m22:29:41.981959 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m22:29:41.983496 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:29:41.989220 [debug] [MainThread]: On master: COMMIT
[0m22:29:41.990856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:41.992017 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m22:29:41.993138 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m22:29:41.994156 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m22:29:41.995271 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m22:29:41.996662 [info ] [MainThread]: 
[0m22:29:41.997867 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m22:29:42.000100 [debug] [MainThread]: Command end result
[0m22:29:42.086067 [info ] [MainThread]: 
[0m22:29:42.087884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:42.090111 [info ] [MainThread]: 
[0m22:29:42.091727 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:29:42.094869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8603985, "process_user_time": 3.275061, "process_kernel_time": 1.87663, "process_mem_max_rss": "124728", "process_in_blocks": "4528", "process_out_blocks": "0"}
[0m22:29:42.096335 [debug] [MainThread]: Command `dbt run` succeeded at 22:29:42.096151 after 3.86 seconds
[0m22:29:42.097878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37efc1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37ad2f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b37b73bca0>]}
[0m22:29:42.099570 [debug] [MainThread]: Flushing usage events
[0m22:29:46.632005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75363a6ad670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536398a4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753638572190>]}


============================== 22:29:46.638486 | 39d8db08-e3f1-4a3c-89e1-556498e4662e ==============================
[0m22:29:46.638486 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:46.641212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:47.020303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39d8db08-e3f1-4a3c-89e1-556498e4662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536386b2d60>]}
[0m22:29:47.094901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39d8db08-e3f1-4a3c-89e1-556498e4662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536385c9880>]}
[0m22:29:47.097506 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:29:47.244577 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:29:48.502592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:48.503822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:48.516126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.marts
- models.dbt_sqlserver_project.intermediate
[0m22:29:48.571736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39d8db08-e3f1-4a3c-89e1-556498e4662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753636c9bf10>]}
[0m22:29:48.836919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39d8db08-e3f1-4a3c-89e1-556498e4662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536385c9610>]}
[0m22:29:48.838673 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:29:48.840627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39d8db08-e3f1-4a3c-89e1-556498e4662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75363717c430>]}
[0m22:29:48.843805 [info ] [MainThread]: 
[0m22:29:48.845889 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:29:48.854793 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m22:29:48.886860 [debug] [ThreadPool]: dbt-sqlserver
[0m22:29:48.889489 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:29:48.891049 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:29:48.893019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:48.894922 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:48.926239 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:48.932097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:48.934778 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:29:48.935942 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:29:48.939148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39d8db08-e3f1-4a3c-89e1-556498e4662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75363717c430>]}
[0m22:29:48.940682 [debug] [MainThread]: On master: COMMIT
[0m22:29:48.941975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:48.943040 [info ] [MainThread]: 
[0m22:29:48.948236 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:29:48.948832 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:29:48.949480 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:29:48.950530 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:29:48.951950 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m22:29:48.953262 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m22:29:48.955319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m22:29:48.957196 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m22:29:48.958548 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m22:29:48.960030 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:29:48.961374 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:29:48.962505 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:29:48.992713 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:29:48.999112 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:29:49.006701 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:29:49.016907 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:29:49.018837 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:29:49.025378 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:29:49.062405 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m22:29:49.077290 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m22:29:49.074466 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m22:29:49.080041 [debug] [Thread-1  ]: local_md5(invocation_id): 289e8d5f75ee0485b4950981ad625264
[0m22:29:49.081696 [debug] [Thread-3  ]: local_md5(invocation_id): 289e8d5f75ee0485b4950981ad625264
[0m22:29:49.083891 [debug] [Thread-2  ]: local_md5(invocation_id): 289e8d5f75ee0485b4950981ad625264
[0m22:29:49.086390 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:29:49.088391 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:29:49.090727 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:29:49.105968 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:29:49.107820 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:29:49.108877 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_ff0b9ddd93be74fd72e65d3947e9e5f3]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_ff0b9ddd93be74fd72e65d3947e9e5f3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_ff0b9ddd93be74fd72e65d3947e9e5f3]
  ;')
[0m22:29:49.109963 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:29:49.110879 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_56f3e5f9429c339591a62dde4bf0ef7e]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_56f3e5f9429c339591a62dde4bf0ef7e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_56f3e5f9429c339591a62dde4bf0ef7e]
  ;')
[0m22:29:49.112554 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:29:49.113637 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_cb4bee4a18e6fbf1edbc534d03222f47]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_cb4bee4a18e6fbf1edbc534d03222f47]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_cb4bee4a18e6fbf1edbc534d03222f47]
  ;')
[0m22:29:49.115123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:29:49.116629 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:49.118065 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:29:49.119404 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:49.123459 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:29:49.139887 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:49.141800 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:49.143954 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:29:49.174247 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:29:49.184681 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m22:29:49.188356 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m22:29:49.190651 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.23s]
[0m22:29:49.192908 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:29:49.284144 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:29:49.287147 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m22:29:49.288778 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m22:29:49.290662 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.33s]
[0m22:29:49.292182 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:29:49.331268 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:29:49.334124 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m22:29:49.335810 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m22:29:49.337733 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.38s]
[0m22:29:49.340277 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:29:49.343281 [debug] [MainThread]: On master: COMMIT
[0m22:29:49.344672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:49.345882 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m22:29:49.346815 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m22:29:49.347701 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m22:29:49.348839 [info ] [MainThread]: 
[0m22:29:49.349991 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m22:29:49.351641 [debug] [MainThread]: Command end result
[0m22:29:49.438597 [info ] [MainThread]: 
[0m22:29:49.440579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:49.441896 [info ] [MainThread]: 
[0m22:29:49.443139 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:29:49.445021 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9081218, "process_user_time": 2.589901, "process_kernel_time": 0.336403, "process_mem_max_rss": "123184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:49.446089 [debug] [MainThread]: Command `dbt test` succeeded at 22:29:49.445967 after 2.91 seconds
[0m22:29:49.447020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75363a6ad670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753638be1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536372f4640>]}
[0m22:29:49.448029 [debug] [MainThread]: Flushing usage events
[0m22:33:35.662547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d27a33c76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d27a1251580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d27a1251520>]}


============================== 22:33:35.668041 | 8502327b-218a-42f6-8a3a-d95a44a5bec9 ==============================
[0m22:33:35.668041 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:33:35.669401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:33:36.133289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fee03a0>]}
[0m22:33:36.193237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fee55e0>]}
[0m22:33:36.195287 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:33:36.351020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:33:36.546151 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:33:36.547992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d27a1f0ad60>]}
[0m22:33:38.566369 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:33:38.568466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fb147f0>]}
[0m22:33:38.861784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:33:38.875157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fc77220>]}
[0m22:33:39.016372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fc26c10>]}
[0m22:33:39.017698 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:33:39.018890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279e76ddf0>]}
[0m22:33:39.021780 [info ] [MainThread]: 
[0m22:33:39.023224 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:33:39.030343 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:33:39.048823 [debug] [ThreadPool]: dbt-sqlserver
[0m22:33:39.051390 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:33:39.053405 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:33:39.055330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:39.057547 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:39.117522 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:39.121306 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:33:39.123479 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:33:39.125370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m22:33:39.132600 [debug] [ThreadPool]: dbt-sqlserver
[0m22:33:39.133701 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:33:39.134564 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:33:39.135351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:39.136045 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:39.137209 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:39.143519 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:33:39.145655 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:33:39.146458 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:33:39.148331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d27a356b670>]}
[0m22:33:39.149255 [debug] [MainThread]: On master: COMMIT
[0m22:33:39.150135 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:33:39.150993 [info ] [MainThread]: 
[0m22:33:39.155412 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m22:33:39.155868 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m22:33:39.156297 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m22:33:39.157238 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:33:39.157958 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m22:33:39.159084 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m22:33:39.160134 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m22:33:39.161236 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m22:33:39.162364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m22:33:39.163272 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m22:33:39.164153 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m22:33:39.165123 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m22:33:39.165997 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m22:33:39.166753 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m22:33:39.167580 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m22:33:39.168387 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m22:33:39.177974 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m22:33:39.181770 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m22:33:39.187901 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m22:33:39.193840 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:33:39.202393 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m22:33:39.226229 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m22:33:39.239442 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m22:33:39.240200 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m22:33:39.244376 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m22:33:39.244925 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m22:33:39.250837 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:33:39.258676 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m22:33:39.265725 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:33:39.266960 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:33:39.268248 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:33:39.268855 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:33:39.270071 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:39.271624 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:33:39.272215 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:33:39.273555 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:39.274512 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:33:39.274878 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:33:39.275464 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:33:39.276803 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:33:39.277818 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:33:39.278677 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:39.279541 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:39.280406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:33:39.282764 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:39.291031 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.303361 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:33:39.303941 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:39.304349 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:39.304775 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:39.305247 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m22:33:39.321987 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.322507 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.322940 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.326981 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:33:39.334355 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:33:39.334748 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.341195 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:33:39.342276 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m22:33:39.343470 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m22:33:39.347257 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:33:39.347967 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m22:33:39.350149 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m22:33:39.361831 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.362358 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.379931 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m22:33:39.380418 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.384045 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:33:39.384416 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.392293 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m22:33:39.397202 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:33:39.399089 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m22:33:39.405059 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:33:39.412139 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:33:39.413339 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m22:33:39.416190 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m22:33:39.418856 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:33:39.422110 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:33:39.422757 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.425398 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m22:33:39.426447 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.430055 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m22:33:39.430553 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.430894 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.432832 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:33:39.433949 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:33:39.436980 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m22:33:39.439152 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m22:33:39.439968 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m22:33:39.440957 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:33:39.445346 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m22:33:39.449108 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m22:33:39.450893 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:33:39.452510 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:33:39.455026 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:33:39.457213 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:33:39.458303 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:33:39.459262 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:33:39.460133 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:33:39.461554 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.462017 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.464408 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.465177 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:33:39.465573 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.468007 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m22:33:39.470279 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:33:39.471284 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m22:33:39.473446 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:33:39.474187 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m22:33:39.475007 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m22:33:39.476407 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m22:33:39.478535 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fbfabb0>]}
[0m22:33:39.481000 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.31s]
[0m22:33:39.482337 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m22:33:39.487741 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.488222 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.488595 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:33:39.490245 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m22:33:39.491978 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m22:33:39.493569 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m22:33:39.494376 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m22:33:39.495021 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m22:33:39.495632 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m22:33:39.496347 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fb784f0>]}
[0m22:33:39.497188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279e8b0a30>]}
[0m22:33:39.498164 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8502327b-218a-42f6-8a3a-d95a44a5bec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fc3b9d0>]}
[0m22:33:39.498947 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.33s]
[0m22:33:39.500121 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.33s]
[0m22:33:39.501322 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.33s]
[0m22:33:39.502378 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:33:39.503659 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m22:33:39.504837 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m22:33:39.508180 [debug] [MainThread]: On master: COMMIT
[0m22:33:39.509134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:39.509898 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m22:33:39.510620 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m22:33:39.511346 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m22:33:39.512009 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m22:33:39.512827 [info ] [MainThread]: 
[0m22:33:39.513734 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m22:33:39.515324 [debug] [MainThread]: Command end result
[0m22:33:39.595102 [info ] [MainThread]: 
[0m22:33:39.596322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:33:39.597318 [info ] [MainThread]: 
[0m22:33:39.598309 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:33:39.600036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0179806, "process_user_time": 3.618212, "process_kernel_time": 0.791356, "process_mem_max_rss": "129360", "process_in_blocks": "496", "process_out_blocks": "0"}
[0m22:33:39.601022 [debug] [MainThread]: Command `dbt run` succeeded at 22:33:39.600911 after 4.02 seconds
[0m22:33:39.601815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d27a33c76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d27a1969e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d279fee55e0>]}
[0m22:33:39.602636 [debug] [MainThread]: Flushing usage events
[0m22:33:43.936154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc2cdb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc0b665e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc0b66580>]}


============================== 22:33:43.940516 | 250ffce3-ac69-4b7a-80a3-25c3cb501a5a ==============================
[0m22:33:43.940516 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:33:43.941855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:33:44.193623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '250ffce3-ac69-4b7a-80a3-25c3cb501a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dbf7fb1c0>]}
[0m22:33:44.259050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '250ffce3-ac69-4b7a-80a3-25c3cb501a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc0bd2580>]}
[0m22:33:44.261731 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:33:44.366953 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:33:45.386528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:33:45.387689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:33:45.394694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.gold
- models.dbt_sqlserver_project.silver
[0m22:33:45.435682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '250ffce3-ac69-4b7a-80a3-25c3cb501a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dbf2c9dc0>]}
[0m22:33:45.635898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '250ffce3-ac69-4b7a-80a3-25c3cb501a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc0bd26a0>]}
[0m22:33:45.637939 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:33:45.639362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250ffce3-ac69-4b7a-80a3-25c3cb501a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc296ecd0>]}
[0m22:33:45.642861 [info ] [MainThread]: 
[0m22:33:45.644828 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:33:45.655127 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m22:33:45.689941 [debug] [ThreadPool]: dbt-sqlserver
[0m22:33:45.691837 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:33:45.693564 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:33:45.695345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:45.696729 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:45.733276 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:45.739361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:33:45.741901 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:33:45.743245 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:33:45.758291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250ffce3-ac69-4b7a-80a3-25c3cb501a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc0b866d0>]}
[0m22:33:45.764317 [debug] [MainThread]: On master: COMMIT
[0m22:33:45.766103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:33:45.767263 [info ] [MainThread]: 
[0m22:33:45.772369 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:33:45.772945 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:33:45.773410 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:33:45.774312 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:33:45.775355 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m22:33:45.776523 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m22:33:45.777711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m22:33:45.778846 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m22:33:45.779900 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m22:33:45.780931 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:33:45.781838 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:33:45.782694 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:33:45.801851 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:33:45.811188 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:33:45.815763 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:33:45.825781 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:33:45.832925 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:33:45.855021 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m22:33:45.858802 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m22:33:45.860904 [debug] [Thread-2  ]: local_md5(invocation_id): 5e873ff066d926bd16ce933ea00a13e2
[0m22:33:45.861700 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:33:45.862868 [debug] [Thread-1  ]: local_md5(invocation_id): 5e873ff066d926bd16ce933ea00a13e2
[0m22:33:45.864660 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:33:45.868072 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m22:33:45.870092 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:33:45.873051 [debug] [Thread-3  ]: local_md5(invocation_id): 5e873ff066d926bd16ce933ea00a13e2
[0m22:33:45.875700 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:33:45.883021 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:33:45.884640 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_32f68c641661d98ed507e20f9fa374f8]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_32f68c641661d98ed507e20f9fa374f8]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_32f68c641661d98ed507e20f9fa374f8]
  ;')
[0m22:33:45.885330 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:33:45.887258 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:33:45.889281 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:33:45.889858 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_fb334c0fca13bde48e3435b4b2e77e9b]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_fb334c0fca13bde48e3435b4b2e77e9b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_fb334c0fca13bde48e3435b4b2e77e9b]
  ;')
[0m22:33:45.890942 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:45.892030 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_8e2ea11a7b13d914c202e938f4b076e2]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_8e2ea11a7b13d914c202e938f4b076e2]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_8e2ea11a7b13d914c202e938f4b076e2]
  ;')
[0m22:33:45.893072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:33:45.894070 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:45.894645 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:33:45.895479 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:45.897116 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:33:45.912958 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:45.915363 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:33:45.932202 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:33:45.939662 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m22:33:45.941194 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m22:33:45.942494 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.16s]
[0m22:33:45.943832 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:33:45.972082 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:33:45.975743 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m22:33:45.977173 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m22:33:45.978245 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.20s]
[0m22:33:45.979958 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:33:46.032353 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:33:46.034733 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m22:33:46.035705 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m22:33:46.037443 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.26s]
[0m22:33:46.038915 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:33:46.041051 [debug] [MainThread]: On master: COMMIT
[0m22:33:46.041995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:46.042705 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m22:33:46.043308 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m22:33:46.043931 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m22:33:46.044581 [info ] [MainThread]: 
[0m22:33:46.045541 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m22:33:46.047017 [debug] [MainThread]: Command end result
[0m22:33:46.105440 [info ] [MainThread]: 
[0m22:33:46.106739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:33:46.107936 [info ] [MainThread]: 
[0m22:33:46.108948 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:33:46.110295 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.262536, "process_user_time": 1.887363, "process_kernel_time": 0.375856, "process_mem_max_rss": "122476", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:33:46.111209 [debug] [MainThread]: Command `dbt test` succeeded at 22:33:46.111103 after 2.26 seconds
[0m22:33:46.112008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc2cdb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc0bd2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705dc120ddc0>]}
[0m22:33:46.112783 [debug] [MainThread]: Flushing usage events
[0m22:34:34.186134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f3c8835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f3a70c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f3a70c490>]}


============================== 22:34:34.190356 | 9630f9e8-1d2c-4193-b9b0-aff498601eee ==============================
[0m22:34:34.190356 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:34:34.191899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:34:34.485988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f3ae24940>]}
[0m22:34:34.540083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f393424f0>]}
[0m22:34:34.542588 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:34:34.682031 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:34:35.560590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:35.561843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:35.568858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.gold
- models.dbt_sqlserver_project.silver
[0m22:34:35.609627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f38e6b130>]}
[0m22:34:35.796647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f390091c0>]}
[0m22:34:35.798148 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:34:35.799616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f394c95e0>]}
[0m22:34:35.801893 [info ] [MainThread]: 
[0m22:34:35.803433 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:34:35.810725 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:34:35.835357 [debug] [ThreadPool]: dbt-sqlserver
[0m22:34:35.837776 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:34:35.839684 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:34:35.841403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:35.843005 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:35.881818 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:35.884654 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:34:35.887300 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:34:35.889332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m22:34:35.895994 [debug] [ThreadPool]: dbt-sqlserver
[0m22:34:35.897118 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:34:35.897882 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:34:35.898705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:35.899379 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:35.900122 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:35.904547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:34:35.906322 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:34:35.907138 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:34:35.908993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f393a0df0>]}
[0m22:34:35.909830 [debug] [MainThread]: On master: COMMIT
[0m22:34:35.910825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:35.911796 [info ] [MainThread]: 
[0m22:34:35.916093 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m22:34:35.916610 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m22:34:35.917027 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m22:34:35.917401 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:34:35.918062 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m22:34:35.919249 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m22:34:35.920251 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m22:34:35.921238 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m22:34:35.922197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m22:34:35.923227 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m22:34:35.924175 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m22:34:35.925177 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m22:34:35.925984 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m22:34:35.926807 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m22:34:35.927677 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m22:34:35.928595 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m22:34:35.939630 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m22:34:35.945684 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m22:34:35.950851 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m22:34:35.955876 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:34:35.963776 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m22:34:35.964857 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m22:34:35.966287 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m22:34:35.972296 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m22:34:36.014370 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m22:34:36.015102 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m22:34:36.019572 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m22:34:36.024343 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:34:36.033515 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:34:36.034482 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:34:36.035876 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:34:36.036486 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:34:36.037023 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:34:36.037973 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:34:36.038809 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:34:36.039599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:34:36.040403 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:34:36.041243 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:34:36.042017 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:34:36.042914 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:36.043754 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:34:36.044602 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:36.045421 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:36.047206 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:36.060945 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:36.061777 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:36.065157 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:36.066311 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:36.077694 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.078145 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.078598 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.078990 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.093322 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:34:36.097870 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:34:36.103043 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:34:36.109552 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:34:36.111261 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m22:34:36.112837 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m22:34:36.114124 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m22:34:36.115676 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m22:34:36.129332 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.129787 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.130177 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.130523 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.136176 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:34:36.140739 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:34:36.145564 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:34:36.151306 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:34:36.153142 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m22:34:36.154888 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m22:34:36.156308 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m22:34:36.157302 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m22:34:36.170203 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.170729 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.171094 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.171438 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.193528 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m22:34:36.195396 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m22:34:36.199043 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m22:34:36.201586 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m22:34:36.209091 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m22:34:36.213511 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m22:34:36.218188 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m22:34:36.224393 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m22:34:36.232934 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:34:36.234531 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:34:36.236313 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:34:36.238036 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:34:36.239312 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:34:36.240529 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:34:36.241591 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:34:36.242843 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:34:36.244105 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:34:36.245192 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:34:36.246085 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:34:36.246967 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:34:36.250587 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.251033 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.251485 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.253254 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:34:36.253614 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.255069 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:34:36.257015 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:34:36.257688 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m22:34:36.259872 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:34:36.260686 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m22:34:36.261582 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m22:34:36.263158 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m22:34:36.272962 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.273415 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.273875 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.274194 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:34:36.276969 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m22:34:36.278979 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m22:34:36.280572 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m22:34:36.282334 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m22:34:36.283017 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m22:34:36.283777 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m22:34:36.284652 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m22:34:36.285277 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m22:34:36.287216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f385f26a0>]}
[0m22:34:36.287976 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f385e3730>]}
[0m22:34:36.289042 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f385f2850>]}
[0m22:34:36.289699 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9630f9e8-1d2c-4193-b9b0-aff498601eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f385f2fa0>]}
[0m22:34:36.290814 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.36s]
[0m22:34:36.291997 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.36s]
[0m22:34:36.293253 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.37s]
[0m22:34:36.294165 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.36s]
[0m22:34:36.295427 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m22:34:36.296408 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m22:34:36.297437 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m22:34:36.298273 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:34:36.302171 [debug] [MainThread]: On master: COMMIT
[0m22:34:36.303099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:36.303778 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m22:34:36.304406 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m22:34:36.304999 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m22:34:36.305624 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m22:34:36.306329 [info ] [MainThread]: 
[0m22:34:36.307185 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m22:34:36.308710 [debug] [MainThread]: Command end result
[0m22:34:36.369131 [info ] [MainThread]: 
[0m22:34:36.370397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:36.371734 [info ] [MainThread]: 
[0m22:34:36.372757 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:34:36.374541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2772796, "process_user_time": 1.934118, "process_kernel_time": 0.322353, "process_mem_max_rss": "124100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:36.375596 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:36.375476 after 2.28 seconds
[0m22:34:36.376432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f3c8835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f38410670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f3860bfa0>]}
[0m22:34:36.377355 [debug] [MainThread]: Flushing usage events
[0m22:34:39.903414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5d6b05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5b53a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5b53a370>]}


============================== 22:34:39.907230 | e3812843-8966-4fe3-a9ba-594023e13a69 ==============================
[0m22:34:39.907230 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:34:39.908638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:34:40.144679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3812843-8966-4fe3-a9ba-594023e13a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5a2bebb0>]}
[0m22:34:40.190099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3812843-8966-4fe3-a9ba-594023e13a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5b53a520>]}
[0m22:34:40.192281 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:34:40.289857 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:34:41.154824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:41.155820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:41.163083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:34:41.202512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3812843-8966-4fe3-a9ba-594023e13a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd59c97130>]}
[0m22:34:41.387083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3812843-8966-4fe3-a9ba-594023e13a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5bbe45e0>]}
[0m22:34:41.388477 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:34:41.389688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3812843-8966-4fe3-a9ba-594023e13a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5c214af0>]}
[0m22:34:41.391952 [info ] [MainThread]: 
[0m22:34:41.393240 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:34:41.400015 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m22:34:41.417568 [debug] [ThreadPool]: dbt-sqlserver
[0m22:34:41.419781 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:34:41.421529 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:34:41.423053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:41.424311 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:41.448624 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:41.452770 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:34:41.454805 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:34:41.455665 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:34:41.457670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3812843-8966-4fe3-a9ba-594023e13a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5b5ba2e0>]}
[0m22:34:41.458528 [debug] [MainThread]: On master: COMMIT
[0m22:34:41.459420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:41.460334 [info ] [MainThread]: 
[0m22:34:41.464493 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:34:41.464956 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:34:41.465317 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:34:41.466085 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:34:41.467125 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m22:34:41.468070 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m22:34:41.468974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m22:34:41.469955 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m22:34:41.470849 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m22:34:41.471573 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:34:41.472368 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:34:41.473115 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:34:41.490639 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:34:41.499034 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:34:41.503940 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:34:41.511770 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:34:41.518884 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:34:41.519295 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:34:41.536535 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m22:34:41.539454 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m22:34:41.543118 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m22:34:41.544902 [debug] [Thread-1  ]: local_md5(invocation_id): 5ceec5c036ec3ee5bc093dac2a56b8a5
[0m22:34:41.546744 [debug] [Thread-3  ]: local_md5(invocation_id): 5ceec5c036ec3ee5bc093dac2a56b8a5
[0m22:34:41.548236 [debug] [Thread-2  ]: local_md5(invocation_id): 5ceec5c036ec3ee5bc093dac2a56b8a5
[0m22:34:41.550062 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:34:41.551710 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:34:41.553434 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:34:41.560757 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:34:41.561504 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:34:41.562783 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_e66d0e2ecc4cbabd5a2c3155ad833c88]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_e66d0e2ecc4cbabd5a2c3155ad833c88]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_e66d0e2ecc4cbabd5a2c3155ad833c88]
  ;')
[0m22:34:41.564056 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:34:41.564545 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_5c5b4ca1bc85acb9bd1dce6a1b39519e]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_5c5b4ca1bc85acb9bd1dce6a1b39519e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_5c5b4ca1bc85acb9bd1dce6a1b39519e]
  ;')
[0m22:34:41.565679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:34:41.566600 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_41aba0984914053aec93806ec64a2b06]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_41aba0984914053aec93806ec64a2b06]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_41aba0984914053aec93806ec64a2b06]
  ;')
[0m22:34:41.567508 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:34:41.568377 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:41.569252 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:34:41.570257 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:41.571280 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:41.571943 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:34:41.586767 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:41.588549 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:34:41.610016 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:34:41.615692 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m22:34:41.616734 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m22:34:41.617812 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.15s]
[0m22:34:41.618948 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:34:41.658801 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:34:41.661856 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m22:34:41.663019 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m22:34:41.664287 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.19s]
[0m22:34:41.665767 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:34:41.707868 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:34:41.711489 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m22:34:41.712972 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m22:34:41.714531 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.25s]
[0m22:34:41.716318 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:34:41.719512 [debug] [MainThread]: On master: COMMIT
[0m22:34:41.720845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:41.722198 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m22:34:41.723595 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m22:34:41.724651 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m22:34:41.726836 [info ] [MainThread]: 
[0m22:34:41.729173 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m22:34:41.731622 [debug] [MainThread]: Command end result
[0m22:34:41.801727 [info ] [MainThread]: 
[0m22:34:41.802876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:41.803928 [info ] [MainThread]: 
[0m22:34:41.804984 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:34:41.806833 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9751806, "process_user_time": 1.679326, "process_kernel_time": 0.319111, "process_mem_max_rss": "122560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:41.807788 [debug] [MainThread]: Command `dbt test` succeeded at 22:34:41.807666 after 1.98 seconds
[0m22:34:41.808629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5d6b05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5b53a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cd5d89e160>]}
[0m22:34:41.809482 [debug] [MainThread]: Flushing usage events
[0m22:39:33.929486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abbb55a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb93e3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb93e33a0>]}


============================== 22:39:33.933482 | fd9384a0-7dd9-4825-8bd5-a143d0181c75 ==============================
[0m22:39:33.933482 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:39:33.934759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:39:34.315543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb9419a60>]}
[0m22:39:34.365862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb8084310>]}
[0m22:39:34.367930 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:39:34.475447 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:39:35.495859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:39:35.496986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:39:35.505098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:39:35.556967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb7b48dc0>]}
[0m22:39:35.822201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb7b8d760>]}
[0m22:39:35.823490 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:39:35.824645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb942c310>]}
[0m22:39:35.827145 [info ] [MainThread]: 
[0m22:39:35.828723 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:39:35.836635 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:39:35.868063 [debug] [ThreadPool]: dbt-sqlserver
[0m22:39:35.869929 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:39:35.871599 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:39:35.873337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:35.875019 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:35.921358 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:35.925470 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:39:35.927923 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:39:35.930010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m22:39:35.941659 [debug] [ThreadPool]: dbt-sqlserver
[0m22:39:35.943059 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:39:35.944114 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:39:35.945150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:35.945963 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:35.946876 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:35.952164 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:39:35.954344 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:39:35.955519 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:39:35.958845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb8169e20>]}
[0m22:39:35.960807 [debug] [MainThread]: On master: COMMIT
[0m22:39:35.962143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:39:35.963937 [info ] [MainThread]: 
[0m22:39:35.973026 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.stg_customers
[0m22:39:35.974156 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.stg_example
[0m22:39:35.975262 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.stg_products
[0m22:39:35.975866 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:39:35.976922 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.stg_customers .................................. [RUN]
[0m22:39:35.978810 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.stg_example .................................... [RUN]
[0m22:39:35.980572 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.stg_products ................................... [RUN]
[0m22:39:35.981895 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.stg_sales_orders ............................... [RUN]
[0m22:39:35.983619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.stg_customers)
[0m22:39:35.985781 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_example'
[0m22:39:35.987282 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_products'
[0m22:39:35.988583 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.stg_sales_orders'
[0m22:39:35.989540 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.stg_customers
[0m22:39:35.990526 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.stg_example
[0m22:39:35.991575 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.stg_products
[0m22:39:35.992571 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.stg_sales_orders
[0m22:39:36.005745 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_customers"
[0m22:39:36.012659 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_example"
[0m22:39:36.020086 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_products"
[0m22:39:36.028565 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:39:36.035931 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.stg_customers
[0m22:39:36.037184 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.stg_sales_orders
[0m22:39:36.043794 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.stg_example
[0m22:39:36.055505 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.stg_products
[0m22:39:36.091846 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_customers"
[0m22:39:36.092439 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:39:36.096965 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_example"
[0m22:39:36.105865 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.stg_products"
[0m22:39:36.114868 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:39:36.116001 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:39:36.117977 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:39:36.119120 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:39:36.120128 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:39:36.120560 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:39:36.121456 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:39:36.122368 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:39:36.123515 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."stg_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:39:36.124487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:39:36.125478 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:36.126543 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:39:36.127689 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:39:36.129025 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:36.132004 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:36.133639 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:36.146120 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:36.154375 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:36.156477 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:36.163005 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:36.165687 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.179141 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:39:36.179681 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.180176 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.180512 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.181434 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders', 'stg_sales_orders__dbt_backup'
[0m22:39:36.188365 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:39:36.194204 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:39:36.199521 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:39:36.202320 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example', 'stg_example__dbt_backup'
[0m22:39:36.203552 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers', 'stg_customers__dbt_backup'
[0m22:39:36.204660 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products', 'stg_products__dbt_backup'
[0m22:39:36.217561 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.218172 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.218653 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.223794 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:39:36.224318 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.229488 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:39:36.236261 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:39:36.238133 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_example__dbt_tmp', 'stg_example'
[0m22:39:36.243286 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:39:36.244631 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_sales_orders__dbt_tmp', 'stg_sales_orders'
[0m22:39:36.246626 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_products__dbt_tmp', 'stg_products'
[0m22:39:36.249294 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.stg_customers__dbt_tmp', 'stg_customers'
[0m22:39:36.265475 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.266212 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.266848 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.267590 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.285531 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: COMMIT
[0m22:39:36.288436 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: COMMIT
[0m22:39:36.290569 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: COMMIT
[0m22:39:36.293324 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: COMMIT
[0m22:39:36.300866 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_customers__dbt_backup"
[0m22:39:36.305109 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_products__dbt_backup"
[0m22:39:36.309377 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_example__dbt_backup"
[0m22:39:36.314330 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."stg_sales_orders__dbt_backup"
[0m22:39:36.322146 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:39:36.323417 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:39:36.324735 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:39:36.325924 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:39:36.326885 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:39:36.327844 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:39:36.328748 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:39:36.329677 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:39:36.330498 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:39:36.331383 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:39:36.332350 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:39:36.333572 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:39:36.337421 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.337949 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.338428 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.338871 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.341255 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_customers"
[0m22:39:36.343471 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_example"
[0m22:39:36.345277 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_products"
[0m22:39:36.347204 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.stg_sales_orders"
[0m22:39:36.348166 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m22:39:36.349247 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_example__dbt_backup";');

[0m22:39:36.350361 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_products__dbt_backup";');

[0m22:39:36.351257 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.stg_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."stg_sales_orders__dbt_backup";');

[0m22:39:36.361230 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.361752 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.365411 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: ROLLBACK
[0m22:39:36.365877 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.366445 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:39:36.367805 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: ROLLBACK
[0m22:39:36.368826 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.stg_customers: Close
[0m22:39:36.370650 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: ROLLBACK
[0m22:39:36.372619 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: ROLLBACK
[0m22:39:36.373862 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.stg_sales_orders: Close
[0m22:39:36.376637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abbb32a6a0>]}
[0m22:39:36.377605 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.stg_example: Close
[0m22:39:36.378586 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.stg_products: Close
[0m22:39:36.379702 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb72c8eb0>]}
[0m22:39:36.380886 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 0.39s]
[0m22:39:36.382236 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb72b3220>]}
[0m22:39:36.383403 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9384a0-7dd9-4825-8bd5-a143d0181c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb7b32f70>]}
[0m22:39:36.384380 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.stg_sales_orders .......................... [[32mOK[0m in 0.39s]
[0m22:39:36.385615 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.stg_customers
[0m22:39:36.386902 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.stg_example ............................... [[32mOK[0m in 0.40s]
[0m22:39:36.388171 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.stg_products .............................. [[32mOK[0m in 0.40s]
[0m22:39:36.389316 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.stg_sales_orders
[0m22:39:36.391190 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.stg_example
[0m22:39:36.392358 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.stg_products
[0m22:39:36.396641 [debug] [MainThread]: On master: COMMIT
[0m22:39:36.398225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:36.399144 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_customers' was properly closed.
[0m22:39:36.400246 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_example' was properly closed.
[0m22:39:36.401099 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_products' was properly closed.
[0m22:39:36.402005 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.stg_sales_orders' was properly closed.
[0m22:39:36.403060 [info ] [MainThread]: 
[0m22:39:36.404130 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m22:39:36.405849 [debug] [MainThread]: Command end result
[0m22:39:36.481101 [info ] [MainThread]: 
[0m22:39:36.482394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:39:36.484053 [info ] [MainThread]: 
[0m22:39:36.485282 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:39:36.486989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6490467, "process_user_time": 2.009626, "process_kernel_time": 0.826091, "process_mem_max_rss": "124224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:39:36.488090 [debug] [MainThread]: Command `dbt run` succeeded at 22:39:36.487961 after 2.65 seconds
[0m22:39:36.489187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abbb55a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb4444670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76abb8084310>]}
[0m22:39:36.490196 [debug] [MainThread]: Flushing usage events
[0m22:39:40.197976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a8020a96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7fff335b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7fff33550>]}


============================== 22:39:40.202186 | 499a9311-163f-445f-a031-2ed0614de2fd ==============================
[0m22:39:40.202186 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:39:40.203615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:39:40.434999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '499a9311-163f-445f-a031-2ed0614de2fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7febd5340>]}
[0m22:39:40.482726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '499a9311-163f-445f-a031-2ed0614de2fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7fff9fe50>]}
[0m22:39:40.484767 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:39:40.586036 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:39:41.390936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:39:41.391968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:39:41.399058 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:39:41.441055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '499a9311-163f-445f-a031-2ed0614de2fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7fe696e20>]}
[0m22:39:41.628838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '499a9311-163f-445f-a031-2ed0614de2fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7fec4f640>]}
[0m22:39:41.630276 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:39:41.631542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499a9311-163f-445f-a031-2ed0614de2fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7fff919a0>]}
[0m22:39:41.633860 [info ] [MainThread]: 
[0m22:39:41.635217 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:39:41.641298 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m22:39:41.660179 [debug] [ThreadPool]: dbt-sqlserver
[0m22:39:41.661705 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:39:41.662902 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:39:41.663952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:41.665052 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:41.689377 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:41.693557 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:39:41.695598 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:39:41.696411 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:39:41.698356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499a9311-163f-445f-a031-2ed0614de2fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7fe69ed30>]}
[0m22:39:41.699357 [debug] [MainThread]: On master: COMMIT
[0m22:39:41.700342 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:39:41.701243 [info ] [MainThread]: 
[0m22:39:41.704727 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:39:41.705122 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:39:41.705485 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:39:41.706301 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:39:41.707241 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_sales_orders_order_detail_id .................... [RUN]
[0m22:39:41.708271 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_sales_orders_sales_order_id ..................... [RUN]
[0m22:39:41.709248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95)
[0m22:39:41.710264 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e'
[0m22:39:41.711253 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8'
[0m22:39:41.712140 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:39:41.713055 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:39:41.713786 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:39:41.731324 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:39:41.739065 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:39:41.743885 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:39:41.753088 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:39:41.754301 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:39:41.760403 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:39:41.777619 [debug] [Thread-1  ]: local_md5(model.name): 3e5c62ef8b8d539a0f51750cd177b2af
[0m22:39:41.780048 [debug] [Thread-3  ]: local_md5(model.name): bff43e180c85bd9592cb0947b1a9a63e
[0m22:39:41.785118 [debug] [Thread-2  ]: local_md5(model.name): 043bb01d3bae32fb84491fc944349b57
[0m22:39:41.786880 [debug] [Thread-1  ]: local_md5(invocation_id): 636d497ff6192f04f94a0aa9ca31d682
[0m22:39:41.788386 [debug] [Thread-3  ]: local_md5(invocation_id): 636d497ff6192f04f94a0aa9ca31d682
[0m22:39:41.789835 [debug] [Thread-2  ]: local_md5(invocation_id): 636d497ff6192f04f94a0aa9ca31d682
[0m22:39:41.791435 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:39:41.793074 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:39:41.794625 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:39:41.801342 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"
[0m22:39:41.802665 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"
[0m22:39:41.803517 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_018d59e2b6d8a7554ffac2e7fb67a575]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_018d59e2b6d8a7554ffac2e7fb67a575]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_018d59e2b6d8a7554ffac2e7fb67a575]
  ;')
[0m22:39:41.804128 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"
[0m22:39:41.805157 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3e272a76c43249f01e514d46632cb8a0]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."stg_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3e272a76c43249f01e514d46632cb8a0]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3e272a76c43249f01e514d46632cb8a0]
  ;')
[0m22:39:41.806119 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:39:41.807012 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6c7db437c9b86f8a5a72af70f912b420]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."stg_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6c7db437c9b86f8a5a72af70f912b420]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6c7db437c9b86f8a5a72af70f912b420]
  ;')
[0m22:39:41.807862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:39:41.808756 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:41.809581 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:39:41.810518 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:41.811477 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:41.812210 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:39:41.828310 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:41.828795 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:39:41.833964 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:39:41.839572 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: ROLLBACK
[0m22:39:41.840888 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8: Close
[0m22:39:41.842437 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_sales_orders_sales_order_id ........................... [[32mPASS[0m in 0.13s]
[0m22:39:41.844480 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8
[0m22:39:41.916369 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:39:41.920576 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: ROLLBACK
[0m22:39:41.922595 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e: Close
[0m22:39:41.924452 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_sales_orders_order_detail_id .......................... [[32mPASS[0m in 0.21s]
[0m22:39:41.926192 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e
[0m22:39:42.029162 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:39:42.032183 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: ROLLBACK
[0m22:39:42.033734 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95: Close
[0m22:39:42.035200 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.33s]
[0m22:39:42.036705 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95
[0m22:39:42.039725 [debug] [MainThread]: On master: COMMIT
[0m22:39:42.042015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:42.043310 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_stg_sales_orders_sales_order_id__order_detail_id.78d6e92c95' was properly closed.
[0m22:39:42.044250 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_order_detail_id.a8109b3c4e' was properly closed.
[0m22:39:42.045073 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_stg_sales_orders_sales_order_id.6ddb51f5f8' was properly closed.
[0m22:39:42.045941 [info ] [MainThread]: 
[0m22:39:42.046905 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m22:39:42.048616 [debug] [MainThread]: Command end result
[0m22:39:42.104973 [info ] [MainThread]: 
[0m22:39:42.106001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:39:42.107025 [info ] [MainThread]: 
[0m22:39:42.107963 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:39:42.109347 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9821519, "process_user_time": 1.808333, "process_kernel_time": 0.268333, "process_mem_max_rss": "122552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:39:42.110226 [debug] [MainThread]: Command `dbt test` succeeded at 22:39:42.110123 after 1.98 seconds
[0m22:39:42.111094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a8020a96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a8005dd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a7febd5340>]}
[0m22:39:42.111890 [debug] [MainThread]: Flushing usage events
[0m22:43:47.190401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c7da26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c5c2b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c5c2b520>]}


============================== 22:43:47.194272 | 966782e0-81bd-4c91-881b-81b3f43f116d ==============================
[0m22:43:47.194272 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:43:47.195552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:47.623785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c48ba3a0>]}
[0m22:43:47.678334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c48bf5e0>]}
[0m22:43:47.680922 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:43:47.783133 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:43:48.814525 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 1 files changed.
[0m22:43:48.815930 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/bronze/brnz_customers.sql
[0m22:43:48.816835 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/bronze/brnz_products.sql
[0m22:43:48.817565 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/bronze/brnz_example.sql
[0m22:43:48.818395 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/bronze/brnz_sales_orders.sql
[0m22:43:48.819369 [debug] [MainThread]: Partial parsing: updated file: dbt_sqlserver_project://models/bronze/schema.yml
[0m22:43:48.820055 [debug] [MainThread]: Partial parsing: deleted file: dbt_sqlserver_project://models/bronze/stg_customers.sql
[0m22:43:48.820661 [debug] [MainThread]: Partial parsing: deleted file: dbt_sqlserver_project://models/bronze/stg_sales_orders.sql
[0m22:43:48.821282 [debug] [MainThread]: Partial parsing: deleted file: dbt_sqlserver_project://models/bronze/stg_products.sql
[0m22:43:48.822081 [debug] [MainThread]: Partial parsing: deleted file: dbt_sqlserver_project://models/bronze/stg_example.sql
[0m22:43:49.069988 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:43:49.072186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c4651d00>]}
[0m22:43:49.233044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.gold
- models.dbt_sqlserver_project.silver
[0m22:43:49.247925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c30cf130>]}
[0m22:43:49.384211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c30dc0d0>]}
[0m22:43:49.385540 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:43:49.386758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c309e160>]}
[0m22:43:49.389139 [info ] [MainThread]: 
[0m22:43:49.390723 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:43:49.396670 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:43:49.413288 [debug] [ThreadPool]: dbt-sqlserver
[0m22:43:49.414931 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:43:49.416247 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:43:49.417325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:49.418196 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:49.443740 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:49.446327 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:43:49.448158 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:43:49.450057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m22:43:49.458200 [debug] [ThreadPool]: dbt-sqlserver
[0m22:43:49.459308 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:43:49.460078 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:43:49.460779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:49.461544 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:49.462299 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:49.466990 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:43:49.468764 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:43:49.469572 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:43:49.471506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c49b1f70>]}
[0m22:43:49.472447 [debug] [MainThread]: On master: COMMIT
[0m22:43:49.473601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:49.474604 [info ] [MainThread]: 
[0m22:43:49.478122 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m22:43:49.478678 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m22:43:49.479063 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m22:43:49.479482 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:43:49.480083 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.brnz_customers ................................. [RUN]
[0m22:43:49.481243 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.brnz_example ................................... [RUN]
[0m22:43:49.482289 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.brnz_products .................................. [RUN]
[0m22:43:49.483418 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.brnz_sales_orders .............................. [RUN]
[0m22:43:49.484490 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.brnz_customers)
[0m22:43:49.485551 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_example'
[0m22:43:49.486583 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_products'
[0m22:43:49.487580 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m22:43:49.488424 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m22:43:49.489396 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m22:43:49.490554 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m22:43:49.491770 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:43:49.501191 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:43:49.504768 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m22:43:49.511150 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m22:43:49.515842 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:43:49.522831 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m22:43:49.529984 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m22:43:49.557069 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:43:49.557647 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m22:43:49.558021 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:43:49.562632 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m22:43:49.570247 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m22:43:49.575889 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:43:49.577749 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:43:49.580462 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:43:49.580940 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:43:49.582138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:43:49.582536 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:43:49.583714 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:43:49.584666 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:43:49.585001 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:49.586154 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:43:49.587300 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:43:49.588371 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:43:49.589905 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:49.590789 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:43:49.591831 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:49.592761 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:43:49.594327 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:49.595939 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:49.604717 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.614360 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:49.613928 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:43:49.614881 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:49.615361 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:49.617153 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_customers__dbt_tmp', 'brnz_customers'
[0m22:43:49.629141 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.629656 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.630121 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.634122 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:43:49.638343 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:43:49.642886 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:43:49.643760 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m22:43:49.644843 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_example__dbt_tmp', 'brnz_example'
[0m22:43:49.645691 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_products__dbt_tmp', 'brnz_products'
[0m22:43:49.667982 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.684214 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m22:43:49.684688 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.685095 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.685463 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.692437 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_customers__dbt_backup"
[0m22:43:49.694646 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m22:43:49.696457 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m22:43:49.697988 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m22:43:49.704738 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:43:49.708693 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_sales_orders__dbt_backup"
[0m22:43:49.712935 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_products__dbt_backup"
[0m22:43:49.716427 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_example__dbt_backup"
[0m22:43:49.718016 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:43:49.719832 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:43:49.721809 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:43:49.723353 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:43:49.724318 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:43:49.725222 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:43:49.726147 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:43:49.727009 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:43:49.728412 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:43:49.729352 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:43:49.730226 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:43:49.747764 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.748233 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.750369 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:43:49.751424 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.751884 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.753315 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:43:49.754088 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_customers__dbt_backup";');

[0m22:43:49.756267 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:43:49.758330 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:43:49.758889 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_example__dbt_backup";');

[0m22:43:49.760350 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_products__dbt_backup";');

[0m22:43:49.761288 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_sales_orders__dbt_backup";');

[0m22:43:49.762151 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.764813 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.767335 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m22:43:49.767755 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.768112 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:43:49.769683 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m22:43:49.770509 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m22:43:49.771880 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m22:43:49.773938 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m22:43:49.774653 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m22:43:49.776644 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c21d5df0>]}
[0m22:43:49.777514 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m22:43:49.778371 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m22:43:49.779113 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c3063d60>]}
[0m22:43:49.779907 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.brnz_customers ............................ [[32mOK[0m in 0.29s]
[0m22:43:49.781239 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c21d5f70>]}
[0m22:43:49.782115 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '966782e0-81bd-4c91-881b-81b3f43f116d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c3065cd0>]}
[0m22:43:49.783183 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.brnz_example .............................. [[32mOK[0m in 0.29s]
[0m22:43:49.784276 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m22:43:49.785315 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.brnz_products ............................. [[32mOK[0m in 0.29s]
[0m22:43:49.786378 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.brnz_sales_orders ......................... [[32mOK[0m in 0.29s]
[0m22:43:49.787433 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m22:43:49.789355 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m22:43:49.790659 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:43:49.793873 [debug] [MainThread]: On master: COMMIT
[0m22:43:49.794806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:49.795524 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_customers' was properly closed.
[0m22:43:49.796283 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_example' was properly closed.
[0m22:43:49.796932 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_products' was properly closed.
[0m22:43:49.797507 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_sales_orders' was properly closed.
[0m22:43:49.798248 [info ] [MainThread]: 
[0m22:43:49.799091 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m22:43:49.800570 [debug] [MainThread]: Command end result
[0m22:43:49.854856 [info ] [MainThread]: 
[0m22:43:49.856195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:49.857511 [info ] [MainThread]: 
[0m22:43:49.858488 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:43:49.859838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7368264, "process_user_time": 2.382088, "process_kernel_time": 0.459048, "process_mem_max_rss": "129652", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:49.860730 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:49.860615 after 2.74 seconds
[0m22:43:49.861489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c7da26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c62d6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285c48bf5e0>]}
[0m22:43:49.862256 [debug] [MainThread]: Flushing usage events
[0m22:43:53.470560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e9739670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e8930610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e75fe190>]}


============================== 22:43:53.474284 | 3a546b78-aa67-4109-a86f-781e3346a8a4 ==============================
[0m22:43:53.474284 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:43:53.475552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:43:53.783974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a546b78-aa67-4109-a86f-781e3346a8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e773ed60>]}
[0m22:43:53.831655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a546b78-aa67-4109-a86f-781e3346a8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e7655880>]}
[0m22:43:53.834449 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:43:53.936531 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:43:54.859716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:54.860658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:54.867856 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:43:54.913253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a546b78-aa67-4109-a86f-781e3346a8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e5d28e50>]}
[0m22:43:55.119872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a546b78-aa67-4109-a86f-781e3346a8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e762f5e0>]}
[0m22:43:55.120875 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:43:55.122012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a546b78-aa67-4109-a86f-781e3346a8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e6380640>]}
[0m22:43:55.124743 [info ] [MainThread]: 
[0m22:43:55.126171 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:43:55.132599 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m22:43:55.152135 [debug] [ThreadPool]: dbt-sqlserver
[0m22:43:55.153576 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:43:55.154551 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:43:55.155509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:55.156581 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:55.180674 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:55.185063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:43:55.187188 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:43:55.188093 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:43:55.191788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a546b78-aa67-4109-a86f-781e3346a8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e7643fd0>]}
[0m22:43:55.193185 [debug] [MainThread]: On master: COMMIT
[0m22:43:55.194188 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:55.195114 [info ] [MainThread]: 
[0m22:43:55.199108 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:43:55.199533 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:43:55.199987 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:43:55.200756 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:43:55.201665 [info ] [Thread-2  ]: 2 of 3 START test not_null_brnz_sales_orders_order_detail_id ................... [RUN]
[0m22:43:55.202680 [info ] [Thread-3  ]: 3 of 3 START test not_null_brnz_sales_orders_sales_order_id .................... [RUN]
[0m22:43:55.203731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m22:43:55.204896 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac'
[0m22:43:55.206099 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m22:43:55.207435 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:43:55.208602 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:43:55.209712 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:43:55.230273 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:43:55.239517 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:43:55.245855 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:43:55.253349 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:43:55.280837 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m22:43:55.281447 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:43:55.283020 [debug] [Thread-1  ]: local_md5(invocation_id): 66cee961b908996d2c7de78148d1b4d2
[0m22:43:55.283812 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:43:55.286680 [debug] [Thread-3  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m22:43:55.288216 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:43:55.291962 [debug] [Thread-2  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m22:43:55.293314 [debug] [Thread-3  ]: local_md5(invocation_id): 66cee961b908996d2c7de78148d1b4d2
[0m22:43:55.295059 [debug] [Thread-2  ]: local_md5(invocation_id): 66cee961b908996d2c7de78148d1b4d2
[0m22:43:55.296531 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:43:55.297869 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:43:55.301307 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:43:55.302822 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a2e5aefb38f45a0e8a4cdc03f2c7a73e]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a2e5aefb38f45a0e8a4cdc03f2c7a73e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a2e5aefb38f45a0e8a4cdc03f2c7a73e]
  ;')
[0m22:43:55.303904 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:43:55.304696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:43:55.306857 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_ba2a320430a5e7b872fe47c447d097cc]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_ba2a320430a5e7b872fe47c447d097cc]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_ba2a320430a5e7b872fe47c447d097cc]
  ;')
[0m22:43:55.307692 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:43:55.309026 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:55.310066 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:43:55.310988 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_2afe8378615baa9716224807564ad03c]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_2afe8378615baa9716224807564ad03c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_2afe8378615baa9716224807564ad03c]
  ;')
[0m22:43:55.312022 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:55.312691 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:55.313557 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:43:55.318947 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:43:55.329062 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:55.335751 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:43:55.345865 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:43:55.351283 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m22:43:55.352452 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m22:43:55.353558 [info ] [Thread-3  ]: 3 of 3 PASS not_null_brnz_sales_orders_sales_order_id .......................... [[32mPASS[0m in 0.15s]
[0m22:43:55.355165 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:43:55.388276 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:43:55.391532 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m22:43:55.393141 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m22:43:55.395159 [info ] [Thread-2  ]: 2 of 3 PASS not_null_brnz_sales_orders_order_detail_id ......................... [[32mPASS[0m in 0.19s]
[0m22:43:55.396549 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:43:55.417192 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:43:55.420577 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m22:43:55.421932 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m22:43:55.423329 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.22s]
[0m22:43:55.425098 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:43:55.427790 [debug] [MainThread]: On master: COMMIT
[0m22:43:55.428826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:55.429518 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902' was properly closed.
[0m22:43:55.430241 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac' was properly closed.
[0m22:43:55.430891 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca' was properly closed.
[0m22:43:55.431592 [info ] [MainThread]: 
[0m22:43:55.432472 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m22:43:55.434054 [debug] [MainThread]: Command end result
[0m22:43:55.514040 [info ] [MainThread]: 
[0m22:43:55.515516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:55.516746 [info ] [MainThread]: 
[0m22:43:55.517849 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:43:55.519618 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1250496, "process_user_time": 1.803608, "process_kernel_time": 0.335183, "process_mem_max_rss": "122776", "process_in_blocks": "96", "process_out_blocks": "0"}
[0m22:43:55.520684 [debug] [MainThread]: Command `dbt test` succeeded at 22:43:55.520561 after 2.13 seconds
[0m22:43:55.521680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e9739670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e7c6dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7711e7655880>]}
[0m22:43:55.522718 [debug] [MainThread]: Flushing usage events
[0m22:44:34.183194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982bc557670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982bb74f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982ba41c190>]}


============================== 22:44:34.186952 | 91827eef-3c2b-4347-be08-c66ca9d1bc16 ==============================
[0m22:44:34.186952 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:44:34.188827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:44:34.418370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982ba55dd60>]}
[0m22:44:34.463775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982ba474880>]}
[0m22:44:34.465815 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:44:34.562118 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:44:35.453065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:44:35.453961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:44:35.460923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:44:35.499719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b8b49e50>]}
[0m22:44:35.670670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b8cd7e50>]}
[0m22:44:35.671693 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:44:35.672594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b9166f10>]}
[0m22:44:35.674736 [info ] [MainThread]: 
[0m22:44:35.675859 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:44:35.682212 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:44:35.698313 [debug] [ThreadPool]: dbt-sqlserver
[0m22:44:35.699759 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:44:35.700865 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:44:35.701817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:35.702918 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:35.733451 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:35.736344 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:44:35.738352 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:44:35.740180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_dbo)
[0m22:44:35.746606 [debug] [ThreadPool]: dbt-sqlserver
[0m22:44:35.747387 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:44:35.748088 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:44:35.748767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:35.749415 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:35.750119 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:35.754534 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:44:35.756302 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:44:35.757059 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:44:35.759371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b82c7e20>]}
[0m22:44:35.760258 [debug] [MainThread]: On master: COMMIT
[0m22:44:35.761145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:44:35.762046 [info ] [MainThread]: 
[0m22:44:35.765580 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m22:44:35.766037 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m22:44:35.766429 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m22:44:35.766747 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:44:35.767354 [info ] [Thread-1  ]: 1 of 4 START sql view model dbo.brnz_customers ................................. [RUN]
[0m22:44:35.768480 [info ] [Thread-2  ]: 2 of 4 START sql view model dbo.brnz_example ................................... [RUN]
[0m22:44:35.769633 [info ] [Thread-3  ]: 3 of 4 START sql view model dbo.brnz_products .................................. [RUN]
[0m22:44:35.770683 [info ] [Thread-4  ]: 4 of 4 START sql view model dbo.brnz_sales_orders .............................. [RUN]
[0m22:44:35.771732 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now model.dbt_sqlserver_project.brnz_customers)
[0m22:44:35.772723 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_example'
[0m22:44:35.773649 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_products'
[0m22:44:35.774557 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m22:44:35.775342 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m22:44:35.776126 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m22:44:35.776906 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m22:44:35.777615 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:44:35.787682 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:44:35.791461 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m22:44:35.795225 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m22:44:35.799281 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:44:35.805753 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m22:44:35.806485 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m22:44:35.807548 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m22:44:35.813285 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:44:35.847351 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:44:35.848383 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m22:44:35.853609 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m22:44:35.858845 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:44:35.867015 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:44:35.868238 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:44:35.869324 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:44:35.869939 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:44:35.871159 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:44:35.871734 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:44:35.872545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:44:35.873544 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:44:35.874415 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:44:35.875270 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "dbo"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:44:35.876151 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:35.877000 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:44:35.877868 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:35.878714 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:44:35.879529 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:35.880171 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:35.881625 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:35.893712 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.895084 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:35.902532 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:35.902975 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:35.903403 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:44:35.906058 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_customers', 'brnz_customers__dbt_backup'
[0m22:44:35.912808 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.913268 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.913804 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.914126 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.919135 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:44:35.923273 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:44:35.927064 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:44:35.931173 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:44:35.932788 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m22:44:35.934285 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_example', 'brnz_example__dbt_backup'
[0m22:44:35.935463 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_customers__dbt_tmp', 'brnz_customers'
[0m22:44:35.936498 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_products', 'brnz_products__dbt_backup'
[0m22:44:35.948889 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.949386 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.949844 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.950289 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:44:35.954270 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:44:35.957705 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:44:35.973776 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m22:44:35.977939 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:44:35.980136 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_products__dbt_tmp', 'brnz_products'
[0m22:44:35.981870 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m22:44:35.988923 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_customers__dbt_backup"
[0m22:44:35.990342 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'dbo.brnz_example__dbt_tmp', 'brnz_example'
[0m22:44:36.000264 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:44:36.000745 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.001171 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.002707 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:44:36.004916 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m22:44:36.006686 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m22:44:36.007694 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:44:36.011107 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_products__dbt_backup"
[0m22:44:36.011498 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.014533 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_sales_orders__dbt_backup"
[0m22:44:36.016422 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:44:36.018102 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.019124 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m22:44:36.020093 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:44:36.021035 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:44:36.022884 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:44:36.026507 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."dbo"."brnz_example__dbt_backup"
[0m22:44:36.027438 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:44:36.028293 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:44:36.029112 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_customers__dbt_backup";');

[0m22:44:36.030209 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:44:36.030987 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:44:36.033384 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:44:36.034028 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.035522 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:44:36.037620 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:44:36.038965 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_products__dbt_backup";');

[0m22:44:36.040124 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.040528 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.040939 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.042747 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:44:36.045738 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m22:44:36.046231 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.047792 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:44:36.048473 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_sales_orders__dbt_backup";');

[0m22:44:36.049333 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m22:44:36.051042 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m22:44:36.051728 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "dbo"."brnz_example__dbt_backup";');

[0m22:44:36.054422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b82b2880>]}
[0m22:44:36.055532 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m22:44:36.057113 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbo.brnz_customers ............................ [[32mOK[0m in 0.28s]
[0m22:44:36.058521 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b80874f0>]}
[0m22:44:36.059230 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.059741 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m22:44:36.060857 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dbo.brnz_products ............................. [[32mOK[0m in 0.28s]
[0m22:44:36.061447 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:44:36.063167 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m22:44:36.064674 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m22:44:36.066544 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m22:44:36.067527 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m22:44:36.068858 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m22:44:36.069689 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b80f30d0>]}
[0m22:44:36.070558 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91827eef-3c2b-4347-be08-c66ca9d1bc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b9082e50>]}
[0m22:44:36.071397 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dbo.brnz_sales_orders ......................... [[32mOK[0m in 0.30s]
[0m22:44:36.072481 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dbo.brnz_example .............................. [[32mOK[0m in 0.30s]
[0m22:44:36.073628 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:44:36.074699 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m22:44:36.077299 [debug] [MainThread]: On master: COMMIT
[0m22:44:36.078125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:36.078902 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_customers' was properly closed.
[0m22:44:36.079533 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_example' was properly closed.
[0m22:44:36.080130 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_products' was properly closed.
[0m22:44:36.080745 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_sales_orders' was properly closed.
[0m22:44:36.081503 [info ] [MainThread]: 
[0m22:44:36.082393 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m22:44:36.084056 [debug] [MainThread]: Command end result
[0m22:44:36.138052 [info ] [MainThread]: 
[0m22:44:36.139094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:44:36.140041 [info ] [MainThread]: 
[0m22:44:36.141030 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:44:36.142469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0332327, "process_user_time": 1.927356, "process_kernel_time": 0.182424, "process_mem_max_rss": "123712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:44:36.143378 [debug] [MainThread]: Command `dbt run` succeeded at 22:44:36.143269 after 2.03 seconds
[0m22:44:36.144159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982bc557670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b900e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982b8b8bf70>]}
[0m22:44:36.144949 [debug] [MainThread]: Flushing usage events
[0m22:44:39.824588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e40b7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e32ae610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e1f7c190>]}


============================== 22:44:39.828128 | ac5d2b1a-d047-42b8-b1f2-1544065b3f90 ==============================
[0m22:44:39.828128 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:44:39.829368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:44:40.050772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac5d2b1a-d047-42b8-b1f2-1544065b3f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e20bcd60>]}
[0m22:44:40.096439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac5d2b1a-d047-42b8-b1f2-1544065b3f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e1f57880>]}
[0m22:44:40.098845 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:44:40.197062 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:44:41.114712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:44:41.115614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:44:41.123384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:44:41.167312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac5d2b1a-d047-42b8-b1f2-1544065b3f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e06a7e50>]}
[0m22:44:41.357106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac5d2b1a-d047-42b8-b1f2-1544065b3f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e1fad5e0>]}
[0m22:44:41.358493 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:44:41.359666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac5d2b1a-d047-42b8-b1f2-1544065b3f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e0cfe640>]}
[0m22:44:41.362224 [info ] [MainThread]: 
[0m22:44:41.363627 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:44:41.370459 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_dbo'
[0m22:44:41.389890 [debug] [ThreadPool]: dbt-sqlserver
[0m22:44:41.391620 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_dbo"
[0m22:44:41.392945 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_dbo"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:44:41.394362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:41.395527 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:41.421089 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:41.425760 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:44:41.427845 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: ROLLBACK
[0m22:44:41.428816 [debug] [ThreadPool]: On list_AdventureWorks2014_dbo: Close
[0m22:44:41.431329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac5d2b1a-d047-42b8-b1f2-1544065b3f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e1fc1fd0>]}
[0m22:44:41.432260 [debug] [MainThread]: On master: COMMIT
[0m22:44:41.433351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:44:41.434683 [info ] [MainThread]: 
[0m22:44:41.438609 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:44:41.439038 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:44:41.439400 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:44:41.440137 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:44:41.440960 [info ] [Thread-2  ]: 2 of 3 START test not_null_brnz_sales_orders_order_detail_id ................... [RUN]
[0m22:44:41.442067 [info ] [Thread-3  ]: 3 of 3 START test not_null_brnz_sales_orders_sales_order_id .................... [RUN]
[0m22:44:41.443369 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_dbo, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m22:44:41.444405 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac'
[0m22:44:41.445379 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m22:44:41.446235 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:44:41.447044 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:44:41.447798 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:44:41.468563 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:44:41.477754 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:44:41.482935 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:44:41.491801 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:44:41.492788 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:44:41.499321 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:44:41.524254 [debug] [Thread-3  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m22:44:41.525639 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m22:44:41.529187 [debug] [Thread-2  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m22:44:41.530913 [debug] [Thread-3  ]: local_md5(invocation_id): 8a8e06e7c12c5ad17e76c19d73fc2c16
[0m22:44:41.532156 [debug] [Thread-1  ]: local_md5(invocation_id): 8a8e06e7c12c5ad17e76c19d73fc2c16
[0m22:44:41.533325 [debug] [Thread-2  ]: local_md5(invocation_id): 8a8e06e7c12c5ad17e76c19d73fc2c16
[0m22:44:41.534787 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:44:41.536176 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:44:41.537768 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:44:41.543623 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:44:41.544876 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:44:41.545808 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_66e870acbab423e4f9fab54d0329fd80]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."dbo"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_66e870acbab423e4f9fab54d0329fd80]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_66e870acbab423e4f9fab54d0329fd80]
  ;')
[0m22:44:41.546481 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:44:41.547565 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_f243df3826fbaf3e614fedee29680995]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."dbo"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_f243df3826fbaf3e614fedee29680995]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_f243df3826fbaf3e614fedee29680995]
  ;')
[0m22:44:41.548902 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:44:41.549848 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_d0c6d22e392e82133af15e1d03cdbfa3]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."dbo"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_d0c6d22e392e82133af15e1d03cdbfa3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_d0c6d22e392e82133af15e1d03cdbfa3]
  ;')
[0m22:44:41.550971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:44:41.551910 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:41.552766 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:44:41.553598 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:41.554582 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:41.555325 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:44:41.570472 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:41.574799 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:44:41.576494 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:44:41.582275 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m22:44:41.590932 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m22:44:41.592330 [info ] [Thread-3  ]: 3 of 3 PASS not_null_brnz_sales_orders_sales_order_id .......................... [[32mPASS[0m in 0.15s]
[0m22:44:41.593832 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:44:41.648593 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:44:41.651645 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m22:44:41.652672 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m22:44:41.653797 [info ] [Thread-2  ]: 2 of 3 PASS not_null_brnz_sales_orders_order_detail_id ......................... [[32mPASS[0m in 0.21s]
[0m22:44:41.655090 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:44:41.677126 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:44:41.679466 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m22:44:41.680387 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m22:44:41.681454 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.24s]
[0m22:44:41.682777 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:44:41.685376 [debug] [MainThread]: On master: COMMIT
[0m22:44:41.686409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:41.687122 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902' was properly closed.
[0m22:44:41.687737 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac' was properly closed.
[0m22:44:41.688426 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca' was properly closed.
[0m22:44:41.689123 [info ] [MainThread]: 
[0m22:44:41.690068 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m22:44:41.691530 [debug] [MainThread]: Command end result
[0m22:44:41.745867 [info ] [MainThread]: 
[0m22:44:41.747158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:44:41.748086 [info ] [MainThread]: 
[0m22:44:41.749075 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:44:41.750647 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9936265, "process_user_time": 1.695684, "process_kernel_time": 0.193679, "process_mem_max_rss": "122428", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:44:41.751590 [debug] [MainThread]: Command `dbt test` succeeded at 22:44:41.751474 after 1.99 seconds
[0m22:44:41.752421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e40b7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e2bba670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e59e1f57880>]}
[0m22:44:41.753194 [debug] [MainThread]: Flushing usage events
[0m22:46:12.119112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607503e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756072f465b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756072f46610>]}


============================== 22:46:12.123273 | 67e6b64f-97e9-4b22-b7f3-755347a74a4d ==============================
[0m22:46:12.123273 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:46:12.124826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:46:12.392392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756072ee7190>]}
[0m22:46:12.509911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756071c4dc40>]}
[0m22:46:12.511690 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:46:12.612598 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:46:12.753452 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:46:12.755227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756074248c40>]}
[0m22:46:15.176113 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:46:15.178553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560706b2520>]}
[0m22:46:15.380379 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.gold
- models.dbt_sqlserver_project.silver
[0m22:46:15.393890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560706b9160>]}
[0m22:46:15.535536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560707b2c70>]}
[0m22:46:15.536609 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:46:15.537569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607079a130>]}
[0m22:46:15.539579 [info ] [MainThread]: 
[0m22:46:15.540727 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:46:15.546632 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:46:15.562275 [debug] [ThreadPool]: dbt-sqlserver
[0m22:46:15.563539 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:46:15.564429 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:46:15.565399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:15.566617 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:15.595942 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:15.598479 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:46:15.600363 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:46:15.601866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now create_AdventureWorks2014_bronze)
[0m22:46:15.603735 [debug] [ThreadPool]: Creating schema "database: "AdventureWorks2014"
schema: "bronze"
"
[0m22:46:15.609472 [debug] [ThreadPool]: Using sqlserver connection "create_AdventureWorks2014_bronze"
[0m22:46:15.610370 [debug] [ThreadPool]: On create_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "create_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
    BEGIN
    EXEC('CREATE SCHEMA [bronze]')
    END
  
[0m22:46:15.611170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:15.611899 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:15.612674 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:15.632995 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:46:15.635076 [debug] [ThreadPool]: On create_AdventureWorks2014_bronze: COMMIT
[0m22:46:15.636068 [debug] [ThreadPool]: On create_AdventureWorks2014_bronze: Close
[0m22:46:15.637926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AdventureWorks2014_bronze, now list_AdventureWorks2014_bronze)
[0m22:46:15.644961 [debug] [ThreadPool]: dbt-sqlserver
[0m22:46:15.645880 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:46:15.647095 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:46:15.648477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:15.649782 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:15.651421 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:15.679836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:46:15.681815 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:46:15.682771 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:46:15.684109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756071b65a00>]}
[0m22:46:15.685438 [debug] [MainThread]: On master: COMMIT
[0m22:46:15.686669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:15.687865 [info ] [MainThread]: 
[0m22:46:15.691933 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m22:46:15.692551 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m22:46:15.692900 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m22:46:15.693292 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:46:15.693980 [info ] [Thread-1  ]: 1 of 4 START sql view model bronze.brnz_customers .............................. [RUN]
[0m22:46:15.695148 [info ] [Thread-2  ]: 2 of 4 START sql view model bronze.brnz_example ................................ [RUN]
[0m22:46:15.696194 [info ] [Thread-3  ]: 3 of 4 START sql view model bronze.brnz_products ............................... [RUN]
[0m22:46:15.697248 [info ] [Thread-4  ]: 4 of 4 START sql view model bronze.brnz_sales_orders ........................... [RUN]
[0m22:46:15.698348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_customers)
[0m22:46:15.699303 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_example'
[0m22:46:15.700265 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_products'
[0m22:46:15.701252 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m22:46:15.702350 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m22:46:15.703204 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m22:46:15.704059 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m22:46:15.704848 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:46:15.713695 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:46:15.717329 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m22:46:15.721908 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m22:46:15.726944 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:46:15.737154 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m22:46:15.738039 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m22:46:15.745495 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m22:46:15.745908 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:46:15.776428 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m22:46:15.777382 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:46:15.781800 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m22:46:15.787790 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:46:15.797822 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:46:15.799226 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:46:15.799949 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:46:15.800784 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:46:15.802338 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:46:15.803192 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:46:15.804720 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:46:15.806025 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:46:15.807351 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:46:15.808700 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:46:15.809847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:46:15.810805 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:15.811663 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:46:15.812698 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:15.814017 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:15.815354 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:15.816330 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:15.831049 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.839389 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:15.842986 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:46:15.843596 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:15.844179 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:15.845763 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m22:46:15.856615 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.857233 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.862321 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:46:15.881229 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m22:46:15.881717 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.882215 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.883441 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m22:46:15.891753 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m22:46:15.897374 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:46:15.904309 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:46:15.915136 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:46:15.916585 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m22:46:15.917252 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.918287 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m22:46:15.919850 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:46:15.922741 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m22:46:15.924823 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:46:15.928880 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m22:46:15.931648 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:46:15.932932 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:46:15.934321 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.934913 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.935420 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:46:15.938054 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m22:46:15.940111 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m22:46:15.945692 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m22:46:15.946281 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.949842 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m22:46:15.952148 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:46:15.952679 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.954859 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:46:15.955826 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:46:15.956886 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:46:15.959115 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:46:15.960066 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m22:46:15.961208 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:46:15.962229 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:46:15.963376 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m22:46:15.965091 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:46:15.967000 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.972551 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m22:46:15.973123 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.978902 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m22:46:15.979642 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.981563 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m22:46:15.981994 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:46:15.984320 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756070533340>]}
[0m22:46:15.987037 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:46:15.988490 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m22:46:15.991255 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:46:15.992510 [info ] [Thread-2  ]: 2 of 4 OK created sql view model bronze.brnz_example ........................... [[32mOK[0m in 0.28s]
[0m22:46:15.993595 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m22:46:15.995031 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756070324820>]}
[0m22:46:15.996231 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m22:46:15.997362 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m22:46:15.999159 [info ] [Thread-4  ]: 4 of 4 OK created sql view model bronze.brnz_sales_orders ...................... [[32mOK[0m in 0.29s]
[0m22:46:16.000865 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:46:16.002928 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:46:16.003366 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:46:16.005176 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m22:46:16.007758 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m22:46:16.008609 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m22:46:16.009252 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m22:46:16.010255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607030e880>]}
[0m22:46:16.011296 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e6b64f-97e9-4b22-b7f3-755347a74a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560702cf070>]}
[0m22:46:16.012826 [info ] [Thread-1  ]: 1 of 4 OK created sql view model bronze.brnz_customers ......................... [[32mOK[0m in 0.31s]
[0m22:46:16.014325 [info ] [Thread-3  ]: 3 of 4 OK created sql view model bronze.brnz_products .......................... [[32mOK[0m in 0.31s]
[0m22:46:16.015650 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m22:46:16.016773 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m22:46:16.020142 [debug] [MainThread]: On master: COMMIT
[0m22:46:16.021158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:16.021882 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_customers' was properly closed.
[0m22:46:16.022680 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_example' was properly closed.
[0m22:46:16.023456 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_products' was properly closed.
[0m22:46:16.024085 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_sales_orders' was properly closed.
[0m22:46:16.024818 [info ] [MainThread]: 
[0m22:46:16.025948 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m22:46:16.027726 [debug] [MainThread]: Command end result
[0m22:46:16.104022 [info ] [MainThread]: 
[0m22:46:16.105812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:16.107080 [info ] [MainThread]: 
[0m22:46:16.108416 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:46:16.110882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0617065, "process_user_time": 3.391028, "process_kernel_time": 0.330734, "process_mem_max_rss": "128720", "process_in_blocks": "16", "process_out_blocks": "0"}
[0m22:46:16.112250 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:16.112100 after 4.06 seconds
[0m22:46:16.113298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607503e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756073572400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756071c4dc40>]}
[0m22:46:16.114340 [debug] [MainThread]: Flushing usage events
[0m22:46:20.388948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59698fe5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59677883d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5967788370>]}


============================== 22:46:20.394362 | 4ec5f799-a0e9-4c01-97fe-0f90a0bca27e ==============================
[0m22:46:20.394362 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:46:20.396160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:46:20.647697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ec5f799-a0e9-4c01-97fe-0f90a0bca27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596650dbb0>]}
[0m22:46:20.697705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ec5f799-a0e9-4c01-97fe-0f90a0bca27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59677f5a30>]}
[0m22:46:20.699595 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:46:20.803231 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:46:21.709282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:46:21.710249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:46:21.717197 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.gold
- models.dbt_sqlserver_project.silver
[0m22:46:21.759015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ec5f799-a0e9-4c01-97fe-0f90a0bca27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5965ee5130>]}
[0m22:46:21.949657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ec5f799-a0e9-4c01-97fe-0f90a0bca27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596649ebe0>]}
[0m22:46:21.950847 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:46:21.951933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ec5f799-a0e9-4c01-97fe-0f90a0bca27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5969aea370>]}
[0m22:46:21.955383 [info ] [MainThread]: 
[0m22:46:21.956673 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:46:21.963226 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m22:46:21.982113 [debug] [ThreadPool]: dbt-sqlserver
[0m22:46:21.983760 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:46:21.985308 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:46:21.986594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:21.987865 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:22.013473 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:22.017991 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:46:22.020583 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:46:22.021529 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:46:22.023218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ec5f799-a0e9-4c01-97fe-0f90a0bca27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596641dc10>]}
[0m22:46:22.024122 [debug] [MainThread]: On master: COMMIT
[0m22:46:22.025090 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:22.026127 [info ] [MainThread]: 
[0m22:46:22.029820 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:46:22.030322 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:46:22.030727 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:46:22.031498 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:46:22.032570 [info ] [Thread-2  ]: 2 of 3 START test not_null_brnz_sales_orders_order_detail_id ................... [RUN]
[0m22:46:22.033541 [info ] [Thread-3  ]: 3 of 3 START test not_null_brnz_sales_orders_sales_order_id .................... [RUN]
[0m22:46:22.034690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m22:46:22.036102 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac'
[0m22:46:22.037368 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m22:46:22.038317 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:46:22.039255 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:46:22.040108 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:46:22.058649 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:46:22.067238 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:46:22.073092 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:46:22.081655 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:46:22.082862 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:46:22.089123 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:46:22.107469 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m22:46:22.110557 [debug] [Thread-3  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m22:46:22.114028 [debug] [Thread-2  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m22:46:22.115804 [debug] [Thread-1  ]: local_md5(invocation_id): e1073b5f917aedefa4b34eaca2f03d2c
[0m22:46:22.117491 [debug] [Thread-3  ]: local_md5(invocation_id): e1073b5f917aedefa4b34eaca2f03d2c
[0m22:46:22.118992 [debug] [Thread-2  ]: local_md5(invocation_id): e1073b5f917aedefa4b34eaca2f03d2c
[0m22:46:22.120914 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:46:22.123108 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:46:22.125162 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:46:22.133168 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:46:22.134551 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:46:22.135612 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_f16d012ef9f0bfe89900553994adb218]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_f16d012ef9f0bfe89900553994adb218]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_f16d012ef9f0bfe89900553994adb218]
  ;')
[0m22:46:22.136479 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:46:22.137603 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b6d0cc64da0f8c512ddf98c853ab6ef5]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b6d0cc64da0f8c512ddf98c853ab6ef5]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b6d0cc64da0f8c512ddf98c853ab6ef5]
  ;')
[0m22:46:22.138543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:46:22.139380 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3bf9cac2fa3f1a1c96245ee4e2bd66a2]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3bf9cac2fa3f1a1c96245ee4e2bd66a2]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3bf9cac2fa3f1a1c96245ee4e2bd66a2]
  ;')
[0m22:46:22.140204 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:46:22.141087 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:22.141889 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:46:22.142743 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:22.143736 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:22.144352 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:46:22.158591 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:22.159322 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:46:22.174737 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:46:22.182298 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m22:46:22.183766 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m22:46:22.185501 [info ] [Thread-3  ]: 3 of 3 PASS not_null_brnz_sales_orders_sales_order_id .......................... [[32mPASS[0m in 0.15s]
[0m22:46:22.187379 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:46:22.216449 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:46:22.220346 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m22:46:22.221863 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m22:46:22.223401 [info ] [Thread-2  ]: 2 of 3 PASS not_null_brnz_sales_orders_order_detail_id ......................... [[32mPASS[0m in 0.19s]
[0m22:46:22.224929 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:46:22.259218 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:46:22.262232 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m22:46:22.263552 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m22:46:22.265434 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.23s]
[0m22:46:22.267035 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:46:22.269925 [debug] [MainThread]: On master: COMMIT
[0m22:46:22.272168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:22.273400 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902' was properly closed.
[0m22:46:22.274500 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac' was properly closed.
[0m22:46:22.275546 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca' was properly closed.
[0m22:46:22.276694 [info ] [MainThread]: 
[0m22:46:22.278098 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m22:46:22.280472 [debug] [MainThread]: Command end result
[0m22:46:22.354576 [info ] [MainThread]: 
[0m22:46:22.355661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:22.356680 [info ] [MainThread]: 
[0m22:46:22.357659 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:46:22.359105 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0387669, "process_user_time": 1.795806, "process_kernel_time": 0.278728, "process_mem_max_rss": "122084", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:46:22.360107 [debug] [MainThread]: Command `dbt test` succeeded at 22:46:22.359918 after 2.04 seconds
[0m22:46:22.360908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59698fe5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5968401cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59677f5a30>]}
[0m22:46:22.361690 [debug] [MainThread]: Flushing usage events
[0m22:49:34.033337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767efb2f1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767efa4e8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef91b5190>]}


============================== 22:49:34.037364 | a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8 ==============================
[0m22:49:34.037364 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:49:34.038528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:34.297574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767efb0cfcd0>]}
[0m22:49:34.343356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef7db9910>]}
[0m22:49:34.345484 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:49:34.443687 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:49:35.385397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:35.386397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:35.393610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:49:35.433969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef78dfdf0>]}
[0m22:49:35.629404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef7968850>]}
[0m22:49:35.630390 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:49:35.631333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef7e77520>]}
[0m22:49:35.633569 [info ] [MainThread]: 
[0m22:49:35.634918 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:49:35.640955 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:49:35.657204 [debug] [ThreadPool]: dbt-sqlserver
[0m22:49:35.658872 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:49:35.660028 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:49:35.661286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:35.662421 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:35.689435 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:35.691923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:35.693760 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:49:35.695531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m22:49:35.702022 [debug] [ThreadPool]: dbt-sqlserver
[0m22:49:35.702885 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:49:35.703609 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:49:35.704326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:35.704984 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:35.705686 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:35.709965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:35.711625 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:49:35.712312 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:49:35.713799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef7e77520>]}
[0m22:49:35.714689 [debug] [MainThread]: On master: COMMIT
[0m22:49:35.715552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:35.716354 [info ] [MainThread]: 
[0m22:49:35.720049 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m22:49:35.720524 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m22:49:35.720994 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m22:49:35.721471 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:49:35.722125 [info ] [Thread-1  ]: 1 of 4 START sql view model bronze.brnz_customers .............................. [RUN]
[0m22:49:35.723307 [info ] [Thread-2  ]: 2 of 4 START sql view model bronze.brnz_example ................................ [RUN]
[0m22:49:35.724455 [info ] [Thread-3  ]: 3 of 4 START sql view model bronze.brnz_products ............................... [RUN]
[0m22:49:35.725541 [info ] [Thread-4  ]: 4 of 4 START sql view model bronze.brnz_sales_orders ........................... [RUN]
[0m22:49:35.726758 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_customers)
[0m22:49:35.727679 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_example'
[0m22:49:35.728562 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_products'
[0m22:49:35.729423 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m22:49:35.730208 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m22:49:35.730964 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m22:49:35.731795 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m22:49:35.732532 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:49:35.742306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:49:35.746427 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m22:49:35.750585 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m22:49:35.755137 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:49:35.763363 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:49:35.765327 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m22:49:35.771275 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m22:49:35.771867 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m22:49:35.804058 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m22:49:35.804926 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:49:35.809381 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:49:35.814226 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m22:49:35.825381 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:49:35.826722 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:49:35.827759 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:49:35.828349 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:49:35.829256 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:49:35.830027 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:49:35.831571 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:49:35.832971 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:49:35.834288 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:49:35.835499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:49:35.836699 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:35.837606 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:49:35.838494 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:49:35.839372 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:35.840347 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:35.841005 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:35.841880 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:35.866517 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.867305 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:35.870065 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:35.870864 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:35.882608 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:49:35.886525 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m22:49:35.898144 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.898697 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.899110 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.903757 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:49:35.904217 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.908881 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:49:35.912722 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:49:35.914261 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m22:49:35.919081 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:49:35.920846 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m22:49:35.921865 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m22:49:35.924267 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m22:49:35.933467 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.934069 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.934464 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.934817 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.940455 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:49:35.946210 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:49:35.965459 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m22:49:35.968800 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:49:35.970768 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m22:49:35.972261 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m22:49:35.980777 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m22:49:35.982075 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m22:49:35.993156 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:49:35.994915 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.995340 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:49:35.996013 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:49:35.998036 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m22:49:35.999830 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m22:49:36.000538 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.001088 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:49:36.005036 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m22:49:36.009865 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m22:49:36.012369 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m22:49:36.014344 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:49:36.015320 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.016185 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:49:36.020711 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m22:49:36.021926 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:49:36.024033 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:49:36.024573 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:49:36.025705 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:49:36.026582 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:49:36.027421 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m22:49:36.028213 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:49:36.029120 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:49:36.032119 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.032913 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.033291 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:49:36.035983 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:49:36.038036 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.038693 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:49:36.039964 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m22:49:36.042937 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m22:49:36.043318 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.043865 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m22:49:36.045417 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m22:49:36.047294 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:49:36.049922 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef6a4bee0>]}
[0m22:49:36.051024 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.051517 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m22:49:36.052819 [info ] [Thread-2  ]: 2 of 4 OK created sql view model bronze.brnz_example ........................... [[32mOK[0m in 0.32s]
[0m22:49:36.054851 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m22:49:36.056467 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m22:49:36.056836 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.057592 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m22:49:36.060362 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m22:49:36.061178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef705fa30>]}
[0m22:49:36.062041 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m22:49:36.062928 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:49:36.063510 [info ] [Thread-1  ]: 1 of 4 OK created sql view model bronze.brnz_customers ......................... [[32mOK[0m in 0.33s]
[0m22:49:36.064558 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef7e77520>]}
[0m22:49:36.066405 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m22:49:36.067332 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m22:49:36.068629 [info ] [Thread-3  ]: 3 of 4 OK created sql view model bronze.brnz_products .......................... [[32mOK[0m in 0.34s]
[0m22:49:36.069562 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m22:49:36.071347 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m22:49:36.072284 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18c61a2-5d60-4e7a-9c6a-2ee6bbc6b0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef705f910>]}
[0m22:49:36.073782 [info ] [Thread-4  ]: 4 of 4 OK created sql view model bronze.brnz_sales_orders ...................... [[32mOK[0m in 0.34s]
[0m22:49:36.074823 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:49:36.077157 [debug] [MainThread]: On master: COMMIT
[0m22:49:36.078046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:36.078785 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_customers' was properly closed.
[0m22:49:36.079443 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_example' was properly closed.
[0m22:49:36.080136 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_products' was properly closed.
[0m22:49:36.080773 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_sales_orders' was properly closed.
[0m22:49:36.081506 [info ] [MainThread]: 
[0m22:49:36.082379 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m22:49:36.084003 [debug] [MainThread]: Command end result
[0m22:49:36.150859 [info ] [MainThread]: 
[0m22:49:36.152067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:36.153190 [info ] [MainThread]: 
[0m22:49:36.154216 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:49:36.155714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2044196, "process_user_time": 1.999232, "process_kernel_time": 0.319238, "process_mem_max_rss": "124120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:49:36.156576 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:36.156472 after 2.21 seconds
[0m22:49:36.157402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767efb2f1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ef40c8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767efafe3670>]}
[0m22:49:36.158197 [debug] [MainThread]: Flushing usage events
[0m22:49:40.231317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52d067640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52aef15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52aef1580>]}


============================== 22:49:40.235054 | 0980a4a1-feb0-4f4f-84eb-4d260f5539ec ==============================
[0m22:49:40.235054 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:49:40.236488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:40.483441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0980a4a1-feb0-4f4f-84eb-4d260f5539ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa529b861c0>]}
[0m22:49:40.530873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0980a4a1-feb0-4f4f-84eb-4d260f5539ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa529b944f0>]}
[0m22:49:40.533304 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:49:40.633522 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:49:41.513172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:41.514268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:41.521651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.gold
- models.dbt_sqlserver_project.silver
[0m22:49:41.561755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0980a4a1-feb0-4f4f-84eb-4d260f5539ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa529654dc0>]}
[0m22:49:41.755618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0980a4a1-feb0-4f4f-84eb-4d260f5539ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52af27580>]}
[0m22:49:41.756896 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:49:41.758079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0980a4a1-feb0-4f4f-84eb-4d260f5539ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa529befbe0>]}
[0m22:49:41.760987 [info ] [MainThread]: 
[0m22:49:41.762429 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:49:41.768702 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m22:49:41.787082 [debug] [ThreadPool]: dbt-sqlserver
[0m22:49:41.789089 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:49:41.790637 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:49:41.793103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.794621 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:41.828991 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:41.833494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:41.836541 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:49:41.837731 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:49:41.839647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0980a4a1-feb0-4f4f-84eb-4d260f5539ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52af116d0>]}
[0m22:49:41.840770 [debug] [MainThread]: On master: COMMIT
[0m22:49:41.842461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:41.844406 [info ] [MainThread]: 
[0m22:49:41.848775 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:49:41.849202 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:49:41.849581 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:49:41.850321 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:49:41.851559 [info ] [Thread-2  ]: 2 of 3 START test not_null_brnz_sales_orders_order_detail_id ................... [RUN]
[0m22:49:41.853069 [info ] [Thread-3  ]: 3 of 3 START test not_null_brnz_sales_orders_sales_order_id .................... [RUN]
[0m22:49:41.854588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m22:49:41.855840 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac'
[0m22:49:41.856975 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m22:49:41.857941 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:49:41.858855 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:49:41.860133 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:49:41.881336 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:49:41.889630 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:49:41.894339 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:49:41.904148 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:49:41.905717 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:49:41.911473 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:49:41.936361 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m22:49:41.936960 [debug] [Thread-3  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m22:49:41.940173 [debug] [Thread-2  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m22:49:41.941775 [debug] [Thread-1  ]: local_md5(invocation_id): e7589934b23e83eed9aea0377fb08a0d
[0m22:49:41.943522 [debug] [Thread-3  ]: local_md5(invocation_id): e7589934b23e83eed9aea0377fb08a0d
[0m22:49:41.944837 [debug] [Thread-2  ]: local_md5(invocation_id): e7589934b23e83eed9aea0377fb08a0d
[0m22:49:41.946456 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:49:41.948159 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:49:41.949584 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:49:41.957200 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:49:41.959130 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:49:41.960121 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_ef6a2a3dec9256febaef0d08aab24828]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_ef6a2a3dec9256febaef0d08aab24828]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_ef6a2a3dec9256febaef0d08aab24828]
  ;')
[0m22:49:41.961349 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:49:41.961898 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3db2d9b98a40a0a7c23ac17a52aaf4bf]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3db2d9b98a40a0a7c23ac17a52aaf4bf]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3db2d9b98a40a0a7c23ac17a52aaf4bf]
  ;')
[0m22:49:41.962878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:49:41.963928 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_48d2d8975b94001488ccb8115b6a9f93]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_48d2d8975b94001488ccb8115b6a9f93]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_48d2d8975b94001488ccb8115b6a9f93]
  ;')
[0m22:49:41.964850 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:49:41.965683 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:41.966754 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:49:41.967772 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:41.968730 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:41.969342 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:49:41.982313 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:41.984725 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:49:42.003377 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:49:42.009226 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m22:49:42.010643 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m22:49:42.011994 [info ] [Thread-3  ]: 3 of 3 PASS not_null_brnz_sales_orders_sales_order_id .......................... [[32mPASS[0m in 0.16s]
[0m22:49:42.013340 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:49:42.037952 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:49:42.040476 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m22:49:42.041595 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m22:49:42.042713 [info ] [Thread-2  ]: 2 of 3 PASS not_null_brnz_sales_orders_order_detail_id ......................... [[32mPASS[0m in 0.19s]
[0m22:49:42.044159 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:49:42.070942 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:49:42.073806 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m22:49:42.075044 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m22:49:42.076511 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.22s]
[0m22:49:42.078283 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:49:42.081491 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.082661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:42.083466 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902' was properly closed.
[0m22:49:42.084316 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac' was properly closed.
[0m22:49:42.085458 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca' was properly closed.
[0m22:49:42.086555 [info ] [MainThread]: 
[0m22:49:42.087723 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m22:49:42.089988 [debug] [MainThread]: Command end result
[0m22:49:42.161481 [info ] [MainThread]: 
[0m22:49:42.162741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:42.163727 [info ] [MainThread]: 
[0m22:49:42.164761 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:49:42.166161 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.00119, "process_user_time": 1.800194, "process_kernel_time": 0.287868, "process_mem_max_rss": "122568", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m22:49:42.167130 [debug] [MainThread]: Command `dbt test` succeeded at 22:49:42.166977 after 2.00 seconds
[0m22:49:42.168175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52d067640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52af83b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52af83910>]}
[0m22:49:42.169161 [debug] [MainThread]: Flushing usage events
[0m22:54:34.508830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d714d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d4fd6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d4fd6520>]}


============================== 22:54:34.513860 | 21efb50a-ac9a-4842-b6bd-f375ff17379f ==============================
[0m22:54:34.513860 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:54:34.515260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:54:34.936689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d4f81e80>]}
[0m22:54:34.996421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d7324cd0>]}
[0m22:54:34.998449 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:54:35.110126 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:54:36.759415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:54:36.760422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:54:36.767498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.gold
- models.dbt_sqlserver_project.silver
[0m22:54:36.808730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d373be50>]}
[0m22:54:37.022166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d37c4b80>]}
[0m22:54:37.023409 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:54:37.024513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d3cd3610>]}
[0m22:54:37.026877 [info ] [MainThread]: 
[0m22:54:37.028614 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:54:37.035368 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:54:37.054302 [debug] [ThreadPool]: dbt-sqlserver
[0m22:54:37.056407 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:54:37.057528 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:54:37.058610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:37.059598 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:37.370850 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:37.375167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:54:37.377111 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:54:37.379045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m22:54:37.385465 [debug] [ThreadPool]: dbt-sqlserver
[0m22:54:37.386330 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:54:37.387032 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:54:37.387615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:54:37.388222 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:37.388940 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:37.402747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:54:37.405181 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:54:37.406656 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:54:37.408972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d3b9ba30>]}
[0m22:54:37.410071 [debug] [MainThread]: On master: COMMIT
[0m22:54:37.411176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:37.412354 [info ] [MainThread]: 
[0m22:54:37.416798 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m22:54:37.417207 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m22:54:37.417721 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m22:54:37.418158 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:54:37.418853 [info ] [Thread-1  ]: 1 of 4 START sql view model bronze.brnz_customers .............................. [RUN]
[0m22:54:37.419864 [info ] [Thread-2  ]: 2 of 4 START sql view model bronze.brnz_example ................................ [RUN]
[0m22:54:37.420921 [info ] [Thread-3  ]: 3 of 4 START sql view model bronze.brnz_products ............................... [RUN]
[0m22:54:37.422085 [info ] [Thread-4  ]: 4 of 4 START sql view model bronze.brnz_sales_orders ........................... [RUN]
[0m22:54:37.423198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_customers)
[0m22:54:37.424090 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_example'
[0m22:54:37.424973 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_products'
[0m22:54:37.425879 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m22:54:37.426692 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m22:54:37.427448 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m22:54:37.428290 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m22:54:37.429067 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:54:37.438774 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:54:37.442617 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m22:54:37.447731 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m22:54:37.452681 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:54:37.462773 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m22:54:37.463546 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m22:54:37.464609 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:54:37.470287 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m22:54:37.510346 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m22:54:37.511672 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:54:37.516074 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:54:37.522249 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m22:54:37.541107 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:54:37.542480 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:54:37.543836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:54:37.544881 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:37.545894 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:37.549550 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:54:37.550634 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:54:37.551669 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:54:37.552695 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:37.560054 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:54:37.561210 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:54:37.562265 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:54:37.563198 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:37.569784 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:54:37.570867 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:54:37.571827 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:54:37.572763 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:37.731939 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.748570 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:54:37.749357 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:37.749857 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:37.750332 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:37.751236 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m22:54:37.785666 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.788902 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.789343 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.789664 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.797764 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:54:37.802178 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:54:37.806705 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:54:37.810448 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:54:37.811646 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m22:54:37.813007 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m22:54:37.814139 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m22:54:37.815239 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m22:54:37.831311 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.831846 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.836324 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:54:37.836751 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.845757 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.853362 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m22:54:37.854131 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m22:54:37.859585 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:54:37.864228 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:54:37.871658 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m22:54:37.874267 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m22:54:37.875517 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m22:54:37.882694 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:54:37.885951 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:54:37.886743 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.887656 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:54:37.890107 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m22:54:37.894479 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m22:54:37.895084 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.895515 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.895822 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.896943 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:54:37.898819 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m22:54:37.900624 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:54:37.902279 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m22:54:37.903055 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:54:37.906215 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m22:54:37.907143 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m22:54:37.910690 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m22:54:37.912155 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:54:37.913307 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:54:37.915102 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:54:37.917043 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:54:37.918214 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:54:37.919317 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:54:37.920208 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:54:37.923703 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.924111 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.924634 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.925028 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.927408 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m22:54:37.929376 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:54:37.930988 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:54:37.932623 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:54:37.933339 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m22:54:37.933982 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m22:54:37.934895 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m22:54:37.935656 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m22:54:37.937594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d2ebceb0>]}
[0m22:54:37.940920 [info ] [Thread-1  ]: 1 of 4 OK created sql view model bronze.brnz_customers ......................... [[32mOK[0m in 0.51s]
[0m22:54:37.942488 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m22:54:37.950161 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.952419 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m22:54:37.953370 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.953758 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:54:37.954132 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m22:54:37.955883 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m22:54:37.957629 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m22:54:37.958749 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d2ed0430>]}
[0m22:54:37.959465 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m22:54:37.960019 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m22:54:37.961051 [info ] [Thread-4  ]: 4 of 4 OK created sql view model bronze.brnz_sales_orders ...................... [[32mOK[0m in 0.53s]
[0m22:54:37.962132 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d3b9ba30>]}
[0m22:54:37.963156 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21efb50a-ac9a-4842-b6bd-f375ff17379f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d28d40a0>]}
[0m22:54:37.964130 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:54:37.965336 [info ] [Thread-3  ]: 3 of 4 OK created sql view model bronze.brnz_products .......................... [[32mOK[0m in 0.54s]
[0m22:54:37.966459 [info ] [Thread-2  ]: 2 of 4 OK created sql view model bronze.brnz_example ........................... [[32mOK[0m in 0.54s]
[0m22:54:37.968652 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m22:54:37.969777 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m22:54:37.972732 [debug] [MainThread]: On master: COMMIT
[0m22:54:37.973895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:37.974654 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_customers' was properly closed.
[0m22:54:37.975461 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_example' was properly closed.
[0m22:54:37.976163 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_products' was properly closed.
[0m22:54:37.976841 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_sales_orders' was properly closed.
[0m22:54:37.977682 [info ] [MainThread]: 
[0m22:54:37.978567 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m22:54:37.980305 [debug] [MainThread]: Command end result
[0m22:54:38.035836 [info ] [MainThread]: 
[0m22:54:38.036970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:54:38.038006 [info ] [MainThread]: 
[0m22:54:38.038973 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:54:38.040774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6087937, "process_user_time": 2.505373, "process_kernel_time": 0.973835, "process_mem_max_rss": "123516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:54:38.041746 [debug] [MainThread]: Command `dbt run` succeeded at 22:54:38.041623 after 3.61 seconds
[0m22:54:38.042577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d714d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d7324cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0d37c4b50>]}
[0m22:54:38.043311 [debug] [MainThread]: Flushing usage events
[0m22:54:42.276815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4f6f4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4e8ec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4d5ba190>]}


============================== 22:54:42.280484 | 8e8fdf89-f2df-43b7-b935-98cc3fe870c7 ==============================
[0m22:54:42.280484 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:54:42.281998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:54:42.508099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e8fdf89-f2df-43b7-b935-98cc3fe870c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4f4d3cd0>]}
[0m22:54:42.555816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e8fdf89-f2df-43b7-b935-98cc3fe870c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4c1bd910>]}
[0m22:54:42.558337 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:54:42.663812 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:54:43.575595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:54:43.577465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:54:43.584935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:54:43.628282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e8fdf89-f2df-43b7-b935-98cc3fe870c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4bce2df0>]}
[0m22:54:43.820735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e8fdf89-f2df-43b7-b935-98cc3fe870c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4c218e20>]}
[0m22:54:43.822438 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:54:43.823819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8fdf89-f2df-43b7-b935-98cc3fe870c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4c27d790>]}
[0m22:54:43.826234 [info ] [MainThread]: 
[0m22:54:43.827655 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:54:43.833757 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m22:54:43.849839 [debug] [ThreadPool]: dbt-sqlserver
[0m22:54:43.851780 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:54:43.853121 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:54:43.854281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:43.855480 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:43.880698 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:43.884980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:54:43.887225 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:54:43.888110 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:54:43.889738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8fdf89-f2df-43b7-b935-98cc3fe870c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4c2ba700>]}
[0m22:54:43.890701 [debug] [MainThread]: On master: COMMIT
[0m22:54:43.891607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:43.892442 [info ] [MainThread]: 
[0m22:54:43.895941 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:54:43.896369 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:54:43.896715 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:54:43.897465 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:54:43.898452 [info ] [Thread-2  ]: 2 of 3 START test not_null_brnz_sales_orders_order_detail_id ................... [RUN]
[0m22:54:43.899430 [info ] [Thread-3  ]: 3 of 3 START test not_null_brnz_sales_orders_sales_order_id .................... [RUN]
[0m22:54:43.900514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m22:54:43.901567 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac'
[0m22:54:43.902570 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m22:54:43.903466 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:54:43.904166 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:54:43.905105 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:54:43.923309 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:54:43.931719 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:54:43.937262 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:54:43.944176 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:54:43.944862 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:54:43.951421 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:54:43.969326 [debug] [Thread-2  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m22:54:43.972028 [debug] [Thread-3  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m22:54:43.976067 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m22:54:43.977891 [debug] [Thread-2  ]: local_md5(invocation_id): 9fa18db86cfffbebf3f9a1c8db033650
[0m22:54:43.979378 [debug] [Thread-3  ]: local_md5(invocation_id): 9fa18db86cfffbebf3f9a1c8db033650
[0m22:54:43.980994 [debug] [Thread-1  ]: local_md5(invocation_id): 9fa18db86cfffbebf3f9a1c8db033650
[0m22:54:43.982660 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:54:43.983964 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:54:43.985503 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:54:43.992289 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:54:43.993051 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:54:43.994215 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_9a21293d9ff7b648566d7f111b68793b]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_9a21293d9ff7b648566d7f111b68793b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_9a21293d9ff7b648566d7f111b68793b]
  ;')
[0m22:54:43.995200 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:54:43.995984 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_2c1708a7b7eab76743e8f174cca43879]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_2c1708a7b7eab76743e8f174cca43879]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_2c1708a7b7eab76743e8f174cca43879]
  ;')
[0m22:54:43.996826 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:54:43.997635 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_64073fc312ef4eee9475d665c998a52c]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_64073fc312ef4eee9475d665c998a52c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_64073fc312ef4eee9475d665c998a52c]
  ;')
[0m22:54:43.998459 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:54:43.999277 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:44.000042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:54:44.000970 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:44.002018 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:44.002747 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:54:44.021920 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:44.022959 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:54:44.036970 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:54:44.042485 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m22:54:44.043670 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m22:54:44.044983 [info ] [Thread-3  ]: 3 of 3 PASS not_null_brnz_sales_orders_sales_order_id .......................... [[32mPASS[0m in 0.14s]
[0m22:54:44.046417 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:54:44.113388 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:54:44.116010 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m22:54:44.117017 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m22:54:44.118403 [info ] [Thread-2  ]: 2 of 3 PASS not_null_brnz_sales_orders_order_detail_id ......................... [[32mPASS[0m in 0.22s]
[0m22:54:44.119859 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:54:44.164361 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:54:44.166850 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m22:54:44.168480 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m22:54:44.169975 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.27s]
[0m22:54:44.171363 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:54:44.173954 [debug] [MainThread]: On master: COMMIT
[0m22:54:44.175501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:44.176762 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902' was properly closed.
[0m22:54:44.177568 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac' was properly closed.
[0m22:54:44.178498 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca' was properly closed.
[0m22:54:44.179593 [info ] [MainThread]: 
[0m22:54:44.180610 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m22:54:44.182363 [debug] [MainThread]: Command end result
[0m22:54:44.241346 [info ] [MainThread]: 
[0m22:54:44.242481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:54:44.243554 [info ] [MainThread]: 
[0m22:54:44.244566 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:54:44.245951 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.044226, "process_user_time": 1.773769, "process_kernel_time": 0.275379, "process_mem_max_rss": "122384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:54:44.246865 [debug] [MainThread]: Command `dbt test` succeeded at 22:54:44.246751 after 2.05 seconds
[0m22:54:44.247688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4f6f4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4dc29be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a4c1bd910>]}
[0m22:54:44.248509 [debug] [MainThread]: Flushing usage events
[0m22:59:35.725816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f76fe640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f55875e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f5587580>]}


============================== 22:59:35.731250 | 9cdec0bc-bc77-4131-aaa3-ee6be6179401 ==============================
[0m22:59:35.731250 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:59:35.732481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:36.194695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f421b1c0>]}
[0m22:59:36.248067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f42284f0>]}
[0m22:59:36.250142 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:59:36.381096 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:59:37.774811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:37.775967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:37.783780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:59:37.827247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f3cecdc0>]}
[0m22:59:38.043406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f3d66730>]}
[0m22:59:38.044495 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:59:38.045591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f3d78f70>]}
[0m22:59:38.048066 [info ] [MainThread]: 
[0m22:59:38.049685 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:59:38.056207 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m22:59:38.083223 [debug] [ThreadPool]: dbt-sqlserver
[0m22:59:38.085416 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m22:59:38.087266 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:59:38.089246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:38.090955 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:38.291641 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:38.298753 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:59:38.303075 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m22:59:38.305624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m22:59:38.315270 [debug] [ThreadPool]: dbt-sqlserver
[0m22:59:38.320596 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:59:38.321982 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:59:38.324073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:38.326032 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:38.327512 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:38.352450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:59:38.357515 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:59:38.358775 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:59:38.361258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f430dc40>]}
[0m22:59:38.364915 [debug] [MainThread]: On master: COMMIT
[0m22:59:38.366539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:38.367795 [info ] [MainThread]: 
[0m22:59:38.374021 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m22:59:38.374703 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m22:59:38.375318 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m22:59:38.375826 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:59:38.376942 [info ] [Thread-1  ]: 1 of 4 START sql view model bronze.brnz_customers .............................. [RUN]
[0m22:59:38.378101 [info ] [Thread-2  ]: 2 of 4 START sql view model bronze.brnz_example ................................ [RUN]
[0m22:59:38.379584 [info ] [Thread-3  ]: 3 of 4 START sql view model bronze.brnz_products ............................... [RUN]
[0m22:59:38.380535 [info ] [Thread-4  ]: 4 of 4 START sql view model bronze.brnz_sales_orders ........................... [RUN]
[0m22:59:38.381745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_customers)
[0m22:59:38.382755 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_example'
[0m22:59:38.383813 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_products'
[0m22:59:38.384743 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m22:59:38.385597 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m22:59:38.386296 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m22:59:38.387125 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m22:59:38.387889 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:59:38.397593 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:59:38.402711 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m22:59:38.407082 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m22:59:38.414639 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:59:38.423844 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m22:59:38.424619 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m22:59:38.425912 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m22:59:38.454908 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:59:38.486054 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m22:59:38.487033 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m22:59:38.491207 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m22:59:38.496359 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:59:38.506474 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:59:38.507925 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:59:38.510166 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m22:59:38.510802 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:59:38.512156 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m22:59:38.512734 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:59:38.513640 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:59:38.515084 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m22:59:38.516348 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:59:38.517511 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m22:59:38.518830 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:38.519715 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:59:38.520624 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:38.521616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:59:38.522663 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:38.523304 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:38.524837 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:38.559430 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:38.560979 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:38.566461 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:38.592094 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.592598 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.593131 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.593514 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.601788 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:59:38.606942 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:59:38.613050 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:59:38.623506 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:59:38.624373 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m22:59:38.625854 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m22:59:38.627303 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m22:59:38.628783 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m22:59:38.664176 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.664784 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.665282 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.665632 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.671575 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:59:38.676858 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:59:38.681310 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:59:38.686785 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:59:38.688002 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m22:59:38.689276 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m22:59:38.690511 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m22:59:38.691975 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m22:59:38.704966 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.705475 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.705874 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.726544 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.731031 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m22:59:38.732469 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m22:59:38.735379 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m22:59:38.738531 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m22:59:38.746395 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m22:59:38.756178 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m22:59:38.763222 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m22:59:38.769074 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m22:59:38.778177 [debug] [Thread-1  ]: dbt-sqlserver
[0m22:59:38.779325 [debug] [Thread-3  ]: dbt-sqlserver
[0m22:59:38.780598 [debug] [Thread-2  ]: dbt-sqlserver
[0m22:59:38.782031 [debug] [Thread-4  ]: dbt-sqlserver
[0m22:59:38.783254 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:59:38.784325 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:59:38.785235 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:59:38.786073 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:59:38.786870 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:59:38.787663 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:59:38.788580 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:59:38.789400 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m22:59:38.795817 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.796335 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.797019 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.797427 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.799643 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m22:59:38.801727 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m22:59:38.804045 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m22:59:38.805715 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m22:59:38.806449 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m22:59:38.807247 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m22:59:38.808065 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m22:59:38.808849 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m22:59:38.823951 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.827267 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m22:59:38.828436 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m22:59:38.829200 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.829656 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.829978 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m22:59:38.831652 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f346cca0>]}
[0m22:59:38.833497 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m22:59:38.835964 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m22:59:38.837576 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m22:59:38.838727 [info ] [Thread-1  ]: 1 of 4 OK created sql view model bronze.brnz_customers ......................... [[32mOK[0m in 0.45s]
[0m22:59:38.839703 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m22:59:38.840462 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m22:59:38.841210 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m22:59:38.842026 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m22:59:38.843024 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f2e53eb0>]}
[0m22:59:38.843840 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f4348880>]}
[0m22:59:38.844788 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdec0bc-bc77-4131-aaa3-ee6be6179401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f3cea1c0>]}
[0m22:59:38.846395 [info ] [Thread-2  ]: 2 of 4 OK created sql view model bronze.brnz_example ........................... [[32mOK[0m in 0.46s]
[0m22:59:38.847533 [info ] [Thread-3  ]: 3 of 4 OK created sql view model bronze.brnz_products .......................... [[32mOK[0m in 0.46s]
[0m22:59:38.848643 [info ] [Thread-4  ]: 4 of 4 OK created sql view model bronze.brnz_sales_orders ...................... [[32mOK[0m in 0.46s]
[0m22:59:38.849888 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m22:59:38.851110 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m22:59:38.852288 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m22:59:38.855967 [debug] [MainThread]: On master: COMMIT
[0m22:59:38.857118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:38.857912 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_customers' was properly closed.
[0m22:59:38.858697 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_example' was properly closed.
[0m22:59:38.859422 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_products' was properly closed.
[0m22:59:38.860198 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.brnz_sales_orders' was properly closed.
[0m22:59:38.861085 [info ] [MainThread]: 
[0m22:59:38.862026 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m22:59:38.863883 [debug] [MainThread]: Command end result
[0m22:59:38.980395 [info ] [MainThread]: 
[0m22:59:38.982120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:38.984320 [info ] [MainThread]: 
[0m22:59:38.986267 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:59:38.993102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3898451, "process_user_time": 2.398187, "process_kernel_time": 1.118617, "process_mem_max_rss": "123316", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:59:38.994693 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:38.994462 after 3.39 seconds
[0m22:59:38.995894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f76fe640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f3d78f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99f42284f0>]}
[0m22:59:38.996992 [debug] [MainThread]: Flushing usage events
[0m22:59:43.669449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f573e9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f565e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f552ad190>]}


============================== 22:59:43.675358 | 86d48ed4-b82a-48a7-a3a7-67c28d6853fa ==============================
[0m22:59:43.675358 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:59:43.677023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:43.963749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86d48ed4-b82a-48a7-a3a7-67c28d6853fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f571c7cd0>]}
[0m22:59:44.027816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86d48ed4-b82a-48a7-a3a7-67c28d6853fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f53eb1910>]}
[0m22:59:44.029516 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m22:59:44.148090 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:59:45.400554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:45.403536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:45.413359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sqlserver_project.silver
- models.dbt_sqlserver_project.gold
[0m22:59:45.459332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86d48ed4-b82a-48a7-a3a7-67c28d6853fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f539d6df0>]}
[0m22:59:45.710777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86d48ed4-b82a-48a7-a3a7-67c28d6853fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f53f09e20>]}
[0m22:59:45.712790 [info ] [MainThread]: Found 4 models, 3 data tests, 13 sources, 614 macros
[0m22:59:45.714486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d48ed4-b82a-48a7-a3a7-67c28d6853fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f53f71790>]}
[0m22:59:45.717679 [info ] [MainThread]: 
[0m22:59:45.720523 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:59:45.727299 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m22:59:45.744792 [debug] [ThreadPool]: dbt-sqlserver
[0m22:59:45.747116 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m22:59:45.749136 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m22:59:45.751375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:45.753479 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:45.795481 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:45.801080 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:59:45.803408 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m22:59:45.804422 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m22:59:45.806205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d48ed4-b82a-48a7-a3a7-67c28d6853fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f53fb0700>]}
[0m22:59:45.807114 [debug] [MainThread]: On master: COMMIT
[0m22:59:45.808177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:45.809496 [info ] [MainThread]: 
[0m22:59:45.816059 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:59:45.816576 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:59:45.817487 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:59:45.818545 [info ] [Thread-1  ]: 1 of 3 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m22:59:45.819668 [info ] [Thread-2  ]: 2 of 3 START test not_null_brnz_sales_orders_order_detail_id ................... [RUN]
[0m22:59:45.820783 [info ] [Thread-3  ]: 3 of 3 START test not_null_brnz_sales_orders_sales_order_id .................... [RUN]
[0m22:59:45.822066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m22:59:45.823415 [debug] [Thread-2  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac'
[0m22:59:45.824566 [debug] [Thread-3  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m22:59:45.825463 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:59:45.826410 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:59:45.827311 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:59:45.848046 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:59:45.857840 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:59:45.862987 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:59:45.876113 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:59:45.879436 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:59:45.899098 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:59:45.905311 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m22:59:45.910162 [debug] [Thread-2  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m22:59:45.914385 [debug] [Thread-3  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m22:59:45.916311 [debug] [Thread-1  ]: local_md5(invocation_id): 71ec477a5bebd782b99a9f68e59fc62d
[0m22:59:45.918452 [debug] [Thread-2  ]: local_md5(invocation_id): 71ec477a5bebd782b99a9f68e59fc62d
[0m22:59:45.920435 [debug] [Thread-3  ]: local_md5(invocation_id): 71ec477a5bebd782b99a9f68e59fc62d
[0m22:59:45.922744 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:59:45.925556 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:59:45.927298 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:59:45.939279 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m22:59:45.941262 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m22:59:45.943060 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_7441ee16f5811737aa0e2ff2c33add08]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_7441ee16f5811737aa0e2ff2c33add08]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_7441ee16f5811737aa0e2ff2c33add08]
  ;')
[0m22:59:45.944197 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m22:59:45.944982 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6a0df784564d19487b75c9568d742734]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6a0df784564d19487b75c9568d742734]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6a0df784564d19487b75c9568d742734]
  ;')
[0m22:59:45.946155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:59:45.947189 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_29633bf8f28df82a499f8ca9603a08bb]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_29633bf8f28df82a499f8ca9603a08bb]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_29633bf8f28df82a499f8ca9603a08bb]
  ;')
[0m22:59:45.948225 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:59:45.949503 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:45.951284 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:59:45.952180 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:45.953188 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:45.953790 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m22:59:45.971370 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:45.984335 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m22:59:46.001778 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m22:59:46.011867 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m22:59:46.013847 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m22:59:46.015822 [info ] [Thread-3  ]: 3 of 3 PASS not_null_brnz_sales_orders_sales_order_id .......................... [[32mPASS[0m in 0.19s]
[0m22:59:46.017754 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m22:59:46.096476 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m22:59:46.099148 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m22:59:46.100355 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m22:59:46.101493 [info ] [Thread-2  ]: 2 of 3 PASS not_null_brnz_sales_orders_order_detail_id ......................... [[32mPASS[0m in 0.28s]
[0m22:59:46.102758 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m22:59:46.152710 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m22:59:46.155173 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m22:59:46.156302 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m22:59:46.157660 [info ] [Thread-1  ]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.34s]
[0m22:59:46.159040 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m22:59:46.161295 [debug] [MainThread]: On master: COMMIT
[0m22:59:46.162225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:46.162934 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902' was properly closed.
[0m22:59:46.163661 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac' was properly closed.
[0m22:59:46.164303 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca' was properly closed.
[0m22:59:46.165046 [info ] [MainThread]: 
[0m22:59:46.165965 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m22:59:46.167559 [debug] [MainThread]: Command end result
[0m22:59:46.230229 [info ] [MainThread]: 
[0m22:59:46.231425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:46.232752 [info ] [MainThread]: 
[0m22:59:46.234094 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:59:46.235904 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6392918, "process_user_time": 2.26223, "process_kernel_time": 0.346467, "process_mem_max_rss": "122776", "process_in_blocks": "136", "process_out_blocks": "0"}
[0m22:59:46.237791 [debug] [MainThread]: Command `dbt test` succeeded at 22:59:46.237642 after 2.64 seconds
[0m22:59:46.238706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f573e9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f5591cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f53eb1910>]}
[0m22:59:46.239554 [debug] [MainThread]: Flushing usage events
[0m23:04:39.770107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c465a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c24e4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c24e4520>]}


============================== 23:04:39.777069 | b7803c05-bdd9-401c-b7c8-c861df08edac ==============================
[0m23:04:39.777069 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:04:39.779188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:04:40.203486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c25768b0>]}
[0m23:04:40.263350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c2576a00>]}
[0m23:04:40.265795 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:04:40.402906 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:04:42.083350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m23:04:42.086983 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/gold/gld_sales_summary.sql
[0m23:04:42.088817 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/gold/gld_customer_metrics.sql
[0m23:04:42.090949 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/gold/gld_product_performance.sql
[0m23:04:42.092589 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/silver/slvr_products.sql
[0m23:04:42.094103 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/silver/schema.yml
[0m23:04:42.095672 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/gold/schema.yml
[0m23:04:42.097451 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/silver/slvr_sales_orders.sql
[0m23:04:42.099245 [debug] [MainThread]: Partial parsing: added file: dbt_sqlserver_project://models/silver/slvr_customers.sql
[0m23:04:42.668115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:04:42.670609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c0c51850>]}
[0m23:04:43.357567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b392a130>]}
[0m23:04:43.716676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c0c8afd0>]}
[0m23:04:43.718850 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m23:04:43.720876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b396d040>]}
[0m23:04:43.725277 [info ] [MainThread]: 
[0m23:04:43.727729 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:04:43.744058 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:04:43.746232 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:04:43.747875 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:04:43.791091 [debug] [ThreadPool]: dbt-sqlserver
[0m23:04:43.793246 [debug] [ThreadPool]: dbt-sqlserver
[0m23:04:43.798500 [debug] [ThreadPool]: dbt-sqlserver
[0m23:04:43.800569 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:04:43.802324 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:04:43.804088 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:04:43.805699 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:04:43.807013 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:04:43.808354 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:04:43.809787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:43.811189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:43.812683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:43.814188 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:43.815657 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:43.817636 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:44.567009 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.571007 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.572773 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.584037 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m23:04:44.584879 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m23:04:44.585536 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m23:04:44.588917 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:04:44.591975 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:04:44.595012 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:04:44.602030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now create_AdventureWorks2014_silver)
[0m23:04:44.602898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now create_AdventureWorks2014_gold)
[0m23:04:44.605442 [debug] [ThreadPool]: Creating schema "database: "AdventureWorks2014"
schema: "silver"
"
[0m23:04:44.607370 [debug] [ThreadPool]: Creating schema "database: "AdventureWorks2014"
schema: "gold"
"
[0m23:04:44.621505 [debug] [ThreadPool]: Using sqlserver connection "create_AdventureWorks2014_silver"
[0m23:04:44.629593 [debug] [ThreadPool]: Using sqlserver connection "create_AdventureWorks2014_gold"
[0m23:04:44.631130 [debug] [ThreadPool]: On create_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "create_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'silver')
    BEGIN
    EXEC('CREATE SCHEMA [silver]')
    END
  
[0m23:04:44.634288 [debug] [ThreadPool]: On create_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "create_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'gold')
    BEGIN
    EXEC('CREATE SCHEMA [gold]')
    END
  
[0m23:04:44.636515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:44.637939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:44.639346 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:44.640683 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:44.642365 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.643836 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.757784 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:44.758448 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:44.760946 [debug] [ThreadPool]: On create_AdventureWorks2014_silver: COMMIT
[0m23:04:44.763740 [debug] [ThreadPool]: On create_AdventureWorks2014_gold: COMMIT
[0m23:04:44.765003 [debug] [ThreadPool]: On create_AdventureWorks2014_silver: Close
[0m23:04:44.766756 [debug] [ThreadPool]: On create_AdventureWorks2014_gold: Close
[0m23:04:44.772989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AdventureWorks2014_gold, now list_AdventureWorks2014_silver)
[0m23:04:44.773867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AdventureWorks2014_silver, now list_AdventureWorks2014_bronze)
[0m23:04:44.774913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_gold)
[0m23:04:44.785844 [debug] [ThreadPool]: dbt-sqlserver
[0m23:04:44.790570 [debug] [ThreadPool]: dbt-sqlserver
[0m23:04:44.795606 [debug] [ThreadPool]: dbt-sqlserver
[0m23:04:44.797162 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m23:04:44.799130 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m23:04:44.800803 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m23:04:44.802014 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:04:44.803419 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:04:44.804776 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:04:44.806345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:44.808299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:44.810023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:44.811392 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:44.812770 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:44.814361 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:44.815995 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.817720 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.818944 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:44.935236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:44.940659 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m23:04:44.942796 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m23:04:45.071163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:45.075750 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m23:04:45.077404 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m23:04:45.101087 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:45.103910 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m23:04:45.105362 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m23:04:45.107313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c2568580>]}
[0m23:04:45.108910 [debug] [MainThread]: On master: COMMIT
[0m23:04:45.110392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:45.111887 [info ] [MainThread]: 
[0m23:04:45.121334 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m23:04:45.122475 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m23:04:45.123222 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m23:04:45.124171 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:04:45.125918 [info ] [Thread-1  ]: 1 of 10 START sql view model bronze.brnz_customers ............................. [RUN]
[0m23:04:45.128712 [info ] [Thread-2  ]: 2 of 10 START sql view model bronze.brnz_example ............................... [RUN]
[0m23:04:45.131670 [info ] [Thread-3  ]: 3 of 10 START sql view model bronze.brnz_products .............................. [RUN]
[0m23:04:45.135376 [info ] [Thread-4  ]: 4 of 10 START sql view model bronze.brnz_sales_orders .......................... [RUN]
[0m23:04:45.139620 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now model.dbt_sqlserver_project.brnz_customers)
[0m23:04:45.142384 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now model.dbt_sqlserver_project.brnz_example)
[0m23:04:45.144627 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_products)
[0m23:04:45.147085 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m23:04:45.149293 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m23:04:45.151997 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m23:04:45.154731 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m23:04:45.156958 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:04:45.177812 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m23:04:45.183793 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m23:04:45.189349 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m23:04:45.196002 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:04:45.208937 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m23:04:45.210124 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:04:45.217275 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m23:04:45.233321 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m23:04:45.298916 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m23:04:45.300400 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m23:04:45.296446 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:04:45.307076 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m23:04:45.317992 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:04:45.320038 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:04:45.322291 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m23:04:45.323338 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:04:45.324583 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:04:45.325840 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m23:04:45.327820 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:04:45.329576 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m23:04:45.331282 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m23:04:45.333423 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:04:45.335027 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:45.336613 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:04:45.338102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:04:45.339819 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:45.341642 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:45.342932 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:45.344471 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:45.347251 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:45.408016 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:45.430655 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.431596 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.432528 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:45.446454 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:04:45.447041 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.454178 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:04:45.457050 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m23:04:45.465127 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:04:45.467165 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m23:04:45.470499 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m23:04:45.503843 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.521123 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:04:45.524614 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m23:04:45.551623 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.552513 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.561893 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:04:45.570430 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:04:45.571683 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m23:04:45.573405 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m23:04:45.574314 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.587707 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:04:45.593678 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m23:04:45.620859 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.622106 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.661408 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.666835 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m23:04:45.667710 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.760881 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:04:45.763150 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m23:04:45.774699 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m23:04:45.778443 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m23:04:45.779801 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m23:04:45.787930 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m23:04:45.802396 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:04:45.808668 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m23:04:45.812496 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:04:45.814612 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:04:45.818420 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:04:45.821279 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:04:45.823211 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:45.825720 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:04:45.826543 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.827760 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:45.830668 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:45.835191 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m23:04:45.849302 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m23:04:45.850428 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.853029 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.855041 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:04:45.855707 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.859344 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:04:45.862331 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:04:45.863807 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:04:45.868736 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:04:45.869898 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m23:04:45.871669 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m23:04:45.873444 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:45.875048 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m23:04:45.904062 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.905165 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.906086 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.906770 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.912983 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m23:04:45.916846 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m23:04:45.919961 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m23:04:45.923239 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:04:45.924435 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m23:04:45.925771 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m23:04:45.927023 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m23:04:45.928212 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m23:04:45.932854 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b19c0190>]}
[0m23:04:45.934725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b1e5a4c0>]}
[0m23:04:45.936206 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b1e68850>]}
[0m23:04:45.939510 [info ] [Thread-2  ]: 2 of 10 OK created sql view model bronze.brnz_example .......................... [[32mOK[0m in 0.79s]
[0m23:04:45.943636 [info ] [Thread-1  ]: 1 of 10 OK created sql view model bronze.brnz_customers ........................ [[32mOK[0m in 0.80s]
[0m23:04:45.947812 [info ] [Thread-3  ]: 3 of 10 OK created sql view model bronze.brnz_products ......................... [[32mOK[0m in 0.79s]
[0m23:04:45.951481 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m23:04:45.953680 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m23:04:45.955739 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m23:04:45.958704 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:45.960249 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.slvr_customers
[0m23:04:45.962091 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.slvr_products
[0m23:04:45.967576 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m23:04:45.969637 [info ] [Thread-2  ]: 5 of 10 START sql table model silver.slvr_customers ............................ [RUN]
[0m23:04:45.972638 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.slvr_products ............................. [RUN]
[0m23:04:45.974771 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m23:04:45.976538 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_example, now model.dbt_sqlserver_project.slvr_customers)
[0m23:04:45.978829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_customers, now model.dbt_sqlserver_project.slvr_products)
[0m23:04:45.980933 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b018c730>]}
[0m23:04:45.982756 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.slvr_customers
[0m23:04:45.984846 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.slvr_products
[0m23:04:45.986991 [info ] [Thread-4  ]: 4 of 10 OK created sql view model bronze.brnz_sales_orders ..................... [[32mOK[0m in 0.83s]
[0m23:04:45.998250 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_customers"
[0m23:04:46.007988 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_products"
[0m23:04:46.010005 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:04:46.015238 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:04:46.017570 [info ] [Thread-3  ]: 7 of 10 START sql table model silver.slvr_sales_orders ......................... [RUN]
[0m23:04:46.020063 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_products, now model.dbt_sqlserver_project.slvr_sales_orders)
[0m23:04:46.022181 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:04:46.032377 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:04:46.035274 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.slvr_customers
[0m23:04:46.037651 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.slvr_products
[0m23:04:46.060741 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:04:46.140618 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:04:46.156897 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:04:46.157799 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:04:46.162506 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw"
[0m23:04:46.168682 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw"
[0m23:04:46.174231 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw"
[0m23:04:46.177212 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:04:46.179733 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:04:46.185701 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:04:46.188270 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:04:46.190272 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:04:46.191974 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:04:46.193782 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_customers__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:46.195521 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:46.197619 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_sales_orders__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:46.199821 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:04:46.201720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:04:46.203632 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:04:46.205435 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:46.207237 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:46.208938 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:46.279497 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:46.286181 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:46.287207 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:46.340668 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:46.345498 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:04:46.347635 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw";');

[0m23:04:46.354990 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:46.356051 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:46.362450 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:04:46.363234 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:46.367317 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:04:46.369882 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw";');

[0m23:04:46.386055 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_customers"
[0m23:04:46.387406 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_products__dbt_tmp__dbt_tmp_vw";');

[0m23:04:46.397767 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:46.409318 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:04:46.410513 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:46.419732 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_products"
[0m23:04:46.439728 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:04:46.443432 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" as 

with bronze_sales as (
    select * from "AdventureWorks2014"."bronze"."brnz_sales_orders"
),

cleaned as (
    select
        sales_order_id,
        order_detail_id,
        order_date,
        due_date,
        ship_date,
        status,
        case 
            when online_order_flag = 1 then ''Online''
            else ''Offline''
        end as order_channel,
        sales_order_number,
        purchase_order_number,
        customer_id,
        sales_person_id,
        territory_id,
        product_id,
        order_qty,
        unit_price,
        unit_price_discount,
        line_total,
        -- Calculated fields
        unit_price * order_qty as gross_amount,
        line_total / nullif(order_qty, 0) as effective_unit_price,
        case 
            when unit_price_discount > 0 then 1
            else 0
        end as has_discount
    from bronze_sales
    where order_qty > 0
        and unit_price >= 0
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_sales_orders__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_sales_orders__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_sales_orders__dbt_tmp')
    )
    DROP index "silver"."slvr_sales_orders__dbt_tmp".silver_slvr_sales_orders__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_sales_orders__dbt_tmp_cci
    ON "silver"."slvr_sales_orders__dbt_tmp"

   


  
[0m23:04:46.445574 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:04:46.455068 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" as 

with bronze_customers as (
    select * from "AdventureWorks2014"."bronze"."brnz_customers"
),

cleaned as (
    select
        CustomerID as customer_id,
        coalesce(FirstName, ''Unknown'') as first_name,
        coalesce(LastName, ''Unknown'') as last_name,
        concat(coalesce(FirstName, ''Unknown''), '' '', coalesce(LastName, ''Unknown'')) as full_name,
        EmailPromotion as email_promotion,
        StoreID as store_id,
        TerritoryID as territory_id,
        last_modified_date
    from bronze_customers
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_customers__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_customers__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_customers__dbt_tmp')
    )
    DROP index "silver"."slvr_customers__dbt_tmp".silver_slvr_customers__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_customers__dbt_tmp_cci
    ON "silver"."slvr_customers__dbt_tmp"

   


  
[0m23:04:46.460639 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:04:46.466211 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_products__dbt_tmp__dbt_tmp_vw" as 

with bronze_products as (
    select * from "AdventureWorks2014"."bronze"."brnz_products"
),

cleaned as (
    select
        ProductID as product_id,
        ProductName as product_name,
        ProductNumber as product_number,
        coalesce(Color, ''N/A'') as color,
        StandardCost as standard_cost,
        ListPrice as list_price,
        coalesce(Size, ''N/A'') as size,
        coalesce(Weight, 0) as weight,
        ProductLine as product_line,
        Class as class,
        Style as style,
        ProductSubcategoryID as subcategory_id,
        coalesce(SubcategoryName, ''Uncategorized'') as subcategory_name,
        ProductCategoryID as category_id,
        SellStartDate as sell_start_date,
        SellEndDate as sell_end_date,
        case 
            when DiscontinuedDate is not null then 1
            else 0
        end as is_discontinued,
        last_modified_date
    from bronze_products
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_products__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_products__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_products__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_products__dbt_tmp')
    )
    DROP index "silver"."slvr_products__dbt_tmp".silver_slvr_products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_products__dbt_tmp_cci
    ON "silver"."slvr_products__dbt_tmp"

   


  
[0m23:04:47.956499 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m23:04:47.977739 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:04:47.982764 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products__dbt_tmp', 'slvr_products'
[0m23:04:48.078609 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:48.103251 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_products: COMMIT
[0m23:04:48.114654 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_backup"
[0m23:04:48.123940 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:04:48.128236 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_products__dbt_backup";');

[0m23:04:48.140882 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:48.146558 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_products: Close
[0m23:04:48.156391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b1e553d0>]}
[0m23:04:48.161724 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.slvr_products ........................ [[32mOK[0m in 2.18s]
[0m23:04:48.165162 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.slvr_products
[0m23:04:48.431487 [debug] [Thread-2  ]: SQL status: OK in 2.000 seconds
[0m23:04:48.445518 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:04:48.449828 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers__dbt_tmp', 'slvr_customers'
[0m23:04:48.477044 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:48.482769 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_customers: COMMIT
[0m23:04:48.491435 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_backup"
[0m23:04:48.494803 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:04:48.498392 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_customers__dbt_backup";');

[0m23:04:48.510693 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:48.516922 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_customers: Close
[0m23:04:48.520459 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b1e689a0>]}
[0m23:04:48.522881 [info ] [Thread-2  ]: 5 of 10 OK created sql table model silver.slvr_customers ....................... [[32mOK[0m in 2.54s]
[0m23:04:48.526362 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.slvr_customers
[0m23:04:50.711300 [debug] [Thread-3  ]: SQL status: OK in 4.000 seconds
[0m23:04:50.716968 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:04:50.718291 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders__dbt_tmp', 'slvr_sales_orders'
[0m23:04:50.728904 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.731480 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_sales_orders: COMMIT
[0m23:04:50.736657 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_backup"
[0m23:04:50.738183 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:04:50.739348 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_sales_orders__dbt_backup";');

[0m23:04:50.743933 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.746260 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_sales_orders: Close
[0m23:04:50.747578 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c01110d0>]}
[0m23:04:50.749677 [info ] [Thread-3  ]: 7 of 10 OK created sql table model silver.slvr_sales_orders .................... [[32mOK[0m in 4.73s]
[0m23:04:50.751652 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:04:50.754799 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:04:50.755305 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.gld_product_performance
[0m23:04:50.755755 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.gld_sales_summary
[0m23:04:50.756790 [info ] [Thread-4  ]: 8 of 10 START sql table model gold.gld_customer_metrics ........................ [RUN]
[0m23:04:50.757996 [info ] [Thread-1  ]: 9 of 10 START sql table model gold.gld_product_performance ..................... [RUN]
[0m23:04:50.759364 [info ] [Thread-2  ]: 10 of 10 START sql table model gold.gld_sales_summary .......................... [RUN]
[0m23:04:50.760620 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_sales_orders, now model.dbt_sqlserver_project.gld_customer_metrics)
[0m23:04:50.761639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_products, now model.dbt_sqlserver_project.gld_product_performance)
[0m23:04:50.762695 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_customers, now model.dbt_sqlserver_project.gld_sales_summary)
[0m23:04:50.763812 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:04:50.764834 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.gld_product_performance
[0m23:04:50.765937 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.gld_sales_summary
[0m23:04:50.770947 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:04:50.775145 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_product_performance"
[0m23:04:50.778937 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:04:50.788750 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.gld_product_performance
[0m23:04:50.794922 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:04:50.795367 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:04:50.799356 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw"
[0m23:04:50.806620 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.gld_sales_summary
[0m23:04:50.809763 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:04:50.839107 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:04:50.856365 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:04:50.863040 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw"
[0m23:04:50.868768 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:04:50.874689 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw"
[0m23:04:50.877320 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:04:50.879135 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_product_performance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:50.882010 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:04:50.883808 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:04:50.885726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:04:50.887717 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:04:50.889767 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_customer_metrics__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:50.891429 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:50.893239 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_sales_summary__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:04:50.895343 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:04:50.897205 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:50.898459 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:04:50.900295 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:50.903307 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:04:50.918065 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.921594 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:04:50.922941 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw";');

[0m23:04:50.926896 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.930100 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_product_performance"
[0m23:04:50.942473 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:50.943079 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:04:50.955804 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:04:50.957668 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" as 

with products as (
    select * from "AdventureWorks2014"."silver"."slvr_products"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

product_sales as (
    select
        p.product_id,
        p.product_name,
        p.subcategory_name,
        p.color,
        p.list_price,
        p.standard_cost,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.order_qty) as total_quantity_sold,
        sum(s.line_total) as total_revenue,
        avg(s.unit_price) as avg_selling_price,
        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,
        case 
            when sum(s.order_qty) > 0 then 
                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100
            else 0
        end as profit_margin_pct
    from products p
    left join sales s
        on p.product_id = s.product_id
    group by 
        p.product_id, 
        p.product_name, 
        p.subcategory_name, 
        p.color, 
        p.list_price, 
        p.standard_cost
)

select * from product_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_product_performance__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_product_performance__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_product_performance__dbt_tmp')
    )
    DROP index "gold"."gld_product_performance__dbt_tmp".gold_gld_product_performance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_product_performance__dbt_tmp_cci
    ON "gold"."gld_product_performance__dbt_tmp"

   


  
[0m23:04:50.963893 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.967679 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:04:50.969339 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw";');

[0m23:04:50.970181 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.974289 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:04:50.974820 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.976048 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw";');

[0m23:04:50.979719 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:04:50.987043 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:50.990904 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:04:50.992994 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:04:50.994248 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" as 

with customers as (
    select * from "AdventureWorks2014"."silver"."slvr_customers"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

customer_sales as (
    select
        c.customer_id,
        c.full_name,
        c.territory_id,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.line_total) as total_revenue,
        avg(s.line_total) as avg_order_value,
        sum(s.order_qty) as total_items_purchased,
        min(s.order_date) as first_order_date,
        max(s.order_date) as last_order_date,
        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount
    from customers c
    left join sales s
        on c.customer_id = s.customer_id
    group by c.customer_id, c.full_name, c.territory_id
)

select * from customer_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_customer_metrics__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_customer_metrics__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_customer_metrics__dbt_tmp')
    )
    DROP index "gold"."gld_customer_metrics__dbt_tmp".gold_gld_customer_metrics__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_customer_metrics__dbt_tmp_cci
    ON "gold"."gld_customer_metrics__dbt_tmp"

   


  
[0m23:04:51.000558 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:04:51.002002 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" as 

with sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

daily_summary as (
    select
        cast(order_date as date) as order_date,
        count(distinct sales_order_id) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(order_qty) as total_items_sold,
        sum(line_total) as total_revenue,
        avg(line_total) as avg_order_line_value,
        sum(case when order_channel = ''Online'' then 1 else 0 end) as online_orders,
        sum(case when order_channel = ''Offline'' then 1 else 0 end) as offline_orders,
        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue
    from sales
    group by cast(order_date as date)
)

select * from daily_summary;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_sales_summary__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_sales_summary__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_sales_summary__dbt_tmp')
    )
    DROP index "gold"."gld_sales_summary__dbt_tmp".gold_gld_sales_summary__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_sales_summary__dbt_tmp_cci
    ON "gold"."gld_sales_summary__dbt_tmp"

   


  
[0m23:04:51.720432 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m23:04:51.728165 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:04:51.733835 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary__dbt_tmp', 'gld_sales_summary'
[0m23:04:51.766893 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:51.770339 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_sales_summary: COMMIT
[0m23:04:51.774983 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_backup"
[0m23:04:51.777274 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:04:51.778841 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_sales_summary__dbt_backup";');

[0m23:04:51.786382 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:04:51.790770 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_sales_summary: Close
[0m23:04:51.793141 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b012fbb0>]}
[0m23:04:51.795478 [info ] [Thread-2  ]: 10 of 10 OK created sql table model gold.gld_sales_summary ..................... [[32mOK[0m in 1.03s]
[0m23:04:51.797424 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.gld_sales_summary
[0m23:04:51.931775 [debug] [Thread-4  ]: SQL status: OK in 1.000 seconds
[0m23:04:51.938928 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:04:51.940681 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics__dbt_tmp', 'gld_customer_metrics'
[0m23:04:51.960600 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:51.964318 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_customer_metrics: COMMIT
[0m23:04:51.971738 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_backup"
[0m23:04:51.973756 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:04:51.974962 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_customer_metrics__dbt_backup";');

[0m23:04:51.979938 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:04:51.983774 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_customer_metrics: Close
[0m23:04:51.986119 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b012f160>]}
[0m23:04:51.988077 [info ] [Thread-4  ]: 8 of 10 OK created sql table model gold.gld_customer_metrics ................... [[32mOK[0m in 1.23s]
[0m23:04:51.989998 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:04:52.431186 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m23:04:52.437423 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:04:52.438907 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance__dbt_tmp', 'gld_product_performance'
[0m23:04:52.449882 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:52.453048 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: COMMIT
[0m23:04:52.459267 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_backup"
[0m23:04:52.461566 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:04:52.463014 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_product_performance__dbt_backup";');

[0m23:04:52.468639 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:04:52.471513 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: Close
[0m23:04:52.472965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7803c05-bdd9-401c-b7c8-c861df08edac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5b19dc7f0>]}
[0m23:04:52.474378 [info ] [Thread-1  ]: 9 of 10 OK created sql table model gold.gld_product_performance ................ [[32mOK[0m in 1.71s]
[0m23:04:52.475913 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.gld_product_performance
[0m23:04:52.479059 [debug] [MainThread]: On master: COMMIT
[0m23:04:52.480312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:52.481322 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_sales_summary' was properly closed.
[0m23:04:52.482567 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.slvr_sales_orders' was properly closed.
[0m23:04:52.483796 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_product_performance' was properly closed.
[0m23:04:52.485028 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_customer_metrics' was properly closed.
[0m23:04:52.486820 [info ] [MainThread]: 
[0m23:04:52.488620 [info ] [MainThread]: Finished running 4 view models, 6 table models in 0 hours 0 minutes and 8.76 seconds (8.76s).
[0m23:04:52.492922 [debug] [MainThread]: Command end result
[0m23:04:52.592531 [info ] [MainThread]: 
[0m23:04:52.594192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:52.595600 [info ] [MainThread]: 
[0m23:04:52.597232 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:04:52.604030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.932364, "process_user_time": 5.632036, "process_kernel_time": 1.307583, "process_mem_max_rss": "131696", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m23:04:52.605739 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:52.605470 after 12.93 seconds
[0m23:04:52.607046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c465a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c0034fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5c25768b0>]}
[0m23:04:52.608022 [debug] [MainThread]: Flushing usage events
[0m23:05:03.478878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2513249610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25110fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25110fca30>]}


============================== 23:05:03.484577 | 2d455e85-04ba-4355-b95d-7a8ac90dfcbc ==============================
[0m23:05:03.484577 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:05:03.486813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:04.026387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d455e85-04ba-4355-b95d-7a8ac90dfcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250fe10310>]}
[0m23:05:04.168482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d455e85-04ba-4355-b95d-7a8ac90dfcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25110f2d30>]}
[0m23:05:04.170786 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:05:04.366194 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:05:06.201370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:06.203317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:06.292566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d455e85-04ba-4355-b95d-7a8ac90dfcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250f7ea130>]}
[0m23:05:06.652113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d455e85-04ba-4355-b95d-7a8ac90dfcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250f9caac0>]}
[0m23:05:06.655076 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m23:05:06.657756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d455e85-04ba-4355-b95d-7a8ac90dfcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250f805760>]}
[0m23:05:06.663469 [info ] [MainThread]: 
[0m23:05:06.666053 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:05:06.675309 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m23:05:06.676540 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_gold'
[0m23:05:06.677323 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_silver'
[0m23:05:06.711077 [debug] [ThreadPool]: dbt-sqlserver
[0m23:05:06.713467 [debug] [ThreadPool]: dbt-sqlserver
[0m23:05:06.719214 [debug] [ThreadPool]: dbt-sqlserver
[0m23:05:06.721668 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m23:05:06.724140 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m23:05:06.726552 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m23:05:06.728720 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:05:06.731505 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:05:06.733493 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:05:06.735409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:06.737153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:06.738562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:06.740461 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:06.742282 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:06.743911 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:06.829679 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:06.830188 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:06.831805 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:06.846479 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:05:06.847475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:05:06.850501 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m23:05:06.851062 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:05:06.852671 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m23:05:06.853631 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m23:05:06.855877 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m23:05:06.857575 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m23:05:06.860046 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m23:05:06.863488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d455e85-04ba-4355-b95d-7a8ac90dfcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250fe909a0>]}
[0m23:05:06.864937 [debug] [MainThread]: On master: COMMIT
[0m23:05:06.866107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:06.868039 [info ] [MainThread]: 
[0m23:05:06.877891 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:05:06.879019 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:05:06.879581 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:05:06.880178 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:05:06.881023 [info ] [Thread-1  ]: 1 of 18 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m23:05:06.882858 [info ] [Thread-2  ]: 2 of 18 START test dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m23:05:06.884284 [info ] [Thread-3  ]: 3 of 18 START test not_null_brnz_sales_orders_order_detail_id .................. [RUN]
[0m23:05:06.885504 [info ] [Thread-4  ]: 4 of 18 START test not_null_brnz_sales_orders_sales_order_id ................... [RUN]
[0m23:05:06.886901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m23:05:06.888248 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc)
[0m23:05:06.889620 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac)
[0m23:05:06.891946 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m23:05:06.893124 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:05:06.894694 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:05:06.896054 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:05:06.897222 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:05:06.933487 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m23:05:06.937226 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m23:05:06.948952 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m23:05:06.960697 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m23:05:06.974957 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:05:06.975821 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:05:06.982978 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:05:06.983611 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:05:07.029693 [debug] [Thread-4  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m23:05:07.052754 [debug] [Thread-3  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m23:05:07.053636 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m23:05:07.059388 [debug] [Thread-2  ]: local_md5(model.name): fa6b3d9cc18a40cfba3de7295a3a38e6
[0m23:05:07.062249 [debug] [Thread-4  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.064348 [debug] [Thread-3  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.066384 [debug] [Thread-1  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.068695 [debug] [Thread-2  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.071001 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m23:05:07.073914 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m23:05:07.077226 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m23:05:07.079950 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m23:05:07.090656 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m23:05:07.093733 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m23:05:07.094392 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_678c9fcaed75ee14f3dcd4e541df8462]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_678c9fcaed75ee14f3dcd4e541df8462]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_678c9fcaed75ee14f3dcd4e541df8462]
  ;')
[0m23:05:07.095116 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m23:05:07.096394 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_71cdec6ab69ee24135424e0c05ddda7e]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_71cdec6ab69ee24135424e0c05ddda7e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_71cdec6ab69ee24135424e0c05ddda7e]
  ;')
[0m23:05:07.098358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:05:07.099899 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m23:05:07.100494 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_5c919d387725d710c9d62dee627abe10]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_5c919d387725d710c9d62dee627abe10]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_5c919d387725d710c9d62dee627abe10]
  ;')
[0m23:05:07.102444 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:05:07.104242 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.105325 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_9153dacb8e620dfc1b2c0bac435c9f95]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."silver"."slvr_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_9153dacb8e620dfc1b2c0bac435c9f95]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_9153dacb8e620dfc1b2c0bac435c9f95]
  ;')
[0m23:05:07.107082 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:05:07.108678 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.111199 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:05:07.113306 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.116664 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.135521 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.138029 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.146010 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.161728 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.183423 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.194031 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m23:05:07.195679 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m23:05:07.197209 [info ] [Thread-4  ]: 4 of 18 PASS not_null_brnz_sales_orders_sales_order_id ......................... [[32mPASS[0m in 0.31s]
[0m23:05:07.198992 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:05:07.203609 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:05:07.205178 [info ] [Thread-4  ]: 5 of 18 START test not_null_gld_customer_metrics_customer_id ................... [RUN]
[0m23:05:07.206697 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca, now test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39)
[0m23:05:07.208722 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:05:07.218568 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m23:05:07.245849 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:05:07.252900 [debug] [Thread-4  ]: local_md5(model.name): ac0d77cdfe99d22d2680c19319e8499c
[0m23:05:07.255409 [debug] [Thread-4  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.258302 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m23:05:07.284140 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m23:05:07.285651 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a6b866a5cfdd38e43557cf10460714ff]
   as 
    
    



select customer_id
from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a6b866a5cfdd38e43557cf10460714ff]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a6b866a5cfdd38e43557cf10460714ff]
  ;')
[0m23:05:07.286934 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:05:07.288589 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.290589 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.293086 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.295970 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m23:05:07.297341 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m23:05:07.299018 [info ] [Thread-3  ]: 3 of 18 PASS not_null_brnz_sales_orders_order_detail_id ........................ [[32mPASS[0m in 0.41s]
[0m23:05:07.300721 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:05:07.302202 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:05:07.304173 [info ] [Thread-3  ]: 6 of 18 START test not_null_gld_product_performance_product_id ................. [RUN]
[0m23:05:07.306155 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac, now test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397)
[0m23:05:07.307771 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:05:07.315769 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m23:05:07.316292 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.320519 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: ROLLBACK
[0m23:05:07.322485 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: Close
[0m23:05:07.324901 [info ] [Thread-4  ]: 5 of 18 PASS not_null_gld_customer_metrics_customer_id ......................... [[32mPASS[0m in 0.12s]
[0m23:05:07.329362 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:05:07.331106 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:05:07.333020 [info ] [Thread-4  ]: 7 of 18 START test not_null_gld_sales_summary_order_date ....................... [RUN]
[0m23:05:07.335438 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39, now test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e)
[0m23:05:07.336514 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:05:07.337372 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:05:07.343210 [debug] [Thread-3  ]: local_md5(model.name): a5b86011b8d22b04b2506841bc10c840
[0m23:05:07.353178 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m23:05:07.354775 [debug] [Thread-3  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.359497 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m23:05:07.371500 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:05:07.379168 [debug] [Thread-4  ]: local_md5(model.name): 31cffa58c58a08e4f0ecffd253b46aa2
[0m23:05:07.379818 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m23:05:07.381125 [debug] [Thread-4  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.382717 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_dfb57981d1e62ae1dad3899006796e61]
   as 
    
    



select product_id
from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_dfb57981d1e62ae1dad3899006796e61]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_dfb57981d1e62ae1dad3899006796e61]
  ;')
[0m23:05:07.384797 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m23:05:07.386390 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:05:07.389496 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.391877 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.404915 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m23:05:07.407445 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_93362569045a99e883699ef819ae6e4f]
   as 
    
    



select order_date
from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_93362569045a99e883699ef819ae6e4f]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_93362569045a99e883699ef819ae6e4f]
  ;')
[0m23:05:07.409189 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:05:07.410745 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.412302 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.413115 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.417671 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: ROLLBACK
[0m23:05:07.419574 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: Close
[0m23:05:07.421476 [info ] [Thread-3  ]: 6 of 18 PASS not_null_gld_product_performance_product_id ....................... [[32mPASS[0m in 0.12s]
[0m23:05:07.423893 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:05:07.429066 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:05:07.430882 [info ] [Thread-3  ]: 8 of 18 START test not_null_slvr_customers_customer_id ......................... [RUN]
[0m23:05:07.436672 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397, now test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275)
[0m23:05:07.438834 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:05:07.449749 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m23:05:07.450496 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.454652 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: ROLLBACK
[0m23:05:07.456722 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: Close
[0m23:05:07.458336 [info ] [Thread-4  ]: 7 of 18 PASS not_null_gld_sales_summary_order_date ............................. [[32mPASS[0m in 0.12s]
[0m23:05:07.460465 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:05:07.462875 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:05:07.465247 [info ] [Thread-4  ]: 9 of 18 START test not_null_slvr_products_list_price ........................... [RUN]
[0m23:05:07.466071 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:05:07.467740 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e, now test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076)
[0m23:05:07.473288 [debug] [Thread-3  ]: local_md5(model.name): 8e9f64ea0dd2dc40d032bf48fa566213
[0m23:05:07.476501 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:05:07.479547 [debug] [Thread-3  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.487790 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m23:05:07.490007 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m23:05:07.494907 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.501454 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m23:05:07.503363 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m23:05:07.506285 [info ] [Thread-1  ]: 1 of 18 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.62s]
[0m23:05:07.512386 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:05:07.513360 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.514065 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:05:07.514734 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m23:05:07.515867 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:05:07.519122 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: ROLLBACK
[0m23:05:07.525270 [debug] [Thread-4  ]: local_md5(model.name): d9ecc431b4a169296ca29c386f015286
[0m23:05:07.526764 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_9d2c04ffe604974684664f6c1c873be4]
   as 
    
    



select customer_id
from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_9d2c04ffe604974684664f6c1c873be4]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_9d2c04ffe604974684664f6c1c873be4]
  ;')
[0m23:05:07.528688 [info ] [Thread-1  ]: 10 of 18 START test not_null_slvr_products_product_id .......................... [RUN]
[0m23:05:07.531250 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: Close
[0m23:05:07.532762 [debug] [Thread-4  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.534187 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:05:07.535656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902, now test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551)
[0m23:05:07.537332 [info ] [Thread-2  ]: 2 of 18 PASS dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.65s]
[0m23:05:07.540364 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m23:05:07.542862 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.544222 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:05:07.545872 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:05:07.548648 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.560241 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m23:05:07.564377 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:05:07.568352 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m23:05:07.569935 [info ] [Thread-2  ]: 11 of 18 START test not_null_slvr_sales_orders_line_total ...................... [RUN]
[0m23:05:07.572086 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b7ac2bd9075ab43ba8bd831840f1aa12]
   as 
    
    



select list_price
from "AdventureWorks2014"."silver"."slvr_products"
where list_price is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b7ac2bd9075ab43ba8bd831840f1aa12]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b7ac2bd9075ab43ba8bd831840f1aa12]
  ;')
[0m23:05:07.574314 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d)
[0m23:05:07.575907 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:05:07.577643 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:05:07.579257 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.590291 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m23:05:07.592238 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:05:07.593877 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.595596 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.600888 [debug] [Thread-1  ]: local_md5(model.name): 6fbe07cd99985a105c0e61275b7ef592
[0m23:05:07.606317 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: ROLLBACK
[0m23:05:07.608445 [debug] [Thread-1  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.610384 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: Close
[0m23:05:07.612751 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m23:05:07.614311 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:05:07.615736 [info ] [Thread-3  ]: 8 of 18 PASS not_null_slvr_customers_customer_id ............................... [[32mPASS[0m in 0.18s]
[0m23:05:07.624184 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.625176 [debug] [Thread-2  ]: local_md5(model.name): 9aed47cbdc8c4c391feec0e17f79c145
[0m23:05:07.627092 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:05:07.634644 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: ROLLBACK
[0m23:05:07.636070 [debug] [Thread-2  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.638224 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:05:07.639029 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m23:05:07.640136 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: Close
[0m23:05:07.641917 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m23:05:07.643631 [info ] [Thread-3  ]: 12 of 18 START test not_null_slvr_sales_orders_order_detail_id ................. [RUN]
[0m23:05:07.645183 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_169ace32b58a79b7480c7aba54eccb3c]
   as 
    
    



select product_id
from "AdventureWorks2014"."silver"."slvr_products"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_169ace32b58a79b7480c7aba54eccb3c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_169ace32b58a79b7480c7aba54eccb3c]
  ;')
[0m23:05:07.647187 [info ] [Thread-4  ]: 9 of 18 PASS not_null_slvr_products_list_price ................................. [[32mPASS[0m in 0.18s]
[0m23:05:07.650392 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53)
[0m23:05:07.652174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:05:07.654340 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:05:07.656189 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:05:07.658240 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.659817 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:05:07.671226 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m23:05:07.673004 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.673624 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m23:05:07.674692 [info ] [Thread-4  ]: 13 of 18 START test not_null_slvr_sales_orders_sales_order_id .................. [RUN]
[0m23:05:07.679140 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_7d88a9204df3bdc62dea14e28c2c8a57]
   as 
    
    



select line_total
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where line_total is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_7d88a9204df3bdc62dea14e28c2c8a57]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_7d88a9204df3bdc62dea14e28c2c8a57]
  ;')
[0m23:05:07.681627 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4)
[0m23:05:07.683724 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:05:07.685628 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:05:07.686974 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.699493 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.697998 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.697145 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m23:05:07.701101 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:05:07.705632 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: ROLLBACK
[0m23:05:07.713508 [debug] [Thread-3  ]: local_md5(model.name): ea59c6424fdef3f68e31047da36d4522
[0m23:05:07.716438 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: Close
[0m23:05:07.718029 [debug] [Thread-3  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.719805 [info ] [Thread-1  ]: 10 of 18 PASS not_null_slvr_products_product_id ................................ [[32mPASS[0m in 0.18s]
[0m23:05:07.722919 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m23:05:07.725527 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:05:07.726188 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:05:07.728368 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:05:07.733042 [debug] [Thread-4  ]: local_md5(model.name): 8afc66a1e810936eb9dee9b36ebd66ab
[0m23:05:07.734708 [info ] [Thread-1  ]: 14 of 18 START test unique_gld_customer_metrics_customer_id .................... [RUN]
[0m23:05:07.736409 [debug] [Thread-4  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.738300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551, now test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd)
[0m23:05:07.740889 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m23:05:07.742780 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:05:07.743696 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m23:05:07.760636 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m23:05:07.762287 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_c52872851775b56ccd4f5bf950d43f98]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_c52872851775b56ccd4f5bf950d43f98]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_c52872851775b56ccd4f5bf950d43f98]
  ;')
[0m23:05:07.763790 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m23:05:07.766112 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:05:07.767575 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_03925d198f58b051bdb7c7f50ef6824b]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_03925d198f58b051bdb7c7f50ef6824b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_03925d198f58b051bdb7c7f50ef6824b]
  ;')
[0m23:05:07.769338 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.771457 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:05:07.773373 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.774732 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.778662 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.781052 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:05:07.789176 [debug] [Thread-1  ]: local_md5(model.name): 09e4fbf108b34f10d79cdb74070d011e
[0m23:05:07.791734 [debug] [Thread-1  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.794660 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m23:05:07.801146 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.802215 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.806812 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: ROLLBACK
[0m23:05:07.810608 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: ROLLBACK
[0m23:05:07.811929 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: Close
[0m23:05:07.813478 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m23:05:07.814040 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: Close
[0m23:05:07.816533 [info ] [Thread-3  ]: 12 of 18 PASS not_null_slvr_sales_orders_order_detail_id ....................... [[32mPASS[0m in 0.17s]
[0m23:05:07.818257 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_58711c16b9848d294c648b526a33f97d]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_58711c16b9848d294c648b526a33f97d]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_58711c16b9848d294c648b526a33f97d]
  ;')
[0m23:05:07.820160 [info ] [Thread-4  ]: 13 of 18 PASS not_null_slvr_sales_orders_sales_order_id ........................ [[32mPASS[0m in 0.14s]
[0m23:05:07.822306 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:05:07.824293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:05:07.826462 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:05:07.828147 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:05:07.829589 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.831521 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:05:07.832925 [info ] [Thread-3  ]: 15 of 18 START test unique_gld_product_performance_product_id .................. [RUN]
[0m23:05:07.834701 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.835835 [info ] [Thread-4  ]: 16 of 18 START test unique_gld_sales_summary_order_date ........................ [RUN]
[0m23:05:07.837358 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53, now test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8)
[0m23:05:07.841015 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4, now test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b)
[0m23:05:07.842634 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:05:07.844099 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:05:07.857707 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m23:05:07.865915 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m23:05:07.876085 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:05:07.885565 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:05:07.885246 [debug] [Thread-3  ]: local_md5(model.name): 282efc8b63abc4326c2e3fe9cf80b2ea
[0m23:05:07.891940 [debug] [Thread-4  ]: local_md5(model.name): 9242e0fb865d08f661cf2dc3e20a299e
[0m23:05:07.892639 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.893863 [debug] [Thread-3  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.894510 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:05:07.895819 [debug] [Thread-4  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.899754 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: ROLLBACK
[0m23:05:07.901164 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m23:05:07.904483 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: ROLLBACK
[0m23:05:07.907889 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m23:05:07.909665 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: Close
[0m23:05:07.912661 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: Close
[0m23:05:07.915704 [info ] [Thread-1  ]: 14 of 18 PASS unique_gld_customer_metrics_customer_id .......................... [[32mPASS[0m in 0.18s]
[0m23:05:07.917422 [info ] [Thread-2  ]: 11 of 18 PASS not_null_slvr_sales_orders_line_total ............................ [[32mPASS[0m in 0.34s]
[0m23:05:07.919709 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:05:07.922633 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:05:07.925785 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:05:07.926860 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m23:05:07.928402 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:05:07.929101 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m23:05:07.930131 [info ] [Thread-1  ]: 17 of 18 START test unique_slvr_customers_customer_id .......................... [RUN]
[0m23:05:07.931800 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_15fe5af9b26991c1c8d5cec71229f0ca]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_15fe5af9b26991c1c8d5cec71229f0ca]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_15fe5af9b26991c1c8d5cec71229f0ca]
  ;')
[0m23:05:07.933110 [info ] [Thread-2  ]: 18 of 18 START test unique_slvr_products_product_id ............................ [RUN]
[0m23:05:07.934585 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_515f4ceab1655cfbfeee7049118e24e2]
   as 
    
    

select
    order_date as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is not null
group by order_date
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_515f4ceab1655cfbfeee7049118e24e2]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_515f4ceab1655cfbfeee7049118e24e2]
  ;')
[0m23:05:07.935958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd, now test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600)
[0m23:05:07.937098 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:05:07.938637 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d, now test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f)
[0m23:05:07.940083 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:05:07.941596 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:05:07.943526 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.944851 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:05:07.946365 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:07.956174 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m23:05:07.958490 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.965909 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m23:05:07.967772 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:07.978558 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:05:07.988012 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:05:07.988640 [debug] [Thread-1  ]: local_md5(model.name): 4e2331c32d747d8df52121a664e91469
[0m23:05:07.994701 [debug] [Thread-2  ]: local_md5(model.name): 460bcc0c9f9b8191fcda43c5bbb8239e
[0m23:05:07.996096 [debug] [Thread-1  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.997218 [debug] [Thread-2  ]: local_md5(invocation_id): 28664cd2d2a42aa80260dfff6f381255
[0m23:05:07.999528 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m23:05:08.000243 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:05:08.001764 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m23:05:08.007145 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:05:08.009089 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: ROLLBACK
[0m23:05:08.013723 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: ROLLBACK
[0m23:05:08.014652 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: Close
[0m23:05:08.016511 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: Close
[0m23:05:08.019009 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m23:05:08.020339 [info ] [Thread-4  ]: 16 of 18 PASS unique_gld_sales_summary_order_date .............................. [[32mPASS[0m in 0.18s]
[0m23:05:08.024685 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m23:05:08.023631 [info ] [Thread-3  ]: 15 of 18 PASS unique_gld_product_performance_product_id ........................ [[32mPASS[0m in 0.19s]
[0m23:05:08.026250 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b78ce1b76ee0100c977d0b75be1f7a06]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b78ce1b76ee0100c977d0b75be1f7a06]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b78ce1b76ee0100c977d0b75be1f7a06]
  ;')
[0m23:05:08.027819 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:05:08.029027 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_2cd2644c35e2ef21d1de63639b7bc5df]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_products"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_2cd2644c35e2ef21d1de63639b7bc5df]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_2cd2644c35e2ef21d1de63639b7bc5df]
  ;')
[0m23:05:08.030645 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:05:08.032081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:05:08.034789 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:05:08.037632 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:08.039262 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:05:08.041337 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:08.043189 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:05:08.062879 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:05:08.066544 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: ROLLBACK
[0m23:05:08.068117 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: Close
[0m23:05:08.070385 [info ] [Thread-2  ]: 18 of 18 PASS unique_slvr_products_product_id .................................. [[32mPASS[0m in 0.13s]
[0m23:05:08.071267 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:05:08.073373 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:05:08.076463 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: ROLLBACK
[0m23:05:08.078092 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: Close
[0m23:05:08.079623 [info ] [Thread-1  ]: 17 of 18 PASS unique_slvr_customers_customer_id ................................ [[32mPASS[0m in 0.14s]
[0m23:05:08.081119 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:05:08.084087 [debug] [MainThread]: On master: COMMIT
[0m23:05:08.085375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:08.086507 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8' was properly closed.
[0m23:05:08.087763 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f' was properly closed.
[0m23:05:08.089101 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600' was properly closed.
[0m23:05:08.090688 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b' was properly closed.
[0m23:05:08.091935 [info ] [MainThread]: 
[0m23:05:08.093228 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m23:05:08.097788 [debug] [MainThread]: Command end result
[0m23:05:08.288728 [info ] [MainThread]: 
[0m23:05:08.291330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:08.293359 [info ] [MainThread]: 
[0m23:05:08.294887 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m23:05:08.297228 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.917758, "process_user_time": 3.787967, "process_kernel_time": 1.290804, "process_mem_max_rss": "126748", "process_in_blocks": "1760", "process_out_blocks": "0"}
[0m23:05:08.298815 [debug] [MainThread]: Command `dbt test` succeeded at 23:05:08.298601 after 4.92 seconds
[0m23:05:08.300348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2513249610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2512fb7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25110f2d30>]}
[0m23:05:08.301465 [debug] [MainThread]: Flushing usage events
[0m23:09:20.059167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c160bbc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15ea45670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15ea45610>]}


============================== 23:09:20.065612 | b97cf748-4cbd-4259-a5c2-331ab0e27c1c ==============================
[0m23:09:20.065612 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:20.067648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:09:20.390059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15d7cbbe0>]}
[0m23:09:20.441663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c162cd7e50>]}
[0m23:09:20.443342 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:09:20.567094 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:09:20.683794 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:09:20.685572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15f6fed60>]}
[0m23:09:22.755988 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:09:22.757798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15d622820>]}
[0m23:09:23.070248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15d552a90>]}
[0m23:09:23.224214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15d355070>]}
[0m23:09:23.225327 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m23:09:23.226321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15d2dd160>]}
[0m23:09:23.228732 [info ] [MainThread]: 
[0m23:09:23.229975 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:09:23.237058 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:09:23.238000 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:09:23.238684 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:09:23.261973 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:23.267126 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:23.272877 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:23.274796 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:09:23.276496 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:09:23.277966 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:09:23.279272 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:23.280653 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:23.282233 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:23.284116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:23.286119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:23.287233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:23.288386 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.289304 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.290117 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.369451 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.370007 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.370460 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.375902 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:23.376385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:23.376785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:23.378627 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:09:23.379797 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:09:23.381292 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:09:23.385150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_gold)
[0m23:09:23.385747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m23:09:23.386310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_silver)
[0m23:09:23.393279 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:23.397125 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:23.401316 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:23.402637 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m23:09:23.403599 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m23:09:23.404456 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m23:09:23.405526 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:23.406251 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:23.407009 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:23.407823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:23.408591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:23.409344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:23.410118 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.410830 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.411642 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.412580 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.413201 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.413800 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.421123 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:23.423256 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m23:09:23.423799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:23.424348 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:23.424922 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m23:09:23.426415 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m23:09:23.427856 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m23:09:23.429689 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m23:09:23.430242 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m23:09:23.432815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c157e6a7f0>]}
[0m23:09:23.433677 [debug] [MainThread]: On master: COMMIT
[0m23:09:23.434523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:23.435436 [info ] [MainThread]: 
[0m23:09:23.439529 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m23:09:23.439923 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m23:09:23.440307 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m23:09:23.440684 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:23.441323 [info ] [Thread-1  ]: 1 of 10 START sql view model bronze.brnz_customers ............................. [RUN]
[0m23:09:23.442614 [info ] [Thread-2  ]: 2 of 10 START sql view model bronze.brnz_example ............................... [RUN]
[0m23:09:23.443818 [info ] [Thread-3  ]: 3 of 10 START sql view model bronze.brnz_products .............................. [RUN]
[0m23:09:23.445499 [info ] [Thread-4  ]: 4 of 10 START sql view model bronze.brnz_sales_orders .......................... [RUN]
[0m23:09:23.447301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now model.dbt_sqlserver_project.brnz_customers)
[0m23:09:23.448895 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now model.dbt_sqlserver_project.brnz_example)
[0m23:09:23.450873 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_products)
[0m23:09:23.452345 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m23:09:23.453225 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m23:09:23.454268 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m23:09:23.455234 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m23:09:23.456115 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:23.465238 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:23.470203 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m23:09:23.474731 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m23:09:23.479310 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:23.487325 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m23:09:23.488935 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m23:09:23.501354 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:23.513889 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m23:09:23.526158 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:23.529877 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m23:09:23.535484 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:23.540356 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m23:09:23.549955 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:23.551733 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m23:09:23.552322 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:23.552814 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:23.553465 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:23.554000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:23.554821 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m23:09:23.555745 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m23:09:23.556753 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m23:09:23.557817 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.558594 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:23.559497 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:23.560452 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:09:23.561439 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.562100 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.563174 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.564109 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.565936 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.566758 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.586638 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.592497 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.601395 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:23.601864 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.602240 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.602984 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m23:09:23.607240 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:23.607619 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.611360 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:23.613361 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m23:09:23.618114 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:23.618858 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m23:09:23.620862 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m23:09:23.649809 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.650264 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.650696 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.651114 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.654825 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:23.658563 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:23.662641 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:23.666512 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:23.668010 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m23:09:23.669024 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m23:09:23.670039 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m23:09:23.670892 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m23:09:23.683520 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.683975 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.696747 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.697193 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.702105 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m23:09:23.703448 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m23:09:23.705693 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m23:09:23.707697 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m23:09:23.715050 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m23:09:23.718769 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m23:09:23.722893 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m23:09:23.726777 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m23:09:23.734515 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:23.735971 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:23.737723 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:23.740287 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:09:23.741733 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:23.743160 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:23.744713 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:23.745617 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:23.746479 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:23.747569 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:23.748560 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:23.749497 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:23.755625 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.756229 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.756611 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.756966 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.758597 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:23.760253 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:23.762136 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:23.763879 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:23.764603 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m23:09:23.765495 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m23:09:23.766335 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m23:09:23.767260 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m23:09:23.779368 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.782977 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m23:09:23.783824 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.784142 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.784463 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.784993 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m23:09:23.786530 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m23:09:23.788309 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m23:09:23.789797 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m23:09:23.791617 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15c0455b0>]}
[0m23:09:23.792334 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m23:09:23.792942 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m23:09:23.793736 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m23:09:23.794595 [info ] [Thread-2  ]: 2 of 10 OK created sql view model bronze.brnz_example .......................... [[32mOK[0m in 0.34s]
[0m23:09:23.795726 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c11ffc6af0>]}
[0m23:09:23.796588 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c11ffc9250>]}
[0m23:09:23.797325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c157f34430>]}
[0m23:09:23.798559 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m23:09:23.799719 [info ] [Thread-4  ]: 4 of 10 OK created sql view model bronze.brnz_sales_orders ..................... [[32mOK[0m in 0.34s]
[0m23:09:23.800969 [info ] [Thread-3  ]: 3 of 10 OK created sql view model bronze.brnz_products ......................... [[32mOK[0m in 0.35s]
[0m23:09:23.802240 [info ] [Thread-1  ]: 1 of 10 OK created sql view model bronze.brnz_customers ........................ [[32mOK[0m in 0.35s]
[0m23:09:23.804335 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:23.805411 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m23:09:23.806657 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m23:09:23.808546 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:23.809636 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.slvr_products
[0m23:09:23.810510 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.slvr_customers
[0m23:09:23.811377 [info ] [Thread-2  ]: 5 of 10 START sql table model silver.slvr_sales_orders ......................... [RUN]
[0m23:09:23.812386 [info ] [Thread-4  ]: 6 of 10 START sql table model silver.slvr_products ............................. [RUN]
[0m23:09:23.813772 [info ] [Thread-3  ]: 7 of 10 START sql table model silver.slvr_customers ............................ [RUN]
[0m23:09:23.815058 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_example, now model.dbt_sqlserver_project.slvr_sales_orders)
[0m23:09:23.816436 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_sales_orders, now model.dbt_sqlserver_project.slvr_products)
[0m23:09:23.817574 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_products, now model.dbt_sqlserver_project.slvr_customers)
[0m23:09:23.818475 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:23.819613 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.slvr_products
[0m23:09:23.820754 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.slvr_customers
[0m23:09:23.825174 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:23.829360 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_products"
[0m23:09:23.834396 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:23.841154 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.slvr_customers
[0m23:09:23.848119 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.slvr_products
[0m23:09:23.854374 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:23.926576 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:23.933049 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:23.937051 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:09:23.940450 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw"
[0m23:09:23.943721 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw"
[0m23:09:23.947494 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw"
[0m23:09:23.949293 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:23.950620 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:23.951814 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:09:23.952707 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:23.953584 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:23.954505 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:23.955359 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_customers__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:23.956257 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:23.957070 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_sales_orders__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:23.957914 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:23.958725 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:09:23.959568 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:23.960411 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.961292 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.962196 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:23.963126 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.963844 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.964716 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:23.969488 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.969944 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.970353 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.972257 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:23.973879 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:23.975521 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:23.976219 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_products__dbt_tmp__dbt_tmp_vw";');

[0m23:09:23.977026 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw";');

[0m23:09:23.977870 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw";');

[0m23:09:23.980688 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.981091 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.981596 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:23.986529 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_products"
[0m23:09:23.988839 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:23.991019 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:23.996927 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:23.998236 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:23.999169 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" as 

with bronze_customers as (
    select * from "AdventureWorks2014"."bronze"."brnz_customers"
),

cleaned as (
    select
        CustomerID as customer_id,
        coalesce(FirstName, ''Unknown'') as first_name,
        coalesce(LastName, ''Unknown'') as last_name,
        concat(coalesce(FirstName, ''Unknown''), '' '', coalesce(LastName, ''Unknown'')) as full_name,
        EmailPromotion as email_promotion,
        StoreID as store_id,
        TerritoryID as territory_id,
        last_modified_date
    from bronze_customers
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_customers__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_customers__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_customers__dbt_tmp')
    )
    DROP index "silver"."slvr_customers__dbt_tmp".silver_slvr_customers__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_customers__dbt_tmp_cci
    ON "silver"."slvr_customers__dbt_tmp"

   


  
[0m23:09:23.999850 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:24.000723 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_products__dbt_tmp__dbt_tmp_vw" as 

with bronze_products as (
    select * from "AdventureWorks2014"."bronze"."brnz_products"
),

cleaned as (
    select
        ProductID as product_id,
        ProductName as product_name,
        ProductNumber as product_number,
        coalesce(Color, ''N/A'') as color,
        StandardCost as standard_cost,
        ListPrice as list_price,
        coalesce(Size, ''N/A'') as size,
        coalesce(Weight, 0) as weight,
        ProductLine as product_line,
        Class as class,
        Style as style,
        ProductSubcategoryID as subcategory_id,
        coalesce(SubcategoryName, ''Uncategorized'') as subcategory_name,
        ProductCategoryID as category_id,
        SellStartDate as sell_start_date,
        SellEndDate as sell_end_date,
        case 
            when DiscontinuedDate is not null then 1
            else 0
        end as is_discontinued,
        last_modified_date
    from bronze_products
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_products__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_products__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_products__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_products__dbt_tmp')
    )
    DROP index "silver"."slvr_products__dbt_tmp".silver_slvr_products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_products__dbt_tmp_cci
    ON "silver"."slvr_products__dbt_tmp"

   


  
[0m23:09:24.002240 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" as 

with bronze_sales as (
    select * from "AdventureWorks2014"."bronze"."brnz_sales_orders"
),

cleaned as (
    select
        sales_order_id,
        order_detail_id,
        order_date,
        due_date,
        ship_date,
        status,
        case 
            when online_order_flag = 1 then ''Online''
            else ''Offline''
        end as order_channel,
        sales_order_number,
        purchase_order_number,
        customer_id,
        sales_person_id,
        territory_id,
        product_id,
        order_qty,
        unit_price,
        unit_price_discount,
        line_total,
        -- Calculated fields
        unit_price * order_qty as gross_amount,
        line_total / nullif(order_qty, 0) as effective_unit_price,
        case 
            when unit_price_discount > 0 then 1
            else 0
        end as has_discount
    from bronze_sales
    where order_qty > 0
        and unit_price >= 0
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_sales_orders__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_sales_orders__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_sales_orders__dbt_tmp')
    )
    DROP index "silver"."slvr_sales_orders__dbt_tmp".silver_slvr_sales_orders__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_sales_orders__dbt_tmp_cci
    ON "silver"."slvr_sales_orders__dbt_tmp"

   


  
[0m23:09:24.212071 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:24.217636 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:24.218993 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products', 'slvr_products__dbt_backup'
[0m23:09:24.229352 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:24.234397 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:24.235722 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products__dbt_tmp', 'slvr_products'
[0m23:09:24.245603 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:24.253975 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: COMMIT
[0m23:09:24.258682 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_backup"
[0m23:09:24.261048 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:24.262662 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_products__dbt_backup";');

[0m23:09:24.301778 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:24.305040 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: Close
[0m23:09:24.306700 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c157f34b50>]}
[0m23:09:24.308142 [info ] [Thread-4  ]: 6 of 10 OK created sql table model silver.slvr_products ........................ [[32mOK[0m in 0.49s]
[0m23:09:24.309795 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.slvr_products
[0m23:09:24.577815 [debug] [Thread-3  ]: SQL status: OK in 1.000 seconds
[0m23:09:24.583462 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:24.584739 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers', 'slvr_customers__dbt_backup'
[0m23:09:24.608432 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:24.614641 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:24.616034 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers__dbt_tmp', 'slvr_customers'
[0m23:09:24.624265 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:24.627001 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: COMMIT
[0m23:09:24.630783 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_backup"
[0m23:09:24.633011 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:24.634477 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_customers__dbt_backup";');

[0m23:09:24.650314 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:24.656624 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: Close
[0m23:09:24.657913 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c157f34130>]}
[0m23:09:24.659113 [info ] [Thread-3  ]: 7 of 10 OK created sql table model silver.slvr_customers ....................... [[32mOK[0m in 0.84s]
[0m23:09:24.660341 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.slvr_customers
[0m23:09:25.525111 [debug] [Thread-2  ]: SQL status: OK in 2.000 seconds
[0m23:09:25.530401 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:25.531613 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders', 'slvr_sales_orders__dbt_backup'
[0m23:09:25.539689 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.544750 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:25.546410 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders__dbt_tmp', 'slvr_sales_orders'
[0m23:09:25.555325 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.558450 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: COMMIT
[0m23:09:25.562993 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_backup"
[0m23:09:25.565713 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:25.567401 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_sales_orders__dbt_backup";');

[0m23:09:25.592587 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.597813 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: Close
[0m23:09:25.603082 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c157f34430>]}
[0m23:09:25.606014 [info ] [Thread-2  ]: 5 of 10 OK created sql table model silver.slvr_sales_orders .................... [[32mOK[0m in 1.79s]
[0m23:09:25.608695 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:25.612722 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:25.613404 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:25.614019 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:25.615516 [info ] [Thread-1  ]: 8 of 10 START sql table model gold.gld_customer_metrics ........................ [RUN]
[0m23:09:25.617288 [info ] [Thread-4  ]: 9 of 10 START sql table model gold.gld_product_performance ..................... [RUN]
[0m23:09:25.619159 [info ] [Thread-3  ]: 10 of 10 START sql table model gold.gld_sales_summary .......................... [RUN]
[0m23:09:25.620584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_customers, now model.dbt_sqlserver_project.gld_customer_metrics)
[0m23:09:25.621916 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_products, now model.dbt_sqlserver_project.gld_product_performance)
[0m23:09:25.623629 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_customers, now model.dbt_sqlserver_project.gld_sales_summary)
[0m23:09:25.625079 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:25.626316 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:25.627677 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:25.634062 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:25.640978 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:25.647864 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:25.658419 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:25.659686 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:25.666619 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:25.666066 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:25.672062 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:25.677872 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:25.681926 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw"
[0m23:09:25.686016 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw"
[0m23:09:25.690469 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw"
[0m23:09:25.692463 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:25.694602 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:25.696264 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:25.697985 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:25.699179 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:25.700762 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:25.702576 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_customer_metrics__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:25.704049 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_product_performance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:25.705502 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_sales_summary__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:25.707249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:25.708624 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:09:25.710009 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:25.711482 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:25.713320 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:25.715285 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:25.717985 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:25.727161 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.733285 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:25.735198 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw";');

[0m23:09:25.740178 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.744260 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:25.744801 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:25.745271 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:25.752470 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.753890 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.756173 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:25.757945 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:25.758624 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:25.759446 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw";');

[0m23:09:25.760372 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" as 

with customers as (
    select * from "AdventureWorks2014"."silver"."slvr_customers"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

customer_sales as (
    select
        c.customer_id,
        c.full_name,
        c.territory_id,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.line_total) as total_revenue,
        avg(s.line_total) as avg_order_value,
        sum(s.order_qty) as total_items_purchased,
        min(s.order_date) as first_order_date,
        max(s.order_date) as last_order_date,
        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount
    from customers c
    left join sales s
        on c.customer_id = s.customer_id
    group by c.customer_id, c.full_name, c.territory_id
)

select * from customer_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_customer_metrics__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_customer_metrics__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_customer_metrics__dbt_tmp')
    )
    DROP index "gold"."gld_customer_metrics__dbt_tmp".gold_gld_customer_metrics__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_customer_metrics__dbt_tmp_cci
    ON "gold"."gld_customer_metrics__dbt_tmp"

   


  
[0m23:09:25.761226 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw";');

[0m23:09:25.764754 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.766041 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:25.768792 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:25.771144 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:25.777827 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:25.779624 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" as 

with products as (
    select * from "AdventureWorks2014"."silver"."slvr_products"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

product_sales as (
    select
        p.product_id,
        p.product_name,
        p.subcategory_name,
        p.color,
        p.list_price,
        p.standard_cost,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.order_qty) as total_quantity_sold,
        sum(s.line_total) as total_revenue,
        avg(s.unit_price) as avg_selling_price,
        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,
        case 
            when sum(s.order_qty) > 0 then 
                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100
            else 0
        end as profit_margin_pct
    from products p
    left join sales s
        on p.product_id = s.product_id
    group by 
        p.product_id, 
        p.product_name, 
        p.subcategory_name, 
        p.color, 
        p.list_price, 
        p.standard_cost
)

select * from product_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_product_performance__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_product_performance__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_product_performance__dbt_tmp')
    )
    DROP index "gold"."gld_product_performance__dbt_tmp".gold_gld_product_performance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_product_performance__dbt_tmp_cci
    ON "gold"."gld_product_performance__dbt_tmp"

   


  
[0m23:09:25.780163 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:25.782232 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" as 

with sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

daily_summary as (
    select
        cast(order_date as date) as order_date,
        count(distinct sales_order_id) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(order_qty) as total_items_sold,
        sum(line_total) as total_revenue,
        avg(line_total) as avg_order_line_value,
        sum(case when order_channel = ''Online'' then 1 else 0 end) as online_orders,
        sum(case when order_channel = ''Offline'' then 1 else 0 end) as offline_orders,
        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue
    from sales
    group by cast(order_date as date)
)

select * from daily_summary;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_sales_summary__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_sales_summary__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_sales_summary__dbt_tmp')
    )
    DROP index "gold"."gld_sales_summary__dbt_tmp".gold_gld_sales_summary__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_sales_summary__dbt_tmp_cci
    ON "gold"."gld_sales_summary__dbt_tmp"

   


  
[0m23:09:26.219457 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.224596 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:26.227617 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary', 'gld_sales_summary__dbt_backup'
[0m23:09:26.365658 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m23:09:26.372656 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:26.374579 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics', 'gld_customer_metrics__dbt_backup'
[0m23:09:26.383685 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.384993 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.388588 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:26.392458 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:26.393309 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics__dbt_tmp', 'gld_customer_metrics'
[0m23:09:26.394312 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary__dbt_tmp', 'gld_sales_summary'
[0m23:09:26.406801 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.409620 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: COMMIT
[0m23:09:26.410147 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.413417 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_backup"
[0m23:09:26.415892 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: COMMIT
[0m23:09:26.417000 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:26.420411 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_backup"
[0m23:09:26.421460 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_customer_metrics__dbt_backup";');

[0m23:09:26.422719 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:26.424419 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_sales_summary__dbt_backup";');

[0m23:09:26.457868 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.460962 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: Close
[0m23:09:26.462831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c15605ca00>]}
[0m23:09:26.464972 [info ] [Thread-1  ]: 8 of 10 OK created sql table model gold.gld_customer_metrics ................... [[32mOK[0m in 0.84s]
[0m23:09:26.467192 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:26.480791 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.484364 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: Close
[0m23:09:26.485884 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c11feb18b0>]}
[0m23:09:26.487667 [info ] [Thread-3  ]: 10 of 10 OK created sql table model gold.gld_sales_summary ..................... [[32mOK[0m in 0.86s]
[0m23:09:26.489370 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:26.774721 [debug] [Thread-4  ]: SQL status: OK in 1.000 seconds
[0m23:09:26.779623 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:26.781059 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance', 'gld_product_performance__dbt_backup'
[0m23:09:26.790318 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.796056 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:26.797169 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance__dbt_tmp', 'gld_product_performance'
[0m23:09:26.804853 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.807125 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: COMMIT
[0m23:09:26.810426 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_backup"
[0m23:09:26.811619 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:26.812398 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_product_performance__dbt_backup";');

[0m23:09:26.820819 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:26.823012 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: Close
[0m23:09:26.824161 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97cf748-4cbd-4259-a5c2-331ab0e27c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c11feb13d0>]}
[0m23:09:26.825380 [info ] [Thread-4  ]: 9 of 10 OK created sql table model gold.gld_product_performance ................ [[32mOK[0m in 1.20s]
[0m23:09:26.826731 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:26.828996 [debug] [MainThread]: On master: COMMIT
[0m23:09:26.830051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:26.830963 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_sales_summary' was properly closed.
[0m23:09:26.831803 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.slvr_sales_orders' was properly closed.
[0m23:09:26.832552 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_customer_metrics' was properly closed.
[0m23:09:26.833283 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_product_performance' was properly closed.
[0m23:09:26.834178 [info ] [MainThread]: 
[0m23:09:26.835161 [info ] [MainThread]: Finished running 4 view models, 6 table models in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m23:09:26.837774 [debug] [MainThread]: Command end result
[0m23:09:26.905997 [info ] [MainThread]: 
[0m23:09:26.907148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:26.908158 [info ] [MainThread]: 
[0m23:09:26.909104 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:09:26.910860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.924667, "process_user_time": 3.903089, "process_kernel_time": 0.650514, "process_mem_max_rss": "131360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:09:26.911823 [debug] [MainThread]: Command `dbt run` succeeded at 23:09:26.911723 after 6.93 seconds
[0m23:09:26.912629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c160bbc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c157e6ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c156055340>]}
[0m23:09:26.913316 [debug] [MainThread]: Flushing usage events
[0m23:09:35.422298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193147da6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193126645b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719312664550>]}


============================== 23:09:35.426160 | ad740226-757a-46ac-be86-d1a852e93777 ==============================
[0m23:09:35.426160 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:35.427544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:36.010126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719311420a60>]}
[0m23:09:36.058352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193149b1e80>]}
[0m23:09:36.060852 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:09:36.189200 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:09:37.171020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:37.172027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:37.223078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719310d7a130>]}
[0m23:09:37.428619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71931128c8b0>]}
[0m23:09:37.429663 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m23:09:37.430655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719310da1430>]}
[0m23:09:37.433975 [info ] [MainThread]: 
[0m23:09:37.435396 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:09:37.444616 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:09:37.447287 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:09:37.463434 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m23:09:37.475819 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:37.483043 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:37.486728 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:37.488432 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:09:37.489806 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:09:37.491417 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m23:09:37.492670 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:37.494095 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:37.495439 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:37.496568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:37.497507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:37.498282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:37.499076 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.499847 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.500634 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.537164 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.539594 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.540812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:37.542312 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:37.542742 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.544282 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:09:37.545861 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:09:37.548627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:37.550425 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m23:09:37.552710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_gold)
[0m23:09:37.553225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_silver)
[0m23:09:37.553769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m23:09:37.563340 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:37.568867 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:37.571848 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:37.572912 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m23:09:37.573743 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m23:09:37.574537 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m23:09:37.575338 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:37.576076 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:37.576860 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:37.577688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:37.578416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:37.579203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:37.580056 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.580692 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.581426 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.582266 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.582924 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.583498 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.588539 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:37.588882 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:37.590645 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m23:09:37.591025 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:37.592346 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m23:09:37.592996 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m23:09:37.595346 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m23:09:37.596128 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m23:09:37.598472 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m23:09:37.601902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193111e3ee0>]}
[0m23:09:37.602837 [debug] [MainThread]: On master: COMMIT
[0m23:09:37.603767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:37.604786 [info ] [MainThread]: 
[0m23:09:37.608819 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m23:09:37.609239 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m23:09:37.609624 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m23:09:37.610304 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:37.611235 [info ] [Thread-1  ]: 1 of 10 START sql view model bronze.brnz_customers ............................. [RUN]
[0m23:09:37.612351 [info ] [Thread-2  ]: 2 of 10 START sql view model bronze.brnz_example ............................... [RUN]
[0m23:09:37.613605 [info ] [Thread-3  ]: 3 of 10 START sql view model bronze.brnz_products .............................. [RUN]
[0m23:09:37.614760 [info ] [Thread-4  ]: 4 of 10 START sql view model bronze.brnz_sales_orders .......................... [RUN]
[0m23:09:37.616085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_customers)
[0m23:09:37.617038 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now model.dbt_sqlserver_project.brnz_example)
[0m23:09:37.617921 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now model.dbt_sqlserver_project.brnz_products)
[0m23:09:37.618876 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m23:09:37.619792 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m23:09:37.620622 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m23:09:37.621378 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m23:09:37.622134 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:37.633888 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:37.639634 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m23:09:37.643526 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m23:09:37.650742 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:37.656714 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m23:09:37.657436 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m23:09:37.658799 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m23:09:37.664713 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:37.719240 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:37.720245 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m23:09:37.724725 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m23:09:37.732445 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:37.740812 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:37.742106 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:37.743356 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m23:09:37.744088 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:37.744538 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:37.746023 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m23:09:37.746900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:37.747841 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m23:09:37.748964 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m23:09:37.749821 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:37.750638 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.751569 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:09:37.752421 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:37.753252 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.754229 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.754866 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.755757 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:37.756631 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.758002 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.771204 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.775671 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.781812 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:37.783757 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:37.784204 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.788099 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:37.789753 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m23:09:37.795394 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:37.796377 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m23:09:37.798186 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m23:09:37.806032 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.806713 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.807092 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.807451 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.813657 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:37.818066 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:37.821655 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:37.825826 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:37.826962 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m23:09:37.828218 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m23:09:37.829546 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m23:09:37.830683 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m23:09:37.843096 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.843671 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.844209 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.844559 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.864898 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m23:09:37.865770 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m23:09:37.868225 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m23:09:37.873102 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:37.882183 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m23:09:37.886964 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m23:09:37.892625 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m23:09:37.894282 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m23:09:37.903033 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:37.904852 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:37.906661 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:37.909037 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:37.910422 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:37.911559 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:37.912647 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:37.913561 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:37.914718 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:37.916718 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.919437 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.919989 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.920470 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.921429 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m23:09:37.923194 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m23:09:37.924918 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m23:09:37.926494 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m23:09:37.931116 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m23:09:37.932445 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m23:09:37.933536 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m23:09:37.934428 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m23:09:37.935604 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:09:37.940108 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:37.941067 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:37.944410 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.944889 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.945372 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.945755 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.948396 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m23:09:37.950280 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m23:09:37.952185 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m23:09:37.954352 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m23:09:37.955110 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m23:09:37.955742 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m23:09:37.956418 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m23:09:37.957079 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m23:09:37.959115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719311085880>]}
[0m23:09:37.960239 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193111e3ee0>]}
[0m23:09:37.961237 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719310d73280>]}
[0m23:09:37.962980 [info ] [Thread-1  ]: 1 of 10 OK created sql view model bronze.brnz_customers ........................ [[32mOK[0m in 0.34s]
[0m23:09:37.964256 [info ] [Thread-3  ]: 3 of 10 OK created sql view model bronze.brnz_products ......................... [[32mOK[0m in 0.34s]
[0m23:09:37.965604 [info ] [Thread-4  ]: 4 of 10 OK created sql view model bronze.brnz_sales_orders ..................... [[32mOK[0m in 0.34s]
[0m23:09:37.966789 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m23:09:37.967791 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m23:09:37.968889 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m23:09:37.969256 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:37.970313 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.slvr_customers
[0m23:09:37.971219 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.slvr_products
[0m23:09:37.972085 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:37.973688 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m23:09:37.974623 [info ] [Thread-1  ]: 5 of 10 START sql table model silver.slvr_customers ............................ [RUN]
[0m23:09:37.975627 [info ] [Thread-3  ]: 6 of 10 START sql table model silver.slvr_products ............................. [RUN]
[0m23:09:37.976644 [info ] [Thread-4  ]: 7 of 10 START sql table model silver.slvr_sales_orders ......................... [RUN]
[0m23:09:37.977731 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m23:09:37.978693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_customers, now model.dbt_sqlserver_project.slvr_customers)
[0m23:09:37.979513 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_products, now model.dbt_sqlserver_project.slvr_products)
[0m23:09:37.980543 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_sales_orders, now model.dbt_sqlserver_project.slvr_sales_orders)
[0m23:09:37.981487 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193104a77f0>]}
[0m23:09:37.982141 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.slvr_customers
[0m23:09:37.982896 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.slvr_products
[0m23:09:37.983687 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:37.984816 [info ] [Thread-2  ]: 2 of 10 OK created sql view model bronze.brnz_example .......................... [[32mOK[0m in 0.36s]
[0m23:09:37.989704 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:37.993750 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_products"
[0m23:09:37.999214 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:38.000666 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m23:09:38.006603 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.slvr_customers
[0m23:09:38.007690 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:38.013900 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.slvr_products
[0m23:09:38.070567 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:38.071147 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:38.074715 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:38.083403 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw"
[0m23:09:38.089941 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw"
[0m23:09:38.096360 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw"
[0m23:09:38.101081 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:38.104602 [debug] [Thread-4  ]: dbt-sqlserver
[0m23:09:38.108970 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:38.111042 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:38.112979 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:38.114606 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:38.116264 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_customers__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:38.117935 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_sales_orders__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:38.119175 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:38.120848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:38.122062 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:09:38.122958 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:38.123994 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:38.125109 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:38.126046 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:38.147446 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:38.147948 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:38.150610 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:38.151151 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.151595 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.154100 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:38.154543 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.156097 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:38.156794 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw";');

[0m23:09:38.158971 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:38.159618 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw";');

[0m23:09:38.161351 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_products__dbt_tmp__dbt_tmp_vw";');

[0m23:09:38.163148 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.164839 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.170084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:38.170523 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.172454 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:38.175611 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_products"
[0m23:09:38.180439 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:38.181163 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:38.182359 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" as 

with bronze_customers as (
    select * from "AdventureWorks2014"."bronze"."brnz_customers"
),

cleaned as (
    select
        CustomerID as customer_id,
        coalesce(FirstName, ''Unknown'') as first_name,
        coalesce(LastName, ''Unknown'') as last_name,
        concat(coalesce(FirstName, ''Unknown''), '' '', coalesce(LastName, ''Unknown'')) as full_name,
        EmailPromotion as email_promotion,
        StoreID as store_id,
        TerritoryID as territory_id,
        last_modified_date
    from bronze_customers
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_customers__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_customers__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_customers__dbt_tmp')
    )
    DROP index "silver"."slvr_customers__dbt_tmp".silver_slvr_customers__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_customers__dbt_tmp_cci
    ON "silver"."slvr_customers__dbt_tmp"

   


  
[0m23:09:38.182911 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:38.183690 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_products__dbt_tmp__dbt_tmp_vw" as 

with bronze_products as (
    select * from "AdventureWorks2014"."bronze"."brnz_products"
),

cleaned as (
    select
        ProductID as product_id,
        ProductName as product_name,
        ProductNumber as product_number,
        coalesce(Color, ''N/A'') as color,
        StandardCost as standard_cost,
        ListPrice as list_price,
        coalesce(Size, ''N/A'') as size,
        coalesce(Weight, 0) as weight,
        ProductLine as product_line,
        Class as class,
        Style as style,
        ProductSubcategoryID as subcategory_id,
        coalesce(SubcategoryName, ''Uncategorized'') as subcategory_name,
        ProductCategoryID as category_id,
        SellStartDate as sell_start_date,
        SellEndDate as sell_end_date,
        case 
            when DiscontinuedDate is not null then 1
            else 0
        end as is_discontinued,
        last_modified_date
    from bronze_products
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_products__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_products__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_products__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_products__dbt_tmp')
    )
    DROP index "silver"."slvr_products__dbt_tmp".silver_slvr_products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_products__dbt_tmp_cci
    ON "silver"."slvr_products__dbt_tmp"

   


  
[0m23:09:38.185151 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" as 

with bronze_sales as (
    select * from "AdventureWorks2014"."bronze"."brnz_sales_orders"
),

cleaned as (
    select
        sales_order_id,
        order_detail_id,
        order_date,
        due_date,
        ship_date,
        status,
        case 
            when online_order_flag = 1 then ''Online''
            else ''Offline''
        end as order_channel,
        sales_order_number,
        purchase_order_number,
        customer_id,
        sales_person_id,
        territory_id,
        product_id,
        order_qty,
        unit_price,
        unit_price_discount,
        line_total,
        -- Calculated fields
        unit_price * order_qty as gross_amount,
        line_total / nullif(order_qty, 0) as effective_unit_price,
        case 
            when unit_price_discount > 0 then 1
            else 0
        end as has_discount
    from bronze_sales
    where order_qty > 0
        and unit_price >= 0
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_sales_orders__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_sales_orders__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_sales_orders__dbt_tmp')
    )
    DROP index "silver"."slvr_sales_orders__dbt_tmp".silver_slvr_sales_orders__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_sales_orders__dbt_tmp_cci
    ON "silver"."slvr_sales_orders__dbt_tmp"

   


  
[0m23:09:38.290350 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.296674 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:38.298323 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products', 'slvr_products__dbt_backup'
[0m23:09:38.308114 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.315904 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:38.317183 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products__dbt_tmp', 'slvr_products'
[0m23:09:38.328253 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.334142 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: COMMIT
[0m23:09:38.338898 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_backup"
[0m23:09:38.340343 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m23:09:38.344754 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_products__dbt_backup";');

[0m23:09:38.358369 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.362139 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: Close
[0m23:09:38.363379 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193132d1d60>]}
[0m23:09:38.364720 [info ] [Thread-3  ]: 6 of 10 OK created sql table model silver.slvr_products ........................ [[32mOK[0m in 0.38s]
[0m23:09:38.366177 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.slvr_products
[0m23:09:38.551920 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.556838 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:38.557940 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers', 'slvr_customers__dbt_backup'
[0m23:09:38.570100 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.574252 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:38.575147 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers__dbt_tmp', 'slvr_customers'
[0m23:09:38.585819 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.588457 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: COMMIT
[0m23:09:38.591718 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_backup"
[0m23:09:38.593413 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m23:09:38.594610 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_customers__dbt_backup";');

[0m23:09:38.603797 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:38.605880 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: Close
[0m23:09:38.606915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193102c1400>]}
[0m23:09:38.608047 [info ] [Thread-1  ]: 5 of 10 OK created sql table model silver.slvr_customers ....................... [[32mOK[0m in 0.63s]
[0m23:09:38.609301 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.slvr_customers
[0m23:09:39.201938 [debug] [Thread-4  ]: SQL status: OK in 1.000 seconds
[0m23:09:39.206698 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:39.207619 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders', 'slvr_sales_orders__dbt_backup'
[0m23:09:39.215916 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.223361 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:39.224610 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders__dbt_tmp', 'slvr_sales_orders'
[0m23:09:39.232162 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.235055 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: COMMIT
[0m23:09:39.288650 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_backup"
[0m23:09:39.290924 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m23:09:39.292151 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_sales_orders__dbt_backup";');

[0m23:09:39.300829 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.303005 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: Close
[0m23:09:39.304099 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193100515e0>]}
[0m23:09:39.305191 [info ] [Thread-4  ]: 7 of 10 OK created sql table model silver.slvr_sales_orders .................... [[32mOK[0m in 1.32s]
[0m23:09:39.306607 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.slvr_sales_orders
[0m23:09:39.308327 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:39.308740 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:39.309082 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:39.309894 [info ] [Thread-2  ]: 8 of 10 START sql table model gold.gld_customer_metrics ........................ [RUN]
[0m23:09:39.311092 [info ] [Thread-3  ]: 9 of 10 START sql table model gold.gld_product_performance ..................... [RUN]
[0m23:09:39.312347 [info ] [Thread-1  ]: 10 of 10 START sql table model gold.gld_sales_summary .......................... [RUN]
[0m23:09:39.313485 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_example, now model.dbt_sqlserver_project.gld_customer_metrics)
[0m23:09:39.314552 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_products, now model.dbt_sqlserver_project.gld_product_performance)
[0m23:09:39.315456 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_customers, now model.dbt_sqlserver_project.gld_sales_summary)
[0m23:09:39.316368 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:39.317194 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:39.318035 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:39.322113 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:39.326220 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:39.330229 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.336300 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:39.337057 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:39.341943 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:09:39.342337 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:39.347038 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:39.350400 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw"
[0m23:09:39.354465 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:39.357687 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw"
[0m23:09:39.358989 [debug] [Thread-2  ]: dbt-sqlserver
[0m23:09:39.362440 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw"
[0m23:09:39.363873 [debug] [Thread-3  ]: dbt-sqlserver
[0m23:09:39.364832 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:39.366016 [debug] [Thread-1  ]: dbt-sqlserver
[0m23:09:39.366950 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:39.367869 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_customer_metrics__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:39.368768 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.369671 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_product_performance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:39.370514 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:39.371378 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_sales_summary__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m23:09:39.372206 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:39.373140 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:39.374009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:39.374844 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:39.375980 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:39.377073 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:39.381934 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.385463 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:39.386670 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw";');

[0m23:09:39.389648 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.393572 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:39.394094 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:39.394491 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:39.398504 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.398920 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.400904 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:39.403476 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.403935 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:39.404318 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw";');

[0m23:09:39.405340 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw";');

[0m23:09:39.406217 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" as 

with customers as (
    select * from "AdventureWorks2014"."silver"."slvr_customers"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

customer_sales as (
    select
        c.customer_id,
        c.full_name,
        c.territory_id,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.line_total) as total_revenue,
        avg(s.line_total) as avg_order_value,
        sum(s.order_qty) as total_items_purchased,
        min(s.order_date) as first_order_date,
        max(s.order_date) as last_order_date,
        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount
    from customers c
    left join sales s
        on c.customer_id = s.customer_id
    group by c.customer_id, c.full_name, c.territory_id
)

select * from customer_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_customer_metrics__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_customer_metrics__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_customer_metrics__dbt_tmp')
    )
    DROP index "gold"."gld_customer_metrics__dbt_tmp".gold_gld_customer_metrics__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_customer_metrics__dbt_tmp_cci
    ON "gold"."gld_customer_metrics__dbt_tmp"

   


  
[0m23:09:39.409264 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.409835 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.412705 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:39.415526 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.421416 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:39.422440 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.423561 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" as 

with products as (
    select * from "AdventureWorks2014"."silver"."slvr_products"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

product_sales as (
    select
        p.product_id,
        p.product_name,
        p.subcategory_name,
        p.color,
        p.list_price,
        p.standard_cost,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.order_qty) as total_quantity_sold,
        sum(s.line_total) as total_revenue,
        avg(s.unit_price) as avg_selling_price,
        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,
        case 
            when sum(s.order_qty) > 0 then 
                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100
            else 0
        end as profit_margin_pct
    from products p
    left join sales s
        on p.product_id = s.product_id
    group by 
        p.product_id, 
        p.product_name, 
        p.subcategory_name, 
        p.color, 
        p.list_price, 
        p.standard_cost
)

select * from product_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_product_performance__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_product_performance__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_product_performance__dbt_tmp')
    )
    DROP index "gold"."gld_product_performance__dbt_tmp".gold_gld_product_performance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_product_performance__dbt_tmp_cci
    ON "gold"."gld_product_performance__dbt_tmp"

   


  
[0m23:09:39.424584 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" as 

with sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

daily_summary as (
    select
        cast(order_date as date) as order_date,
        count(distinct sales_order_id) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(order_qty) as total_items_sold,
        sum(line_total) as total_revenue,
        avg(line_total) as avg_order_line_value,
        sum(case when order_channel = ''Online'' then 1 else 0 end) as online_orders,
        sum(case when order_channel = ''Offline'' then 1 else 0 end) as offline_orders,
        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue
    from sales
    group by cast(order_date as date)
)

select * from daily_summary;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_sales_summary__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_sales_summary__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_sales_summary__dbt_tmp')
    )
    DROP index "gold"."gld_sales_summary__dbt_tmp".gold_gld_sales_summary__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_sales_summary__dbt_tmp_cci
    ON "gold"."gld_sales_summary__dbt_tmp"

   


  
[0m23:09:39.731843 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.737134 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.738423 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary', 'gld_sales_summary__dbt_backup'
[0m23:09:39.748321 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.753460 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.754709 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary__dbt_tmp', 'gld_sales_summary'
[0m23:09:39.765220 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.767924 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: COMMIT
[0m23:09:39.771752 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_backup"
[0m23:09:39.773176 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m23:09:39.774220 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_sales_summary__dbt_backup";');

[0m23:09:39.783587 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:39.787625 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: Close
[0m23:09:39.789421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71930afe7220>]}
[0m23:09:39.791048 [info ] [Thread-1  ]: 10 of 10 OK created sql table model gold.gld_sales_summary ..................... [[32mOK[0m in 0.47s]
[0m23:09:39.792683 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.gld_sales_summary
[0m23:09:40.635885 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m23:09:40.640984 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:40.642680 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics', 'gld_customer_metrics__dbt_backup'
[0m23:09:40.656344 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:40.661182 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:40.662293 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics__dbt_tmp', 'gld_customer_metrics'
[0m23:09:40.671002 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:40.673571 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: COMMIT
[0m23:09:40.679346 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_backup"
[0m23:09:40.681285 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m23:09:40.682385 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_customer_metrics__dbt_backup";');

[0m23:09:40.691551 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:40.694358 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: Close
[0m23:09:40.695696 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719310257b20>]}
[0m23:09:40.696889 [info ] [Thread-2  ]: 8 of 10 OK created sql table model gold.gld_customer_metrics ................... [[32mOK[0m in 1.38s]
[0m23:09:40.698161 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.gld_customer_metrics
[0m23:09:40.703270 [debug] [Thread-3  ]: SQL status: OK in 1.000 seconds
[0m23:09:40.707711 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:40.708852 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance', 'gld_product_performance__dbt_backup'
[0m23:09:40.717340 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:40.722335 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:40.723518 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance__dbt_tmp', 'gld_product_performance'
[0m23:09:40.731953 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:40.734456 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: COMMIT
[0m23:09:40.737864 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_backup"
[0m23:09:40.739210 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m23:09:40.740393 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_product_performance__dbt_backup";');

[0m23:09:40.749472 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:40.751858 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: Close
[0m23:09:40.753074 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad740226-757a-46ac-be86-d1a852e93777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71930afe77c0>]}
[0m23:09:40.754302 [info ] [Thread-3  ]: 9 of 10 OK created sql table model gold.gld_product_performance ................ [[32mOK[0m in 1.44s]
[0m23:09:40.755651 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.gld_product_performance
[0m23:09:40.758086 [debug] [MainThread]: On master: COMMIT
[0m23:09:40.759068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:40.760094 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_customer_metrics' was properly closed.
[0m23:09:40.760999 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_sales_summary' was properly closed.
[0m23:09:40.761775 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_product_performance' was properly closed.
[0m23:09:40.762564 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.slvr_sales_orders' was properly closed.
[0m23:09:40.763496 [info ] [MainThread]: 
[0m23:09:40.764669 [info ] [MainThread]: Finished running 4 view models, 6 table models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m23:09:40.767075 [debug] [MainThread]: Command end result
[0m23:09:40.841088 [info ] [MainThread]: 
[0m23:09:40.842294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:40.843506 [info ] [MainThread]: 
[0m23:09:40.844788 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:09:40.846323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.516875, "process_user_time": 2.612552, "process_kernel_time": 0.865408, "process_mem_max_rss": "126016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:09:40.847373 [debug] [MainThread]: Command `dbt run` succeeded at 23:09:40.847235 after 5.52 seconds
[0m23:09:40.848414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193147da6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7193126e4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719312d0e3d0>]}
[0m23:09:40.849367 [debug] [MainThread]: Flushing usage events
[0m23:09:45.029772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f5af30610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f58de3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f58de3a30>]}


============================== 23:09:45.033345 | f4c39f7e-6440-4a90-965f-14f4a2e4b3cb ==============================
[0m23:09:45.033345 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:45.034466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:09:45.259986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c39f7e-6440-4a90-965f-14f4a2e4b3cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f57af7310>]}
[0m23:09:45.310546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c39f7e-6440-4a90-965f-14f4a2e4b3cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f58dd9d30>]}
[0m23:09:45.312445 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m23:09:45.415432 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:09:46.578977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:46.580376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:46.638849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c39f7e-6440-4a90-965f-14f4a2e4b3cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f574d0130>]}
[0m23:09:46.902708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c39f7e-6440-4a90-965f-14f4a2e4b3cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f57b7ce20>]}
[0m23:09:46.904178 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m23:09:46.905442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c39f7e-6440-4a90-965f-14f4a2e4b3cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f574e0a30>]}
[0m23:09:46.908875 [info ] [MainThread]: 
[0m23:09:46.910411 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m23:09:46.917918 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m23:09:46.918696 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_gold'
[0m23:09:46.919532 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_silver'
[0m23:09:46.938872 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:46.942550 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:46.947110 [debug] [ThreadPool]: dbt-sqlserver
[0m23:09:46.949463 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m23:09:46.951546 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m23:09:46.953014 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m23:09:46.954700 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:46.956245 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:46.957804 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m23:09:46.958952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:46.960088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:46.961132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:46.962654 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:46.964396 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:46.965741 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.000487 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.001003 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.001410 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.006723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:47.007511 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:47.009256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:09:47.009899 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m23:09:47.011712 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m23:09:47.013380 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m23:09:47.014204 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m23:09:47.014861 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m23:09:47.015630 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m23:09:47.020238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c39f7e-6440-4a90-965f-14f4a2e4b3cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f57b7cb50>]}
[0m23:09:47.021345 [debug] [MainThread]: On master: COMMIT
[0m23:09:47.022345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:47.023515 [info ] [MainThread]: 
[0m23:09:47.027688 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:09:47.028215 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:09:47.028662 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:09:47.029085 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:09:47.029702 [info ] [Thread-1  ]: 1 of 18 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m23:09:47.030844 [info ] [Thread-2  ]: 2 of 18 START test dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m23:09:47.031943 [info ] [Thread-3  ]: 3 of 18 START test not_null_brnz_sales_orders_order_detail_id .................. [RUN]
[0m23:09:47.033056 [info ] [Thread-4  ]: 4 of 18 START test not_null_brnz_sales_orders_sales_order_id ................... [RUN]
[0m23:09:47.034396 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m23:09:47.035533 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc)
[0m23:09:47.036679 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac)
[0m23:09:47.037756 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m23:09:47.038819 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:09:47.039868 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:09:47.040969 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:09:47.042035 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:09:47.069365 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m23:09:47.064635 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m23:09:47.080890 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m23:09:47.087533 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m23:09:47.098619 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:09:47.100252 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:09:47.112435 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:09:47.129340 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:09:47.133722 [debug] [Thread-3  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m23:09:47.136782 [debug] [Thread-4  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m23:09:47.141458 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m23:09:47.146139 [debug] [Thread-2  ]: local_md5(model.name): fa6b3d9cc18a40cfba3de7295a3a38e6
[0m23:09:47.148397 [debug] [Thread-3  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.149922 [debug] [Thread-4  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.151746 [debug] [Thread-1  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.153548 [debug] [Thread-2  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.155182 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m23:09:47.157080 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m23:09:47.158481 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m23:09:47.160136 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m23:09:47.167694 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m23:09:47.169050 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m23:09:47.170269 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3186c6a595bfe7538753cbd8eaeb052d]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3186c6a595bfe7538753cbd8eaeb052d]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3186c6a595bfe7538753cbd8eaeb052d]
  ;')
[0m23:09:47.170922 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m23:09:47.172217 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6eafb92e98b991219e5d61896a42c9d3]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6eafb92e98b991219e5d61896a42c9d3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6eafb92e98b991219e5d61896a42c9d3]
  ;')
[0m23:09:47.173214 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m23:09:47.174198 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:09:47.175586 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_4a75fb69583762bf957a98c89f50e611]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_4a75fb69583762bf957a98c89f50e611]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_4a75fb69583762bf957a98c89f50e611]
  ;')
[0m23:09:47.176746 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:47.177880 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_f861651350c429c6a5bd4885690138ef]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."silver"."slvr_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_f861651350c429c6a5bd4885690138ef]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_f861651350c429c6a5bd4885690138ef]
  ;')
[0m23:09:47.179145 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.180353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:47.181485 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.182412 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:47.183485 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.184239 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.185378 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.186362 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.188293 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.208922 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.227527 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.234152 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m23:09:47.235860 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m23:09:47.237886 [info ] [Thread-4  ]: 4 of 18 PASS not_null_brnz_sales_orders_sales_order_id ......................... [[32mPASS[0m in 0.20s]
[0m23:09:47.239623 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m23:09:47.241138 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:09:47.242484 [info ] [Thread-4  ]: 5 of 18 START test not_null_gld_customer_metrics_customer_id ................... [RUN]
[0m23:09:47.244416 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca, now test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39)
[0m23:09:47.245882 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:09:47.253348 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m23:09:47.269370 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:09:47.276718 [debug] [Thread-4  ]: local_md5(model.name): ac0d77cdfe99d22d2680c19319e8499c
[0m23:09:47.278650 [debug] [Thread-4  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.279395 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.281141 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m23:09:47.284876 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m23:09:47.287331 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m23:09:47.289041 [info ] [Thread-3  ]: 3 of 18 PASS not_null_brnz_sales_orders_order_detail_id ........................ [[32mPASS[0m in 0.25s]
[0m23:09:47.290882 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m23:09:47.292294 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:09:47.293932 [info ] [Thread-3  ]: 6 of 18 START test not_null_gld_product_performance_product_id ................. [RUN]
[0m23:09:47.295686 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac, now test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397)
[0m23:09:47.297297 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:09:47.306237 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m23:09:47.308476 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m23:09:47.310104 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_16775f70b0f7b7505da9cb1375333ec5]
   as 
    
    



select customer_id
from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_16775f70b0f7b7505da9cb1375333ec5]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_16775f70b0f7b7505da9cb1375333ec5]
  ;')
[0m23:09:47.313555 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:09:47.315331 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.317095 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.330134 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:09:47.334817 [debug] [Thread-3  ]: local_md5(model.name): a5b86011b8d22b04b2506841bc10c840
[0m23:09:47.336961 [debug] [Thread-3  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.339054 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m23:09:47.342060 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.343095 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.346081 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: ROLLBACK
[0m23:09:47.349107 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m23:09:47.350101 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: Close
[0m23:09:47.351853 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m23:09:47.353066 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m23:09:47.353851 [info ] [Thread-4  ]: 5 of 18 PASS not_null_gld_customer_metrics_customer_id ......................... [[32mPASS[0m in 0.11s]
[0m23:09:47.355251 [info ] [Thread-1  ]: 1 of 18 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.32s]
[0m23:09:47.356573 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_c619e8425abfdc13daa1e7c5952cbbfd]
   as 
    
    



select product_id
from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_c619e8425abfdc13daa1e7c5952cbbfd]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_c619e8425abfdc13daa1e7c5952cbbfd]
  ;')
[0m23:09:47.358061 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m23:09:47.359415 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m23:09:47.360738 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:47.362122 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:09:47.363397 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:09:47.364647 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.365964 [info ] [Thread-4  ]: 7 of 18 START test not_null_gld_sales_summary_order_date ....................... [RUN]
[0m23:09:47.366596 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.368150 [info ] [Thread-1  ]: 8 of 18 START test not_null_slvr_customers_customer_id ......................... [RUN]
[0m23:09:47.369900 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.370918 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39, now test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e)
[0m23:09:47.373638 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: ROLLBACK
[0m23:09:47.374391 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902, now test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275)
[0m23:09:47.376921 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:09:47.378293 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: Close
[0m23:09:47.379414 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:09:47.386364 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m23:09:47.387754 [info ] [Thread-2  ]: 2 of 18 PASS dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.35s]
[0m23:09:47.395673 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m23:09:47.396341 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.398210 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m23:09:47.401863 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: ROLLBACK
[0m23:09:47.402712 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:09:47.403983 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: Close
[0m23:09:47.405276 [info ] [Thread-2  ]: 9 of 18 START test not_null_slvr_products_list_price ........................... [RUN]
[0m23:09:47.407653 [info ] [Thread-3  ]: 6 of 18 PASS not_null_gld_product_performance_product_id ....................... [[32mPASS[0m in 0.11s]
[0m23:09:47.408669 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:09:47.410911 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc, now test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076)
[0m23:09:47.411750 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:09:47.413154 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m23:09:47.417703 [debug] [Thread-4  ]: local_md5(model.name): 31cffa58c58a08e4f0ecffd253b46aa2
[0m23:09:47.419089 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:09:47.423308 [debug] [Thread-1  ]: local_md5(model.name): 8e9f64ea0dd2dc40d032bf48fa566213
[0m23:09:47.424803 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:09:47.425996 [debug] [Thread-4  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.432214 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m23:09:47.433321 [debug] [Thread-1  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.434797 [info ] [Thread-3  ]: 10 of 18 START test not_null_slvr_products_product_id .......................... [RUN]
[0m23:09:47.436489 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m23:09:47.438731 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m23:09:47.440394 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397, now test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551)
[0m23:09:47.443822 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:09:47.451107 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m23:09:47.452859 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:09:47.458205 [debug] [Thread-2  ]: local_md5(model.name): d9ecc431b4a169296ca29c386f015286
[0m23:09:47.460036 [debug] [Thread-2  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.460982 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m23:09:47.461686 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m23:09:47.462789 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m23:09:47.464295 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_acdf6df00ba80f080d6c52eaefe4f564]
   as 
    
    



select customer_id
from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_acdf6df00ba80f080d6c52eaefe4f564]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_acdf6df00ba80f080d6c52eaefe4f564]
  ;')
[0m23:09:47.466022 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_87eacea5c7d42fa0f9cabb85dcb6773f]
   as 
    
    



select order_date
from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_87eacea5c7d42fa0f9cabb85dcb6773f]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_87eacea5c7d42fa0f9cabb85dcb6773f]
  ;')
[0m23:09:47.466538 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:09:47.468205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:47.469321 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:09:47.474457 [debug] [Thread-3  ]: local_md5(model.name): 6fbe07cd99985a105c0e61275b7ef592
[0m23:09:47.475787 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.477128 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.478217 [debug] [Thread-3  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.479967 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.481657 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.482378 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m23:09:47.483222 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m23:09:47.486802 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_26decfc4905d412a3c491fbed3489e77]
   as 
    
    



select list_price
from "AdventureWorks2014"."silver"."slvr_products"
where list_price is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_26decfc4905d412a3c491fbed3489e77]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_26decfc4905d412a3c491fbed3489e77]
  ;')
[0m23:09:47.489189 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:47.490442 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.491553 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.500732 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m23:09:47.501497 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.502673 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_88a7231bd383a6a376b009efd74c2a3b]
   as 
    
    



select product_id
from "AdventureWorks2014"."silver"."slvr_products"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_88a7231bd383a6a376b009efd74c2a3b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_88a7231bd383a6a376b009efd74c2a3b]
  ;')
[0m23:09:47.505712 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: ROLLBACK
[0m23:09:47.506727 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:47.508141 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: Close
[0m23:09:47.508951 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.509523 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.510659 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.512329 [info ] [Thread-1  ]: 8 of 18 PASS not_null_slvr_customers_customer_id ............................... [[32mPASS[0m in 0.14s]
[0m23:09:47.514982 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: ROLLBACK
[0m23:09:47.517014 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: ROLLBACK
[0m23:09:47.518013 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.519159 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m23:09:47.520312 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: Close
[0m23:09:47.521251 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: Close
[0m23:09:47.523400 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:09:47.524961 [info ] [Thread-4  ]: 7 of 18 PASS not_null_gld_sales_summary_order_date ............................. [[32mPASS[0m in 0.15s]
[0m23:09:47.527051 [info ] [Thread-2  ]: 9 of 18 PASS not_null_slvr_products_list_price ................................. [[32mPASS[0m in 0.12s]
[0m23:09:47.528532 [info ] [Thread-1  ]: 11 of 18 START test not_null_slvr_sales_orders_line_total ...................... [RUN]
[0m23:09:47.530233 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m23:09:47.531695 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m23:09:47.533142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d)
[0m23:09:47.534468 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:09:47.535714 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:09:47.537282 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:09:47.537791 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.538705 [info ] [Thread-4  ]: 12 of 18 START test not_null_slvr_sales_orders_order_detail_id ................. [RUN]
[0m23:09:47.540056 [info ] [Thread-2  ]: 13 of 18 START test not_null_slvr_sales_orders_sales_order_id .................. [RUN]
[0m23:09:47.547339 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m23:09:47.549921 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: ROLLBACK
[0m23:09:47.550857 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53)
[0m23:09:47.552098 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4)
[0m23:09:47.554033 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: Close
[0m23:09:47.554896 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:09:47.556040 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:09:47.557444 [info ] [Thread-3  ]: 10 of 18 PASS not_null_slvr_products_product_id ................................ [[32mPASS[0m in 0.12s]
[0m23:09:47.565194 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m23:09:47.571944 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m23:09:47.572507 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:09:47.574012 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m23:09:47.581475 [debug] [Thread-1  ]: local_md5(model.name): 9aed47cbdc8c4c391feec0e17f79c145
[0m23:09:47.583180 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:09:47.584796 [debug] [Thread-1  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.586099 [info ] [Thread-3  ]: 14 of 18 START test unique_gld_customer_metrics_customer_id .................... [RUN]
[0m23:09:47.588514 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m23:09:47.590734 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551, now test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd)
[0m23:09:47.591440 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:09:47.592803 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:09:47.594760 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:09:47.600401 [debug] [Thread-2  ]: local_md5(model.name): 8afc66a1e810936eb9dee9b36ebd66ab
[0m23:09:47.606489 [debug] [Thread-4  ]: local_md5(model.name): ea59c6424fdef3f68e31047da36d4522
[0m23:09:47.616692 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m23:09:47.619217 [debug] [Thread-2  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.620591 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m23:09:47.621052 [debug] [Thread-4  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.624369 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m23:09:47.625578 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_74626046680f622c154272e82d0857a4]
   as 
    
    



select line_total
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where line_total is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_74626046680f622c154272e82d0857a4]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_74626046680f622c154272e82d0857a4]
  ;')
[0m23:09:47.627678 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m23:09:47.629989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:47.633671 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.635016 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:09:47.636325 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.641980 [debug] [Thread-3  ]: local_md5(model.name): 09e4fbf108b34f10d79cdb74070d011e
[0m23:09:47.642673 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m23:09:47.643529 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m23:09:47.646571 [debug] [Thread-3  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.648345 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_f5c0e7f60c8cd5b1e4ee3b786678f81c]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_f5c0e7f60c8cd5b1e4ee3b786678f81c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_f5c0e7f60c8cd5b1e4ee3b786678f81c]
  ;')
[0m23:09:47.649826 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_d2acd184abdca36ecbfd37c1a2e766cb]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_d2acd184abdca36ecbfd37c1a2e766cb]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_d2acd184abdca36ecbfd37c1a2e766cb]
  ;')
[0m23:09:47.651729 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m23:09:47.653129 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:47.654506 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:09:47.656731 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.658302 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.661021 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.662537 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.672332 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m23:09:47.676850 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_0a3b7bdb1d97e77dec7329b51dbcdf4c]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_0a3b7bdb1d97e77dec7329b51dbcdf4c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_0a3b7bdb1d97e77dec7329b51dbcdf4c]
  ;')
[0m23:09:47.678693 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:47.680120 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.681675 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.684560 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.685312 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.688731 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: ROLLBACK
[0m23:09:47.691309 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: ROLLBACK
[0m23:09:47.692473 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: Close
[0m23:09:47.694320 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: Close
[0m23:09:47.696374 [info ] [Thread-4  ]: 12 of 18 PASS not_null_slvr_sales_orders_order_detail_id ....................... [[32mPASS[0m in 0.15s]
[0m23:09:47.698656 [info ] [Thread-2  ]: 13 of 18 PASS not_null_slvr_sales_orders_sales_order_id ........................ [[32mPASS[0m in 0.15s]
[0m23:09:47.700283 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m23:09:47.702441 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m23:09:47.704347 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:09:47.706212 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:09:47.707951 [info ] [Thread-4  ]: 15 of 18 START test unique_gld_product_performance_product_id .................. [RUN]
[0m23:09:47.710128 [info ] [Thread-2  ]: 16 of 18 START test unique_gld_sales_summary_order_date ........................ [RUN]
[0m23:09:47.712247 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53, now test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8)
[0m23:09:47.713942 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4, now test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b)
[0m23:09:47.715945 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:09:47.717745 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:09:47.725243 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m23:09:47.735159 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m23:09:47.739008 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.742847 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: ROLLBACK
[0m23:09:47.744766 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: Close
[0m23:09:47.747545 [info ] [Thread-3  ]: 14 of 18 PASS unique_gld_customer_metrics_customer_id .......................... [[32mPASS[0m in 0.16s]
[0m23:09:47.749180 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:09:47.751158 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m23:09:47.752814 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:09:47.757318 [debug] [Thread-4  ]: local_md5(model.name): 282efc8b63abc4326c2e3fe9cf80b2ea
[0m23:09:47.759855 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:09:47.766382 [debug] [Thread-2  ]: local_md5(model.name): 9242e0fb865d08f661cf2dc3e20a299e
[0m23:09:47.767917 [debug] [Thread-4  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.769628 [info ] [Thread-3  ]: 17 of 18 START test unique_slvr_customers_customer_id .......................... [RUN]
[0m23:09:47.771495 [debug] [Thread-2  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.773618 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m23:09:47.775597 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd, now test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600)
[0m23:09:47.777944 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m23:09:47.780770 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:09:47.790491 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m23:09:47.796438 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m23:09:47.798631 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m23:09:47.799665 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_57ff88518f6883f14afc188128443015]
   as 
    
    

select
    order_date as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is not null
group by order_date
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_57ff88518f6883f14afc188128443015]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_57ff88518f6883f14afc188128443015]
  ;')
[0m23:09:47.801065 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6382931f9a510a166ccb4347f2149325]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6382931f9a510a166ccb4347f2149325]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6382931f9a510a166ccb4347f2149325]
  ;')
[0m23:09:47.802774 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:09:47.804749 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:09:47.805781 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:09:47.806785 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.808345 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.813359 [debug] [Thread-3  ]: local_md5(model.name): 4e2331c32d747d8df52121a664e91469
[0m23:09:47.815275 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.815884 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.817060 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.817959 [debug] [Thread-3  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.822633 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: ROLLBACK
[0m23:09:47.825379 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m23:09:47.827417 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: Close
[0m23:09:47.830390 [info ] [Thread-1  ]: 11 of 18 PASS not_null_slvr_sales_orders_line_total ............................ [[32mPASS[0m in 0.30s]
[0m23:09:47.832878 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m23:09:47.834981 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:09:47.836932 [info ] [Thread-1  ]: 18 of 18 START test unique_slvr_products_product_id ............................ [RUN]
[0m23:09:47.838024 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.839495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d, now test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f)
[0m23:09:47.843892 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: ROLLBACK
[0m23:09:47.844563 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m23:09:47.845553 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:09:47.847079 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: Close
[0m23:09:47.848548 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_39f9a0f32d0f6a1bd782bad6f99cccd7]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_39f9a0f32d0f6a1bd782bad6f99cccd7]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_39f9a0f32d0f6a1bd782bad6f99cccd7]
  ;')
[0m23:09:47.849701 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.856178 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m23:09:47.857767 [info ] [Thread-2  ]: 16 of 18 PASS unique_gld_sales_summary_order_date .............................. [[32mPASS[0m in 0.14s]
[0m23:09:47.859014 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:09:47.862315 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: ROLLBACK
[0m23:09:47.864636 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m23:09:47.866019 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.867538 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: Close
[0m23:09:47.870291 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.871816 [info ] [Thread-4  ]: 15 of 18 PASS unique_gld_product_performance_product_id ........................ [[32mPASS[0m in 0.16s]
[0m23:09:47.874829 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m23:09:47.877993 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:09:47.884332 [debug] [Thread-1  ]: local_md5(model.name): 460bcc0c9f9b8191fcda43c5bbb8239e
[0m23:09:47.885977 [debug] [Thread-1  ]: local_md5(invocation_id): 583794c847397f5bbaa9b928bb884f48
[0m23:09:47.887832 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m23:09:47.901960 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m23:09:47.902598 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.903712 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a2c1d5717001360a97c0a76ad8330082]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_products"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a2c1d5717001360a97c0a76ad8330082]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a2c1d5717001360a97c0a76ad8330082]
  ;')
[0m23:09:47.906741 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: ROLLBACK
[0m23:09:47.907510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:47.908824 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: Close
[0m23:09:47.909975 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m23:09:47.911739 [info ] [Thread-3  ]: 17 of 18 PASS unique_slvr_customers_customer_id ................................ [[32mPASS[0m in 0.14s]
[0m23:09:47.913566 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m23:09:47.915098 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m23:09:47.933044 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m23:09:47.936975 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: ROLLBACK
[0m23:09:47.938472 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: Close
[0m23:09:47.939857 [info ] [Thread-1  ]: 18 of 18 PASS unique_slvr_products_product_id .................................. [[32mPASS[0m in 0.10s]
[0m23:09:47.941471 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m23:09:47.945352 [debug] [MainThread]: On master: COMMIT
[0m23:09:47.946999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:47.948495 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b' was properly closed.
[0m23:09:47.949864 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f' was properly closed.
[0m23:09:47.951443 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600' was properly closed.
[0m23:09:47.952894 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8' was properly closed.
[0m23:09:47.954133 [info ] [MainThread]: 
[0m23:09:47.955642 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m23:09:47.960890 [debug] [MainThread]: Command end result
[0m23:09:48.129922 [info ] [MainThread]: 
[0m23:09:48.132373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:48.134186 [info ] [MainThread]: 
[0m23:09:48.135590 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m23:09:48.137501 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1771605, "process_user_time": 2.346347, "process_kernel_time": 0.336911, "process_mem_max_rss": "125760", "process_in_blocks": "1032", "process_out_blocks": "0"}
[0m23:09:48.138672 [debug] [MainThread]: Command `dbt test` succeeded at 23:09:48.138535 after 3.18 seconds
[0m23:09:48.139782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f5af30610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f5afa1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f58dd9d30>]}
[0m23:09:48.141015 [debug] [MainThread]: Flushing usage events
[0m06:34:43.705091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703c0173d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bff5c65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bff5c6550>]}


============================== 06:34:43.715077 | f2c9ab11-c663-4c7b-b898-ba15111c2b50 ==============================
[0m06:34:43.715077 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:34:43.717521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:34:44.594695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfe383a60>]}
[0m06:34:44.668737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703c01915e80>]}
[0m06:34:44.670859 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:34:44.877427 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:34:46.439448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:46.440810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:46.499143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfdcdd130>]}
[0m06:34:46.712226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfe1ef8b0>]}
[0m06:34:46.713358 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:34:46.714524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfdd04430>]}
[0m06:34:46.717463 [info ] [MainThread]: 
[0m06:34:46.719061 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:34:46.726060 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:34:46.726989 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:34:46.727588 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:34:46.747191 [debug] [ThreadPool]: dbt-sqlserver
[0m06:34:46.750734 [debug] [ThreadPool]: dbt-sqlserver
[0m06:34:46.756284 [debug] [ThreadPool]: dbt-sqlserver
[0m06:34:46.757881 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:34:46.759415 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:34:46.760665 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:34:46.761652 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:34:46.762794 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:34:46.763791 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:34:46.764743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:46.765557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:46.766367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:46.767184 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:46.768027 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:46.768879 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.054390 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.054844 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.055268 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.065889 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:34:47.066412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:34:47.066874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:34:47.068801 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:34:47.070552 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:34:47.071894 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:34:47.075288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_silver)
[0m06:34:47.075947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_gold)
[0m06:34:47.076548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m06:34:47.084334 [debug] [ThreadPool]: dbt-sqlserver
[0m06:34:47.089013 [debug] [ThreadPool]: dbt-sqlserver
[0m06:34:47.092813 [debug] [ThreadPool]: dbt-sqlserver
[0m06:34:47.094411 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:34:47.095646 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:34:47.097168 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:34:47.098537 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:34:47.099677 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:34:47.100837 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:34:47.101825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:47.102729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:47.103561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:47.104459 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.105279 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.106107 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.107037 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.107884 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.108661 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.226727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:34:47.228490 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:34:47.228970 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:34:47.230736 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:34:47.233176 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:34:47.235775 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:34:47.237053 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:34:47.238474 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:34:47.239651 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:34:47.244443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfe3874f0>]}
[0m06:34:47.246196 [debug] [MainThread]: On master: COMMIT
[0m06:34:47.247779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:47.249005 [info ] [MainThread]: 
[0m06:34:47.254900 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m06:34:47.255393 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m06:34:47.255854 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m06:34:47.256311 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:34:47.257188 [info ] [Thread-1  ]: 1 of 10 START sql view model bronze.brnz_customers ............................. [RUN]
[0m06:34:47.258372 [info ] [Thread-2  ]: 2 of 10 START sql view model bronze.brnz_example ............................... [RUN]
[0m06:34:47.259731 [info ] [Thread-3  ]: 3 of 10 START sql view model bronze.brnz_products .............................. [RUN]
[0m06:34:47.261055 [info ] [Thread-4  ]: 4 of 10 START sql view model bronze.brnz_sales_orders .......................... [RUN]
[0m06:34:47.262365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now model.dbt_sqlserver_project.brnz_customers)
[0m06:34:47.263551 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now model.dbt_sqlserver_project.brnz_example)
[0m06:34:47.264901 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_products)
[0m06:34:47.266375 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m06:34:47.267420 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m06:34:47.268635 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m06:34:47.269736 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m06:34:47.270959 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:34:47.280671 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:34:47.286029 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m06:34:47.294327 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m06:34:47.305293 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:34:47.325911 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m06:34:47.326930 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:34:47.334747 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m06:34:47.361172 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m06:34:47.386800 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:34:47.387711 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:34:47.394777 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m06:34:47.400350 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m06:34:47.412959 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:34:47.414148 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:34:47.415741 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:34:47.416588 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m06:34:47.418584 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:34:47.419357 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:34:47.420878 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m06:34:47.421948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:47.423249 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m06:34:47.424704 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:34:47.425788 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:34:47.427415 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.428884 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:34:47.430849 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.432256 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.433501 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.434148 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:47.435183 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.435931 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.460173 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:47.467682 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.468266 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.468733 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.478402 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:34:47.484214 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:34:47.484746 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.489948 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:34:47.491124 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m06:34:47.492633 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m06:34:47.500743 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:34:47.501511 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m06:34:47.504993 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m06:34:47.742868 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.743574 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.744021 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.744392 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.749865 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:34:47.756043 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:34:47.762521 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:34:47.767694 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:34:47.769277 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m06:34:47.770666 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m06:34:47.771568 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m06:34:47.772984 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m06:34:47.787939 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.788863 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.789666 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.789986 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.817530 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m06:34:47.819004 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m06:34:47.822151 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m06:34:47.824436 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m06:34:47.833731 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m06:34:47.839349 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m06:34:47.844311 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m06:34:47.849946 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m06:34:47.859732 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:34:47.861759 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:34:47.864567 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:34:47.866228 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:34:47.867611 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:34:47.868880 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:34:47.870256 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:34:47.871605 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:34:47.872820 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:47.873815 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:47.874994 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:47.876025 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:47.922767 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.923636 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.927723 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:34:47.928416 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.931636 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:34:47.932592 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m06:34:47.933194 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.936430 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:34:47.937765 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m06:34:47.941729 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:34:47.942849 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m06:34:47.945632 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m06:34:47.958563 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.959404 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.960044 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.960530 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:47.964767 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m06:34:47.966930 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m06:34:47.969610 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m06:34:47.972073 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m06:34:47.973627 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m06:34:47.974648 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m06:34:47.976107 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m06:34:47.977389 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m06:34:47.980099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfde71e50>]}
[0m06:34:47.981694 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfde3a3a0>]}
[0m06:34:47.983599 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfde71190>]}
[0m06:34:47.985058 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfe3874f0>]}
[0m06:34:47.987364 [info ] [Thread-1  ]: 1 of 10 OK created sql view model bronze.brnz_customers ........................ [[32mOK[0m in 0.72s]
[0m06:34:47.988829 [info ] [Thread-4  ]: 4 of 10 OK created sql view model bronze.brnz_sales_orders ..................... [[32mOK[0m in 0.72s]
[0m06:34:47.990869 [info ] [Thread-2  ]: 2 of 10 OK created sql view model bronze.brnz_example .......................... [[32mOK[0m in 0.72s]
[0m06:34:47.992465 [info ] [Thread-3  ]: 3 of 10 OK created sql view model bronze.brnz_products ......................... [[32mOK[0m in 0.72s]
[0m06:34:47.994217 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m06:34:47.995781 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:34:47.997357 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m06:34:47.998855 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m06:34:48.001068 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.slvr_customers
[0m06:34:48.002407 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:34:48.004770 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.slvr_products
[0m06:34:48.006275 [info ] [Thread-1  ]: 5 of 10 START sql table model silver.slvr_customers ............................ [RUN]
[0m06:34:48.008339 [info ] [Thread-4  ]: 6 of 10 START sql table model silver.slvr_sales_orders ......................... [RUN]
[0m06:34:48.010239 [info ] [Thread-2  ]: 7 of 10 START sql table model silver.slvr_products ............................. [RUN]
[0m06:34:48.011924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_customers, now model.dbt_sqlserver_project.slvr_customers)
[0m06:34:48.013456 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_sales_orders, now model.dbt_sqlserver_project.slvr_sales_orders)
[0m06:34:48.014888 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_example, now model.dbt_sqlserver_project.slvr_products)
[0m06:34:48.016341 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.slvr_customers
[0m06:34:48.017953 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:34:48.019460 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.slvr_products
[0m06:34:48.025421 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:48.031897 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:48.039619 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.049179 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.slvr_customers
[0m06:34:48.050630 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:34:48.057741 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.slvr_products
[0m06:34:48.093794 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:34:48.098213 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:34:48.103485 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:34:48.108601 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw"
[0m06:34:48.114318 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw"
[0m06:34:48.121078 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw"
[0m06:34:48.123694 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:34:48.126169 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:34:48.128821 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:34:48.130209 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:48.131452 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:48.132536 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.133675 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_customers__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:48.134712 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_sales_orders__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:48.135734 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:48.136621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:48.137469 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:34:48.138254 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:34:48.139166 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:48.140205 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:48.141255 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:48.164836 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:48.165454 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:48.165978 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:48.182577 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.185751 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.187269 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_products__dbt_tmp__dbt_tmp_vw";');

[0m06:34:48.191318 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.198777 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.199340 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.199897 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.203091 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:48.205157 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:48.205928 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw";');

[0m06:34:48.207154 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw";');

[0m06:34:48.210914 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.211984 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.212521 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_products__dbt_tmp__dbt_tmp_vw" as 

with bronze_products as (
    select * from "AdventureWorks2014"."bronze"."brnz_products"
),

cleaned as (
    select
        ProductID as product_id,
        ProductName as product_name,
        ProductNumber as product_number,
        coalesce(Color, ''N/A'') as color,
        StandardCost as standard_cost,
        ListPrice as list_price,
        coalesce(Size, ''N/A'') as size,
        coalesce(Weight, 0) as weight,
        ProductLine as product_line,
        Class as class,
        Style as style,
        ProductSubcategoryID as subcategory_id,
        coalesce(SubcategoryName, ''Uncategorized'') as subcategory_name,
        ProductCategoryID as category_id,
        SellStartDate as sell_start_date,
        SellEndDate as sell_end_date,
        case 
            when DiscontinuedDate is not null then 1
            else 0
        end as is_discontinued,
        last_modified_date
    from bronze_products
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_products__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_products__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_products__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_products__dbt_tmp')
    )
    DROP index "silver"."slvr_products__dbt_tmp".silver_slvr_products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_products__dbt_tmp_cci
    ON "silver"."slvr_products__dbt_tmp"

   


  
[0m06:34:48.213053 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.216253 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:48.221292 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:48.229774 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:48.232277 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" as 

with bronze_customers as (
    select * from "AdventureWorks2014"."bronze"."brnz_customers"
),

cleaned as (
    select
        CustomerID as customer_id,
        coalesce(FirstName, ''Unknown'') as first_name,
        coalesce(LastName, ''Unknown'') as last_name,
        concat(coalesce(FirstName, ''Unknown''), '' '', coalesce(LastName, ''Unknown'')) as full_name,
        EmailPromotion as email_promotion,
        StoreID as store_id,
        TerritoryID as territory_id,
        last_modified_date
    from bronze_customers
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_customers__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_customers__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_customers__dbt_tmp')
    )
    DROP index "silver"."slvr_customers__dbt_tmp".silver_slvr_customers__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_customers__dbt_tmp_cci
    ON "silver"."slvr_customers__dbt_tmp"

   


  
[0m06:34:48.233373 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:48.235336 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" as 

with bronze_sales as (
    select * from "AdventureWorks2014"."bronze"."brnz_sales_orders"
),

cleaned as (
    select
        sales_order_id,
        order_detail_id,
        order_date,
        due_date,
        ship_date,
        status,
        case 
            when online_order_flag = 1 then ''Online''
            else ''Offline''
        end as order_channel,
        sales_order_number,
        purchase_order_number,
        customer_id,
        sales_person_id,
        territory_id,
        product_id,
        order_qty,
        unit_price,
        unit_price_discount,
        line_total,
        -- Calculated fields
        unit_price * order_qty as gross_amount,
        line_total / nullif(order_qty, 0) as effective_unit_price,
        case 
            when unit_price_discount > 0 then 1
            else 0
        end as has_discount
    from bronze_sales
    where order_qty > 0
        and unit_price >= 0
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_sales_orders__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_sales_orders__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_sales_orders__dbt_tmp')
    )
    DROP index "silver"."slvr_sales_orders__dbt_tmp".silver_slvr_sales_orders__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_sales_orders__dbt_tmp_cci
    ON "silver"."slvr_sales_orders__dbt_tmp"

   


  
[0m06:34:48.504420 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.513730 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.516113 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products', 'slvr_products__dbt_backup'
[0m06:34:48.528092 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.538090 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.539537 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products__dbt_tmp', 'slvr_products'
[0m06:34:48.549585 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.559174 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: COMMIT
[0m06:34:48.566868 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_backup"
[0m06:34:48.568752 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:34:48.569801 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_products__dbt_backup";');

[0m06:34:48.581518 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:48.584325 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_products: Close
[0m06:34:48.585522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfc023ee0>]}
[0m06:34:48.586710 [info ] [Thread-2  ]: 7 of 10 OK created sql table model silver.slvr_products ........................ [[32mOK[0m in 0.57s]
[0m06:34:48.588211 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.slvr_products
[0m06:34:49.843455 [debug] [Thread-1  ]: SQL status: OK in 2.000 seconds
[0m06:34:49.852360 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:49.859420 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers', 'slvr_customers__dbt_backup'
[0m06:34:49.871163 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:49.878754 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:49.880309 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers__dbt_tmp', 'slvr_customers'
[0m06:34:49.890490 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:49.893401 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: COMMIT
[0m06:34:49.898171 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_backup"
[0m06:34:49.900010 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:34:49.901287 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_customers__dbt_backup";');

[0m06:34:49.913446 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:49.916116 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: Close
[0m06:34:49.917342 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfdcff400>]}
[0m06:34:49.919226 [info ] [Thread-1  ]: 5 of 10 OK created sql table model silver.slvr_customers ....................... [[32mOK[0m in 1.91s]
[0m06:34:49.922971 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.slvr_customers
[0m06:34:50.996518 [debug] [Thread-4  ]: SQL status: OK in 3.000 seconds
[0m06:34:51.004706 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:51.006682 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders', 'slvr_sales_orders__dbt_backup'
[0m06:34:51.022946 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.029197 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:51.030765 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders__dbt_tmp', 'slvr_sales_orders'
[0m06:34:51.043140 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.046183 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: COMMIT
[0m06:34:51.052304 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_backup"
[0m06:34:51.054277 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:34:51.055504 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_sales_orders__dbt_backup";');

[0m06:34:51.065569 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.131031 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: Close
[0m06:34:51.133425 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703befff87c0>]}
[0m06:34:51.135245 [info ] [Thread-4  ]: 6 of 10 OK created sql table model silver.slvr_sales_orders .................... [[32mOK[0m in 3.12s]
[0m06:34:51.136983 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:34:51.139007 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:34:51.139597 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.gld_product_performance
[0m06:34:51.140020 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:34:51.141130 [info ] [Thread-3  ]: 8 of 10 START sql table model gold.gld_customer_metrics ........................ [RUN]
[0m06:34:51.142504 [info ] [Thread-2  ]: 9 of 10 START sql table model gold.gld_product_performance ..................... [RUN]
[0m06:34:51.144223 [info ] [Thread-1  ]: 10 of 10 START sql table model gold.gld_sales_summary .......................... [RUN]
[0m06:34:51.145677 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_products, now model.dbt_sqlserver_project.gld_customer_metrics)
[0m06:34:51.146814 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_products, now model.dbt_sqlserver_project.gld_product_performance)
[0m06:34:51.148155 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_customers, now model.dbt_sqlserver_project.gld_sales_summary)
[0m06:34:51.149221 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:34:51.150498 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.gld_product_performance
[0m06:34:51.151633 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.gld_sales_summary
[0m06:34:51.157233 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:51.163294 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:51.168486 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:51.179340 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:34:51.181630 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.gld_sales_summary
[0m06:34:51.188400 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.gld_product_performance
[0m06:34:51.190004 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:34:51.195917 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:34:51.201356 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:34:51.206419 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw"
[0m06:34:51.210835 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw"
[0m06:34:51.215360 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw"
[0m06:34:51.217369 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:34:51.219403 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:34:51.221398 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:34:51.223175 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:51.224498 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:51.225897 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:51.227526 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_customer_metrics__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:51.228997 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_sales_summary__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:51.230576 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_product_performance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:34:51.231975 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:34:51.233558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:51.235689 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:34:51.237232 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:51.238512 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:51.239725 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:34:51.240890 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:51.258774 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.261506 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:51.262021 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:34:51.263000 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:51.265832 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw";');

[0m06:34:51.269303 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.272479 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:51.283993 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:51.285696 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" as 

with customers as (
    select * from "AdventureWorks2014"."silver"."slvr_customers"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

customer_sales as (
    select
        c.customer_id,
        c.full_name,
        c.territory_id,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.line_total) as total_revenue,
        avg(s.line_total) as avg_order_value,
        sum(s.order_qty) as total_items_purchased,
        min(s.order_date) as first_order_date,
        max(s.order_date) as last_order_date,
        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount
    from customers c
    left join sales s
        on c.customer_id = s.customer_id
    group by c.customer_id, c.full_name, c.territory_id
)

select * from customer_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_customer_metrics__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_customer_metrics__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_customer_metrics__dbt_tmp')
    )
    DROP index "gold"."gld_customer_metrics__dbt_tmp".gold_gld_customer_metrics__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_customer_metrics__dbt_tmp_cci
    ON "gold"."gld_customer_metrics__dbt_tmp"

   


  
[0m06:34:51.291601 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.295546 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:51.297067 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw";');

[0m06:34:51.301261 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.301847 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.304965 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:51.307308 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:51.309081 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw";');

[0m06:34:51.313206 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.316958 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:51.319070 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:51.320379 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" as 

with sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

daily_summary as (
    select
        cast(order_date as date) as order_date,
        count(distinct sales_order_id) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(order_qty) as total_items_sold,
        sum(line_total) as total_revenue,
        avg(line_total) as avg_order_line_value,
        sum(case when order_channel = ''Online'' then 1 else 0 end) as online_orders,
        sum(case when order_channel = ''Offline'' then 1 else 0 end) as offline_orders,
        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue
    from sales
    group by cast(order_date as date)
)

select * from daily_summary;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_sales_summary__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_sales_summary__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_sales_summary__dbt_tmp')
    )
    DROP index "gold"."gld_sales_summary__dbt_tmp".gold_gld_sales_summary__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_sales_summary__dbt_tmp_cci
    ON "gold"."gld_sales_summary__dbt_tmp"

   


  
[0m06:34:51.327577 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:51.329084 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" as 

with products as (
    select * from "AdventureWorks2014"."silver"."slvr_products"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

product_sales as (
    select
        p.product_id,
        p.product_name,
        p.subcategory_name,
        p.color,
        p.list_price,
        p.standard_cost,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.order_qty) as total_quantity_sold,
        sum(s.line_total) as total_revenue,
        avg(s.unit_price) as avg_selling_price,
        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,
        case 
            when sum(s.order_qty) > 0 then 
                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100
            else 0
        end as profit_margin_pct
    from products p
    left join sales s
        on p.product_id = s.product_id
    group by 
        p.product_id, 
        p.product_name, 
        p.subcategory_name, 
        p.color, 
        p.list_price, 
        p.standard_cost
)

select * from product_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_product_performance__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_product_performance__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_product_performance__dbt_tmp')
    )
    DROP index "gold"."gld_product_performance__dbt_tmp".gold_gld_product_performance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_product_performance__dbt_tmp_cci
    ON "gold"."gld_product_performance__dbt_tmp"

   


  
[0m06:34:51.940104 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m06:34:51.952767 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:51.956701 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary', 'gld_sales_summary__dbt_backup'
[0m06:34:51.981914 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:51.997362 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:52.003385 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary__dbt_tmp', 'gld_sales_summary'
[0m06:34:52.034771 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.038126 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: COMMIT
[0m06:34:52.045491 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_backup"
[0m06:34:52.047779 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:34:52.049373 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_sales_summary__dbt_backup";');

[0m06:34:52.063890 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.067422 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: Close
[0m06:34:52.070599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703beff51040>]}
[0m06:34:52.073035 [info ] [Thread-1  ]: 10 of 10 OK created sql table model gold.gld_sales_summary ..................... [[32mOK[0m in 0.92s]
[0m06:34:52.075168 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:34:52.230740 [debug] [Thread-3  ]: SQL status: OK in 1.000 seconds
[0m06:34:52.239727 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:52.241421 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics', 'gld_customer_metrics__dbt_backup'
[0m06:34:52.254405 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.261190 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:52.262861 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics__dbt_tmp', 'gld_customer_metrics'
[0m06:34:52.273145 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.276282 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: COMMIT
[0m06:34:52.285404 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_backup"
[0m06:34:52.287425 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:34:52.288870 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_customer_metrics__dbt_backup";');

[0m06:34:52.299831 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.302983 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_customer_metrics: Close
[0m06:34:52.304686 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bfc208ca0>]}
[0m06:34:52.306382 [info ] [Thread-3  ]: 8 of 10 OK created sql table model gold.gld_customer_metrics ................... [[32mOK[0m in 1.16s]
[0m06:34:52.308175 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:34:52.486570 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m06:34:52.493404 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:52.495451 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance', 'gld_product_performance__dbt_backup'
[0m06:34:52.508200 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.516505 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:52.518243 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance__dbt_tmp', 'gld_product_performance'
[0m06:34:52.529086 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.534198 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: COMMIT
[0m06:34:52.569648 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_backup"
[0m06:34:52.590449 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:34:52.596568 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_product_performance__dbt_backup";');

[0m06:34:52.610230 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:34:52.615579 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_product_performance: Close
[0m06:34:52.618518 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c9ab11-c663-4c7b-b898-ba15111c2b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703beff51e80>]}
[0m06:34:52.624743 [info ] [Thread-2  ]: 9 of 10 OK created sql table model gold.gld_product_performance ................ [[32mOK[0m in 1.47s]
[0m06:34:52.627715 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.gld_product_performance
[0m06:34:52.632297 [debug] [MainThread]: On master: COMMIT
[0m06:34:52.634317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:52.635947 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_sales_summary' was properly closed.
[0m06:34:52.637899 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_product_performance' was properly closed.
[0m06:34:52.639529 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_customer_metrics' was properly closed.
[0m06:34:52.641245 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.slvr_sales_orders' was properly closed.
[0m06:34:52.644063 [info ] [MainThread]: 
[0m06:34:52.646716 [info ] [MainThread]: Finished running 4 view models, 6 table models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m06:34:52.652534 [debug] [MainThread]: Command end result
[0m06:34:52.753495 [info ] [MainThread]: 
[0m06:34:52.755200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:52.756680 [info ] [MainThread]: 
[0m06:34:52.758057 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m06:34:52.761190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.188062, "process_user_time": 3.540881, "process_kernel_time": 1.448726, "process_mem_max_rss": "126928", "process_in_blocks": "96336", "process_out_blocks": "0"}
[0m06:34:52.762926 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:52.762724 after 9.19 seconds
[0m06:34:52.764653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703c0173d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703c01915e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703bffc713d0>]}
[0m06:34:52.766404 [debug] [MainThread]: Flushing usage events
[0m06:35:00.847939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e537c586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e535ae2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e535ae2520>]}


============================== 06:35:00.856223 | 792ff20c-c33e-4663-a2be-7fe5f98fce44 ==============================
[0m06:35:00.856223 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:35:00.858480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:35:01.548734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '792ff20c-c33e-4663-a2be-7fe5f98fce44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e535a8be80>]}
[0m06:35:01.612720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '792ff20c-c33e-4663-a2be-7fe5f98fce44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e537e30cd0>]}
[0m06:35:01.614895 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:35:01.773372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:35:03.564390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:35:03.566210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:35:03.635050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '792ff20c-c33e-4663-a2be-7fe5f98fce44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5341f8130>]}
[0m06:35:03.896401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '792ff20c-c33e-4663-a2be-7fe5f98fce44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5343d7fd0>]}
[0m06:35:03.898611 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:35:03.900277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792ff20c-c33e-4663-a2be-7fe5f98fce44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e534209af0>]}
[0m06:35:03.904428 [info ] [MainThread]: 
[0m06:35:03.906493 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:35:03.916191 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_silver'
[0m06:35:03.917545 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_gold'
[0m06:35:03.919337 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m06:35:03.938939 [debug] [ThreadPool]: dbt-sqlserver
[0m06:35:03.942395 [debug] [ThreadPool]: dbt-sqlserver
[0m06:35:03.949668 [debug] [ThreadPool]: dbt-sqlserver
[0m06:35:03.951536 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:35:03.953493 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:35:03.955821 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:35:03.958477 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:35:03.960692 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:35:03.963412 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:35:03.966035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:03.968743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:03.971100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:03.973433 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:03.975695 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:03.977749 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.024672 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.025319 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.026001 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.034497 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:35:04.035145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:35:04.035597 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:35:04.039144 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:35:04.041669 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:35:04.044767 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:35:04.046549 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:35:04.048693 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:35:04.050421 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:35:04.058209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792ff20c-c33e-4663-a2be-7fe5f98fce44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5343d7520>]}
[0m06:35:04.059692 [debug] [MainThread]: On master: COMMIT
[0m06:35:04.061020 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:35:04.062411 [info ] [MainThread]: 
[0m06:35:04.066514 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:35:04.067010 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:35:04.067458 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:35:04.067902 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:35:04.068637 [info ] [Thread-1  ]: 1 of 18 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:35:04.070003 [info ] [Thread-2  ]: 2 of 18 START test dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:35:04.071517 [info ] [Thread-3  ]: 3 of 18 START test not_null_brnz_sales_orders_order_detail_id .................. [RUN]
[0m06:35:04.073007 [info ] [Thread-4  ]: 4 of 18 START test not_null_brnz_sales_orders_sales_order_id ................... [RUN]
[0m06:35:04.074458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m06:35:04.075820 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc)
[0m06:35:04.077336 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac)
[0m06:35:04.078981 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m06:35:04.080235 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:35:04.081365 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:35:04.082731 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:35:04.084088 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:35:04.117361 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:35:04.120931 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:35:04.134611 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:35:04.142015 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:35:04.157034 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:35:04.220180 [debug] [Thread-3  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m06:35:04.221019 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:35:04.221916 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:35:04.222544 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:35:04.223360 [debug] [Thread-3  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.228053 [debug] [Thread-4  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m06:35:04.233733 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m06:35:04.238530 [debug] [Thread-2  ]: local_md5(model.name): fa6b3d9cc18a40cfba3de7295a3a38e6
[0m06:35:04.249995 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:35:04.251255 [debug] [Thread-4  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.252801 [debug] [Thread-1  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.253939 [debug] [Thread-2  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.257110 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:35:04.259075 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:35:04.261235 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:35:04.279236 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:35:04.280502 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:35:04.281328 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:35:04.283589 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_0d65cbb462573dc6dbb1beba3b262ab0]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."silver"."slvr_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_0d65cbb462573dc6dbb1beba3b262ab0]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_0d65cbb462573dc6dbb1beba3b262ab0]
  ;')
[0m06:35:04.285726 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_933d995ffd20a803583edc18a2076676]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_933d995ffd20a803583edc18a2076676]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_933d995ffd20a803583edc18a2076676]
  ;')
[0m06:35:04.286586 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:35:04.287906 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_4dec4c20624cbc3b98197127e282e8a0]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_4dec4c20624cbc3b98197127e282e8a0]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_4dec4c20624cbc3b98197127e282e8a0]
  ;')
[0m06:35:04.289216 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:35:04.290289 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:35:04.291220 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_f74a8b76a3776a34f19f99d64464b7a8]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_f74a8b76a3776a34f19f99d64464b7a8]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_f74a8b76a3776a34f19f99d64464b7a8]
  ;')
[0m06:35:04.292258 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:35:04.293188 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.294707 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.295640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:35:04.296670 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.297809 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.298619 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.299380 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.300409 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.330501 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.331899 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.343029 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m06:35:04.345372 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m06:35:04.347671 [info ] [Thread-4  ]: 4 of 18 PASS not_null_brnz_sales_orders_sales_order_id ......................... [[32mPASS[0m in 0.27s]
[0m06:35:04.349732 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:35:04.351345 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:35:04.352547 [info ] [Thread-4  ]: 5 of 18 START test not_null_gld_customer_metrics_customer_id ................... [RUN]
[0m06:35:04.354028 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca, now test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39)
[0m06:35:04.355334 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:35:04.362568 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:35:04.373248 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:35:04.377690 [debug] [Thread-4  ]: local_md5(model.name): ac0d77cdfe99d22d2680c19319e8499c
[0m06:35:04.378841 [debug] [Thread-4  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.380386 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:35:04.392035 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:35:04.393424 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_47f44c5b821444a92bca7957f3f7cb71]
   as 
    
    



select customer_id
from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_47f44c5b821444a92bca7957f3f7cb71]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_47f44c5b821444a92bca7957f3f7cb71]
  ;')
[0m06:35:04.394554 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:35:04.395627 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.396697 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.412133 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.415262 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: ROLLBACK
[0m06:35:04.416435 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: Close
[0m06:35:04.417661 [info ] [Thread-4  ]: 5 of 18 PASS not_null_gld_customer_metrics_customer_id ......................... [[32mPASS[0m in 0.06s]
[0m06:35:04.419050 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:35:04.420101 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:35:04.421489 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.426680 [info ] [Thread-4  ]: 6 of 18 START test not_null_gld_product_performance_product_id ................. [RUN]
[0m06:35:04.433016 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m06:35:04.433798 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39, now test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397)
[0m06:35:04.434972 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m06:35:04.436038 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:35:04.437362 [info ] [Thread-3  ]: 3 of 18 PASS not_null_brnz_sales_orders_order_detail_id ........................ [[32mPASS[0m in 0.36s]
[0m06:35:04.445634 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:35:04.446155 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.447390 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:35:04.450993 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: ROLLBACK
[0m06:35:04.451720 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:35:04.452886 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: Close
[0m06:35:04.453945 [info ] [Thread-3  ]: 7 of 18 START test not_null_gld_sales_summary_order_date ....................... [RUN]
[0m06:35:04.455633 [info ] [Thread-2  ]: 2 of 18 PASS dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.38s]
[0m06:35:04.457499 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac, now test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e)
[0m06:35:04.459855 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:35:04.460773 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:35:04.461519 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:35:04.462678 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:35:04.466608 [debug] [Thread-4  ]: local_md5(model.name): a5b86011b8d22b04b2506841bc10c840
[0m06:35:04.473990 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:35:04.475044 [info ] [Thread-2  ]: 8 of 18 START test not_null_slvr_customers_customer_id ......................... [RUN]
[0m06:35:04.476434 [debug] [Thread-4  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.478596 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc, now test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275)
[0m06:35:04.480283 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:35:04.481519 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:35:04.491670 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:35:04.493799 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:35:04.498530 [debug] [Thread-3  ]: local_md5(model.name): 31cffa58c58a08e4f0ecffd253b46aa2
[0m06:35:04.499135 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.500650 [debug] [Thread-3  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.501835 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:35:04.503942 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m06:35:04.505241 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:35:04.506390 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_04da92f2b80acad80d7cd58546785450]
   as 
    
    



select product_id
from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_04da92f2b80acad80d7cd58546785450]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_04da92f2b80acad80d7cd58546785450]
  ;')
[0m06:35:04.507456 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m06:35:04.508972 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:35:04.510213 [info ] [Thread-1  ]: 1 of 18 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.44s]
[0m06:35:04.511539 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.515342 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:35:04.516975 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.518652 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:35:04.519539 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:35:04.521903 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:35:04.522404 [info ] [Thread-1  ]: 9 of 18 START test not_null_slvr_products_list_price ........................... [RUN]
[0m06:35:04.526233 [debug] [Thread-2  ]: local_md5(model.name): 8e9f64ea0dd2dc40d032bf48fa566213
[0m06:35:04.527552 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_67bd2e69a8fd1a2684940657476e57ec]
   as 
    
    



select order_date
from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_67bd2e69a8fd1a2684940657476e57ec]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_67bd2e69a8fd1a2684940657476e57ec]
  ;')
[0m06:35:04.528768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902, now test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076)
[0m06:35:04.529960 [debug] [Thread-2  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.531157 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:35:04.532274 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:35:04.533752 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:35:04.534853 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.535440 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.540618 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:35:04.542632 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.544934 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: ROLLBACK
[0m06:35:04.547322 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: Close
[0m06:35:04.548860 [info ] [Thread-4  ]: 6 of 18 PASS not_null_gld_product_performance_product_id ....................... [[32mPASS[0m in 0.11s]
[0m06:35:04.551125 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:35:04.552949 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:35:04.553634 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:35:04.554470 [info ] [Thread-4  ]: 10 of 18 START test not_null_slvr_products_product_id .......................... [RUN]
[0m06:35:04.559108 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_e74e05d6edbe16b6b34d6dd417740065]
   as 
    
    



select customer_id
from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_e74e05d6edbe16b6b34d6dd417740065]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_e74e05d6edbe16b6b34d6dd417740065]
  ;')
[0m06:35:04.561621 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397, now test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551)
[0m06:35:04.562451 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:35:04.563261 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:35:04.564302 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:35:04.568151 [debug] [Thread-1  ]: local_md5(model.name): d9ecc431b4a169296ca29c386f015286
[0m06:35:04.568987 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.569607 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.575592 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:35:04.576771 [debug] [Thread-1  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.579490 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: ROLLBACK
[0m06:35:04.580204 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.582226 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:35:04.583306 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: Close
[0m06:35:04.586389 [info ] [Thread-3  ]: 7 of 18 PASS not_null_gld_sales_summary_order_date ............................. [[32mPASS[0m in 0.13s]
[0m06:35:04.588254 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:35:04.589750 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:35:04.591814 [info ] [Thread-3  ]: 11 of 18 START test not_null_slvr_sales_orders_line_total ...................... [RUN]
[0m06:35:04.592934 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:35:04.594021 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d)
[0m06:35:04.600980 [debug] [Thread-4  ]: local_md5(model.name): 6fbe07cd99985a105c0e61275b7ef592
[0m06:35:04.601865 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.602917 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:35:04.604896 [debug] [Thread-4  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.605426 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:35:04.608699 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: ROLLBACK
[0m06:35:04.616487 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:35:04.617924 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:35:04.619224 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_57cfdce3b7227ff8063d0c475037a458]
   as 
    
    



select list_price
from "AdventureWorks2014"."silver"."slvr_products"
where list_price is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_57cfdce3b7227ff8063d0c475037a458]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_57cfdce3b7227ff8063d0c475037a458]
  ;')
[0m06:35:04.620628 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: Close
[0m06:35:04.624326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:35:04.626156 [info ] [Thread-2  ]: 8 of 18 PASS not_null_slvr_customers_customer_id ............................... [[32mPASS[0m in 0.15s]
[0m06:35:04.628247 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.630625 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:35:04.632520 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.634405 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:35:04.638934 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:35:04.638156 [info ] [Thread-2  ]: 12 of 18 START test not_null_slvr_sales_orders_order_detail_id ................. [RUN]
[0m06:35:04.640690 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:35:04.646216 [debug] [Thread-3  ]: local_md5(model.name): 9aed47cbdc8c4c391feec0e17f79c145
[0m06:35:04.648169 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53)
[0m06:35:04.649941 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_13b18e073157b5687e8d45a0dccc3f2a]
   as 
    
    



select product_id
from "AdventureWorks2014"."silver"."slvr_products"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_13b18e073157b5687e8d45a0dccc3f2a]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_13b18e073157b5687e8d45a0dccc3f2a]
  ;')
[0m06:35:04.651293 [debug] [Thread-3  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.652658 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:35:04.654307 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.655122 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:35:04.657687 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:35:04.667506 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:35:04.670661 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: ROLLBACK
[0m06:35:04.671418 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.675881 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: Close
[0m06:35:04.677347 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.679030 [info ] [Thread-1  ]: 9 of 18 PASS not_null_slvr_products_list_price ................................. [[32mPASS[0m in 0.15s]
[0m06:35:04.682125 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:35:04.684703 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:35:04.686632 [info ] [Thread-1  ]: 13 of 18 START test not_null_slvr_sales_orders_sales_order_id .................. [RUN]
[0m06:35:04.689091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4)
[0m06:35:04.690143 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:35:04.691693 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:35:04.692355 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:35:04.693339 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6d03d410524c9f3ccaa88fcca448e682]
   as 
    
    



select line_total
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where line_total is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6d03d410524c9f3ccaa88fcca448e682]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6d03d410524c9f3ccaa88fcca448e682]
  ;')
[0m06:35:04.701145 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:35:04.701616 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.706022 [debug] [Thread-2  ]: local_md5(model.name): ea59c6424fdef3f68e31047da36d4522
[0m06:35:04.708746 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:35:04.713021 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: ROLLBACK
[0m06:35:04.714007 [debug] [Thread-2  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.715131 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.716349 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: Close
[0m06:35:04.718061 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:35:04.719464 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.720649 [info ] [Thread-4  ]: 10 of 18 PASS not_null_slvr_products_product_id ................................ [[32mPASS[0m in 0.16s]
[0m06:35:04.723991 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:35:04.726165 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:35:04.732353 [debug] [Thread-1  ]: local_md5(model.name): 8afc66a1e810936eb9dee9b36ebd66ab
[0m06:35:04.734686 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:35:04.736621 [debug] [Thread-1  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.738643 [info ] [Thread-4  ]: 14 of 18 START test unique_gld_customer_metrics_customer_id .................... [RUN]
[0m06:35:04.741300 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:35:04.743641 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551, now test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd)
[0m06:35:04.744509 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:35:04.746396 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:35:04.747897 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_58c96b30575a93f0ba4bc92bd855d29c]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_58c96b30575a93f0ba4bc92bd855d29c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_58c96b30575a93f0ba4bc92bd855d29c]
  ;')
[0m06:35:04.758665 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:35:04.759879 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:35:04.762773 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.764565 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.765166 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:35:04.767524 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_81543724b1627add3460d74fcc1388df]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_81543724b1627add3460d74fcc1388df]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_81543724b1627add3460d74fcc1388df]
  ;')
[0m06:35:04.769168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:35:04.770786 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.772287 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.777082 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:35:04.783042 [debug] [Thread-4  ]: local_md5(model.name): 09e4fbf108b34f10d79cdb74070d011e
[0m06:35:04.783710 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.785022 [debug] [Thread-4  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.789169 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: ROLLBACK
[0m06:35:04.790911 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:35:04.792168 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.793302 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: Close
[0m06:35:04.798525 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: ROLLBACK
[0m06:35:04.799866 [info ] [Thread-2  ]: 12 of 18 PASS not_null_slvr_sales_orders_order_detail_id ....................... [[32mPASS[0m in 0.15s]
[0m06:35:04.801716 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: Close
[0m06:35:04.803635 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:35:04.805578 [info ] [Thread-1  ]: 13 of 18 PASS not_null_slvr_sales_orders_sales_order_id ........................ [[32mPASS[0m in 0.12s]
[0m06:35:04.807160 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:35:04.809563 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:35:04.811157 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:35:04.811850 [info ] [Thread-2  ]: 15 of 18 START test unique_gld_product_performance_product_id .................. [RUN]
[0m06:35:04.813797 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:35:04.815581 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b6aca9e6db0b67873976d87d30ec9c6f]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b6aca9e6db0b67873976d87d30ec9c6f]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b6aca9e6db0b67873976d87d30ec9c6f]
  ;')
[0m06:35:04.817746 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53, now test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8)
[0m06:35:04.819710 [info ] [Thread-1  ]: 16 of 18 START test unique_gld_sales_summary_order_date ........................ [RUN]
[0m06:35:04.821274 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:35:04.823193 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:35:04.824935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4, now test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b)
[0m06:35:04.826640 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.836133 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:35:04.837138 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:35:04.839045 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.848187 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:35:04.856293 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:35:04.866215 [debug] [Thread-2  ]: local_md5(model.name): 282efc8b63abc4326c2e3fe9cf80b2ea
[0m06:35:04.866981 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:35:04.867666 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.868856 [debug] [Thread-2  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.874316 [debug] [Thread-1  ]: local_md5(model.name): 9242e0fb865d08f661cf2dc3e20a299e
[0m06:35:04.879724 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: ROLLBACK
[0m06:35:04.881124 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:35:04.883150 [debug] [Thread-1  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.884676 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: Close
[0m06:35:04.889098 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:35:04.889710 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.891465 [info ] [Thread-3  ]: 11 of 18 PASS not_null_slvr_sales_orders_line_total ............................ [[32mPASS[0m in 0.30s]
[0m06:35:04.896885 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: ROLLBACK
[0m06:35:04.898792 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:35:04.900785 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: Close
[0m06:35:04.903764 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:35:04.905787 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:35:04.906893 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:35:04.907647 [info ] [Thread-4  ]: 14 of 18 PASS unique_gld_customer_metrics_customer_id .......................... [[32mPASS[0m in 0.16s]
[0m06:35:04.909223 [info ] [Thread-3  ]: 17 of 18 START test unique_slvr_customers_customer_id .......................... [RUN]
[0m06:35:04.910955 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_51544e7d06091530fc526cebe4d942e7]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_51544e7d06091530fc526cebe4d942e7]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_51544e7d06091530fc526cebe4d942e7]
  ;')
[0m06:35:04.912327 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_8508538b3ce0e325db485ac1e689c721]
   as 
    
    

select
    order_date as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is not null
group by order_date
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_8508538b3ce0e325db485ac1e689c721]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_8508538b3ce0e325db485ac1e689c721]
  ;')
[0m06:35:04.914054 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:35:04.915560 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d, now test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600)
[0m06:35:04.917289 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:35:04.918819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:35:04.920504 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:35:04.922133 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:35:04.923788 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.925795 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:04.927658 [info ] [Thread-4  ]: 18 of 18 START test unique_slvr_products_product_id ............................ [RUN]
[0m06:35:04.935891 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:35:04.937748 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.939393 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:04.940533 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd, now test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f)
[0m06:35:04.945749 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:35:04.955942 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:35:04.959903 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:35:04.961298 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.967624 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:35:04.969732 [debug] [Thread-3  ]: local_md5(model.name): 4e2331c32d747d8df52121a664e91469
[0m06:35:04.973581 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: ROLLBACK
[0m06:35:04.976429 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: ROLLBACK
[0m06:35:04.977335 [debug] [Thread-3  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.977795 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:35:04.979241 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: Close
[0m06:35:04.980253 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: Close
[0m06:35:04.981821 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:35:04.986796 [debug] [Thread-4  ]: local_md5(model.name): 460bcc0c9f9b8191fcda43c5bbb8239e
[0m06:35:04.988547 [info ] [Thread-1  ]: 16 of 18 PASS unique_gld_sales_summary_order_date .............................. [[32mPASS[0m in 0.16s]
[0m06:35:04.990041 [info ] [Thread-2  ]: 15 of 18 PASS unique_gld_product_performance_product_id ........................ [[32mPASS[0m in 0.17s]
[0m06:35:04.992426 [debug] [Thread-4  ]: local_md5(invocation_id): 0aaf8c2a3005cbb802381f5f38d3860a
[0m06:35:04.993852 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:35:04.995190 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:35:04.997175 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:35:05.001074 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:35:05.002240 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_52c9e8081db9cf592906e0a44b7e427e]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_52c9e8081db9cf592906e0a44b7e427e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_52c9e8081db9cf592906e0a44b7e427e]
  ;')
[0m06:35:05.003456 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:35:05.004382 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:35:05.004781 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:05.005884 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_f0768e93ac5a5e0dc07aa1c02bdd360c]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_products"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_f0768e93ac5a5e0dc07aa1c02bdd360c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_f0768e93ac5a5e0dc07aa1c02bdd360c]
  ;')
[0m06:35:05.008509 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:35:05.010618 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:35:05.028855 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:05.033710 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:35:05.050283 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:35:05.050909 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:35:05.053520 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: ROLLBACK
[0m06:35:05.055551 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: ROLLBACK
[0m06:35:05.056680 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: Close
[0m06:35:05.058414 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: Close
[0m06:35:05.059594 [info ] [Thread-4  ]: 18 of 18 PASS unique_slvr_products_product_id .................................. [[32mPASS[0m in 0.12s]
[0m06:35:05.060725 [info ] [Thread-3  ]: 17 of 18 PASS unique_slvr_customers_customer_id ................................ [[32mPASS[0m in 0.15s]
[0m06:35:05.062500 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:35:05.064077 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:35:05.068253 [debug] [MainThread]: On master: COMMIT
[0m06:35:05.069442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:35:05.070510 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600' was properly closed.
[0m06:35:05.071441 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b' was properly closed.
[0m06:35:05.072290 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8' was properly closed.
[0m06:35:05.073427 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f' was properly closed.
[0m06:35:05.074959 [info ] [MainThread]: 
[0m06:35:05.076104 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m06:35:05.080240 [debug] [MainThread]: Command end result
[0m06:35:05.231028 [info ] [MainThread]: 
[0m06:35:05.232754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:35:05.234318 [info ] [MainThread]: 
[0m06:35:05.235962 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m06:35:05.238263 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.5108767, "process_user_time": 3.118759, "process_kernel_time": 1.482222, "process_mem_max_rss": "127056", "process_in_blocks": "42232", "process_out_blocks": "0"}
[0m06:35:05.239973 [debug] [MainThread]: Command `dbt test` succeeded at 06:35:05.239807 after 4.51 seconds
[0m06:35:05.241243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e537c586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5361fae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5378f6040>]}
[0m06:35:05.243057 [debug] [MainThread]: Flushing usage events
[0m06:36:44.643327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a6b396d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a49c2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a49c2520>]}


============================== 06:36:44.648366 | 74ca4b88-1fa7-4354-8021-041f57d66fa6 ==============================
[0m06:36:44.648366 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:36:44.652632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:36:45.329745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a496de80>]}
[0m06:36:45.381282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a6d10cd0>]}
[0m06:36:45.383512 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:36:45.495393 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:36:46.503690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:36:46.504920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:36:46.560832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a30d9130>]}
[0m06:36:46.753295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a377ba60>]}
[0m06:36:46.754416 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:36:46.755504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a31001f0>]}
[0m06:36:46.758799 [info ] [MainThread]: 
[0m06:36:46.760103 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:36:46.766614 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:36:46.767430 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:36:46.768077 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:36:46.784123 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:46.787099 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:46.791791 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:46.793735 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:36:46.795560 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:36:46.797184 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:36:46.798540 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:46.799892 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:46.801070 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:46.802343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:46.803188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:46.804155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:46.805088 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:46.806390 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:46.807417 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:46.848475 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:46.849430 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:46.849909 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:46.853863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:46.854394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:46.854866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:46.857625 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:36:46.859783 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:36:46.861862 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:36:46.866367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m06:36:46.867240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_silver)
[0m06:36:46.867938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_gold)
[0m06:36:46.875427 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:46.880427 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:46.884618 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:46.886621 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:36:46.888019 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:36:46.889507 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:36:46.890664 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:46.891731 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:46.892890 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:46.893745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:46.894538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:46.895562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:46.896563 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:46.897526 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:46.898471 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:46.899380 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:46.900079 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:46.900743 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:46.906574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:46.907211 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:46.909313 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:36:46.909659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:46.911324 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:36:46.911978 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:36:46.913712 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:36:46.914350 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:36:46.916198 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:36:46.918458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a36bf550>]}
[0m06:36:46.919292 [debug] [MainThread]: On master: COMMIT
[0m06:36:46.920203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:36:46.921096 [info ] [MainThread]: 
[0m06:36:46.925135 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m06:36:46.925566 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m06:36:46.925969 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m06:36:46.926394 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:36:46.927303 [info ] [Thread-1  ]: 1 of 10 START sql view model bronze.brnz_customers ............................. [RUN]
[0m06:36:46.928410 [info ] [Thread-2  ]: 2 of 10 START sql view model bronze.brnz_example ............................... [RUN]
[0m06:36:46.929603 [info ] [Thread-3  ]: 3 of 10 START sql view model bronze.brnz_products .............................. [RUN]
[0m06:36:46.930603 [info ] [Thread-4  ]: 4 of 10 START sql view model bronze.brnz_sales_orders .......................... [RUN]
[0m06:36:46.931659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now model.dbt_sqlserver_project.brnz_customers)
[0m06:36:46.932773 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now model.dbt_sqlserver_project.brnz_example)
[0m06:36:46.933776 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_products)
[0m06:36:46.934678 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m06:36:46.935567 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m06:36:46.936389 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m06:36:46.937217 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m06:36:46.937955 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:36:46.947396 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:36:46.951132 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m06:36:46.955174 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m06:36:46.959290 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:36:46.967256 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m06:36:46.968715 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m06:36:46.980310 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:36:46.980843 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m06:36:47.005848 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:36:47.007412 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m06:36:47.014433 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:36:47.020210 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m06:36:47.029455 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:36:47.030463 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:36:47.032031 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:36:47.032652 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m06:36:47.033233 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:36:47.034172 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m06:36:47.035391 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m06:36:47.036362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:47.037329 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:36:47.038445 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:36:47.039478 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:47.040637 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:47.041662 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:36:47.042713 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:47.043772 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:47.045735 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:47.062312 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:47.064894 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:47.065632 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:47.066174 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:47.079178 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.079731 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.088544 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:36:47.089089 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.089563 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.094442 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:36:47.095561 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m06:36:47.099810 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:36:47.104502 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:36:47.105459 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m06:36:47.107514 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m06:36:47.108786 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m06:36:47.129061 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.129546 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.130044 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.134917 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:36:47.139260 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:36:47.143832 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:36:47.144769 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m06:36:47.145963 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m06:36:47.146994 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m06:36:47.168222 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.168896 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.169311 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.169659 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.186415 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m06:36:47.188417 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m06:36:47.193622 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:36:47.195840 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m06:36:47.203264 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m06:36:47.209104 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m06:36:47.211514 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m06:36:47.216339 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m06:36:47.225373 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:36:47.227182 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:36:47.230418 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:36:47.231655 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:36:47.233123 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:36:47.234444 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:36:47.235510 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:47.236602 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:47.237144 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.237815 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:47.242288 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m06:36:47.243370 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.243728 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.247781 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m06:36:47.248232 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.250589 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:36:47.252973 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:36:47.254163 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:36:47.257194 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:36:47.258326 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m06:36:47.259793 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m06:36:47.260785 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:36:47.261755 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m06:36:47.264189 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:47.276349 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.276946 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.277445 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.277772 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.280837 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m06:36:47.283373 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m06:36:47.285172 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m06:36:47.287441 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:36:47.288368 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m06:36:47.289571 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m06:36:47.290801 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m06:36:47.291807 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m06:36:47.294131 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a3748910>]}
[0m06:36:47.295234 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a182ba30>]}
[0m06:36:47.296488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a3088b50>]}
[0m06:36:47.298357 [info ] [Thread-4  ]: 4 of 10 OK created sql view model bronze.brnz_sales_orders ..................... [[32mOK[0m in 0.36s]
[0m06:36:47.300234 [info ] [Thread-3  ]: 3 of 10 OK created sql view model bronze.brnz_products ......................... [[32mOK[0m in 0.36s]
[0m06:36:47.302094 [info ] [Thread-1  ]: 1 of 10 OK created sql view model bronze.brnz_customers ........................ [[32mOK[0m in 0.36s]
[0m06:36:47.303599 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:36:47.305060 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m06:36:47.305602 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.307014 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m06:36:47.309318 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:36:47.310544 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.slvr_products
[0m06:36:47.312245 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m06:36:47.313257 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.slvr_customers
[0m06:36:47.314054 [info ] [Thread-4  ]: 5 of 10 START sql table model silver.slvr_sales_orders ......................... [RUN]
[0m06:36:47.315230 [info ] [Thread-3  ]: 6 of 10 START sql table model silver.slvr_products ............................. [RUN]
[0m06:36:47.316449 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m06:36:47.317345 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.slvr_customers ............................ [RUN]
[0m06:36:47.318494 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_sales_orders, now model.dbt_sqlserver_project.slvr_sales_orders)
[0m06:36:47.319355 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_products, now model.dbt_sqlserver_project.slvr_products)
[0m06:36:47.320341 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a36bf550>]}
[0m06:36:47.321163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_customers, now model.dbt_sqlserver_project.slvr_customers)
[0m06:36:47.322033 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:36:47.322838 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.slvr_products
[0m06:36:47.324042 [info ] [Thread-2  ]: 2 of 10 OK created sql view model bronze.brnz_example .......................... [[32mOK[0m in 0.39s]
[0m06:36:47.324977 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.slvr_customers
[0m06:36:47.329722 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:47.333475 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.334615 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m06:36:47.339113 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:47.345431 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.slvr_products
[0m06:36:47.346685 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:36:47.352750 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.slvr_customers
[0m06:36:47.370317 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:36:47.374079 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:36:47.378862 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:36:47.382564 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw"
[0m06:36:47.392045 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw"
[0m06:36:47.395521 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw"
[0m06:36:47.397598 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:36:47.399940 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:36:47.402653 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:36:47.403970 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.405467 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:47.407175 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:47.409442 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:47.411096 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_sales_orders__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:47.412693 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_customers__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:47.414004 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:47.415280 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:36:47.416687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:47.417901 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:47.418870 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:47.419835 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:47.420924 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:47.421705 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:47.422623 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:47.428037 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.428730 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.431246 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:47.431818 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.433815 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.434848 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw";');

[0m06:36:47.437134 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:47.438087 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_products__dbt_tmp__dbt_tmp_vw";');

[0m06:36:47.440046 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw";');

[0m06:36:47.442436 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.444700 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.449901 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:47.450493 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.452944 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.458219 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:47.463388 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:47.464264 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:47.465630 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" as 

with bronze_sales as (
    select * from "AdventureWorks2014"."bronze"."brnz_sales_orders"
),

cleaned as (
    select
        sales_order_id,
        order_detail_id,
        order_date,
        due_date,
        ship_date,
        status,
        case 
            when online_order_flag = 1 then ''Online''
            else ''Offline''
        end as order_channel,
        sales_order_number,
        purchase_order_number,
        customer_id,
        sales_person_id,
        territory_id,
        product_id,
        order_qty,
        unit_price,
        unit_price_discount,
        line_total,
        -- Calculated fields
        unit_price * order_qty as gross_amount,
        line_total / nullif(order_qty, 0) as effective_unit_price,
        case 
            when unit_price_discount > 0 then 1
            else 0
        end as has_discount
    from bronze_sales
    where order_qty > 0
        and unit_price >= 0
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_sales_orders__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_sales_orders__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_sales_orders__dbt_tmp')
    )
    DROP index "silver"."slvr_sales_orders__dbt_tmp".silver_slvr_sales_orders__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_sales_orders__dbt_tmp_cci
    ON "silver"."slvr_sales_orders__dbt_tmp"

   


  
[0m06:36:47.466451 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.467391 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" as 

with bronze_customers as (
    select * from "AdventureWorks2014"."bronze"."brnz_customers"
),

cleaned as (
    select
        CustomerID as customer_id,
        coalesce(FirstName, ''Unknown'') as first_name,
        coalesce(LastName, ''Unknown'') as last_name,
        concat(coalesce(FirstName, ''Unknown''), '' '', coalesce(LastName, ''Unknown'')) as full_name,
        EmailPromotion as email_promotion,
        StoreID as store_id,
        TerritoryID as territory_id,
        last_modified_date
    from bronze_customers
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_customers__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_customers__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_customers__dbt_tmp')
    )
    DROP index "silver"."slvr_customers__dbt_tmp".silver_slvr_customers__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_customers__dbt_tmp_cci
    ON "silver"."slvr_customers__dbt_tmp"

   


  
[0m06:36:47.469363 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_products__dbt_tmp__dbt_tmp_vw" as 

with bronze_products as (
    select * from "AdventureWorks2014"."bronze"."brnz_products"
),

cleaned as (
    select
        ProductID as product_id,
        ProductName as product_name,
        ProductNumber as product_number,
        coalesce(Color, ''N/A'') as color,
        StandardCost as standard_cost,
        ListPrice as list_price,
        coalesce(Size, ''N/A'') as size,
        coalesce(Weight, 0) as weight,
        ProductLine as product_line,
        Class as class,
        Style as style,
        ProductSubcategoryID as subcategory_id,
        coalesce(SubcategoryName, ''Uncategorized'') as subcategory_name,
        ProductCategoryID as category_id,
        SellStartDate as sell_start_date,
        SellEndDate as sell_end_date,
        case 
            when DiscontinuedDate is not null then 1
            else 0
        end as is_discontinued,
        last_modified_date
    from bronze_products
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_products__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_products__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_products__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_products__dbt_tmp')
    )
    DROP index "silver"."slvr_products__dbt_tmp".silver_slvr_products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_products__dbt_tmp_cci
    ON "silver"."slvr_products__dbt_tmp"

   


  
[0m06:36:47.776631 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.782339 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.784008 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products', 'slvr_products__dbt_backup'
[0m06:36:47.796951 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.803470 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.805040 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products__dbt_tmp', 'slvr_products'
[0m06:36:47.819181 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.826468 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: COMMIT
[0m06:36:47.831556 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_backup"
[0m06:36:47.833587 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:36:47.835000 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_products__dbt_backup";');

[0m06:36:47.851713 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.855151 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: Close
[0m06:36:47.857411 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a0100970>]}
[0m06:36:47.859561 [info ] [Thread-3  ]: 6 of 10 OK created sql table model silver.slvr_products ........................ [[32mOK[0m in 0.54s]
[0m06:36:47.861313 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.slvr_products
[0m06:36:47.952238 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.957645 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:47.958692 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers', 'slvr_customers__dbt_backup'
[0m06:36:47.968421 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:47.973916 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:47.975431 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers__dbt_tmp', 'slvr_customers'
[0m06:36:47.997793 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:48.001410 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: COMMIT
[0m06:36:48.006890 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_backup"
[0m06:36:48.009603 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:36:48.011314 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_customers__dbt_backup";');

[0m06:36:48.025797 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:48.028678 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: Close
[0m06:36:48.030078 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a1831340>]}
[0m06:36:48.031371 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.slvr_customers ....................... [[32mOK[0m in 0.71s]
[0m06:36:48.033092 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.slvr_customers
[0m06:36:48.978230 [debug] [Thread-4  ]: SQL status: OK in 2.000 seconds
[0m06:36:48.982785 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:48.983843 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders', 'slvr_sales_orders__dbt_backup'
[0m06:36:48.991693 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:48.995868 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:48.996767 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders__dbt_tmp', 'slvr_sales_orders'
[0m06:36:49.004442 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.007260 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: COMMIT
[0m06:36:49.011552 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_backup"
[0m06:36:49.012742 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:36:49.013549 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_sales_orders__dbt_backup";');

[0m06:36:49.029978 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.032241 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: Close
[0m06:36:49.033488 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a1810730>]}
[0m06:36:49.034556 [info ] [Thread-4  ]: 5 of 10 OK created sql table model silver.slvr_sales_orders .................... [[32mOK[0m in 1.72s]
[0m06:36:49.035819 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:36:49.037497 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:36:49.037829 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.gld_product_performance
[0m06:36:49.038192 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:36:49.039080 [info ] [Thread-2  ]: 8 of 10 START sql table model gold.gld_customer_metrics ........................ [RUN]
[0m06:36:49.040664 [info ] [Thread-3  ]: 9 of 10 START sql table model gold.gld_product_performance ..................... [RUN]
[0m06:36:49.042051 [info ] [Thread-1  ]: 10 of 10 START sql table model gold.gld_sales_summary .......................... [RUN]
[0m06:36:49.043143 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_example, now model.dbt_sqlserver_project.gld_customer_metrics)
[0m06:36:49.044114 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_products, now model.dbt_sqlserver_project.gld_product_performance)
[0m06:36:49.045121 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_customers, now model.dbt_sqlserver_project.gld_sales_summary)
[0m06:36:49.045957 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:36:49.046767 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.gld_product_performance
[0m06:36:49.047581 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.gld_sales_summary
[0m06:36:49.099115 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:49.103229 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:49.107828 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.116099 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.gld_sales_summary
[0m06:36:49.121730 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:36:49.126572 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw"
[0m06:36:49.126988 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.gld_product_performance
[0m06:36:49.127402 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:36:49.128697 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:36:49.134174 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:36:49.139225 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:36:49.141374 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.145699 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw"
[0m06:36:49.150602 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw"
[0m06:36:49.152554 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_sales_summary__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:49.154380 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:36:49.156410 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:36:49.157985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:49.159183 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:49.160336 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:49.161386 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:49.162295 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_product_performance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:49.163179 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_customer_metrics__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:36:49.164292 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:49.165021 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:49.166220 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:36:49.167903 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:49.168914 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:49.170262 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.174156 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.175812 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw";');

[0m06:36:49.179713 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.183042 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.185070 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:49.185631 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:49.188949 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.190101 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.192290 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:49.194203 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.194935 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:49.195541 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw";');

[0m06:36:49.196474 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" as 

with sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

daily_summary as (
    select
        cast(order_date as date) as order_date,
        count(distinct sales_order_id) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(order_qty) as total_items_sold,
        sum(line_total) as total_revenue,
        avg(line_total) as avg_order_line_value,
        sum(case when order_channel = ''Online'' then 1 else 0 end) as online_orders,
        sum(case when order_channel = ''Offline'' then 1 else 0 end) as offline_orders,
        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue
    from sales
    group by cast(order_date as date)
)

select * from daily_summary;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_sales_summary__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_sales_summary__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_sales_summary__dbt_tmp')
    )
    DROP index "gold"."gld_sales_summary__dbt_tmp".gold_gld_sales_summary__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_sales_summary__dbt_tmp_cci
    ON "gold"."gld_sales_summary__dbt_tmp"

   


  
[0m06:36:49.197377 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw";');

[0m06:36:49.209575 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.212448 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:49.212934 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.215891 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:49.221502 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:49.222537 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:49.223683 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" as 

with customers as (
    select * from "AdventureWorks2014"."silver"."slvr_customers"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

customer_sales as (
    select
        c.customer_id,
        c.full_name,
        c.territory_id,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.line_total) as total_revenue,
        avg(s.line_total) as avg_order_value,
        sum(s.order_qty) as total_items_purchased,
        min(s.order_date) as first_order_date,
        max(s.order_date) as last_order_date,
        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount
    from customers c
    left join sales s
        on c.customer_id = s.customer_id
    group by c.customer_id, c.full_name, c.territory_id
)

select * from customer_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_customer_metrics__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_customer_metrics__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_customer_metrics__dbt_tmp')
    )
    DROP index "gold"."gld_customer_metrics__dbt_tmp".gold_gld_customer_metrics__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_customer_metrics__dbt_tmp_cci
    ON "gold"."gld_customer_metrics__dbt_tmp"

   


  
[0m06:36:49.224771 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" as 

with products as (
    select * from "AdventureWorks2014"."silver"."slvr_products"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

product_sales as (
    select
        p.product_id,
        p.product_name,
        p.subcategory_name,
        p.color,
        p.list_price,
        p.standard_cost,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.order_qty) as total_quantity_sold,
        sum(s.line_total) as total_revenue,
        avg(s.unit_price) as avg_selling_price,
        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,
        case 
            when sum(s.order_qty) > 0 then 
                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100
            else 0
        end as profit_margin_pct
    from products p
    left join sales s
        on p.product_id = s.product_id
    group by 
        p.product_id, 
        p.product_name, 
        p.subcategory_name, 
        p.color, 
        p.list_price, 
        p.standard_cost
)

select * from product_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_product_performance__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_product_performance__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_product_performance__dbt_tmp')
    )
    DROP index "gold"."gld_product_performance__dbt_tmp".gold_gld_product_performance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_product_performance__dbt_tmp_cci
    ON "gold"."gld_product_performance__dbt_tmp"

   


  
[0m06:36:49.665503 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.673355 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.675298 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary', 'gld_sales_summary__dbt_backup'
[0m06:36:49.686438 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.693596 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.695164 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary__dbt_tmp', 'gld_sales_summary'
[0m06:36:49.752493 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.755101 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: COMMIT
[0m06:36:49.759102 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_backup"
[0m06:36:49.760572 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:36:49.761608 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_sales_summary__dbt_backup";');

[0m06:36:49.800908 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:49.804209 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_sales_summary: Close
[0m06:36:49.806504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74398af038e0>]}
[0m06:36:49.808907 [info ] [Thread-1  ]: 10 of 10 OK created sql table model gold.gld_sales_summary ..................... [[32mOK[0m in 0.76s]
[0m06:36:49.810876 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:36:50.004775 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m06:36:50.009914 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:50.011309 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics', 'gld_customer_metrics__dbt_backup'
[0m06:36:50.020770 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:50.025594 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:50.026909 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics__dbt_tmp', 'gld_customer_metrics'
[0m06:36:50.037297 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:50.040262 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: COMMIT
[0m06:36:50.044251 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_backup"
[0m06:36:50.045808 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:36:50.046673 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_customer_metrics__dbt_backup";');

[0m06:36:50.059647 [debug] [Thread-3  ]: SQL status: OK in 1.000 seconds
[0m06:36:50.060121 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:50.065189 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:50.067154 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: Close
[0m06:36:50.067832 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance', 'gld_product_performance__dbt_backup'
[0m06:36:50.068970 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a00bb310>]}
[0m06:36:50.070707 [info ] [Thread-2  ]: 8 of 10 OK created sql table model gold.gld_customer_metrics ................... [[32mOK[0m in 1.03s]
[0m06:36:50.072242 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:36:50.077979 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:50.082270 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:50.083367 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance__dbt_tmp', 'gld_product_performance'
[0m06:36:50.092070 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:50.094503 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: COMMIT
[0m06:36:50.097916 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_backup"
[0m06:36:50.099327 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:36:50.100155 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_product_performance__dbt_backup";');

[0m06:36:50.109115 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:50.111344 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_product_performance: Close
[0m06:36:50.112369 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ca4b88-1fa7-4354-8021-041f57d66fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74398af034c0>]}
[0m06:36:50.113467 [info ] [Thread-3  ]: 9 of 10 OK created sql table model gold.gld_product_performance ................ [[32mOK[0m in 1.07s]
[0m06:36:50.114548 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.gld_product_performance
[0m06:36:50.116783 [debug] [MainThread]: On master: COMMIT
[0m06:36:50.117851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:50.118703 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_sales_summary' was properly closed.
[0m06:36:50.119455 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_product_performance' was properly closed.
[0m06:36:50.120174 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_customer_metrics' was properly closed.
[0m06:36:50.120872 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.slvr_sales_orders' was properly closed.
[0m06:36:50.121722 [info ] [MainThread]: 
[0m06:36:50.122741 [info ] [MainThread]: Finished running 4 view models, 6 table models in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m06:36:50.125926 [debug] [MainThread]: Command end result
[0m06:36:50.209896 [info ] [MainThread]: 
[0m06:36:50.210994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:36:50.212122 [info ] [MainThread]: 
[0m06:36:50.213286 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m06:36:50.214984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7014523, "process_user_time": 2.965464, "process_kernel_time": 1.46242, "process_mem_max_rss": "126416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:36:50.216048 [debug] [MainThread]: Command `dbt run` succeeded at 06:36:50.215908 after 5.70 seconds
[0m06:36:50.217001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a6b396d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a56a2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7439a6870e20>]}
[0m06:36:50.217869 [debug] [MainThread]: Flushing usage events
[0m06:36:54.336873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e64c8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e56c0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e4390190>]}


============================== 06:36:54.341870 | 441bc0ea-dae3-4091-8e31-a4d7a8d84cb6 ==============================
[0m06:36:54.341870 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:36:54.343130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:36:54.597790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '441bc0ea-dae3-4091-8e31-a4d7a8d84cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e62a7cd0>]}
[0m06:36:54.658495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '441bc0ea-dae3-4091-8e31-a4d7a8d84cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e2f91910>]}
[0m06:36:54.660742 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:36:54.799576 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:36:55.837575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:36:55.838985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:36:55.894518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '441bc0ea-dae3-4091-8e31-a4d7a8d84cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e2a69130>]}
[0m06:36:56.099369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '441bc0ea-dae3-4091-8e31-a4d7a8d84cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e2c44370>]}
[0m06:36:56.100813 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:36:56.102166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '441bc0ea-dae3-4091-8e31-a4d7a8d84cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e2a7aa60>]}
[0m06:36:56.105306 [info ] [MainThread]: 
[0m06:36:56.107220 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:36:56.113880 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_silver'
[0m06:36:56.114638 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m06:36:56.115392 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_gold'
[0m06:36:56.133872 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:56.137424 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:56.141937 [debug] [ThreadPool]: dbt-sqlserver
[0m06:36:56.143430 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:36:56.144670 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:36:56.145985 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:36:56.146733 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:56.147629 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:56.148660 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:36:56.149702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:56.150616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:56.151568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:56.152433 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.153333 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.154305 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.189987 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.190477 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.191508 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.195677 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:56.196921 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:56.197465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:36:56.199444 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:36:56.201062 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:36:56.202604 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:36:56.203289 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:36:56.203920 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:36:56.204929 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:36:56.209828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '441bc0ea-dae3-4091-8e31-a4d7a8d84cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e30d8cd0>]}
[0m06:36:56.210913 [debug] [MainThread]: On master: COMMIT
[0m06:36:56.211876 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:36:56.212936 [info ] [MainThread]: 
[0m06:36:56.217911 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:36:56.218365 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:36:56.218849 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:36:56.219281 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:36:56.219805 [info ] [Thread-1  ]: 1 of 18 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:36:56.220931 [info ] [Thread-2  ]: 2 of 18 START test dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:36:56.222155 [info ] [Thread-3  ]: 3 of 18 START test not_null_brnz_sales_orders_order_detail_id .................. [RUN]
[0m06:36:56.223994 [info ] [Thread-4  ]: 4 of 18 START test not_null_brnz_sales_orders_sales_order_id ................... [RUN]
[0m06:36:56.225186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m06:36:56.226161 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc)
[0m06:36:56.227214 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac)
[0m06:36:56.228279 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m06:36:56.229234 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:36:56.230125 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:36:56.231002 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:36:56.231797 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:36:56.252890 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:36:56.260584 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:36:56.272826 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:36:56.279646 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:36:56.288781 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:36:56.290074 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:36:56.297674 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:36:56.305570 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:36:56.318887 [debug] [Thread-4  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m06:36:56.322018 [debug] [Thread-3  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m06:36:56.326565 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m06:36:56.330282 [debug] [Thread-2  ]: local_md5(model.name): fa6b3d9cc18a40cfba3de7295a3a38e6
[0m06:36:56.331977 [debug] [Thread-4  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.333622 [debug] [Thread-3  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.335204 [debug] [Thread-1  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.336340 [debug] [Thread-2  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.337798 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:36:56.339475 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:36:56.341363 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:36:56.343022 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:36:56.349841 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:36:56.351566 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:36:56.353593 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_42f410f5aba4918d3a13309d1cff4866]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_42f410f5aba4918d3a13309d1cff4866]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_42f410f5aba4918d3a13309d1cff4866]
  ;')
[0m06:36:56.354572 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:36:56.355117 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:36:56.357464 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_368a60d83ef564f77121af4e7ceaf70b]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_368a60d83ef564f77121af4e7ceaf70b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_368a60d83ef564f77121af4e7ceaf70b]
  ;')
[0m06:36:56.359657 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:56.361340 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_725e61120079a5f1fcf2b3a3567376b6]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_725e61120079a5f1fcf2b3a3567376b6]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_725e61120079a5f1fcf2b3a3567376b6]
  ;')
[0m06:36:56.362502 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_6acad11e3d1318cf7020aab0b25e127a]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."silver"."slvr_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_6acad11e3d1318cf7020aab0b25e127a]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_6acad11e3d1318cf7020aab0b25e127a]
  ;')
[0m06:36:56.363746 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:36:56.364928 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.366020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:56.367189 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:36:56.368337 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.369584 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.370321 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.371257 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.372738 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.374816 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.392945 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.396911 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.404160 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m06:36:56.406815 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m06:36:56.408695 [info ] [Thread-4  ]: 4 of 18 PASS not_null_brnz_sales_orders_sales_order_id ......................... [[32mPASS[0m in 0.18s]
[0m06:36:56.410618 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:36:56.412040 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:36:56.413211 [info ] [Thread-4  ]: 5 of 18 START test not_null_gld_customer_metrics_customer_id ................... [RUN]
[0m06:36:56.414595 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca, now test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39)
[0m06:36:56.416098 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:36:56.423503 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:36:56.434997 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:36:56.440528 [debug] [Thread-4  ]: local_md5(model.name): ac0d77cdfe99d22d2680c19319e8499c
[0m06:36:56.442392 [debug] [Thread-4  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.443197 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.444620 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:36:56.447076 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m06:36:56.448771 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m06:36:56.450453 [info ] [Thread-3  ]: 3 of 18 PASS not_null_brnz_sales_orders_order_detail_id ........................ [[32mPASS[0m in 0.22s]
[0m06:36:56.451843 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:36:56.453007 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:36:56.454097 [info ] [Thread-3  ]: 6 of 18 START test not_null_gld_product_performance_product_id ................. [RUN]
[0m06:36:56.455690 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac, now test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397)
[0m06:36:56.458463 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:36:56.459523 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:36:56.465042 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:36:56.466880 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_47f528ad46eb4504fffc5b12ae0501fc]
   as 
    
    



select customer_id
from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_47f528ad46eb4504fffc5b12ae0501fc]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_47f528ad46eb4504fffc5b12ae0501fc]
  ;')
[0m06:36:56.468631 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:36:56.469640 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.470702 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.476817 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:36:56.481036 [debug] [Thread-3  ]: local_md5(model.name): a5b86011b8d22b04b2506841bc10c840
[0m06:36:56.482807 [debug] [Thread-3  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.484712 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:36:56.488514 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.492031 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: ROLLBACK
[0m06:36:56.493548 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: Close
[0m06:36:56.496659 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:36:56.496079 [info ] [Thread-4  ]: 5 of 18 PASS not_null_gld_customer_metrics_customer_id ......................... [[32mPASS[0m in 0.08s]
[0m06:36:56.497776 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_dd163b6f8659f0500eb34171197b5655]
   as 
    
    



select product_id
from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_dd163b6f8659f0500eb34171197b5655]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_dd163b6f8659f0500eb34171197b5655]
  ;')
[0m06:36:56.499360 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:36:56.500385 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:56.501567 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:36:56.502504 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.503394 [info ] [Thread-4  ]: 7 of 18 START test not_null_gld_sales_summary_order_date ....................... [RUN]
[0m06:36:56.504785 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.506446 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39, now test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e)
[0m06:36:56.508589 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:36:56.514566 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:36:56.516834 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.519832 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m06:36:56.521267 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m06:36:56.523765 [info ] [Thread-1  ]: 1 of 18 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.30s]
[0m06:36:56.524557 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.525763 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:36:56.528996 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: ROLLBACK
[0m06:36:56.529859 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:36:56.531554 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: Close
[0m06:36:56.532156 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:36:56.532981 [info ] [Thread-1  ]: 8 of 18 START test not_null_slvr_customers_customer_id ......................... [RUN]
[0m06:36:56.534568 [info ] [Thread-3  ]: 6 of 18 PASS not_null_gld_product_performance_product_id ....................... [[32mPASS[0m in 0.08s]
[0m06:36:56.539775 [debug] [Thread-4  ]: local_md5(model.name): 31cffa58c58a08e4f0ecffd253b46aa2
[0m06:36:56.540280 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.541112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902, now test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275)
[0m06:36:56.542205 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:36:56.543191 [debug] [Thread-4  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.545465 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: ROLLBACK
[0m06:36:56.546057 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:36:56.546987 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:36:56.548219 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:36:56.549250 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: Close
[0m06:36:56.554016 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:36:56.555482 [info ] [Thread-3  ]: 9 of 18 START test not_null_slvr_products_list_price ........................... [RUN]
[0m06:36:56.558499 [info ] [Thread-2  ]: 2 of 18 PASS dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.33s]
[0m06:36:56.560787 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397, now test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076)
[0m06:36:56.562155 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:36:56.563190 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:36:56.564210 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:36:56.570993 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:36:56.572572 [info ] [Thread-2  ]: 10 of 18 START test not_null_slvr_products_product_id .......................... [RUN]
[0m06:36:56.573909 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:36:56.574427 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:36:56.576719 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc, now test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551)
[0m06:36:56.581168 [debug] [Thread-1  ]: local_md5(model.name): 8e9f64ea0dd2dc40d032bf48fa566213
[0m06:36:56.583199 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_ef78999f544e1bac7596de1cd93f4038]
   as 
    
    



select order_date
from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_ef78999f544e1bac7596de1cd93f4038]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_ef78999f544e1bac7596de1cd93f4038]
  ;')
[0m06:36:56.584968 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:36:56.586470 [debug] [Thread-1  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.588830 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:36:56.590765 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:36:56.596363 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:36:56.598178 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:36:56.599708 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.603967 [debug] [Thread-3  ]: local_md5(model.name): d9ecc431b4a169296ca29c386f015286
[0m06:36:56.607911 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.608963 [debug] [Thread-3  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.611892 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:36:56.618053 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:36:56.619114 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:36:56.619919 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:36:56.621074 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_743a08bce52e1b1cf23bf368ac853e37]
   as 
    
    



select customer_id
from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_743a08bce52e1b1cf23bf368ac853e37]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_743a08bce52e1b1cf23bf368ac853e37]
  ;')
[0m06:36:56.623527 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_76754631e8e6bb16a91073703ffda362]
   as 
    
    



select list_price
from "AdventureWorks2014"."silver"."slvr_products"
where list_price is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_76754631e8e6bb16a91073703ffda362]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_76754631e8e6bb16a91073703ffda362]
  ;')
[0m06:36:56.628742 [debug] [Thread-2  ]: local_md5(model.name): 6fbe07cd99985a105c0e61275b7ef592
[0m06:36:56.630165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:56.631444 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:56.632945 [debug] [Thread-2  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.634417 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.635659 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.637254 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:36:56.638981 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.640015 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.640561 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.645531 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: ROLLBACK
[0m06:36:56.647745 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: Close
[0m06:36:56.649771 [info ] [Thread-4  ]: 7 of 18 PASS not_null_gld_sales_summary_order_date ............................. [[32mPASS[0m in 0.14s]
[0m06:36:56.654087 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:36:56.656662 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:36:56.658219 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.660352 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:36:56.660902 [info ] [Thread-4  ]: 11 of 18 START test not_null_slvr_sales_orders_line_total ...................... [RUN]
[0m06:36:56.663567 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: ROLLBACK
[0m06:36:56.664237 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_af7d3bcb5646b79d63ceda865a854daf]
   as 
    
    



select product_id
from "AdventureWorks2014"."silver"."slvr_products"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_af7d3bcb5646b79d63ceda865a854daf]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_af7d3bcb5646b79d63ceda865a854daf]
  ;')
[0m06:36:56.664644 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.665989 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d)
[0m06:36:56.667083 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: Close
[0m06:36:56.667757 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:36:56.669931 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: ROLLBACK
[0m06:36:56.670445 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:36:56.671814 [info ] [Thread-1  ]: 8 of 18 PASS not_null_slvr_customers_customer_id ............................... [[32mPASS[0m in 0.13s]
[0m06:36:56.672959 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.674454 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: Close
[0m06:36:56.679303 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:36:56.680495 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:36:56.681481 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.682661 [info ] [Thread-3  ]: 9 of 18 PASS not_null_slvr_products_list_price ................................. [[32mPASS[0m in 0.12s]
[0m06:36:56.684752 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:36:56.687136 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:36:56.689473 [info ] [Thread-1  ]: 12 of 18 START test not_null_slvr_sales_orders_order_detail_id ................. [RUN]
[0m06:36:56.691636 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:36:56.693341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53)
[0m06:36:56.695275 [info ] [Thread-3  ]: 13 of 18 START test not_null_slvr_sales_orders_sales_order_id .................. [RUN]
[0m06:36:56.696178 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:36:56.697264 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:36:56.698439 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4)
[0m06:36:56.702401 [debug] [Thread-4  ]: local_md5(model.name): 9aed47cbdc8c4c391feec0e17f79c145
[0m06:36:56.703128 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.708831 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:36:56.709792 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:36:56.710756 [debug] [Thread-4  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.712900 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: ROLLBACK
[0m06:36:56.718847 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:36:56.720245 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:36:56.721358 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: Close
[0m06:36:56.724940 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:36:56.726255 [info ] [Thread-2  ]: 10 of 18 PASS not_null_slvr_products_product_id ................................ [[32mPASS[0m in 0.15s]
[0m06:36:56.732284 [debug] [Thread-1  ]: local_md5(model.name): ea59c6424fdef3f68e31047da36d4522
[0m06:36:56.732900 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:36:56.733931 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:36:56.734845 [debug] [Thread-1  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.739173 [debug] [Thread-3  ]: local_md5(model.name): 8afc66a1e810936eb9dee9b36ebd66ab
[0m06:36:56.741106 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:36:56.741635 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:36:56.742731 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:36:56.743630 [debug] [Thread-3  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.744441 [info ] [Thread-2  ]: 14 of 18 START test unique_gld_customer_metrics_customer_id .................... [RUN]
[0m06:36:56.745305 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_ece0f4bb735d56663866ae2bc12cc367]
   as 
    
    



select line_total
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where line_total is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_ece0f4bb735d56663866ae2bc12cc367]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_ece0f4bb735d56663866ae2bc12cc367]
  ;')
[0m06:36:56.747201 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:36:56.748243 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551, now test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd)
[0m06:36:56.749540 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:36:56.751147 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:36:56.752144 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.762275 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:36:56.762893 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:36:56.764137 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.765040 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:36:56.766341 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_badee04b5050884386efae34fccb62fc]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_badee04b5050884386efae34fccb62fc]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_badee04b5050884386efae34fccb62fc]
  ;')
[0m06:36:56.768178 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_65db2ca2621d414c4133822197561fce]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_65db2ca2621d414c4133822197561fce]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_65db2ca2621d414c4133822197561fce]
  ;')
[0m06:36:56.771078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:56.772642 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:56.773797 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.781994 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.783735 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.784166 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:36:56.784725 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.789581 [debug] [Thread-2  ]: local_md5(model.name): 09e4fbf108b34f10d79cdb74070d011e
[0m06:36:56.791793 [debug] [Thread-2  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.795043 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:36:56.799758 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.803253 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: ROLLBACK
[0m06:36:56.806011 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: Close
[0m06:36:56.807443 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:36:56.808379 [info ] [Thread-1  ]: 12 of 18 PASS not_null_slvr_sales_orders_order_detail_id ....................... [[32mPASS[0m in 0.12s]
[0m06:36:56.809270 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_c322287a88bfde68800f4c55c5163284]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_c322287a88bfde68800f4c55c5163284]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_c322287a88bfde68800f4c55c5163284]
  ;')
[0m06:36:56.810594 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:36:56.811498 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:36:56.812451 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:36:56.813446 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.814302 [info ] [Thread-1  ]: 15 of 18 START test unique_gld_product_performance_product_id .................. [RUN]
[0m06:36:56.815769 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.816740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53, now test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8)
[0m06:36:56.818486 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:36:56.825957 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:36:56.837325 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:36:56.842436 [debug] [Thread-1  ]: local_md5(model.name): 282efc8b63abc4326c2e3fe9cf80b2ea
[0m06:36:56.843043 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.844149 [debug] [Thread-1  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.847284 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: ROLLBACK
[0m06:36:56.848666 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:36:56.849748 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: Close
[0m06:36:56.851982 [info ] [Thread-3  ]: 13 of 18 PASS not_null_slvr_sales_orders_sales_order_id ........................ [[32mPASS[0m in 0.15s]
[0m06:36:56.853578 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:36:56.855242 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:36:56.856777 [info ] [Thread-3  ]: 16 of 18 START test unique_gld_sales_summary_order_date ........................ [RUN]
[0m06:36:56.858500 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4, now test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b)
[0m06:36:56.859801 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:36:56.867197 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:36:56.867677 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:36:56.869391 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_5878ef29014bb060ba3b0811bff071a2]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_5878ef29014bb060ba3b0811bff071a2]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_5878ef29014bb060ba3b0811bff071a2]
  ;')
[0m06:36:56.870763 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.871479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:36:56.874242 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: ROLLBACK
[0m06:36:56.874927 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.876437 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: Close
[0m06:36:56.877865 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.878601 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:36:56.879396 [info ] [Thread-2  ]: 14 of 18 PASS unique_gld_customer_metrics_customer_id .......................... [[32mPASS[0m in 0.13s]
[0m06:36:56.884036 [debug] [Thread-3  ]: local_md5(model.name): 9242e0fb865d08f661cf2dc3e20a299e
[0m06:36:56.885438 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:36:56.886485 [debug] [Thread-3  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.887815 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:36:56.890091 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:36:56.891780 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.891216 [info ] [Thread-2  ]: 17 of 18 START test unique_slvr_customers_customer_id .......................... [RUN]
[0m06:36:56.895157 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: ROLLBACK
[0m06:36:56.895823 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd, now test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600)
[0m06:36:56.896778 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: Close
[0m06:36:56.897631 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:36:56.899771 [info ] [Thread-4  ]: 11 of 18 PASS not_null_slvr_sales_orders_line_total ............................ [[32mPASS[0m in 0.23s]
[0m06:36:56.906549 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.907890 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:36:56.908248 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:36:56.909223 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:36:56.911194 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: ROLLBACK
[0m06:36:56.912518 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_4c0b5677077246e9825d6b4b62e4848b]
   as 
    
    

select
    order_date as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is not null
group by order_date
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_4c0b5677077246e9825d6b4b62e4848b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_4c0b5677077246e9825d6b4b62e4848b]
  ;')
[0m06:36:56.913604 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:36:56.914926 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: Close
[0m06:36:56.915648 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:36:56.916549 [info ] [Thread-4  ]: 18 of 18 START test unique_slvr_products_product_id ............................ [RUN]
[0m06:36:56.917997 [info ] [Thread-1  ]: 15 of 18 PASS unique_gld_product_performance_product_id ........................ [[32mPASS[0m in 0.10s]
[0m06:36:56.918862 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.920876 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d, now test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f)
[0m06:36:56.922280 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:36:56.923096 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:36:56.924198 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.925158 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:36:56.928471 [debug] [Thread-2  ]: local_md5(model.name): 4e2331c32d747d8df52121a664e91469
[0m06:36:56.934996 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:36:56.936265 [debug] [Thread-2  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.938809 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:36:56.946267 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:36:56.946971 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.952951 [debug] [Thread-4  ]: local_md5(model.name): 460bcc0c9f9b8191fcda43c5bbb8239e
[0m06:36:56.953418 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:36:56.956434 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: ROLLBACK
[0m06:36:56.957178 [debug] [Thread-4  ]: local_md5(invocation_id): 50e21db28cec6ec8f18dc8a17fcbde6b
[0m06:36:56.958222 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_c9718d2469b75ef2a30b72e4f9238788]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_c9718d2469b75ef2a30b72e4f9238788]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_c9718d2469b75ef2a30b72e4f9238788]
  ;')
[0m06:36:56.959157 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: Close
[0m06:36:56.960131 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:36:56.961069 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:36:56.962224 [info ] [Thread-3  ]: 16 of 18 PASS unique_gld_sales_summary_order_date .............................. [[32mPASS[0m in 0.10s]
[0m06:36:56.963805 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.965190 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:36:56.966484 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.973381 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:36:56.974583 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_db3ea9d79cc934217caceeee1272ec61]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_products"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_db3ea9d79cc934217caceeee1272ec61]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_db3ea9d79cc934217caceeee1272ec61]
  ;')
[0m06:36:56.975497 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:36:56.976393 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:36:56.977524 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:36:56.987320 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.990461 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: ROLLBACK
[0m06:36:56.991452 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: Close
[0m06:36:56.992714 [info ] [Thread-2  ]: 17 of 18 PASS unique_slvr_customers_customer_id ................................ [[32mPASS[0m in 0.10s]
[0m06:36:56.993229 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:36:56.994217 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:36:56.996271 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: ROLLBACK
[0m06:36:56.997421 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: Close
[0m06:36:56.998605 [info ] [Thread-4  ]: 18 of 18 PASS unique_slvr_products_product_id .................................. [[32mPASS[0m in 0.08s]
[0m06:36:57.000025 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:36:57.002601 [debug] [MainThread]: On master: COMMIT
[0m06:36:57.003811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:57.004904 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8' was properly closed.
[0m06:36:57.005786 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600' was properly closed.
[0m06:36:57.006534 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b' was properly closed.
[0m06:36:57.007204 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f' was properly closed.
[0m06:36:57.007974 [info ] [MainThread]: 
[0m06:36:57.008875 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m06:36:57.011909 [debug] [MainThread]: Command end result
[0m06:36:57.134993 [info ] [MainThread]: 
[0m06:36:57.136299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:36:57.138234 [info ] [MainThread]: 
[0m06:36:57.139679 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m06:36:57.141568 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8752542, "process_user_time": 2.411167, "process_kernel_time": 0.361269, "process_mem_max_rss": "126516", "process_in_blocks": "32", "process_out_blocks": "0"}
[0m06:36:57.142672 [debug] [MainThread]: Command `dbt test` succeeded at 06:36:57.142505 after 2.88 seconds
[0m06:36:57.143545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e64c8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e30d8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851e2ff62b0>]}
[0m06:36:57.144456 [debug] [MainThread]: Flushing usage events
[0m06:39:38.940295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d337a1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d3162a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d3162a580>]}


============================== 06:39:38.945872 | e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f ==============================
[0m06:39:38.945872 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:39:38.947859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:39:39.351171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d302be1c0>]}
[0m06:39:39.412707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d302cb4f0>]}
[0m06:39:39.414380 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:39:39.540787 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:39:40.622991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:40.624074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:40.672084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2fd41130>]}
[0m06:39:40.897032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d30366040>]}
[0m06:39:40.898201 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:39:40.899531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2fd68e50>]}
[0m06:39:40.902529 [info ] [MainThread]: 
[0m06:39:40.904763 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:39:40.911742 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:39:40.913581 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:39:40.914556 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:39:40.940126 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:40.942691 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:40.947667 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:40.949073 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:39:40.950000 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:39:40.951053 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:39:40.952307 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:40.953465 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:40.954569 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:40.955496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:40.956391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:40.957208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:40.958061 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:40.958956 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:40.959984 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.018557 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.019160 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.019508 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.024378 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:41.024776 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:41.025154 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:41.027354 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:39:41.029478 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:39:41.031150 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:39:41.035374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_silver)
[0m06:39:41.036538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m06:39:41.037727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_gold)
[0m06:39:41.046590 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:41.050641 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:41.055100 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:41.057239 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:39:41.059405 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:39:41.061572 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:39:41.062987 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:41.064224 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:41.065423 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:41.067439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:41.069017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:41.070290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:41.071287 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.072418 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.073613 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.074681 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.075462 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.076371 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.186624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:41.190074 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:39:41.191259 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:39:41.211043 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:41.213930 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:39:41.214391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:41.215382 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:39:41.217987 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:39:41.221461 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:39:41.224005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d3004d130>]}
[0m06:39:41.225224 [debug] [MainThread]: On master: COMMIT
[0m06:39:41.226357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:39:41.228316 [info ] [MainThread]: 
[0m06:39:41.233562 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m06:39:41.234395 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m06:39:41.235117 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m06:39:41.236360 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:39:41.238626 [info ] [Thread-1  ]: 1 of 10 START sql view model bronze.brnz_customers ............................. [RUN]
[0m06:39:41.240335 [info ] [Thread-2  ]: 2 of 10 START sql view model bronze.brnz_example ............................... [RUN]
[0m06:39:41.241603 [info ] [Thread-3  ]: 3 of 10 START sql view model bronze.brnz_products .............................. [RUN]
[0m06:39:41.243046 [info ] [Thread-4  ]: 4 of 10 START sql view model bronze.brnz_sales_orders .......................... [RUN]
[0m06:39:41.244355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now model.dbt_sqlserver_project.brnz_customers)
[0m06:39:41.245538 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_example)
[0m06:39:41.246632 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now model.dbt_sqlserver_project.brnz_products)
[0m06:39:41.247578 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m06:39:41.248410 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m06:39:41.249306 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m06:39:41.250619 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m06:39:41.252044 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:39:41.263910 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:39:41.272164 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m06:39:41.277346 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m06:39:41.289257 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:39:41.296791 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m06:39:41.298952 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m06:39:41.300055 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m06:39:41.306257 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:39:41.362885 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:39:41.363976 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m06:39:41.371821 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m06:39:41.378822 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:39:41.388107 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:39:41.389221 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:39:41.390905 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:39:41.391465 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:39:41.392670 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m06:39:41.393080 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:39:41.393726 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:39:41.394761 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m06:39:41.395742 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:39:41.396663 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m06:39:41.397504 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.398392 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:41.399705 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.401045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:41.403309 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.403134 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.404172 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.405332 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.407057 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.415526 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.419151 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.419774 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.430663 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:39:41.431396 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.440663 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:39:41.446604 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:39:41.447878 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m06:39:41.451629 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m06:39:41.453188 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m06:39:41.468611 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.469357 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.469877 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.470273 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.476340 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:39:41.482117 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:39:41.488571 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:39:41.494590 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:39:41.496139 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m06:39:41.497351 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m06:39:41.498776 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m06:39:41.500593 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m06:39:41.520307 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.521202 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.521725 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.522123 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.531074 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:39:41.550348 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m06:39:41.552312 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m06:39:41.554884 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m06:39:41.555949 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m06:39:41.563135 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m06:39:41.570112 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m06:39:41.574577 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m06:39:41.585684 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:39:41.586290 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.587503 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:39:41.589548 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:39:41.590643 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:39:41.592674 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m06:39:41.593423 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:39:41.594341 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:39:41.595215 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:41.600327 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m06:39:41.602091 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:41.603152 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:41.605833 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:39:41.607869 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.608731 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:39:41.609462 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.611207 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.612049 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:39:41.612980 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:41.616505 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:39:41.619119 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:39:41.619830 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m06:39:41.621767 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m06:39:41.622902 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m06:39:41.623868 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.629579 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:39:41.630948 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m06:39:41.636641 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.637439 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.638057 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.644292 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m06:39:41.647272 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m06:39:41.647730 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.652498 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m06:39:41.654101 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m06:39:41.655563 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m06:39:41.658192 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m06:39:41.660246 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m06:39:41.663361 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2fd68580>]}
[0m06:39:41.665876 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2fe2f280>]}
[0m06:39:41.668285 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m06:39:41.670160 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2fe2f190>]}
[0m06:39:41.671950 [info ] [Thread-2  ]: 2 of 10 OK created sql view model bronze.brnz_example .......................... [[32mOK[0m in 0.42s]
[0m06:39:41.673914 [info ] [Thread-4  ]: 4 of 10 OK created sql view model bronze.brnz_sales_orders ..................... [[32mOK[0m in 0.42s]
[0m06:39:41.675422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2fceff10>]}
[0m06:39:41.677316 [info ] [Thread-3  ]: 3 of 10 OK created sql view model bronze.brnz_products ......................... [[32mOK[0m in 0.42s]
[0m06:39:41.679126 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m06:39:41.680692 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:39:41.682655 [info ] [Thread-1  ]: 1 of 10 OK created sql view model bronze.brnz_customers ........................ [[32mOK[0m in 0.43s]
[0m06:39:41.685332 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m06:39:41.688774 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:39:41.689983 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m06:39:41.691862 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.slvr_products
[0m06:39:41.693250 [info ] [Thread-2  ]: 5 of 10 START sql table model silver.slvr_sales_orders ......................... [RUN]
[0m06:39:41.695462 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.slvr_customers
[0m06:39:41.696337 [info ] [Thread-4  ]: 6 of 10 START sql table model silver.slvr_products ............................. [RUN]
[0m06:39:41.697768 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_example, now model.dbt_sqlserver_project.slvr_sales_orders)
[0m06:39:41.699338 [info ] [Thread-3  ]: 7 of 10 START sql table model silver.slvr_customers ............................ [RUN]
[0m06:39:41.701773 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_sales_orders, now model.dbt_sqlserver_project.slvr_products)
[0m06:39:41.706121 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:39:41.708204 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_products, now model.dbt_sqlserver_project.slvr_customers)
[0m06:39:41.710066 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.slvr_products
[0m06:39:41.718417 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:41.719978 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.slvr_customers
[0m06:39:41.733206 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_products"
[0m06:39:41.739870 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:41.744828 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:39:41.746428 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.slvr_customers
[0m06:39:41.757792 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.slvr_products
[0m06:39:41.781064 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:39:41.790472 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:39:41.794892 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:39:41.799936 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw"
[0m06:39:41.807643 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw"
[0m06:39:41.814361 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw"
[0m06:39:41.818090 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:39:41.821242 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:39:41.824095 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:39:41.825664 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:41.826962 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:41.828045 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:39:41.829078 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_sales_orders__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:41.830406 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_customers__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:41.832090 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:41.834653 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:39:41.837163 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:41.839076 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:39:41.840630 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.842752 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.844391 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:41.845775 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.846758 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.847704 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:41.856009 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.856852 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.859401 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.860399 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:41.862386 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:41.864547 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:39:41.866767 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw";');

[0m06:39:41.870234 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw";');

[0m06:39:41.871900 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_products__dbt_tmp__dbt_tmp_vw";');

[0m06:39:41.876150 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.876703 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.877320 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:41.886221 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:41.889478 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:41.892120 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_products"
[0m06:39:41.899969 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:41.903251 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:41.904536 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" as 

with bronze_customers as (
    select * from "AdventureWorks2014"."bronze"."brnz_customers"
),

cleaned as (
    select
        CustomerID as customer_id,
        coalesce(FirstName, ''Unknown'') as first_name,
        coalesce(LastName, ''Unknown'') as last_name,
        concat(coalesce(FirstName, ''Unknown''), '' '', coalesce(LastName, ''Unknown'')) as full_name,
        EmailPromotion as email_promotion,
        StoreID as store_id,
        TerritoryID as territory_id,
        last_modified_date
    from bronze_customers
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_customers__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_customers__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_customers__dbt_tmp')
    )
    DROP index "silver"."slvr_customers__dbt_tmp".silver_slvr_customers__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_customers__dbt_tmp_cci
    ON "silver"."slvr_customers__dbt_tmp"

   


  
[0m06:39:41.905190 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:39:41.906334 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" as 

with bronze_sales as (
    select * from "AdventureWorks2014"."bronze"."brnz_sales_orders"
),

cleaned as (
    select
        sales_order_id,
        order_detail_id,
        order_date,
        due_date,
        ship_date,
        status,
        case 
            when online_order_flag = 1 then ''Online''
            else ''Offline''
        end as order_channel,
        sales_order_number,
        purchase_order_number,
        customer_id,
        sales_person_id,
        territory_id,
        product_id,
        order_qty,
        unit_price,
        unit_price_discount,
        line_total,
        -- Calculated fields
        unit_price * order_qty as gross_amount,
        line_total / nullif(order_qty, 0) as effective_unit_price,
        case 
            when unit_price_discount > 0 then 1
            else 0
        end as has_discount
    from bronze_sales
    where order_qty > 0
        and unit_price >= 0
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_sales_orders__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_sales_orders__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_sales_orders__dbt_tmp')
    )
    DROP index "silver"."slvr_sales_orders__dbt_tmp".silver_slvr_sales_orders__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_sales_orders__dbt_tmp_cci
    ON "silver"."slvr_sales_orders__dbt_tmp"

   


  
[0m06:39:41.908149 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_products__dbt_tmp__dbt_tmp_vw" as 

with bronze_products as (
    select * from "AdventureWorks2014"."bronze"."brnz_products"
),

cleaned as (
    select
        ProductID as product_id,
        ProductName as product_name,
        ProductNumber as product_number,
        coalesce(Color, ''N/A'') as color,
        StandardCost as standard_cost,
        ListPrice as list_price,
        coalesce(Size, ''N/A'') as size,
        coalesce(Weight, 0) as weight,
        ProductLine as product_line,
        Class as class,
        Style as style,
        ProductSubcategoryID as subcategory_id,
        coalesce(SubcategoryName, ''Uncategorized'') as subcategory_name,
        ProductCategoryID as category_id,
        SellStartDate as sell_start_date,
        SellEndDate as sell_end_date,
        case 
            when DiscontinuedDate is not null then 1
            else 0
        end as is_discontinued,
        last_modified_date
    from bronze_products
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_products__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_products__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_products__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_products__dbt_tmp')
    )
    DROP index "silver"."slvr_products__dbt_tmp".silver_slvr_products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_products__dbt_tmp_cci
    ON "silver"."slvr_products__dbt_tmp"

   


  
[0m06:39:42.092176 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.100519 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:39:42.102537 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products', 'slvr_products__dbt_backup'
[0m06:39:42.116539 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.125872 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:39:42.127714 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products__dbt_tmp', 'slvr_products'
[0m06:39:42.141070 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.149644 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: COMMIT
[0m06:39:42.154994 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_backup"
[0m06:39:42.156575 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:39:42.157639 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_products__dbt_backup";');

[0m06:39:42.170529 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.172787 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_products: Close
[0m06:39:42.174193 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2c5e22b0>]}
[0m06:39:42.175446 [info ] [Thread-4  ]: 6 of 10 OK created sql table model silver.slvr_products ........................ [[32mOK[0m in 0.47s]
[0m06:39:42.176820 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.slvr_products
[0m06:39:42.387257 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.392500 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:42.393582 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers', 'slvr_customers__dbt_backup'
[0m06:39:42.402291 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.408663 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:42.410379 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers__dbt_tmp', 'slvr_customers'
[0m06:39:42.421017 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.423861 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: COMMIT
[0m06:39:42.429411 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_backup"
[0m06:39:42.431727 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:39:42.433167 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_customers__dbt_backup";');

[0m06:39:42.448044 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:42.451398 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_customers: Close
[0m06:39:42.453525 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2de78d60>]}
[0m06:39:42.455326 [info ] [Thread-3  ]: 7 of 10 OK created sql table model silver.slvr_customers ....................... [[32mOK[0m in 0.75s]
[0m06:39:42.457095 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.slvr_customers
[0m06:39:43.403310 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m06:39:43.410413 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:43.411925 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders', 'slvr_sales_orders__dbt_backup'
[0m06:39:43.421701 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.427409 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:43.428876 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders__dbt_tmp', 'slvr_sales_orders'
[0m06:39:43.439082 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.442735 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: COMMIT
[0m06:39:43.503813 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_backup"
[0m06:39:43.505539 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:39:43.506730 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_sales_orders__dbt_backup";');

[0m06:39:43.524691 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.530521 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.slvr_sales_orders: Close
[0m06:39:43.532076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2c4c5a90>]}
[0m06:39:43.533525 [info ] [Thread-2  ]: 5 of 10 OK created sql table model silver.slvr_sales_orders .................... [[32mOK[0m in 1.83s]
[0m06:39:43.534767 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:39:43.536877 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:39:43.537297 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.gld_product_performance
[0m06:39:43.537653 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:39:43.538510 [info ] [Thread-1  ]: 8 of 10 START sql table model gold.gld_customer_metrics ........................ [RUN]
[0m06:39:43.539648 [info ] [Thread-4  ]: 9 of 10 START sql table model gold.gld_product_performance ..................... [RUN]
[0m06:39:43.541181 [info ] [Thread-3  ]: 10 of 10 START sql table model gold.gld_sales_summary .......................... [RUN]
[0m06:39:43.542239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_customers, now model.dbt_sqlserver_project.gld_customer_metrics)
[0m06:39:43.543161 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_products, now model.dbt_sqlserver_project.gld_product_performance)
[0m06:39:43.543973 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_customers, now model.dbt_sqlserver_project.gld_sales_summary)
[0m06:39:43.544835 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:39:43.545708 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.gld_product_performance
[0m06:39:43.546587 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.gld_sales_summary
[0m06:39:43.550665 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:43.554921 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:43.558685 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:43.564660 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:39:43.565505 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.gld_sales_summary
[0m06:39:43.570531 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:39:43.570991 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.gld_product_performance
[0m06:39:43.575489 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:39:43.579187 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw"
[0m06:39:43.584156 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:39:43.588188 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw"
[0m06:39:43.590203 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:39:43.594131 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw"
[0m06:39:43.595511 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:39:43.596578 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:43.597762 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:39:43.598769 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:43.599747 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_customer_metrics__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:43.600655 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:43.601588 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_sales_summary__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:43.602454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:43.603296 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_product_performance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:39:43.604280 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:43.605178 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:43.606073 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:39:43.607001 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:43.607981 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:43.608668 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:43.614108 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.619521 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:43.621469 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw";');

[0m06:39:43.624591 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.625140 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:43.628651 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:43.629201 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:43.632621 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.633725 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.635500 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:43.637580 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:43.638384 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw";');

[0m06:39:43.639663 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw";');

[0m06:39:43.640114 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:43.643286 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" as 

with customers as (
    select * from "AdventureWorks2014"."silver"."slvr_customers"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

customer_sales as (
    select
        c.customer_id,
        c.full_name,
        c.territory_id,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.line_total) as total_revenue,
        avg(s.line_total) as avg_order_value,
        sum(s.order_qty) as total_items_purchased,
        min(s.order_date) as first_order_date,
        max(s.order_date) as last_order_date,
        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount
    from customers c
    left join sales s
        on c.customer_id = s.customer_id
    group by c.customer_id, c.full_name, c.territory_id
)

select * from customer_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_customer_metrics__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_customer_metrics__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_customer_metrics__dbt_tmp')
    )
    DROP index "gold"."gld_customer_metrics__dbt_tmp".gold_gld_customer_metrics__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_customer_metrics__dbt_tmp_cci
    ON "gold"."gld_customer_metrics__dbt_tmp"

   


  
[0m06:39:43.643975 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.644465 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.647542 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:43.650490 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:43.657877 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:43.659776 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" as 

with products as (
    select * from "AdventureWorks2014"."silver"."slvr_products"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

product_sales as (
    select
        p.product_id,
        p.product_name,
        p.subcategory_name,
        p.color,
        p.list_price,
        p.standard_cost,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.order_qty) as total_quantity_sold,
        sum(s.line_total) as total_revenue,
        avg(s.unit_price) as avg_selling_price,
        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,
        case 
            when sum(s.order_qty) > 0 then 
                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100
            else 0
        end as profit_margin_pct
    from products p
    left join sales s
        on p.product_id = s.product_id
    group by 
        p.product_id, 
        p.product_name, 
        p.subcategory_name, 
        p.color, 
        p.list_price, 
        p.standard_cost
)

select * from product_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_product_performance__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_product_performance__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_product_performance__dbt_tmp')
    )
    DROP index "gold"."gld_product_performance__dbt_tmp".gold_gld_product_performance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_product_performance__dbt_tmp_cci
    ON "gold"."gld_product_performance__dbt_tmp"

   


  
[0m06:39:43.661849 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:43.662966 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" as 

with sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

daily_summary as (
    select
        cast(order_date as date) as order_date,
        count(distinct sales_order_id) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(order_qty) as total_items_sold,
        sum(line_total) as total_revenue,
        avg(line_total) as avg_order_line_value,
        sum(case when order_channel = ''Online'' then 1 else 0 end) as online_orders,
        sum(case when order_channel = ''Offline'' then 1 else 0 end) as offline_orders,
        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue
    from sales
    group by cast(order_date as date)
)

select * from daily_summary;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_sales_summary__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_sales_summary__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_sales_summary__dbt_tmp')
    )
    DROP index "gold"."gld_sales_summary__dbt_tmp".gold_gld_sales_summary__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_sales_summary__dbt_tmp_cci
    ON "gold"."gld_sales_summary__dbt_tmp"

   


  
[0m06:39:43.972092 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:43.979494 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:43.982910 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary', 'gld_sales_summary__dbt_backup'
[0m06:39:44.060458 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.066204 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:44.067798 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary__dbt_tmp', 'gld_sales_summary'
[0m06:39:44.083541 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.086824 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: COMMIT
[0m06:39:44.091068 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_backup"
[0m06:39:44.092775 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:39:44.093938 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_sales_summary__dbt_backup";');

[0m06:39:44.113380 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.116354 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: Close
[0m06:39:44.117888 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2c3daca0>]}
[0m06:39:44.119360 [info ] [Thread-3  ]: 10 of 10 OK created sql table model gold.gld_sales_summary ..................... [[32mOK[0m in 0.57s]
[0m06:39:44.121011 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:39:44.432727 [debug] [Thread-4  ]: SQL status: OK in 1.000 seconds
[0m06:39:44.441021 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:44.442749 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance', 'gld_product_performance__dbt_backup'
[0m06:39:44.452300 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.459725 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:44.461602 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance__dbt_tmp', 'gld_product_performance'
[0m06:39:44.470750 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.473605 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: COMMIT
[0m06:39:44.479313 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_backup"
[0m06:39:44.481191 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:39:44.482132 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_product_performance__dbt_backup";');

[0m06:39:44.489911 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.490576 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m06:39:44.492889 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.gld_product_performance: Close
[0m06:39:44.497258 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:44.498469 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2c3da4c0>]}
[0m06:39:44.499792 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics', 'gld_customer_metrics__dbt_backup'
[0m06:39:44.501251 [info ] [Thread-4  ]: 9 of 10 OK created sql table model gold.gld_product_performance ................ [[32mOK[0m in 0.96s]
[0m06:39:44.503414 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.gld_product_performance
[0m06:39:44.509327 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.514070 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:44.515477 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics__dbt_tmp', 'gld_customer_metrics'
[0m06:39:44.523639 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.526329 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: COMMIT
[0m06:39:44.530616 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_backup"
[0m06:39:44.532469 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:39:44.533686 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_customer_metrics__dbt_backup";');

[0m06:39:44.544226 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:44.546655 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_customer_metrics: Close
[0m06:39:44.547815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bf54a4-ee6e-45f4-b43a-37dc09b07a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2c3c8c40>]}
[0m06:39:44.549092 [info ] [Thread-1  ]: 8 of 10 OK created sql table model gold.gld_customer_metrics ................... [[32mOK[0m in 1.01s]
[0m06:39:44.550724 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:39:44.554009 [debug] [MainThread]: On master: COMMIT
[0m06:39:44.555892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:44.556825 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_customer_metrics' was properly closed.
[0m06:39:44.557793 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_sales_summary' was properly closed.
[0m06:39:44.558835 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.slvr_sales_orders' was properly closed.
[0m06:39:44.559812 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_product_performance' was properly closed.
[0m06:39:44.560888 [info ] [MainThread]: 
[0m06:39:44.562125 [info ] [MainThread]: Finished running 4 view models, 6 table models in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m06:39:44.564598 [debug] [MainThread]: Command end result
[0m06:39:44.636456 [info ] [MainThread]: 
[0m06:39:44.639068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:44.640647 [info ] [MainThread]: 
[0m06:39:44.642197 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m06:39:44.644621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.789586, "process_user_time": 2.61107, "process_kernel_time": 1.584868, "process_mem_max_rss": "125952", "process_in_blocks": "720", "process_out_blocks": "0"}
[0m06:39:44.645901 [debug] [MainThread]: Command `dbt run` succeeded at 06:39:44.645732 after 5.79 seconds
[0m06:39:44.647070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d337a1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d31cd5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2c4c29a0>]}
[0m06:39:44.648444 [debug] [MainThread]: Flushing usage events
[0m06:39:48.811417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a6769670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a5960610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a462e190>]}


============================== 06:39:48.815040 | a4aea9bf-d00f-497a-b730-04bf2cda0650 ==============================
[0m06:39:48.815040 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:39:48.816227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:39:49.049844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4aea9bf-d00f-497a-b730-04bf2cda0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a6547cd0>]}
[0m06:39:49.099868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4aea9bf-d00f-497a-b730-04bf2cda0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a3231910>]}
[0m06:39:49.101663 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:39:49.214072 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:39:50.172709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:50.174035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:50.220550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4aea9bf-d00f-497a-b730-04bf2cda0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a2d09130>]}
[0m06:39:50.433886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4aea9bf-d00f-497a-b730-04bf2cda0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a2ee4370>]}
[0m06:39:50.435560 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:39:50.437070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4aea9bf-d00f-497a-b730-04bf2cda0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a2d1aa60>]}
[0m06:39:50.441472 [info ] [MainThread]: 
[0m06:39:50.443562 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:39:50.453007 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m06:39:50.454837 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_gold'
[0m06:39:50.456509 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_silver'
[0m06:39:50.516230 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:50.517003 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:50.520836 [debug] [ThreadPool]: dbt-sqlserver
[0m06:39:50.522891 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:39:50.524508 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:39:50.526009 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:39:50.527647 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:50.529027 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:50.530132 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:39:50.531195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:50.531983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:50.532933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:50.533872 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.534643 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.535579 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.575904 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.576367 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.576802 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.581343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:50.581687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:50.584070 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:39:50.584409 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:39:50.585983 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:39:50.586594 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:39:50.588591 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:39:50.589386 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:39:50.591072 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:39:50.593650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4aea9bf-d00f-497a-b730-04bf2cda0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a3288dc0>]}
[0m06:39:50.594664 [debug] [MainThread]: On master: COMMIT
[0m06:39:50.595609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:39:50.596603 [info ] [MainThread]: 
[0m06:39:50.601976 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:39:50.602455 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:39:50.603050 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:39:50.603518 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:39:50.604238 [info ] [Thread-1  ]: 1 of 18 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:39:50.605222 [info ] [Thread-2  ]: 2 of 18 START test dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:39:50.606241 [info ] [Thread-3  ]: 3 of 18 START test not_null_brnz_sales_orders_order_detail_id .................. [RUN]
[0m06:39:50.607229 [info ] [Thread-4  ]: 4 of 18 START test not_null_brnz_sales_orders_sales_order_id ................... [RUN]
[0m06:39:50.608247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m06:39:50.609584 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc)
[0m06:39:50.610651 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac)
[0m06:39:50.611839 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m06:39:50.612712 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:39:50.613624 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:39:50.614471 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:39:50.615356 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:39:50.639616 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:39:50.645993 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:39:50.659969 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:39:50.667675 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:39:50.674786 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:39:50.676257 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:39:50.682308 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:39:50.692998 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:39:50.708144 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m06:39:50.710948 [debug] [Thread-4  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m06:39:50.714364 [debug] [Thread-3  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m06:39:50.719945 [debug] [Thread-2  ]: local_md5(model.name): fa6b3d9cc18a40cfba3de7295a3a38e6
[0m06:39:50.722236 [debug] [Thread-1  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.723508 [debug] [Thread-4  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.724653 [debug] [Thread-3  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.725697 [debug] [Thread-2  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.727093 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:39:50.728579 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:39:50.729981 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:39:50.731719 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:39:50.739811 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:39:50.740817 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:39:50.742573 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_d07da468a7bbbed7bb5c4976daca6a49]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_d07da468a7bbbed7bb5c4976daca6a49]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_d07da468a7bbbed7bb5c4976daca6a49]
  ;')
[0m06:39:50.743312 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:39:50.744533 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b1ec0faa27642ccde2922528466bc158]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b1ec0faa27642ccde2922528466bc158]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b1ec0faa27642ccde2922528466bc158]
  ;')
[0m06:39:50.745191 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:39:50.746479 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:39:50.747909 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_04ee08f3524e1903badc7f5fd9b8eb38]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_04ee08f3524e1903badc7f5fd9b8eb38]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_04ee08f3524e1903badc7f5fd9b8eb38]
  ;')
[0m06:39:50.749201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:50.750186 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a2505bbd52ce8966ed37ba43755dad4f]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."silver"."slvr_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a2505bbd52ce8966ed37ba43755dad4f]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a2505bbd52ce8966ed37ba43755dad4f]
  ;')
[0m06:39:50.751382 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.752275 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:50.753447 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.754550 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:39:50.755746 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.756461 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.757527 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.758194 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.759798 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.781332 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.786941 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:50.796281 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m06:39:50.797888 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m06:39:50.799659 [info ] [Thread-4  ]: 4 of 18 PASS not_null_brnz_sales_orders_sales_order_id ......................... [[32mPASS[0m in 0.19s]
[0m06:39:50.801295 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:39:50.802693 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:39:50.804010 [info ] [Thread-4  ]: 5 of 18 START test not_null_gld_customer_metrics_customer_id ................... [RUN]
[0m06:39:50.805745 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca, now test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39)
[0m06:39:50.806985 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:39:50.815801 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:39:50.828594 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:39:50.834750 [debug] [Thread-4  ]: local_md5(model.name): ac0d77cdfe99d22d2680c19319e8499c
[0m06:39:50.836573 [debug] [Thread-4  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.838840 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:39:50.853111 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:39:50.853689 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:50.854784 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_60148e53b54f67e016b985361d2de294]
   as 
    
    



select customer_id
from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_60148e53b54f67e016b985361d2de294]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_60148e53b54f67e016b985361d2de294]
  ;')
[0m06:39:50.857789 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m06:39:50.858655 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:39:50.859997 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m06:39:50.861090 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.862325 [info ] [Thread-3  ]: 3 of 18 PASS not_null_brnz_sales_orders_order_detail_id ........................ [[32mPASS[0m in 0.25s]
[0m06:39:50.863656 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.865001 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:39:50.867630 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:39:50.868859 [info ] [Thread-3  ]: 6 of 18 START test not_null_gld_product_performance_product_id ................. [RUN]
[0m06:39:50.870510 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac, now test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397)
[0m06:39:50.871954 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:39:50.879755 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:39:50.889711 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:39:50.895531 [debug] [Thread-3  ]: local_md5(model.name): a5b86011b8d22b04b2506841bc10c840
[0m06:39:50.896297 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:50.897895 [debug] [Thread-3  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.901027 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: ROLLBACK
[0m06:39:50.902653 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:39:50.904380 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: Close
[0m06:39:50.907057 [info ] [Thread-4  ]: 5 of 18 PASS not_null_gld_customer_metrics_customer_id ......................... [[32mPASS[0m in 0.10s]
[0m06:39:50.908750 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:39:50.910157 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:39:50.911509 [info ] [Thread-4  ]: 7 of 18 START test not_null_gld_sales_summary_order_date ....................... [RUN]
[0m06:39:50.913117 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39, now test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e)
[0m06:39:50.914325 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:39:50.926635 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:50.927215 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:39:50.927525 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:39:50.930071 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m06:39:50.930930 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_aaee992d5a7331b5b745c66e5e6816bd]
   as 
    
    



select product_id
from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_aaee992d5a7331b5b745c66e5e6816bd]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_aaee992d5a7331b5b745c66e5e6816bd]
  ;')
[0m06:39:50.932935 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m06:39:50.933879 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:50.935238 [info ] [Thread-1  ]: 1 of 18 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.33s]
[0m06:39:50.936596 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:50.938011 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:39:50.939026 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:50.940102 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:39:50.942551 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:50.943341 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:39:50.942980 [info ] [Thread-1  ]: 8 of 18 START test not_null_slvr_customers_customer_id ......................... [RUN]
[0m06:39:50.947070 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: ROLLBACK
[0m06:39:50.952523 [debug] [Thread-4  ]: local_md5(model.name): 31cffa58c58a08e4f0ecffd253b46aa2
[0m06:39:50.953836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902, now test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275)
[0m06:39:50.954958 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: Close
[0m06:39:50.955435 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:50.956233 [debug] [Thread-4  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.957231 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:39:50.958342 [info ] [Thread-2  ]: 2 of 18 PASS dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.35s]
[0m06:39:50.960589 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: ROLLBACK
[0m06:39:50.961449 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:39:50.966579 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:39:50.967914 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:39:50.968877 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: Close
[0m06:39:50.971406 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:39:50.972780 [info ] [Thread-3  ]: 6 of 18 PASS not_null_gld_product_performance_product_id ....................... [[32mPASS[0m in 0.10s]
[0m06:39:50.973850 [info ] [Thread-2  ]: 9 of 18 START test not_null_slvr_products_list_price ........................... [RUN]
[0m06:39:50.975477 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:39:50.976523 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc, now test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076)
[0m06:39:50.978386 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:39:50.979330 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:39:50.979946 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:39:50.980714 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:39:50.981864 [info ] [Thread-3  ]: 10 of 18 START test not_null_slvr_products_product_id .......................... [RUN]
[0m06:39:50.982815 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_4b70f36b456f72153d860bd15bf751b3]
   as 
    
    



select order_date
from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_4b70f36b456f72153d860bd15bf751b3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_4b70f36b456f72153d860bd15bf751b3]
  ;')
[0m06:39:50.986218 [debug] [Thread-1  ]: local_md5(model.name): 8e9f64ea0dd2dc40d032bf48fa566213
[0m06:39:50.994898 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:39:50.995890 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397, now test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551)
[0m06:39:50.996912 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:39:50.997847 [debug] [Thread-1  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:50.999445 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:39:51.000514 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.002101 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:39:51.008879 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:39:51.011163 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:39:51.018893 [debug] [Thread-2  ]: local_md5(model.name): d9ecc431b4a169296ca29c386f015286
[0m06:39:51.020458 [debug] [Thread-2  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.022025 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:39:51.025639 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:39:51.026660 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:39:51.028211 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a2c30c5b992e6e5de772dd7902a4d84e]
   as 
    
    



select customer_id
from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a2c30c5b992e6e5de772dd7902a4d84e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a2c30c5b992e6e5de772dd7902a4d84e]
  ;')
[0m06:39:51.029191 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:39:51.034450 [debug] [Thread-3  ]: local_md5(model.name): 6fbe07cd99985a105c0e61275b7ef592
[0m06:39:51.035065 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.035993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:51.037194 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b07f5d80ca6966ac134790cc96550be2]
   as 
    
    



select list_price
from "AdventureWorks2014"."silver"."slvr_products"
where list_price is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b07f5d80ca6966ac134790cc96550be2]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b07f5d80ca6966ac134790cc96550be2]
  ;')
[0m06:39:51.038248 [debug] [Thread-3  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.039944 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.040944 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:39:51.042246 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:39:51.043923 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.056262 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:39:51.057294 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.058206 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a6d856920f6ad5e122702eaf2e6fe1d9]
   as 
    
    



select product_id
from "AdventureWorks2014"."silver"."slvr_products"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a6d856920f6ad5e122702eaf2e6fe1d9]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a6d856920f6ad5e122702eaf2e6fe1d9]
  ;')
[0m06:39:51.060033 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:51.061690 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.062295 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.063003 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.066633 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: ROLLBACK
[0m06:39:51.069514 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: Close
[0m06:39:51.071491 [info ] [Thread-4  ]: 7 of 18 PASS not_null_gld_sales_summary_order_date ............................. [[32mPASS[0m in 0.16s]
[0m06:39:51.073495 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:39:51.074860 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:39:51.077271 [info ] [Thread-4  ]: 11 of 18 START test not_null_slvr_sales_orders_line_total ...................... [RUN]
[0m06:39:51.078631 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d)
[0m06:39:51.079750 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:39:51.080398 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.087379 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.088860 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:39:51.089629 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.091750 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: ROLLBACK
[0m06:39:51.095539 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: ROLLBACK
[0m06:39:51.096412 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: Close
[0m06:39:51.097561 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: Close
[0m06:39:51.099341 [info ] [Thread-1  ]: 8 of 18 PASS not_null_slvr_customers_customer_id ............................... [[32mPASS[0m in 0.15s]
[0m06:39:51.100542 [info ] [Thread-2  ]: 9 of 18 PASS not_null_slvr_products_list_price ................................. [[32mPASS[0m in 0.12s]
[0m06:39:51.102429 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:39:51.103766 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:39:51.104163 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:39:51.104930 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:39:51.106039 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:39:51.106769 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.109670 [debug] [Thread-4  ]: local_md5(model.name): 9aed47cbdc8c4c391feec0e17f79c145
[0m06:39:51.110562 [info ] [Thread-1  ]: 12 of 18 START test not_null_slvr_sales_orders_order_detail_id ................. [RUN]
[0m06:39:51.111568 [info ] [Thread-2  ]: 13 of 18 START test not_null_slvr_sales_orders_sales_order_id .................. [RUN]
[0m06:39:51.114503 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: ROLLBACK
[0m06:39:51.115157 [debug] [Thread-4  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.116196 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53)
[0m06:39:51.117168 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4)
[0m06:39:51.118024 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: Close
[0m06:39:51.119031 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:39:51.119877 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:39:51.120696 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:39:51.121909 [info ] [Thread-3  ]: 10 of 18 PASS not_null_slvr_products_product_id ................................ [[32mPASS[0m in 0.13s]
[0m06:39:51.129572 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:39:51.136140 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:39:51.137766 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:39:51.138299 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:39:51.140360 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:39:51.141341 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b7ea1b44a33e2b1643ced15e97cb1164]
   as 
    
    



select line_total
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where line_total is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b7ea1b44a33e2b1643ced15e97cb1164]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b7ea1b44a33e2b1643ced15e97cb1164]
  ;')
[0m06:39:51.142643 [info ] [Thread-3  ]: 14 of 18 START test unique_gld_customer_metrics_customer_id .................... [RUN]
[0m06:39:51.143787 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:39:51.145165 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551, now test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd)
[0m06:39:51.147089 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.147712 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:39:51.149115 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:39:51.150216 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:39:51.150675 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.154555 [debug] [Thread-1  ]: local_md5(model.name): ea59c6424fdef3f68e31047da36d4522
[0m06:39:51.162634 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:39:51.165859 [debug] [Thread-2  ]: local_md5(model.name): 8afc66a1e810936eb9dee9b36ebd66ab
[0m06:39:51.167782 [debug] [Thread-1  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.169581 [debug] [Thread-2  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.171031 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:39:51.172426 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:39:51.177430 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:39:51.184887 [debug] [Thread-3  ]: local_md5(model.name): 09e4fbf108b34f10d79cdb74070d011e
[0m06:39:51.186081 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:39:51.186898 [debug] [Thread-3  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.187278 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:39:51.188033 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_2700eddb1d9bb7118b35963f7606782e]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_2700eddb1d9bb7118b35963f7606782e]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_2700eddb1d9bb7118b35963f7606782e]
  ;')
[0m06:39:51.189882 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:39:51.191203 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_45cc5cc1f960b519178c33b1b6e83fb1]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_45cc5cc1f960b519178c33b1b6e83fb1]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_45cc5cc1f960b519178c33b1b6e83fb1]
  ;')
[0m06:39:51.192370 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:39:51.194085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:51.194989 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.196019 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.197215 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.198230 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.202955 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:39:51.204240 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_bc85cbc00fbf07b00e1ba05c39f45ed6]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_bc85cbc00fbf07b00e1ba05c39f45ed6]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_bc85cbc00fbf07b00e1ba05c39f45ed6]
  ;')
[0m06:39:51.205258 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:51.206213 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.207110 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.214682 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.215257 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.217886 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: ROLLBACK
[0m06:39:51.220593 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: ROLLBACK
[0m06:39:51.221257 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: Close
[0m06:39:51.222054 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: Close
[0m06:39:51.223014 [info ] [Thread-2  ]: 13 of 18 PASS not_null_slvr_sales_orders_sales_order_id ........................ [[32mPASS[0m in 0.11s]
[0m06:39:51.224078 [info ] [Thread-1  ]: 12 of 18 PASS not_null_slvr_sales_orders_order_detail_id ....................... [[32mPASS[0m in 0.11s]
[0m06:39:51.225225 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:39:51.226481 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:39:51.227552 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:39:51.228619 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:39:51.229586 [info ] [Thread-2  ]: 15 of 18 START test unique_gld_product_performance_product_id .................. [RUN]
[0m06:39:51.230665 [info ] [Thread-1  ]: 16 of 18 START test unique_gld_sales_summary_order_date ........................ [RUN]
[0m06:39:51.232089 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4, now test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8)
[0m06:39:51.233514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53, now test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b)
[0m06:39:51.234838 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:39:51.236035 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:39:51.243249 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:39:51.250285 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:39:51.256843 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:39:51.261580 [debug] [Thread-1  ]: local_md5(model.name): 9242e0fb865d08f661cf2dc3e20a299e
[0m06:39:51.261976 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:39:51.262763 [debug] [Thread-1  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.265884 [debug] [Thread-2  ]: local_md5(model.name): 282efc8b63abc4326c2e3fe9cf80b2ea
[0m06:39:51.267553 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:39:51.268736 [debug] [Thread-2  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.270389 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.271537 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:39:51.274022 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: ROLLBACK
[0m06:39:51.275364 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: Close
[0m06:39:51.276599 [info ] [Thread-3  ]: 14 of 18 PASS unique_gld_customer_metrics_customer_id .......................... [[32mPASS[0m in 0.13s]
[0m06:39:51.278933 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:39:51.279718 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:39:51.281342 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:39:51.282154 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:39:51.282672 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b2633ec24c4c9a3dbd2004078ba4185b]
   as 
    
    

select
    order_date as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is not null
group by order_date
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b2633ec24c4c9a3dbd2004078ba4185b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b2633ec24c4c9a3dbd2004078ba4185b]
  ;')
[0m06:39:51.283615 [info ] [Thread-3  ]: 17 of 18 START test unique_slvr_customers_customer_id .......................... [RUN]
[0m06:39:51.284562 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_63bca6c46ad8a023b543d2caa6f7a0fe]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_63bca6c46ad8a023b543d2caa6f7a0fe]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_63bca6c46ad8a023b543d2caa6f7a0fe]
  ;')
[0m06:39:51.285511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:51.286501 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd, now test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600)
[0m06:39:51.287387 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:39:51.288262 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.289140 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:39:51.289982 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.290933 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.295995 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:39:51.297226 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.301636 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.304038 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: ROLLBACK
[0m06:39:51.305032 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: Close
[0m06:39:51.307003 [info ] [Thread-4  ]: 11 of 18 PASS not_null_slvr_sales_orders_line_total ............................ [[32mPASS[0m in 0.23s]
[0m06:39:51.307699 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:39:51.308973 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:39:51.313002 [debug] [Thread-3  ]: local_md5(model.name): 4e2331c32d747d8df52121a664e91469
[0m06:39:51.313981 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.314698 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:39:51.315768 [debug] [Thread-3  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.318179 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: ROLLBACK
[0m06:39:51.318703 [info ] [Thread-4  ]: 18 of 18 START test unique_slvr_products_product_id ............................ [RUN]
[0m06:39:51.319692 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.320404 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:39:51.321367 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: Close
[0m06:39:51.322375 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d, now test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f)
[0m06:39:51.324646 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: ROLLBACK
[0m06:39:51.326092 [info ] [Thread-1  ]: 16 of 18 PASS unique_gld_sales_summary_order_date .............................. [[32mPASS[0m in 0.09s]
[0m06:39:51.326787 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:39:51.327814 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: Close
[0m06:39:51.328689 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:39:51.335155 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:39:51.336599 [info ] [Thread-2  ]: 15 of 18 PASS unique_gld_product_performance_product_id ........................ [[32mPASS[0m in 0.10s]
[0m06:39:51.337199 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:39:51.339661 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:39:51.340580 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_1c64c86e5472c5998088936aa838dcbb]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_1c64c86e5472c5998088936aa838dcbb]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_1c64c86e5472c5998088936aa838dcbb]
  ;')
[0m06:39:51.342162 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:39:51.343029 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.343981 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.347251 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:39:51.351481 [debug] [Thread-4  ]: local_md5(model.name): 460bcc0c9f9b8191fcda43c5bbb8239e
[0m06:39:51.352529 [debug] [Thread-4  ]: local_md5(invocation_id): 77254bbd931197798c6558e625cb1ee1
[0m06:39:51.353771 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:39:51.361986 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:39:51.363253 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_8c171dab55a77282776243c52c291018]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_products"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_8c171dab55a77282776243c52c291018]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_8c171dab55a77282776243c52c291018]
  ;')
[0m06:39:51.364400 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:39:51.365382 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:39:51.366334 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:39:51.367402 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.369653 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: ROLLBACK
[0m06:39:51.370693 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: Close
[0m06:39:51.371771 [info ] [Thread-3  ]: 17 of 18 PASS unique_slvr_customers_customer_id ................................ [[32mPASS[0m in 0.09s]
[0m06:39:51.373058 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:39:51.380501 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:39:51.382611 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: ROLLBACK
[0m06:39:51.383488 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: Close
[0m06:39:51.384467 [info ] [Thread-4  ]: 18 of 18 PASS unique_slvr_products_product_id .................................. [[32mPASS[0m in 0.06s]
[0m06:39:51.385597 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:39:51.388055 [debug] [MainThread]: On master: COMMIT
[0m06:39:51.389068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:51.389884 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b' was properly closed.
[0m06:39:51.390585 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8' was properly closed.
[0m06:39:51.391260 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600' was properly closed.
[0m06:39:51.391955 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f' was properly closed.
[0m06:39:51.392691 [info ] [MainThread]: 
[0m06:39:51.393590 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m06:39:51.396610 [debug] [MainThread]: Command end result
[0m06:39:51.506138 [info ] [MainThread]: 
[0m06:39:51.507287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:51.508541 [info ] [MainThread]: 
[0m06:39:51.509613 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m06:39:51.511169 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7654757, "process_user_time": 2.192263, "process_kernel_time": 0.50528, "process_mem_max_rss": "126920", "process_in_blocks": "88", "process_out_blocks": "0"}
[0m06:39:51.512218 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:51.512060 after 2.77 seconds
[0m06:39:51.513074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a6769670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a52cde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692a3231910>]}
[0m06:39:51.513971 [debug] [MainThread]: Flushing usage events
[0m06:44:37.127737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6663fe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6655f6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6642c2190>]}


============================== 06:44:37.131529 | 0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d ==============================
[0m06:44:37.131529 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:44:37.132760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:44:37.371969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6661ddcd0>]}
[0m06:44:37.421590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b662ec7910>]}
[0m06:44:37.423840 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:44:37.519985 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:44:38.466433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:44:38.467494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:44:38.511679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b66299f130>]}
[0m06:44:38.730071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b662f85d30>]}
[0m06:44:38.731204 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:44:38.732266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6629c6f10>]}
[0m06:44:38.735893 [info ] [MainThread]: 
[0m06:44:38.737440 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:44:38.744577 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:44:38.746146 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:44:38.746955 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014'
[0m06:44:38.770022 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:38.772407 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:38.777421 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:38.779343 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:44:38.780961 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:44:38.782704 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014"
[0m06:44:38.784691 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:38.786101 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:38.787429 [debug] [ThreadPool]: On list_AdventureWorks2014: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014"} */
USE [AdventureWorks2014];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:38.788871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:38.790353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:38.791626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:38.792876 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:38.793830 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:38.794702 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:38.827531 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:38.827920 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:38.828347 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:38.830648 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:38.831028 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:38.831892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:38.833472 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:44:38.835142 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:44:38.836617 [debug] [ThreadPool]: On list_AdventureWorks2014: Close
[0m06:44:38.840514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_silver)
[0m06:44:38.841224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_gold)
[0m06:44:38.841803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AdventureWorks2014, now list_AdventureWorks2014_bronze)
[0m06:44:38.849391 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:38.853860 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:38.857131 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:38.859157 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:44:38.860868 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:44:38.862140 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:44:38.863196 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:38.864109 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:38.864981 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:38.865808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:44:38.866532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:44:38.867292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:44:38.868199 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:38.869113 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:38.869967 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:38.870884 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:38.871470 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:38.872079 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:38.876907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:38.877233 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:38.879013 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:44:38.879294 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:38.880995 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:44:38.881679 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:44:38.883416 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:44:38.883875 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:44:38.885608 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:44:38.888109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b662de77f0>]}
[0m06:44:38.888955 [debug] [MainThread]: On master: COMMIT
[0m06:44:38.889792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:44:38.890653 [info ] [MainThread]: 
[0m06:44:38.895953 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.brnz_customers
[0m06:44:38.896382 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.brnz_example
[0m06:44:38.896764 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.brnz_products
[0m06:44:38.897111 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:44:38.897876 [info ] [Thread-1  ]: 1 of 10 START sql view model bronze.brnz_customers ............................. [RUN]
[0m06:44:38.898919 [info ] [Thread-2  ]: 2 of 10 START sql view model bronze.brnz_example ............................... [RUN]
[0m06:44:38.900008 [info ] [Thread-3  ]: 3 of 10 START sql view model bronze.brnz_products .............................. [RUN]
[0m06:44:38.901096 [info ] [Thread-4  ]: 4 of 10 START sql view model bronze.brnz_sales_orders .......................... [RUN]
[0m06:44:38.902269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now model.dbt_sqlserver_project.brnz_customers)
[0m06:44:38.903256 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now model.dbt_sqlserver_project.brnz_example)
[0m06:44:38.904233 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now model.dbt_sqlserver_project.brnz_products)
[0m06:44:38.905182 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'model.dbt_sqlserver_project.brnz_sales_orders'
[0m06:44:38.906070 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.brnz_customers
[0m06:44:38.906879 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.brnz_example
[0m06:44:38.907685 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.brnz_products
[0m06:44:38.908540 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:44:38.919988 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:44:38.924530 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_example"
[0m06:44:38.929325 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_products"
[0m06:44:38.934673 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:44:38.941391 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.brnz_products
[0m06:44:38.942630 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.brnz_customers
[0m06:44:38.943194 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.brnz_example
[0m06:44:38.949394 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:44:38.990976 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_customers"
[0m06:44:38.992067 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_products"
[0m06:44:38.996267 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_example"
[0m06:44:39.002002 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:44:39.011946 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:44:39.013007 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:44:39.014011 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_sales_orders__dbt_tmp" as with sales_order_header as (
    select
        SalesOrderID as sales_order_id,
        OrderDate as order_date,
        DueDate as due_date,
        ShipDate as ship_date,
        Status as status,
        OnlineOrderFlag as online_order_flag,
        SalesOrderNumber as sales_order_number,
        PurchaseOrderNumber as purchase_order_number,
        CustomerID as customer_id,
        SalesPersonID as sales_person_id,
        TerritoryID as territory_id
    from "AdventureWorks2014"."Sales"."SalesOrderHeader"
),

sales_order_detail as (
    select
        SalesOrderDetailID as order_detail_id,
        SalesOrderID as sales_order_id,
        ProductID as product_id,
        OrderQty as order_qty,
        UnitPrice as unit_price,
        UnitPriceDiscount as unit_price_discount,
        LineTotal as line_total
    from "AdventureWorks2014"."Sales"."SalesOrderDetail"
)

select
    h.sales_order_id,
    h.order_date,
    h.due_date,
    h.ship_date,
    h.status,
    h.online_order_flag,
    h.sales_order_number,
    h.purchase_order_number,
    h.customer_id,
    h.sales_person_id,
    h.territory_id,
    d.order_detail_id,
    d.product_id,
    d.order_qty,
    d.unit_price,
    d.unit_price_discount,
    d.line_total
from sales_order_header h
left join sales_order_detail d
    on h.sales_order_id = d.sales_order_id;
    ')


[0m06:44:39.014572 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:44:39.015354 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:44:39.016175 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_customers__dbt_tmp" as 

with source as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

person as (
    select * from "AdventureWorks2014"."Person"."Person"
),

staged as (
    select
        c.CustomerID,
        p.FirstName,
        p.LastName,
        p.EmailPromotion,
        c.StoreID,
        c.TerritoryID,
        c.ModifiedDate as last_modified_date
    from source c
    left join person p
        on c.PersonID = p.BusinessEntityID
)

select * from staged;
    ')


[0m06:44:39.017236 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:44:39.018158 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_example__dbt_tmp" as 

with source_data as (
    select * from "AdventureWorks2014"."Sales"."Customer"
),

transformed as (
    select
        CustomerID as id,
        AccountNumber as name,
        ModifiedDate as created_at,
        ModifiedDate as updated_at
    from source_data
)

select * from transformed;
    ')


[0m06:44:39.019076 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "bronze"."brnz_products__dbt_tmp" as with product as (
    select * from "AdventureWorks2014"."Production"."Product"
),

product_subcategory as (
    select * from "AdventureWorks2014"."Production"."ProductSubcategory"
),

staged as (
    select
        p.ProductID,
        p.Name as ProductName,
        p.ProductNumber,
        p.MakeFlag,
        p.FinishedGoodsFlag,
        p.Color,
        p.SafetyStockLevel,
        p.ReorderPoint,
        p.StandardCost,
        p.ListPrice,
        p.Size,
        p.SizeUnitMeasureCode,
        p.WeightUnitMeasureCode,
        p.Weight,
        p.DaysToManufacture,
        p.ProductLine,
        p.Class,
        p.Style,
        p.ProductSubcategoryID,
        p.ProductModelID,
        p.SellStartDate,
        p.SellEndDate,
        p.DiscontinuedDate,
        ps.Name as SubcategoryName,
        ps.ProductCategoryID,
        p.ModifiedDate as last_modified_date
    from product p
    left join product_subcategory ps
        on p.ProductSubcategoryID = ps.ProductSubcategoryID
)

select * from staged;
    ')


[0m06:44:39.020199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:44:39.021472 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:39.022444 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:44:39.023270 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:44:39.024177 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:39.025748 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:39.027305 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:39.040528 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:39.041053 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:39.041535 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:39.041894 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:39.053535 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.053995 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.054560 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.054865 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.061439 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:44:39.065258 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:44:39.069588 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:44:39.073741 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:44:39.075156 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products', 'brnz_products__dbt_backup'
[0m06:44:39.076145 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers', 'brnz_customers__dbt_backup'
[0m06:44:39.077027 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example', 'brnz_example__dbt_backup'
[0m06:44:39.077869 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders', 'brnz_sales_orders__dbt_backup'
[0m06:44:39.088326 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.088820 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.089238 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.089638 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.095100 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:44:39.099224 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:44:39.103470 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:44:39.107688 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:44:39.109345 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_sales_orders__dbt_tmp', 'brnz_sales_orders'
[0m06:44:39.110713 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_example__dbt_tmp', 'brnz_example'
[0m06:44:39.111909 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_customers__dbt_tmp', 'brnz_customers'
[0m06:44:39.112979 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'bronze.brnz_products__dbt_tmp', 'brnz_products'
[0m06:44:39.124852 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.125342 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.125740 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.126161 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.145664 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: COMMIT
[0m06:44:39.147532 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: COMMIT
[0m06:44:39.150512 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: COMMIT
[0m06:44:39.152589 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: COMMIT
[0m06:44:39.162761 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_example__dbt_backup"
[0m06:44:39.167073 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_customers__dbt_backup"
[0m06:44:39.171060 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_sales_orders__dbt_backup"
[0m06:44:39.174657 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."bronze"."brnz_products__dbt_backup"
[0m06:44:39.181755 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:44:39.183017 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:44:39.184771 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:44:39.186291 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:44:39.187306 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:44:39.188346 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:44:39.189268 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:44:39.190214 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:44:39.191144 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_example__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:39.192048 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:39.192981 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_sales_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:39.193980 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'bronze'
        and refs.referenced_entity_name = 'brnz_products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:39.231216 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.235473 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.239319 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_sales_orders"
[0m06:44:39.242206 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_customers"
[0m06:44:39.242784 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.243492 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_sales_orders__dbt_backup";');

[0m06:44:39.244762 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_customers__dbt_backup";');

[0m06:44:39.247244 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_products"
[0m06:44:39.250326 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_products__dbt_backup";');

[0m06:44:39.257218 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.257715 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.261056 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: ROLLBACK
[0m06:44:39.263812 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: ROLLBACK
[0m06:44:39.264531 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.brnz_customers: Close
[0m06:44:39.265316 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.brnz_sales_orders: Close
[0m06:44:39.267481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b662ebec70>]}
[0m06:44:39.267940 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.269052 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b662a9e1f0>]}
[0m06:44:39.270137 [info ] [Thread-1  ]: 1 of 10 OK created sql view model bronze.brnz_customers ........................ [[32mOK[0m in 0.36s]
[0m06:44:39.272499 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: ROLLBACK
[0m06:44:39.273549 [info ] [Thread-4  ]: 4 of 10 OK created sql view model bronze.brnz_sales_orders ..................... [[32mOK[0m in 0.36s]
[0m06:44:39.275028 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.brnz_customers
[0m06:44:39.276046 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.brnz_products: Close
[0m06:44:39.281279 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.brnz_sales_orders
[0m06:44:39.281990 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.283626 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.slvr_customers
[0m06:44:39.284383 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b662de7ca0>]}
[0m06:44:39.285750 [debug] [Thread-4  ]: Began running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:44:39.287583 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.brnz_example"
[0m06:44:39.288219 [info ] [Thread-1  ]: 5 of 10 START sql table model silver.slvr_customers ............................ [RUN]
[0m06:44:39.289337 [info ] [Thread-3  ]: 3 of 10 OK created sql view model bronze.brnz_products ......................... [[32mOK[0m in 0.38s]
[0m06:44:39.290489 [info ] [Thread-4  ]: 6 of 10 START sql table model silver.slvr_sales_orders ......................... [RUN]
[0m06:44:39.291486 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.brnz_example"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "bronze"."brnz_example__dbt_backup";');

[0m06:44:39.292344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_customers, now model.dbt_sqlserver_project.slvr_customers)
[0m06:44:39.293363 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.brnz_products
[0m06:44:39.294185 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_sales_orders, now model.dbt_sqlserver_project.slvr_sales_orders)
[0m06:44:39.295742 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.slvr_customers
[0m06:44:39.297179 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.slvr_products
[0m06:44:39.297688 [debug] [Thread-4  ]: Began compiling node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:44:39.301705 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.302855 [info ] [Thread-3  ]: 7 of 10 START sql table model silver.slvr_products ............................. [RUN]
[0m06:44:39.308196 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:39.308649 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.310084 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_products, now model.dbt_sqlserver_project.slvr_products)
[0m06:44:39.312895 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: ROLLBACK
[0m06:44:39.314342 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.slvr_products
[0m06:44:39.314872 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.slvr_customers
[0m06:44:39.315995 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.brnz_example: Close
[0m06:44:39.316477 [debug] [Thread-4  ]: Began executing node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:44:39.321441 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.344669 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:44:39.345296 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b66294fa60>]}
[0m06:44:39.350093 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:44:39.356377 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw"
[0m06:44:39.357667 [info ] [Thread-2  ]: 2 of 10 OK created sql view model bronze.brnz_example .......................... [[32mOK[0m in 0.44s]
[0m06:44:39.361285 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw"
[0m06:44:39.362881 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:44:39.363694 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.slvr_products
[0m06:44:39.364340 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.brnz_example
[0m06:44:39.365590 [debug] [Thread-4  ]: dbt-sqlserver
[0m06:44:39.366470 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.371076 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:44:39.372825 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:39.373653 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_customers__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:39.376755 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw"
[0m06:44:39.377694 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_sales_orders__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:39.378540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:44:39.379788 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:44:39.380676 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:44:39.381451 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:39.382342 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.383211 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:39.384167 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:39.384760 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'silver'
        and refs.referenced_entity_name = 'slvr_products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:39.385740 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:39.387084 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:44:39.396288 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:39.396830 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.397666 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:39.399501 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.400876 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw";');

[0m06:44:39.403382 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.408872 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.410503 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.413268 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:39.414397 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw";');

[0m06:44:39.414912 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.417659 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.418140 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.419033 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "silver"."slvr_products__dbt_tmp__dbt_tmp_vw";');

[0m06:44:39.419504 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.421506 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:39.423093 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" as 

with bronze_customers as (
    select * from "AdventureWorks2014"."bronze"."brnz_customers"
),

cleaned as (
    select
        CustomerID as customer_id,
        coalesce(FirstName, ''Unknown'') as first_name,
        coalesce(LastName, ''Unknown'') as last_name,
        concat(coalesce(FirstName, ''Unknown''), '' '', coalesce(LastName, ''Unknown'')) as full_name,
        EmailPromotion as email_promotion,
        StoreID as store_id,
        TerritoryID as territory_id,
        last_modified_date
    from bronze_customers
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_customers__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_customers__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_customers__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_customers__dbt_tmp')
    )
    DROP index "silver"."slvr_customers__dbt_tmp".silver_slvr_customers__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_customers__dbt_tmp_cci
    ON "silver"."slvr_customers__dbt_tmp"

   


  
[0m06:44:39.424206 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.427117 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.432063 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.432895 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:39.433692 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_products__dbt_tmp__dbt_tmp_vw" as 

with bronze_products as (
    select * from "AdventureWorks2014"."bronze"."brnz_products"
),

cleaned as (
    select
        ProductID as product_id,
        ProductName as product_name,
        ProductNumber as product_number,
        coalesce(Color, ''N/A'') as color,
        StandardCost as standard_cost,
        ListPrice as list_price,
        coalesce(Size, ''N/A'') as size,
        coalesce(Weight, 0) as weight,
        ProductLine as product_line,
        Class as class,
        Style as style,
        ProductSubcategoryID as subcategory_id,
        coalesce(SubcategoryName, ''Uncategorized'') as subcategory_name,
        ProductCategoryID as category_id,
        SellStartDate as sell_start_date,
        SellEndDate as sell_end_date,
        case 
            when DiscontinuedDate is not null then 1
            else 0
        end as is_discontinued,
        last_modified_date
    from bronze_products
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_products__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_products__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_products__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_products__dbt_tmp')
    )
    DROP index "silver"."slvr_products__dbt_tmp".silver_slvr_products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_products__dbt_tmp_cci
    ON "silver"."slvr_products__dbt_tmp"

   


  
[0m06:44:39.434712 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" as 

with bronze_sales as (
    select * from "AdventureWorks2014"."bronze"."brnz_sales_orders"
),

cleaned as (
    select
        sales_order_id,
        order_detail_id,
        order_date,
        due_date,
        ship_date,
        status,
        case 
            when online_order_flag = 1 then ''Online''
            else ''Offline''
        end as order_channel,
        sales_order_number,
        purchase_order_number,
        customer_id,
        sales_person_id,
        territory_id,
        product_id,
        order_qty,
        unit_price,
        unit_price_discount,
        line_total,
        -- Calculated fields
        unit_price * order_qty as gross_amount,
        line_total / nullif(order_qty, 0) as effective_unit_price,
        case 
            when unit_price_discount > 0 then 1
            else 0
        end as has_discount
    from bronze_sales
    where order_qty > 0
        and unit_price >= 0
)

select * from cleaned;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp" FROM "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS silver.slvr_sales_orders__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'silver_slvr_sales_orders__dbt_tmp_cci'
        AND object_id=object_id('silver_slvr_sales_orders__dbt_tmp')
    )
    DROP index "silver"."slvr_sales_orders__dbt_tmp".silver_slvr_sales_orders__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX silver_slvr_sales_orders__dbt_tmp_cci
    ON "silver"."slvr_sales_orders__dbt_tmp"

   


  
[0m06:44:39.621315 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.626084 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.627287 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers', 'slvr_customers__dbt_backup'
[0m06:44:39.636841 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.641418 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.641835 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.642655 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_customers__dbt_tmp', 'slvr_customers'
[0m06:44:39.646782 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.648274 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products', 'slvr_products__dbt_backup'
[0m06:44:39.655476 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.662411 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: COMMIT
[0m06:44:39.666533 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_customers__dbt_backup"
[0m06:44:39.667878 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_customers"
[0m06:44:39.668889 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_customers"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_customers__dbt_backup";');

[0m06:44:39.669314 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.675774 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.676944 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_products__dbt_tmp', 'slvr_products'
[0m06:44:39.680191 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.683528 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.slvr_customers: Close
[0m06:44:39.684927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6602cbc10>]}
[0m06:44:39.686481 [info ] [Thread-1  ]: 5 of 10 OK created sql table model silver.slvr_customers ....................... [[32mOK[0m in 0.39s]
[0m06:44:39.686993 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.688071 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.slvr_customers
[0m06:44:39.690233 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: COMMIT
[0m06:44:39.693992 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_products__dbt_backup"
[0m06:44:39.695268 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_products"
[0m06:44:39.696139 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_products"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_products__dbt_backup";');

[0m06:44:39.706042 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:39.708371 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.slvr_products: Close
[0m06:44:39.709543 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b662de7ca0>]}
[0m06:44:39.710808 [info ] [Thread-3  ]: 7 of 10 OK created sql table model silver.slvr_products ........................ [[32mOK[0m in 0.40s]
[0m06:44:39.712039 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.slvr_products
[0m06:44:40.431736 [debug] [Thread-4  ]: SQL status: OK in 1.000 seconds
[0m06:44:40.436320 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:40.437319 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders', 'slvr_sales_orders__dbt_backup'
[0m06:44:40.444710 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.449163 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:40.450195 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'silver.slvr_sales_orders__dbt_tmp', 'slvr_sales_orders'
[0m06:44:40.458953 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.461261 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: COMMIT
[0m06:44:40.465507 [debug] [Thread-4  ]: Applying DROP to: "AdventureWorks2014"."silver"."slvr_sales_orders__dbt_backup"
[0m06:44:40.467134 [debug] [Thread-4  ]: Using sqlserver connection "model.dbt_sqlserver_project.slvr_sales_orders"
[0m06:44:40.468121 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.slvr_sales_orders"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "silver"."slvr_sales_orders__dbt_backup";');

[0m06:44:40.476702 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.478903 [debug] [Thread-4  ]: On model.dbt_sqlserver_project.slvr_sales_orders: Close
[0m06:44:40.480003 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6629696a0>]}
[0m06:44:40.481106 [info ] [Thread-4  ]: 6 of 10 OK created sql table model silver.slvr_sales_orders .................... [[32mOK[0m in 1.19s]
[0m06:44:40.482204 [debug] [Thread-4  ]: Finished running node model.dbt_sqlserver_project.slvr_sales_orders
[0m06:44:40.483819 [debug] [Thread-2  ]: Began running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:44:40.484173 [debug] [Thread-1  ]: Began running node model.dbt_sqlserver_project.gld_product_performance
[0m06:44:40.484524 [debug] [Thread-3  ]: Began running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:44:40.485354 [info ] [Thread-2  ]: 8 of 10 START sql table model gold.gld_customer_metrics ........................ [RUN]
[0m06:44:40.486472 [info ] [Thread-1  ]: 9 of 10 START sql table model gold.gld_product_performance ..................... [RUN]
[0m06:44:40.487507 [info ] [Thread-3  ]: 10 of 10 START sql table model gold.gld_sales_summary .......................... [RUN]
[0m06:44:40.488590 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.brnz_example, now model.dbt_sqlserver_project.gld_customer_metrics)
[0m06:44:40.489450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_customers, now model.dbt_sqlserver_project.gld_product_performance)
[0m06:44:40.490329 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_sqlserver_project.slvr_products, now model.dbt_sqlserver_project.gld_sales_summary)
[0m06:44:40.491136 [debug] [Thread-2  ]: Began compiling node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:44:40.537487 [debug] [Thread-1  ]: Began compiling node model.dbt_sqlserver_project.gld_product_performance
[0m06:44:40.540179 [debug] [Thread-3  ]: Began compiling node model.dbt_sqlserver_project.gld_sales_summary
[0m06:44:40.545791 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:40.551351 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:40.556124 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:40.565720 [debug] [Thread-2  ]: Began executing node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:44:40.566732 [debug] [Thread-3  ]: Began executing node model.dbt_sqlserver_project.gld_sales_summary
[0m06:44:40.573185 [debug] [Thread-1  ]: Began executing node model.dbt_sqlserver_project.gld_product_performance
[0m06:44:40.573687 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:44:40.578648 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:44:40.583417 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:44:40.587380 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw"
[0m06:44:40.591282 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw"
[0m06:44:40.594997 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw"
[0m06:44:40.597211 [debug] [Thread-2  ]: dbt-sqlserver
[0m06:44:40.599153 [debug] [Thread-3  ]: dbt-sqlserver
[0m06:44:40.601199 [debug] [Thread-1  ]: dbt-sqlserver
[0m06:44:40.602940 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:40.604434 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:40.605772 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:40.606841 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_customer_metrics__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:40.607749 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_sales_summary__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:40.608653 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

        USE [AdventureWorks2014];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'AdventureWorks2014'
        and refs.referenced_schema_name = 'gold'
        and refs.referenced_entity_name = 'gld_product_performance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m06:44:40.609492 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:44:40.610321 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:44:40.611120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:44:40.611972 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:40.612828 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:40.613628 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:40.614786 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:40.628183 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:40.628698 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:40.635189 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.637917 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:40.639308 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw";');

[0m06:44:40.643133 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.645684 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:40.649104 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.651599 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.653937 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:40.656608 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:40.657369 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw";');

[0m06:44:40.659070 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
      
    
    USE [AdventureWorks2014];
    EXEC('DROP view IF EXISTS "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw";');

[0m06:44:40.659482 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:40.663091 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" as 

with customers as (
    select * from "AdventureWorks2014"."silver"."slvr_customers"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

customer_sales as (
    select
        c.customer_id,
        c.full_name,
        c.territory_id,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.line_total) as total_revenue,
        avg(s.line_total) as avg_order_value,
        sum(s.order_qty) as total_items_purchased,
        min(s.order_date) as first_order_date,
        max(s.order_date) as last_order_date,
        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount
    from customers c
    left join sales s
        on c.customer_id = s.customer_id
    group by c.customer_id, c.full_name, c.territory_id
)

select * from customer_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_customer_metrics__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_customer_metrics__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_customer_metrics__dbt_tmp')
    )
    DROP index "gold"."gld_customer_metrics__dbt_tmp".gold_gld_customer_metrics__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_customer_metrics__dbt_tmp_cci
    ON "gold"."gld_customer_metrics__dbt_tmp"

   


  
[0m06:44:40.663813 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.664381 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:40.668460 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:40.672029 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:40.679427 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:40.680658 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:40.681545 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" as 

with products as (
    select * from "AdventureWorks2014"."silver"."slvr_products"
),

sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

product_sales as (
    select
        p.product_id,
        p.product_name,
        p.subcategory_name,
        p.color,
        p.list_price,
        p.standard_cost,
        count(distinct s.sales_order_id) as total_orders,
        sum(s.order_qty) as total_quantity_sold,
        sum(s.line_total) as total_revenue,
        avg(s.unit_price) as avg_selling_price,
        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,
        case 
            when sum(s.order_qty) > 0 then 
                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100
            else 0
        end as profit_margin_pct
    from products p
    left join sales s
        on p.product_id = s.product_id
    group by 
        p.product_id, 
        p.product_name, 
        p.subcategory_name, 
        p.color, 
        p.list_price, 
        p.standard_cost
)

select * from product_sales;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_product_performance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_product_performance__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_product_performance__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_product_performance__dbt_tmp')
    )
    DROP index "gold"."gld_product_performance__dbt_tmp".gold_gld_product_performance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_product_performance__dbt_tmp_cci
    ON "gold"."gld_product_performance__dbt_tmp"

   


  
[0m06:44:40.682975 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

  
    USE [AdventureWorks2014];
    USE [AdventureWorks2014];
    
    

    

    
    USE [AdventureWorks2014];
    EXEC('
        create view "gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" as 

with sales as (
    select * from "AdventureWorks2014"."silver"."slvr_sales_orders"
),

daily_summary as (
    select
        cast(order_date as date) as order_date,
        count(distinct sales_order_id) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(order_qty) as total_items_sold,
        sum(line_total) as total_revenue,
        avg(line_total) as avg_order_line_value,
        sum(case when order_channel = ''Online'' then 1 else 0 end) as online_orders,
        sum(case when order_channel = ''Offline'' then 1 else 0 end) as offline_orders,
        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue
    from sales
    group by cast(order_date as date)
)

select * from daily_summary;
    ')

EXEC('
            SELECT * INTO "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp" FROM "AdventureWorks2014"."gold"."gld_sales_summary__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS gold.gld_sales_summary__dbt_tmp__dbt_tmp_vw')



    
    use [AdventureWorks2014];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'gold_gld_sales_summary__dbt_tmp_cci'
        AND object_id=object_id('gold_gld_sales_summary__dbt_tmp')
    )
    DROP index "gold"."gld_sales_summary__dbt_tmp".gold_gld_sales_summary__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX gold_gld_sales_summary__dbt_tmp_cci
    ON "gold"."gld_sales_summary__dbt_tmp"

   


  
[0m06:44:41.087922 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.095388 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:41.096515 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary', 'gld_sales_summary__dbt_backup'
[0m06:44:41.108914 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.113064 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:41.114042 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_sales_summary__dbt_tmp', 'gld_sales_summary'
[0m06:44:41.122419 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.124810 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: COMMIT
[0m06:44:41.128202 [debug] [Thread-3  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_sales_summary__dbt_backup"
[0m06:44:41.129484 [debug] [Thread-3  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_sales_summary"
[0m06:44:41.130409 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_sales_summary"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_sales_summary__dbt_backup";');

[0m06:44:41.137460 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.139988 [debug] [Thread-3  ]: On model.dbt_sqlserver_project.gld_sales_summary: Close
[0m06:44:41.141049 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6600c99d0>]}
[0m06:44:41.142158 [info ] [Thread-3  ]: 10 of 10 OK created sql table model gold.gld_sales_summary ..................... [[32mOK[0m in 0.65s]
[0m06:44:41.143470 [debug] [Thread-3  ]: Finished running node model.dbt_sqlserver_project.gld_sales_summary
[0m06:44:41.226818 [debug] [Thread-2  ]: SQL status: OK in 1.000 seconds
[0m06:44:41.232230 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:41.233642 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics', 'gld_customer_metrics__dbt_backup'
[0m06:44:41.241617 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.246363 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:41.247688 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_customer_metrics__dbt_tmp', 'gld_customer_metrics'
[0m06:44:41.273272 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.276274 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: COMMIT
[0m06:44:41.281778 [debug] [Thread-2  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_customer_metrics__dbt_backup"
[0m06:44:41.283662 [debug] [Thread-2  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_customer_metrics"
[0m06:44:41.284774 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_customer_metrics"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_customer_metrics__dbt_backup";');

[0m06:44:41.292860 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.295001 [debug] [Thread-2  ]: On model.dbt_sqlserver_project.gld_customer_metrics: Close
[0m06:44:41.296030 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b66028e520>]}
[0m06:44:41.297168 [info ] [Thread-2  ]: 8 of 10 OK created sql table model gold.gld_customer_metrics ................... [[32mOK[0m in 0.81s]
[0m06:44:41.298604 [debug] [Thread-2  ]: Finished running node model.dbt_sqlserver_project.gld_customer_metrics
[0m06:44:41.544798 [debug] [Thread-1  ]: SQL status: OK in 1.000 seconds
[0m06:44:41.550655 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:41.551995 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance', 'gld_product_performance__dbt_backup'
[0m06:44:41.561626 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.566886 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:41.568219 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */
USE [AdventureWorks2014];
      EXEC sp_rename 'gold.gld_product_performance__dbt_tmp', 'gld_product_performance'
[0m06:44:41.575960 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.578858 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: COMMIT
[0m06:44:41.582515 [debug] [Thread-1  ]: Applying DROP to: "AdventureWorks2014"."gold"."gld_product_performance__dbt_backup"
[0m06:44:41.583944 [debug] [Thread-1  ]: Using sqlserver connection "model.dbt_sqlserver_project.gld_product_performance"
[0m06:44:41.584878 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "model.dbt_sqlserver_project.gld_product_performance"} */

      
    USE [AdventureWorks2014];
    EXEC('DROP table IF EXISTS "gold"."gld_product_performance__dbt_backup";');

[0m06:44:41.593064 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:41.595360 [debug] [Thread-1  ]: On model.dbt_sqlserver_project.gld_product_performance: Close
[0m06:44:41.596802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0432dc79-a94d-4ff3-b2cb-5e2829e9ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6600c9160>]}
[0m06:44:41.598370 [info ] [Thread-1  ]: 9 of 10 OK created sql table model gold.gld_product_performance ................ [[32mOK[0m in 1.11s]
[0m06:44:41.599844 [debug] [Thread-1  ]: Finished running node model.dbt_sqlserver_project.gld_product_performance
[0m06:44:41.602496 [debug] [MainThread]: On master: COMMIT
[0m06:44:41.603509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:41.604300 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_customer_metrics' was properly closed.
[0m06:44:41.604962 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_sales_summary' was properly closed.
[0m06:44:41.605603 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.gld_product_performance' was properly closed.
[0m06:44:41.606250 [debug] [MainThread]: Connection 'model.dbt_sqlserver_project.slvr_sales_orders' was properly closed.
[0m06:44:41.607215 [info ] [MainThread]: 
[0m06:44:41.608125 [info ] [MainThread]: Finished running 4 view models, 6 table models in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m06:44:41.610647 [debug] [MainThread]: Command end result
[0m06:44:41.675568 [info ] [MainThread]: 
[0m06:44:41.676716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:44:41.677742 [info ] [MainThread]: 
[0m06:44:41.678830 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m06:44:41.680384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.633018, "process_user_time": 2.249643, "process_kernel_time": 0.339263, "process_mem_max_rss": "126016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:44:41.681390 [debug] [MainThread]: Command `dbt run` succeeded at 06:44:41.681287 after 4.63 seconds
[0m06:44:41.682303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6663fe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6685286d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b6660c2040>]}
[0m06:44:41.683138 [debug] [MainThread]: Flushing usage events
[0m06:44:46.112527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8dc0b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8ba97580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8ba97520>]}


============================== 06:44:46.116643 | 5d4a69d6-aae1-4de0-8dba-4cabec8028da ==============================
[0m06:44:46.116643 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:44:46.118368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:44:46.339517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d4a69d6-aae1-4de0-8dba-4cabec8028da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8ba3fe80>]}
[0m06:44:46.385335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d4a69d6-aae1-4de0-8dba-4cabec8028da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8dde4cd0>]}
[0m06:44:46.387990 [info ] [MainThread]: Registered adapter: sqlserver=1.8.7
[0m06:44:46.511329 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:44:47.441644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:44:47.442629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:44:47.486647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d4a69d6-aae1-4de0-8dba-4cabec8028da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8a1ac130>]}
[0m06:44:47.684071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d4a69d6-aae1-4de0-8dba-4cabec8028da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8a38bfd0>]}
[0m06:44:47.685218 [info ] [MainThread]: Found 10 models, 18 data tests, 13 sources, 614 macros
[0m06:44:47.686197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d4a69d6-aae1-4de0-8dba-4cabec8028da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8a1bdaf0>]}
[0m06:44:47.689099 [info ] [MainThread]: 
[0m06:44:47.690317 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m06:44:47.696619 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_gold'
[0m06:44:47.697350 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_bronze'
[0m06:44:47.697970 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_AdventureWorks2014_silver'
[0m06:44:47.714011 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:47.717154 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:47.721193 [debug] [ThreadPool]: dbt-sqlserver
[0m06:44:47.722832 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_gold"
[0m06:44:47.725261 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_bronze"
[0m06:44:47.726803 [debug] [ThreadPool]: Using sqlserver connection "list_AdventureWorks2014_silver"
[0m06:44:47.728348 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_gold"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:47.729799 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_bronze"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:47.731087 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "connection_name": "list_AdventureWorks2014_silver"} */
USE [AdventureWorks2014];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m06:44:47.732286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:47.733382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:47.734434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:47.735264 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:47.736096 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:47.736917 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:47.763443 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:47.763905 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:47.764327 [debug] [ThreadPool]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:47.768675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:47.769035 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:47.770876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:44:47.772246 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: ROLLBACK
[0m06:44:47.773914 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: ROLLBACK
[0m06:44:47.775313 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: ROLLBACK
[0m06:44:47.775939 [debug] [ThreadPool]: On list_AdventureWorks2014_gold: Close
[0m06:44:47.776528 [debug] [ThreadPool]: On list_AdventureWorks2014_bronze: Close
[0m06:44:47.777031 [debug] [ThreadPool]: On list_AdventureWorks2014_silver: Close
[0m06:44:47.780787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d4a69d6-aae1-4de0-8dba-4cabec8028da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8bc06ac0>]}
[0m06:44:47.781634 [debug] [MainThread]: On master: COMMIT
[0m06:44:47.782480 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:44:47.783399 [info ] [MainThread]: 
[0m06:44:47.787048 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:44:47.787475 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:44:47.787908 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:44:47.788314 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:44:47.788907 [info ] [Thread-1  ]: 1 of 18 START test dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:44:47.789957 [info ] [Thread-2  ]: 2 of 18 START test dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [RUN]
[0m06:44:47.791013 [info ] [Thread-3  ]: 3 of 18 START test not_null_brnz_sales_orders_order_detail_id .................. [RUN]
[0m06:44:47.791992 [info ] [Thread-4  ]: 4 of 18 START test not_null_brnz_sales_orders_sales_order_id ................... [RUN]
[0m06:44:47.793119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_silver, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902)
[0m06:44:47.793957 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_bronze, now test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc)
[0m06:44:47.794925 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_AdventureWorks2014_gold, now test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac)
[0m06:44:47.795888 [debug] [Thread-4  ]: Acquiring new sqlserver connection 'test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca'
[0m06:44:47.796720 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:44:47.797454 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:44:47.798269 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:44:47.799067 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:44:47.817171 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:44:47.821968 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:44:47.830905 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:44:47.836089 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:44:47.846137 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:44:47.868582 [debug] [Thread-2  ]: local_md5(model.name): fa6b3d9cc18a40cfba3de7295a3a38e6
[0m06:44:47.870408 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:44:47.871146 [debug] [Thread-2  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:47.871628 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:44:47.872788 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:44:47.875106 [debug] [Thread-1  ]: local_md5(model.name): 67f0da2d4853f9b58f45c2538ec21c2c
[0m06:44:47.876820 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:44:47.880246 [debug] [Thread-3  ]: local_md5(model.name): ceaaec9b7bfb04833f91aa66d8c142ec
[0m06:44:47.883936 [debug] [Thread-4  ]: local_md5(model.name): 4446247e8e63b633006b12e3047a90f1
[0m06:44:47.885392 [debug] [Thread-1  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:47.887355 [debug] [Thread-3  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:47.888471 [debug] [Thread-4  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:47.889877 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:44:47.891167 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:44:47.892308 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:44:47.894922 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"
[0m06:44:47.896564 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_74cb0cbcb4ecbb2e887b5b87b7ca0705]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."silver"."slvr_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_74cb0cbcb4ecbb2e887b5b87b7ca0705]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_74cb0cbcb4ecbb2e887b5b87b7ca0705]
  ;')
[0m06:44:47.897879 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:44:47.898435 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"
[0m06:44:47.899835 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:47.900517 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"
[0m06:44:47.901675 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_e469becceeffdd2d421a7c040b481e1c]
   as 





with validation_errors as (

    select
        sales_order_id, order_detail_id
    from "AdventureWorks2014"."bronze"."brnz_sales_orders"
    group by sales_order_id, order_detail_id
    having count(*) > 1

)

select *
from validation_errors


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_e469becceeffdd2d421a7c040b481e1c]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_e469becceeffdd2d421a7c040b481e1c]
  ;')
[0m06:44:47.902281 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"
[0m06:44:47.903431 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:47.904078 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_1e27b38a1f2289b1711c4c1fa4d49961]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_1e27b38a1f2289b1711c4c1fa4d49961]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_1e27b38a1f2289b1711c4c1fa4d49961]
  ;')
[0m06:44:47.904930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:44:47.905717 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_ad24aae890529dcfca084c0d3060dd68]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."bronze"."brnz_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_ad24aae890529dcfca084c0d3060dd68]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_ad24aae890529dcfca084c0d3060dd68]
  ;')
[0m06:44:47.907212 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:44:47.915013 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:47.916015 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:44:47.916992 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:47.917982 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:47.918710 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:47.919655 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:47.932964 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:47.946237 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:47.951464 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: ROLLBACK
[0m06:44:47.952669 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca: Close
[0m06:44:47.953901 [info ] [Thread-4  ]: 4 of 18 PASS not_null_brnz_sales_orders_sales_order_id ......................... [[32mPASS[0m in 0.16s]
[0m06:44:47.955734 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca
[0m06:44:47.957069 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:44:47.958276 [info ] [Thread-4  ]: 5 of 18 START test not_null_gld_customer_metrics_customer_id ................... [RUN]
[0m06:44:47.959599 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_sales_order_id.c364a4c6ca, now test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39)
[0m06:44:47.960562 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:44:47.966282 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:44:47.978997 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:44:47.985385 [debug] [Thread-4  ]: local_md5(model.name): ac0d77cdfe99d22d2680c19319e8499c
[0m06:44:47.987469 [debug] [Thread-4  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:47.989524 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:44:48.001479 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"
[0m06:44:48.002718 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_d7ab67fdeb2572270b593a1407b0cfad]
   as 
    
    



select customer_id
from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_d7ab67fdeb2572270b593a1407b0cfad]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_d7ab67fdeb2572270b593a1407b0cfad]
  ;')
[0m06:44:48.003929 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:44:48.004943 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.022932 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.038695 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.041250 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.042373 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: ROLLBACK
[0m06:44:48.044284 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: ROLLBACK
[0m06:44:48.045372 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.045697 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac: Close
[0m06:44:48.046633 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39: Close
[0m06:44:48.048624 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: ROLLBACK
[0m06:44:48.049771 [info ] [Thread-3  ]: 3 of 18 PASS not_null_brnz_sales_orders_order_detail_id ........................ [[32mPASS[0m in 0.25s]
[0m06:44:48.050812 [info ] [Thread-4  ]: 5 of 18 PASS not_null_gld_customer_metrics_customer_id ......................... [[32mPASS[0m in 0.09s]
[0m06:44:48.052375 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902: Close
[0m06:44:48.053685 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac
[0m06:44:48.055255 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39
[0m06:44:48.056585 [info ] [Thread-1  ]: 1 of 18 PASS dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.26s]
[0m06:44:48.057824 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:44:48.058873 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:44:48.059966 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902
[0m06:44:48.060823 [info ] [Thread-3  ]: 6 of 18 START test not_null_gld_product_performance_product_id ................. [RUN]
[0m06:44:48.061730 [info ] [Thread-4  ]: 7 of 18 START test not_null_gld_sales_summary_order_date ....................... [RUN]
[0m06:44:48.062816 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:44:48.063790 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_brnz_sales_orders_order_detail_id.8dbed006ac, now test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397)
[0m06:44:48.065051 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_customer_metrics_customer_id.d4a2f89a39, now test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e)
[0m06:44:48.066228 [info ] [Thread-1  ]: 8 of 18 START test not_null_slvr_customers_customer_id ......................... [RUN]
[0m06:44:48.067225 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:44:48.068250 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:44:48.069251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_brnz_sales_orders_sales_order_id__order_detail_id.c176823902, now test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275)
[0m06:44:48.074061 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:44:48.081248 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:44:48.082427 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:44:48.089649 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:44:48.090251 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.093023 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: ROLLBACK
[0m06:44:48.094687 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc: Close
[0m06:44:48.095478 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:44:48.097559 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:44:48.097083 [info ] [Thread-2  ]: 2 of 18 PASS dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id  [[32mPASS[0m in 0.30s]
[0m06:44:48.098342 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:44:48.103444 [debug] [Thread-4  ]: local_md5(model.name): 31cffa58c58a08e4f0ecffd253b46aa2
[0m06:44:48.106399 [debug] [Thread-3  ]: local_md5(model.name): a5b86011b8d22b04b2506841bc10c840
[0m06:44:48.107562 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc
[0m06:44:48.111191 [debug] [Thread-1  ]: local_md5(model.name): 8e9f64ea0dd2dc40d032bf48fa566213
[0m06:44:48.112220 [debug] [Thread-4  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.113190 [debug] [Thread-3  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.114243 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:44:48.115097 [debug] [Thread-1  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.116220 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:44:48.117409 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:44:48.118368 [info ] [Thread-2  ]: 9 of 18 START test not_null_slvr_products_list_price ........................... [RUN]
[0m06:44:48.119589 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:44:48.121865 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.dbt_utils_unique_combination_of_columns_slvr_sales_orders_sales_order_id__order_detail_id.9ffe017cfc, now test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076)
[0m06:44:48.123650 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:44:48.130637 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:44:48.132117 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"
[0m06:44:48.132696 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"
[0m06:44:48.133328 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"
[0m06:44:48.133866 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_cc9892373490dc0e75e52b5e48a6658b]
   as 
    
    



select product_id
from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_cc9892373490dc0e75e52b5e48a6658b]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_cc9892373490dc0e75e52b5e48a6658b]
  ;')
[0m06:44:48.134887 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a3e2f658e14c8defedfb0ef02c0f35ee]
   as 
    
    



select customer_id
from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a3e2f658e14c8defedfb0ef02c0f35ee]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a3e2f658e14c8defedfb0ef02c0f35ee]
  ;')
[0m06:44:48.135838 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a2318f38f44a6937cbf2862348c845d2]
   as 
    
    



select order_date
from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a2318f38f44a6937cbf2862348c845d2]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a2318f38f44a6937cbf2862348c845d2]
  ;')
[0m06:44:48.136700 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:44:48.137538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:44:48.138708 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:44:48.140085 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.140487 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:44:48.141157 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.141992 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.142935 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.145784 [debug] [Thread-2  ]: local_md5(model.name): d9ecc431b4a169296ca29c386f015286
[0m06:44:48.146868 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.147513 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.149017 [debug] [Thread-2  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.152073 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:44:48.161129 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"
[0m06:44:48.162128 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3732727e46bc8d1c9e77fc769e7633bd]
   as 
    
    



select list_price
from "AdventureWorks2014"."silver"."slvr_products"
where list_price is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3732727e46bc8d1c9e77fc769e7633bd]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3732727e46bc8d1c9e77fc769e7633bd]
  ;')
[0m06:44:48.163072 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:44:48.164092 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.164478 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.164843 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.167086 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: ROLLBACK
[0m06:44:48.168598 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.169366 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: ROLLBACK
[0m06:44:48.169753 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.170480 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275: Close
[0m06:44:48.172302 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: ROLLBACK
[0m06:44:48.172891 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397: Close
[0m06:44:48.174778 [info ] [Thread-1  ]: 8 of 18 PASS not_null_slvr_customers_customer_id ............................... [[32mPASS[0m in 0.11s]
[0m06:44:48.175656 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e: Close
[0m06:44:48.176793 [info ] [Thread-3  ]: 6 of 18 PASS not_null_gld_product_performance_product_id ....................... [[32mPASS[0m in 0.11s]
[0m06:44:48.177775 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275
[0m06:44:48.179062 [info ] [Thread-4  ]: 7 of 18 PASS not_null_gld_sales_summary_order_date ............................. [[32mPASS[0m in 0.11s]
[0m06:44:48.179875 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397
[0m06:44:48.180911 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:44:48.182056 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e
[0m06:44:48.183177 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:44:48.184159 [info ] [Thread-1  ]: 10 of 18 START test not_null_slvr_products_product_id .......................... [RUN]
[0m06:44:48.185401 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:44:48.186622 [info ] [Thread-3  ]: 11 of 18 START test not_null_slvr_sales_orders_line_total ...................... [RUN]
[0m06:44:48.187268 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.188412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_customers_customer_id.f907cb8275, now test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551)
[0m06:44:48.189411 [info ] [Thread-4  ]: 12 of 18 START test not_null_slvr_sales_orders_order_detail_id ................. [RUN]
[0m06:44:48.190671 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_product_performance_product_id.df0c190397, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d)
[0m06:44:48.193077 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: ROLLBACK
[0m06:44:48.193678 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:44:48.194822 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_gld_sales_summary_order_date.d540726f7e, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53)
[0m06:44:48.195761 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:44:48.196701 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076: Close
[0m06:44:48.201476 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:44:48.202934 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:44:48.209626 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:44:48.210697 [info ] [Thread-2  ]: 9 of 18 PASS not_null_slvr_products_list_price ................................. [[32mPASS[0m in 0.09s]
[0m06:44:48.216088 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:44:48.218131 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076
[0m06:44:48.220316 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:44:48.222644 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:44:48.223251 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:44:48.222016 [info ] [Thread-2  ]: 13 of 18 START test not_null_slvr_sales_orders_sales_order_id .................. [RUN]
[0m06:44:48.224411 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:44:48.227395 [debug] [Thread-1  ]: local_md5(model.name): 6fbe07cd99985a105c0e61275b7ef592
[0m06:44:48.230268 [debug] [Thread-3  ]: local_md5(model.name): 9aed47cbdc8c4c391feec0e17f79c145
[0m06:44:48.231216 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_list_price.7131a73076, now test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4)
[0m06:44:48.234037 [debug] [Thread-4  ]: local_md5(model.name): ea59c6424fdef3f68e31047da36d4522
[0m06:44:48.234999 [debug] [Thread-1  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.235872 [debug] [Thread-3  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.236705 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:44:48.237478 [debug] [Thread-4  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.238570 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:44:48.239825 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:44:48.246637 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:44:48.248061 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:44:48.254669 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"
[0m06:44:48.255856 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"
[0m06:44:48.256686 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a850aad6cc7eb3d6573028804fd3d337]
   as 
    
    



select line_total
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where line_total is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a850aad6cc7eb3d6573028804fd3d337]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a850aad6cc7eb3d6573028804fd3d337]
  ;')
[0m06:44:48.257304 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"
[0m06:44:48.258315 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3159ba4585ebf5809f794358d0d15049]
   as 
    
    



select order_detail_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where order_detail_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3159ba4585ebf5809f794358d0d15049]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3159ba4585ebf5809f794358d0d15049]
  ;')
[0m06:44:48.259627 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:44:48.260173 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:44:48.261161 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_41d157483de22e2d29ce4fad81cc51a6]
   as 
    
    



select product_id
from "AdventureWorks2014"."silver"."slvr_products"
where product_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_41d157483de22e2d29ce4fad81cc51a6]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_41d157483de22e2d29ce4fad81cc51a6]
  ;')
[0m06:44:48.262118 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:44:48.263088 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.268552 [debug] [Thread-2  ]: local_md5(model.name): 8afc66a1e810936eb9dee9b36ebd66ab
[0m06:44:48.269636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:44:48.270575 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.271511 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.272145 [debug] [Thread-2  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.272958 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.273880 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.275533 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:44:48.276540 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.286659 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"
[0m06:44:48.287828 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_3d37abe3c6c601c116648cf000907e8d]
   as 
    
    



select sales_order_id
from "AdventureWorks2014"."silver"."slvr_sales_orders"
where sales_order_id is null


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_3d37abe3c6c601c116648cf000907e8d]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_3d37abe3c6c601c116648cf000907e8d]
  ;')
[0m06:44:48.288850 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:44:48.289784 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.290913 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.291367 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.291714 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.293767 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: ROLLBACK
[0m06:44:48.297387 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: ROLLBACK
[0m06:44:48.298365 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551: Close
[0m06:44:48.299327 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53: Close
[0m06:44:48.300583 [info ] [Thread-1  ]: 10 of 18 PASS not_null_slvr_products_product_id ................................ [[32mPASS[0m in 0.11s]
[0m06:44:48.301834 [info ] [Thread-4  ]: 12 of 18 PASS not_null_slvr_sales_orders_order_detail_id ....................... [[32mPASS[0m in 0.11s]
[0m06:44:48.303099 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551
[0m06:44:48.304732 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53
[0m06:44:48.305930 [debug] [Thread-1  ]: Began running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:44:48.307266 [debug] [Thread-4  ]: Began running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:44:48.307855 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.308701 [info ] [Thread-1  ]: 14 of 18 START test unique_gld_customer_metrics_customer_id .................... [RUN]
[0m06:44:48.309778 [info ] [Thread-4  ]: 15 of 18 START test unique_gld_product_performance_product_id .................. [RUN]
[0m06:44:48.312367 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: ROLLBACK
[0m06:44:48.313082 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_products_product_id.e754cc1551, now test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd)
[0m06:44:48.314077 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_order_detail_id.71e8a48f53, now test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8)
[0m06:44:48.315036 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4: Close
[0m06:44:48.315737 [debug] [Thread-1  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:44:48.316592 [debug] [Thread-4  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:44:48.317645 [info ] [Thread-2  ]: 13 of 18 PASS not_null_slvr_sales_orders_sales_order_id ........................ [[32mPASS[0m in 0.09s]
[0m06:44:48.328282 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:44:48.336941 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:44:48.338085 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4
[0m06:44:48.341036 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:44:48.341989 [info ] [Thread-2  ]: 16 of 18 START test unique_gld_sales_summary_order_date ........................ [RUN]
[0m06:44:48.343357 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_sales_order_id.0f82d3dab4, now test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b)
[0m06:44:48.344645 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:44:48.351399 [debug] [Thread-4  ]: Began executing node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:44:48.355493 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:44:48.359608 [debug] [Thread-4  ]: local_md5(model.name): 282efc8b63abc4326c2e3fe9cf80b2ea
[0m06:44:48.360080 [debug] [Thread-1  ]: Began executing node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:44:48.361793 [debug] [Thread-4  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.365263 [debug] [Thread-1  ]: local_md5(model.name): 09e4fbf108b34f10d79cdb74070d011e
[0m06:44:48.366636 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:44:48.367561 [debug] [Thread-1  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.370069 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:44:48.372025 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:44:48.375981 [debug] [Thread-2  ]: local_md5(model.name): 9242e0fb865d08f661cf2dc3e20a299e
[0m06:44:48.377409 [debug] [Thread-2  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.378081 [debug] [Thread-4  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"
[0m06:44:48.378595 [debug] [Thread-1  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"
[0m06:44:48.379337 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:44:48.380404 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_2afe146b06a9c441995cdf507cf39724]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_product_performance"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_2afe146b06a9c441995cdf507cf39724]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_2afe146b06a9c441995cdf507cf39724]
  ;')
[0m06:44:48.381350 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_5f7b2598cc17043d5003374d688d45b9]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_customer_metrics"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_5f7b2598cc17043d5003374d688d45b9]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_5f7b2598cc17043d5003374d688d45b9]
  ;')
[0m06:44:48.383435 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:44:48.384499 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.384890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:44:48.385885 [debug] [Thread-4  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.388297 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: ROLLBACK
[0m06:44:48.388880 [debug] [Thread-1  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.390901 [debug] [Thread-4  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.391716 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"
[0m06:44:48.392061 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d: Close
[0m06:44:48.392975 [debug] [Thread-1  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.394274 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_a5fdc387d46671207c7aad6c3cd2e325]
   as 
    
    

select
    order_date as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."gold"."gld_sales_summary"
where order_date is not null
group by order_date
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_a5fdc387d46671207c7aad6c3cd2e325]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_a5fdc387d46671207c7aad6c3cd2e325]
  ;')
[0m06:44:48.396842 [info ] [Thread-3  ]: 11 of 18 PASS not_null_slvr_sales_orders_line_total ............................ [[32mPASS[0m in 0.21s]
[0m06:44:48.399037 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:44:48.400322 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d
[0m06:44:48.401641 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.402873 [debug] [Thread-3  ]: Began running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:44:48.404088 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.404765 [info ] [Thread-3  ]: 17 of 18 START test unique_slvr_customers_customer_id .......................... [RUN]
[0m06:44:48.406639 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.not_null_slvr_sales_orders_line_total.1365eff03d, now test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600)
[0m06:44:48.407686 [debug] [Thread-3  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:44:48.420544 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:44:48.421157 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.421599 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.424511 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: ROLLBACK
[0m06:44:48.426340 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: ROLLBACK
[0m06:44:48.426926 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b: Close
[0m06:44:48.427644 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.428016 [debug] [Thread-4  ]: On test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8: Close
[0m06:44:48.429060 [info ] [Thread-2  ]: 16 of 18 PASS unique_gld_sales_summary_order_date .............................. [[32mPASS[0m in 0.09s]
[0m06:44:48.431729 [debug] [Thread-3  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:44:48.432437 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: ROLLBACK
[0m06:44:48.433122 [info ] [Thread-4  ]: 15 of 18 PASS unique_gld_product_performance_product_id ........................ [[32mPASS[0m in 0.12s]
[0m06:44:48.434351 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b
[0m06:44:48.437384 [debug] [Thread-3  ]: local_md5(model.name): 4e2331c32d747d8df52121a664e91469
[0m06:44:48.438415 [debug] [Thread-1  ]: On test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd: Close
[0m06:44:48.439216 [debug] [Thread-4  ]: Finished running node test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8
[0m06:44:48.440135 [debug] [Thread-2  ]: Began running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:44:48.440964 [debug] [Thread-3  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.442024 [info ] [Thread-1  ]: 14 of 18 PASS unique_gld_customer_metrics_customer_id .......................... [[32mPASS[0m in 0.13s]
[0m06:44:48.443465 [info ] [Thread-2  ]: 18 of 18 START test unique_slvr_products_product_id ............................ [RUN]
[0m06:44:48.444678 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:44:48.445717 [debug] [Thread-1  ]: Finished running node test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd
[0m06:44:48.446678 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_sqlserver_project.unique_gld_sales_summary_order_date.bb9cac975b, now test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f)
[0m06:44:48.448788 [debug] [Thread-2  ]: Began compiling node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:44:48.455680 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:44:48.460398 [debug] [Thread-3  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"
[0m06:44:48.461214 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_b4eb90b800ef96a9947a5bb360fb26a3]
   as 
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_b4eb90b800ef96a9947a5bb360fb26a3]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_b4eb90b800ef96a9947a5bb360fb26a3]
  ;')
[0m06:44:48.462198 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:44:48.463581 [debug] [Thread-3  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.464556 [debug] [Thread-2  ]: Began executing node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:44:48.464966 [debug] [Thread-3  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.469972 [debug] [Thread-2  ]: local_md5(model.name): 460bcc0c9f9b8191fcda43c5bbb8239e
[0m06:44:48.471752 [debug] [Thread-2  ]: local_md5(invocation_id): 39b67c0f6062ab07a6e8eedb06b0f3e5
[0m06:44:48.473083 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:44:48.481194 [debug] [Thread-2  ]: Using sqlserver connection "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"
[0m06:44:48.482214 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_airflow_project", "target_name": "dev", "node_id": "test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f"} */

  
  

  
  USE [AdventureWorks2014];
  EXEC('create view 

    [dbt_test__audit.testview_148c6a75e63858463ea2cb5c71e062ae]
   as 
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "AdventureWorks2014"."silver"."slvr_products"
where product_id is not null
group by product_id
having count(*) > 1


;')
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select  * from 

    [dbt_test__audit.testview_148c6a75e63858463ea2cb5c71e062ae]
  
  ) dbt_internal_test;

  USE [AdventureWorks2014];
  EXEC('drop view 

    [dbt_test__audit.testview_148c6a75e63858463ea2cb5c71e062ae]
  ;')
[0m06:44:48.483085 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:44:48.483958 [debug] [Thread-2  ]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=host.docker.internal,1433;Database=AdventureWorks2014;UID={imrandbtnew};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.7
[0m06:44:48.484969 [debug] [Thread-2  ]: sqlserver adapter: Connected to db: AdventureWorks2014
[0m06:44:48.488972 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.491297 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: ROLLBACK
[0m06:44:48.492161 [debug] [Thread-3  ]: On test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600: Close
[0m06:44:48.493237 [info ] [Thread-3  ]: 17 of 18 PASS unique_slvr_customers_customer_id ................................ [[32mPASS[0m in 0.09s]
[0m06:44:48.494415 [debug] [Thread-3  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600
[0m06:44:48.499615 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m06:44:48.501863 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: ROLLBACK
[0m06:44:48.502776 [debug] [Thread-2  ]: On test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f: Close
[0m06:44:48.503806 [info ] [Thread-2  ]: 18 of 18 PASS unique_slvr_products_product_id .................................. [[32mPASS[0m in 0.06s]
[0m06:44:48.504969 [debug] [Thread-2  ]: Finished running node test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f
[0m06:44:48.507175 [debug] [MainThread]: On master: COMMIT
[0m06:44:48.508134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:48.508897 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_customers_customer_id.cdbb647600' was properly closed.
[0m06:44:48.509609 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_slvr_products_product_id.5ff76b9e3f' was properly closed.
[0m06:44:48.510312 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_customer_metrics_customer_id.33651a4cdd' was properly closed.
[0m06:44:48.511087 [debug] [MainThread]: Connection 'test.dbt_sqlserver_project.unique_gld_product_performance_product_id.d1cccc0db8' was properly closed.
[0m06:44:48.511912 [info ] [MainThread]: 
[0m06:44:48.512745 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m06:44:48.515786 [debug] [MainThread]: Command end result
[0m06:44:48.635624 [info ] [MainThread]: 
[0m06:44:48.636759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:44:48.637802 [info ] [MainThread]: 
[0m06:44:48.638819 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m06:44:48.640296 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6119976, "process_user_time": 2.038212, "process_kernel_time": 0.335609, "process_mem_max_rss": "126012", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:44:48.641263 [debug] [MainThread]: Command `dbt test` succeeded at 06:44:48.641123 after 2.61 seconds
[0m06:44:48.642072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8dc0b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8a7b1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735d8d8a42e0>]}
[0m06:44:48.642997 [debug] [MainThread]: Flushing usage events
