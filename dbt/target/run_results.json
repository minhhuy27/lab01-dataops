{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-12-04T08:48:26.158975Z", "invocation_id": "eafbb831-8c7a-499b-97a7-cdca3fa9f678", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:21.642647Z", "completed_at": "2025-12-04T08:48:21.678847Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:21.713885Z", "completed_at": "2025-12-04T08:48:22.226702Z"}], "thread_id": "Thread-2", "execution_time": 0.6252789497375488, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_example", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from \"AdventureWorks2014\".\"Sales\".\"Customer\"\n),\n\ntransformed as (\n    select\n        CustomerID as id,\n        AccountNumber as name,\n        ModifiedDate as created_at,\n        ModifiedDate as updated_at\n    from source_data\n)\n\nselect * from transformed", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_example\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:21.650115Z", "completed_at": "2025-12-04T08:48:21.700353Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:21.772048Z", "completed_at": "2025-12-04T08:48:22.235446Z"}], "thread_id": "Thread-3", "execution_time": 0.638108491897583, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_products", "compiled": true, "compiled_code": "with product as (\n    select * from \"AdventureWorks2014\".\"Production\".\"Product\"\n),\n\nproduct_subcategory as (\n    select * from \"AdventureWorks2014\".\"Production\".\"ProductSubcategory\"\n),\n\nstaged as (\n    select\n        p.ProductID as product_id,\n        nullif(ltrim(rtrim(p.Name)), '') as product_name,\n        p.ProductNumber as product_number,\n        p.MakeFlag as make_flag,\n        p.FinishedGoodsFlag as finished_goods_flag,\n        nullif(ltrim(rtrim(p.Color)), '') as color,\n        p.SafetyStockLevel as safety_stock_level,\n        p.ReorderPoint as reorder_point,\n        p.StandardCost as standard_cost,\n        p.ListPrice as list_price,\n        nullif(ltrim(rtrim(p.Size)), '') as size,\n        p.SizeUnitMeasureCode as size_unit_measure_code,\n        p.WeightUnitMeasureCode as weight_unit_measure_code,\n        p.Weight as weight,\n        p.DaysToManufacture as days_to_manufacture,\n        nullif(ltrim(rtrim(p.ProductLine)), '') as product_line,\n        nullif(ltrim(rtrim(p.Class)), '') as class,\n        nullif(ltrim(rtrim(p.Style)), '') as style,\n        p.ProductSubcategoryID as product_subcategory_id,\n        p.ProductModelID as product_model_id,\n        p.SellStartDate as sell_start_date,\n        p.SellEndDate as sell_end_date,\n        p.DiscontinuedDate as discontinued_date,\n        ps.Name as subcategory_name,\n        ps.ProductCategoryID as product_category_id,\n        p.ModifiedDate as last_modified_date\n    from product p\n    left join product_subcategory ps\n        on p.ProductSubcategoryID = ps.ProductSubcategoryID\n)\n\nselect * from staged", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:21.629460Z", "completed_at": "2025-12-04T08:48:21.691659Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:21.765332Z", "completed_at": "2025-12-04T08:48:22.238093Z"}], "thread_id": "Thread-1", "execution_time": 0.6440269947052002, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_customers", "compiled": true, "compiled_code": "\n\nwith customer as (\n    select * from \"AdventureWorks2014\".\"Sales\".\"Customer\"\n),\n\nperson as (\n    select * from \"AdventureWorks2014\".\"Person\".\"Person\"\n),\n\nstaged as (\n    select\n        c.CustomerID as customer_id,\n        c.PersonID as person_id,\n        nullif(ltrim(rtrim(p.FirstName)), '') as first_name,\n        nullif(ltrim(rtrim(p.LastName)), '') as last_name,\n        p.EmailPromotion as email_promotion,\n        c.StoreID as store_id,\n        c.TerritoryID as territory_id,\n        c.ModifiedDate as last_modified_date\n    from customer c\n    left join person p\n        on c.PersonID = p.BusinessEntityID\n)\n\nselect * from staged", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:21.657111Z", "completed_at": "2025-12-04T08:48:21.677926Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:21.680838Z", "completed_at": "2025-12-04T08:48:22.245265Z"}], "thread_id": "Thread-4", "execution_time": 0.6420049667358398, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_sales_orders", "compiled": true, "compiled_code": "with sales_order_header as (\n    select\n        SalesOrderID as sales_order_id,\n        OrderDate as order_date,\n        DueDate as due_date,\n        ShipDate as ship_date,\n        Status as status,\n        OnlineOrderFlag as online_order_flag,\n        nullif(ltrim(rtrim(SalesOrderNumber)), '') as sales_order_number,\n        nullif(ltrim(rtrim(PurchaseOrderNumber)), '') as purchase_order_number,\n        CustomerID as customer_id,\n        SalesPersonID as sales_person_id,\n        TerritoryID as territory_id,\n        ModifiedDate as header_modified_date\n    from \"AdventureWorks2014\".\"Sales\".\"SalesOrderHeader\"\n),\n\nsales_order_detail as (\n    select\n        SalesOrderDetailID as order_detail_id,\n        SalesOrderID as sales_order_id,\n        ProductID as product_id,\n        OrderQty as order_qty,\n        UnitPrice as unit_price,\n        UnitPriceDiscount as unit_price_discount,\n        LineTotal as line_total,\n        ModifiedDate as detail_modified_date\n    from \"AdventureWorks2014\".\"Sales\".\"SalesOrderDetail\"\n)\n\nselect\n    h.sales_order_id,\n    h.order_date,\n    h.due_date,\n    h.ship_date,\n    h.status,\n    h.online_order_flag,\n    h.sales_order_number,\n    h.purchase_order_number,\n    h.customer_id,\n    h.sales_person_id,\n    h.territory_id,\n    d.order_detail_id,\n    d.product_id,\n    d.order_qty,\n    d.unit_price,\n    d.unit_price_discount,\n    d.line_total,\n    coalesce(d.detail_modified_date, h.header_modified_date) as last_modified_date\nfrom sales_order_header h\nleft join sales_order_detail d\n    on h.sales_order_id = d.sales_order_id", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_sales_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:22.312249Z", "completed_at": "2025-12-04T08:48:22.343758Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:22.346766Z", "completed_at": "2025-12-04T08:48:22.778877Z"}], "thread_id": "Thread-2", "execution_time": 0.48336195945739746, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.slvr_products", "compiled": true, "compiled_code": "\n\nwith bronze_products as (\n    select * from \"AdventureWorks2014\".\"bronze\".\"brnz_products\"\n),\n\ncleaned as (\n    select\n        product_id,\n        coalesce(product_name, 'Unknown') as product_name,\n        product_number,\n        make_flag,\n        finished_goods_flag,\n        coalesce(color, 'N/A') as color,\n        standard_cost,\n        list_price,\n        coalesce(size, 'N/A') as size,\n        coalesce(weight, 0) as weight,\n        product_line,\n        class,\n        style,\n        product_subcategory_id as subcategory_id,\n        coalesce(subcategory_name, 'Uncategorized') as subcategory_name,\n        product_category_id as category_id,\n        sell_start_date,\n        sell_end_date,\n        discontinued_date,\n        case \n            when discontinued_date is not null then 1\n            else 0\n        end as is_discontinued,\n        case \n            when sell_end_date is null or sell_end_date >= getdate() then 1\n            else 0\n        end as is_active,\n        list_price - standard_cost as margin_baseline,\n        case \n            when list_price > 0 then (list_price - standard_cost) / list_price * 100\n            else null\n        end as margin_baseline_pct,\n        last_modified_date\n    from bronze_products\n)\n\nselect * from cleaned", "relation_name": "\"AdventureWorks2014\".\"silver\".\"slvr_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:22.319397Z", "completed_at": "2025-12-04T08:48:22.352228Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:22.401025Z", "completed_at": "2025-12-04T08:48:23.144483Z"}], "thread_id": "Thread-3", "execution_time": 0.8463621139526367, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.slvr_customers", "compiled": true, "compiled_code": "\n\nwith bronze_customers as (\n    select * from \"AdventureWorks2014\".\"bronze\".\"brnz_customers\"\n),\n\ncleaned as (\n    select\n        customer_id,\n        person_id,\n        coalesce(first_name, 'Unknown') as first_name,\n        coalesce(last_name, 'Unknown') as last_name,\n        ltrim(rtrim(concat(coalesce(first_name, ''), ' ', coalesce(last_name, '')))) as full_name,\n        email_promotion,\n        case when email_promotion > 0 then 1 else 0 end as wants_email_promo,\n        store_id,\n        territory_id,\n        case when store_id is not null then 'Store' else 'Individual' end as customer_type,\n        case when person_id is not null then 1 else 0 end as has_person_record,\n        last_modified_date\n    from bronze_customers\n)\n\nselect * from cleaned", "relation_name": "\"AdventureWorks2014\".\"silver\".\"slvr_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:22.327208Z", "completed_at": "2025-12-04T08:48:22.345017Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:22.376394Z", "completed_at": "2025-12-04T08:48:25.074035Z"}], "thread_id": "Thread-1", "execution_time": 2.7728261947631836, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.slvr_sales_orders", "compiled": true, "compiled_code": "\n\nwith sales as (\n    select * from \"AdventureWorks2014\".\"bronze\".\"brnz_sales_orders\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        first_name,\n        last_name,\n        territory_id as customer_territory_id\n    from \"AdventureWorks2014\".\"bronze\".\"brnz_customers\"\n),\n\nproducts as (\n    select\n        product_id,\n        product_name,\n        subcategory_name,\n        product_category_id,\n        standard_cost,\n        list_price\n    from \"AdventureWorks2014\".\"bronze\".\"brnz_products\"\n),\n\nenriched as (\n    select\n        s.sales_order_id,\n        s.order_detail_id,\n        s.order_date,\n        s.due_date,\n        s.ship_date,\n        s.status,\n        case \n            when s.online_order_flag = 1 then 'Online'\n            else 'Offline'\n        end as order_channel,\n        s.sales_order_number,\n        s.purchase_order_number,\n        s.customer_id,\n        c.first_name,\n        c.last_name,\n        ltrim(rtrim(concat(coalesce(c.first_name, ''), ' ', coalesce(c.last_name, '')))) as customer_name,\n        s.sales_person_id,\n        coalesce(c.customer_territory_id, s.territory_id) as territory_id,\n        s.product_id,\n        p.product_name,\n        p.subcategory_name,\n        p.product_category_id,\n        s.order_qty,\n        s.unit_price,\n        s.unit_price_discount,\n        s.line_total,\n        -- Calculated fields\n        s.unit_price * s.order_qty as gross_amount,\n        s.line_total / nullif(s.order_qty, 0) as effective_unit_price,\n        case \n            when s.unit_price_discount > 0 then 1\n            else 0\n        end as has_discount,\n        case \n            when p.standard_cost is not null then s.unit_price - p.standard_cost\n            else null\n        end as unit_margin,\n        case \n            when p.standard_cost is not null and s.unit_price > 0 then \n                (s.unit_price - p.standard_cost) / s.unit_price * 100\n            else null\n        end as unit_margin_pct,\n        s.last_modified_date\n    from sales s\n    left join customers c\n        on s.customer_id = c.customer_id\n    left join products p\n        on s.product_id = p.product_id\n    where s.order_qty > 0\n        and s.unit_price >= 0\n)\n\nselect * from enriched", "relation_name": "\"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:25.126698Z", "completed_at": "2025-12-04T08:48:25.149633Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:25.165461Z", "completed_at": "2025-12-04T08:48:25.978527Z"}], "thread_id": "Thread-3", "execution_time": 0.881216287612915, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.gld_sales_summary", "compiled": true, "compiled_code": "\n\nwith sales as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\"\n),\n\ndaily_summary as (\n    select\n        cast(order_date as date) as order_date,\n        count(distinct sales_order_id) as total_orders,\n        count(distinct customer_id) as unique_customers,\n        sum(order_qty) as total_items_sold,\n        sum(line_total) as total_revenue,\n        avg(line_total) as avg_order_line_value,\n        sum(case when order_channel = 'Online' then 1 else 0 end) as online_orders,\n        sum(case when order_channel = 'Offline' then 1 else 0 end) as offline_orders,\n        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue\n    from sales\n    group by cast(order_date as date)\n)\n\nselect * from daily_summary", "relation_name": "\"AdventureWorks2014\".\"gold\".\"gld_sales_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:25.118001Z", "completed_at": "2025-12-04T08:48:25.142260Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:25.152044Z", "completed_at": "2025-12-04T08:48:26.110933Z"}], "thread_id": "Thread-2", "execution_time": 1.018028736114502, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.gld_product_performance", "compiled": true, "compiled_code": "\n\nwith products as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_products\"\n),\n\nsales as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\"\n),\n\nproduct_sales as (\n    select\n        p.product_id,\n        p.product_name,\n        p.subcategory_name,\n        p.color,\n        p.list_price,\n        p.standard_cost,\n        count(distinct s.sales_order_id) as total_orders,\n        sum(s.order_qty) as total_quantity_sold,\n        sum(s.line_total) as total_revenue,\n        avg(s.unit_price) as avg_selling_price,\n        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,\n        case \n            when sum(s.order_qty) > 0 then \n                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100\n            else 0\n        end as profit_margin_pct\n    from products p\n    left join sales s\n        on p.product_id = s.product_id\n    group by \n        p.product_id, \n        p.product_name, \n        p.subcategory_name, \n        p.color, \n        p.list_price, \n        p.standard_cost\n)\n\nselect * from product_sales", "relation_name": "\"AdventureWorks2014\".\"gold\".\"gld_product_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T08:48:25.110538Z", "completed_at": "2025-12-04T08:48:25.140665Z"}, {"name": "execute", "started_at": "2025-12-04T08:48:25.144507Z", "completed_at": "2025-12-04T08:48:26.130963Z"}], "thread_id": "Thread-4", "execution_time": 1.0372650623321533, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.gld_customer_metrics", "compiled": true, "compiled_code": "\n\nwith customers as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_customers\"\n),\n\nsales as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\"\n),\n\ncustomer_sales as (\n    select\n        c.customer_id,\n        c.full_name,\n        c.territory_id,\n        count(distinct s.sales_order_id) as total_orders,\n        sum(s.line_total) as total_revenue,\n        avg(s.line_total) as avg_order_value,\n        sum(s.order_qty) as total_items_purchased,\n        min(s.order_date) as first_order_date,\n        max(s.order_date) as last_order_date,\n        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount\n    from customers c\n    left join sales s\n        on c.customer_id = s.customer_id\n    group by c.customer_id, c.full_name, c.territory_id\n)\n\nselect * from customer_sales", "relation_name": "\"AdventureWorks2014\".\"gold\".\"gld_customer_metrics\""}], "elapsed_time": 4.794130802154541, "args": {"printer_width": 80, "favor_state": false, "print": true, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "indirect_selection": "eager", "macro_debugging": false, "project_dir": "/usr/app/dbt", "partial_parse": true, "require_resource_names_without_spaces": false, "source_freshness_run_project_hooks": false, "quiet": false, "log_file_max_bytes": 10485760, "which": "run", "defer": false, "write_json": true, "strict_mode": false, "use_colors_file": true, "log_level_file": "debug", "send_anonymous_usage_stats": true, "cache_selected_only": false, "enable_legacy_logger": false, "exclude": [], "populate_cache": true, "partial_parse_file_diff": true, "select": ["bronze", "silver", "gold"], "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "introspect": true, "profiles_dir": "/usr/app/dbt", "version_check": true, "invocation_command": "dbt run --select bronze silver gold", "static_parser": true, "vars": {}, "empty": false, "log_format": "default", "log_path": "/usr/app/dbt/logs", "use_colors": true}}